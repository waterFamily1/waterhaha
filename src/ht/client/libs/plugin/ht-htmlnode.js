!function(b){"use strict";var C="ht",t=b[C],N=function(){return document},M=function(){return N().body},k=function(y,i,Q){y.style.setProperty(i,Q,null)},K=function(A){return N().createElement(A)},c=function(){return K("div")},v=function(){var V=K("canvas");return V},e=function(F,L){k(F,"-webkit-transform",L),k(F,"-ms-transform",L),k(F,"transform",L)},$=function(z,i){k(z,"-webkit-transform-origin",i),k(z,"-ms-transform-origin",i),k(z,"transform-origin",i)},o=function(X,q){X.appendChild(q)},y=function(g,o){g.removeChild(o)},G=b.parseInt,Y=t.Default,X=Y.eventListenerOptionsFalse,D=(Y.eventListenerOptionsTrue,function(w,b,H,F){w.addEventListener(b,H,F?X:X)}),h=Y.getInternal(),A=Math.PI,J="white-space",a="visibility",w="left",q="top",u="width",s="height",V="position",Z="display",Q="z-index",l="px",r="0 0",n="absolute",L="visible",I="hidden",f="none",W="block",H="nowrap",d="rgba(0, 0, 0, 0.005)";Y.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var B=t.graph.GraphView.prototype,j=B._42;B.adjustHtmlNodeIndex=!0,B._42=function(W,o){if(j.call(this,W,o),this.adjustHtmlNodeIndex)for(var A=this.getDataModel()._datas._as,O=A.length,f=1,Z=0;O>Z;Z++){var d=A[Z];if(d instanceof S){var I=this.getDataUI(d);k(I.$2f,Q,f+""),k(I.$3f,Q,f+1+""),f+=2}}};var U=t.HtmlNodeUI=function(P,o){var T=this;U.superClass.constructor.call(T,P,o);var K=T.$2f=c(),m=T.$3f=v();k(K,V,n),k(K,a,I),k(K,J,H),m.draggable=!1,k(m,V,n),k(m,Z,f),$(m,r),D(K,"change",function(h){var J=h.target,d=J.bind||J.getAttribute("bind"),f=J.type&&"checkbox"===J.type?J.checked:J.value,Q=o.getContext();d&&Q&&(Q[d]=f,T.$4f=JSON.stringify(Q))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(l){D(K,l,this.$9f.bind(this))},T)};Y.def(U,h.ui().NodeUI,{_visible:!0,$11f:function(){var q=this,E=q.$3f,X=q._data,c=X.getDraggerImageWidth(),p=X.getDraggerImageHeight(),F=X.getDraggerImage(),g=h.initContext(E);g.beginPath(),h.setCanvas(E,c,p),h.translateAndScale(g,0,0,1),g.clearRect(0,0,c,p),Y.drawImage(g,Y.getImage(F),0,0,c,p),g.restore()},_80o:function(E){U.superClass._80o.call(this,E);var J=this,j=J._data,Y=j._padding,B=2*Y,$=J.$2f,N=J.$3f,p=J.gv,g=p.getZoom(),m=p.getTranslateX(),X=p.getTranslateY(),r=p.getView(),R=J._83o,i=j._width,S=j._height,x=R.position,H=R.rotation,_=(i-B)/j.$5f*g,v=(S-B)/j.$6f*g,P=J._html,b=j._html,C=j.getHtmlType();if("html"===C){var y=j.getContext()||{},O=J.$4f,z=j.$10f,M=JSON.stringify(y);P&&O&&P===b&&O===M||(J.$4f=M,J._html=b,$.innerHTML=z?z(y):b)}else if(null!=C){var D=j.getHtml();"ht"===C&&(D=D.getView()),P&&P===D&&$.contains(P)||(J._html=D,$.innerHTML="",o($,D))}if(!$.parentNode){var h=p.$1f;if(!h){var K=c();k(K,V,n),k(K,Q,"0"),h=p.$1f=K;var F=p._canvas.nextSibling;F?r.insertBefore(K,F):o(r,K)}o(h,$),o(h,N),j.onContentInitialized&&j.onContentInitialized($)}if(j._scalable){var t=j.$5f,T=j.$6f;e($,"rotate("+180*(H/A)+"deg) scale("+_+","+v+")"),k($,u,""),k($,s,""),k($,w,(x.x-t/g/2)*g+m+l),k($,q,(x.y-T/g/2)*g+X+l)}else{var Jc=G($.style.width),Fg=G($.style.height),rn=G((i-B)*g),lj=G((S-B)*g),yd="100%",Bh=$.children[0];k(Bh,u,yd),k(Bh,s,yd),(Jc!==rn||Fg!==lj)&&(k($,u,rn+l),k($,s,lj+l),"ht"===C&&b.invalidate()),e($,"rotate("+180*(H/A)+"deg)"),k($,w,(x.x-rn/g/2)*g+m+l),k($,q,(x.y-lj/g/2)*g+X+l)}var Wr=J.dragRect;p.isMovable(j)&&p.isSelected(j)&&Wr?(E.save(),E.fillStyle=d,E.fillRect(Wr.x,Wr.y,Wr.width,Wr.height),E.restore(),k(N,w,Wr.x*g+m+l),k(N,q,Wr.y*g+X+l),e(N,"scale("+g+","+g+")"),k(N,Z,W),J.$11f()):k(N,Z,f),k($,a,this._visible?L:I)},dispose:function(){var k=this.gv.$1f;this.$2f.parentNode===k&&k.removeChild(this.$2f),this.$3f.parentNode===k&&k.removeChild(this.$3f)},_84o:function(j){this._visible=j,k(this.$2f,a,j?L:I),k(this.$3f,Z,j?W:f)},_3O:function(){var y=this,j=y.gv,o=y._data;U.superClass._3O.call(y);var n=o.getRect();j.isEditable(o)&&(y.dragRect={x:n.x+n.width+o._padding,y:n.y+10,width:o.getDraggerImageWidth(),height:o.getDraggerImageHeight()},y._68o(y.dragRect))},rectIntersects:function(r){var c=this._79o();return t.Default.intersection(c,r)?!0:void 0},$9f:function(H){var D=this.gv,y=this._data;D.sm().contains(y)&&H.stopPropagation()}});var S=t.HtmlNode=function(){S.superClass.constructor.call(this)};t.Default.def(S,t.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:t.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(d){var M=this,j=M._html;M._html=d,"html"===M.getHtmlType()&&"Handlebars"in b&&(M.$10f=Handlebars.compile(d)),M.$13f(),M.fp("html",j,d)},setContext:function(y){var P=this,c=P._context;P._context=y,P.fp("context",c,y),P.$13f()},setScalable:function(e){var H=this,i=H._scalable;H._scalable=e,H.fp("scalable",i,e),H.$13f()},getHtmlType:function(){var j=this._html;return j?"string"==typeof j?"html":j.getView?"ht":"dom":null},$13f:function(){var T=this,p=T._html,t=T.$10f;if(p){var C=c(),X=!1,L=T.getHtmlType();if(k(C,V,n),k(C,J,H),k(C,a,I),"html"===L?(C.innerHTML=t?t(T.getContext()||{}):p,X=!0):"ht"===L?(o(C,p.getView()),X=!0):"dom"===L&&(o(C,p),X=!0),X){var v=2*T._padding;o(M(),C),T.$5f=C.scrollWidth,T.$6f=C.scrollHeight,T._width=T.$5f+v,T._height=T.$6f+v,T._originWidth=T._width,T._originHeight=T._height,y(M(),C)}}},getUIClass:function(){return t.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);