!function(z){"use strict";function j(V){var A,$,Q,y,e,W,G,Y=[],k=0;A=v.createDiv(),A.style.overflow="hidden";var j=V.getView();j.insertBefore(A,V.getCanvas()),$=n.Default.createDiv(),$.style.WebkitTransformStyle="preserve-3d",$.style.MozTransformStyle="preserve-3d",$.style.transformStyle="preserve-3d",A.appendChild($),[{event:"mousedown",style:"none"},{event:"mouseup",style:"auto"},{event:"touchstart",style:"none"},{event:"touchend",style:"auto"}].forEach(function(Y){var c=Y.style;j.addEventListener(Y.event,function(){A.style.pointerEvents=c})}),this.updateWebView=function(){var x=V.getCanvas(),T=1*x.style.width.slice(0,-2),n=1*x.style.height.slice(0,-2);(Y[0]!==T||Y[1]!==n)&&(Y[0]=T,Y[1]=n,A.style.width=T+"px",A.style.height=n+"px",$.style.width=T+"px",$.style.height=n+"px");var E=V._projectMatrix[5]*Y[1]/2;E!==Q&&(Q=E,A.style.WebkitPerspective=Q+"px",A.style.MozPerspective=Q+"px",A.style.perspective=Q+"px"),W="translateZ("+Q+"px)"+U(V._viewMatrix);var r=W+"translate("+Y[0]/2+"px,"+Y[1]/2+"px)";y===r||e||($.style.WebkitTransform=r,$.style.MozTransform=r,$.style.transform=r,y=r),k++,G=!1,V.dm().each(function(F){F.isWebView&&b(F)});for(var P,u=$.children,K=[],M=0,w=u.length;w>M;M++)P=u[M],P._isHtWebView&&P._renderCookie!==k&&K.push(P);K.length&&K.forEach(function(Y){$.removeChild(Y)})};var o=new Array(16),b=function(T){var m=T.getAttach();if(m){m.parentElement!==$&&$.appendChild(m),m._renderCookie=k,G=!0;var w=T.getFinalScale3d(),X=T._prefrenceSize;X&&X[0]?X[1]||(X[1]=X[0]/w[0]*w[1]):X=[w[0],w[1]],m.style.width=X[0]+"px",m.style.height=X[1]+"px";var K=1/X[0],J=1/X[1],M=1,h=T.mat;o[0]=h[0]*K,o[1]=h[1]*K,o[2]=h[2]*K,o[3]=h[3]*K,o[4]=h[4]*J,o[5]=h[5]*J,o[6]=h[6]*J,o[7]=h[7]*J,o[8]=h[8]*M,o[9]=h[9]*M,o[10]=h[10]*M,o[11]=h[11]*M,o[12]=h[12],o[13]=h[13],o[14]=h[14],o[15]=h[15];var z=x(o,e?"translate("+Y[0]/2+"px,"+Y[1]/2+"px)"+W:""),n=m.$a2;n!==z&&(m.$a2=z,m.style.WebkitTransform=z,m.style.MozTransform=z,m.style.transform=z)}}}function w(H){return Math.abs(H)<1e-10?0:H}function U(k){var C=k;return"matrix3d("+w(C[0])+","+w(-C[1])+","+w(C[2])+","+w(C[3])+","+w(C[4])+","+w(-C[5])+","+w(C[6])+","+w(C[7])+","+w(C[8])+","+w(-C[9])+","+w(C[10])+","+w(C[11])+","+w(C[12])+","+w(-C[13])+","+w(C[14])+","+w(C[15])+")"}function x(t,Z){var k=t,j="matrix3d("+w(k[0])+","+w(k[1])+","+w(k[2])+","+w(k[3])+","+w(-k[4])+","+w(-k[5])+","+w(-k[6])+","+w(-k[7])+","+w(k[8])+","+w(k[9])+","+w(k[10])+","+w(k[11])+","+w(k[12])+","+w(k[13])+","+w(k[14])+","+w(k[15])+")";return"translate(-50%,-50%)"+(Z||"")+j}var L="ht",n=z[L],v=n.Default,D=v.getInternal(),i=D.superCall,k=n.graph3d.Graph3dView,X=k.prototype.validateImpl;k.prototype.validateImpl=function(){X.call(this);var n=this._webViewRenderer;n||(n=this._webViewRenderer=new j(this)),n.updateWebView()};var s=n.WebView3d=function(){var P=this;i(s,P),P.s({shape3d:"billboard","shape3d.reverse.flip":!0})},e=[1,1,1,1],F=[0,0,0,0];v.def(L+"."+"WebView3d",n.Node,{ms_ac:["attach"],isWebView:!0,attachDOM:function($,n,Q){if(!$)return this.detachDOM();if("string"==typeof $){var k=document.createElement("iframe");k.src=$,$=k}var x=$.style;x.position="absolute",x.border=0,x.outline=0,x.padding=0,x.margin=0,$._isHtWebView=!0,this.setAttach($),this._prefrenceSize=[n,Q],this.s("shape3d.blend",F)},detachDOM:function(){this.setAttach(null),this.s("shape3d.blend",this.getBgColor())},setBgColor:function(g){this.a("defaultBgColor",g),this.getAttach()||this.s("shape3d.blend",g)},getBgColor:function(){return this.a("defaultBgColor")||e}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);