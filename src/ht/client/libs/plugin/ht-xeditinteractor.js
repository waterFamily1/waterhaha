!function(R,Q,U){"use strict";var N="ht",W=R[N],E=W.Default,i=W.graph,c=E.getInternal(),F=c.ui(),$=F.NodeUI.prototype,g=F.ShapeUI.prototype,H=i.GraphView,t=H.prototype,x=F.EdgeUI.prototype,I=W.Node,p=W.Shape,w=W.Edge,S=W.Group,n=E.isTouchable,T=E.preventDefault,B=R.setTimeout,D=E.grow,X=E.isDragging,C=E.getDistance,Y=null,s=W.List,d="undefined"!=typeof Float32Array?Float32Array:Array,k=Math,L=k.PI,r="Crossing",u="No Crossing",b=L/2,P=2*L,O=k.atan2,K=k.sqrt,a=k.pow,V=k.sin,q=k.cos,m=k.min,Z=k.max,h=k.abs,j=k.ceil,A=k.round,o=E.unionPoint,z=E.unionRect,G=E.containsPoint,_=E.clone,M="rgb(52, 152, 219)",l="red",v={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},y={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var T=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],r=0;r<T.length;r++){var g=T[r];g=0===r%2?g/400*y.width:g/100*y.height,T[r]=g}return y.width>120&&(T[4]=y.width-26,T[6]=y.width-40,T[10]=y.width-40,T[12]=y.width-26,T[18]=33),T}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},J={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:M,rotation:.61},{type:"circle",rect:[200,120,70,70],background:M,rotation:.61},{type:"circle",rect:[200,220,70,70],background:M,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:M},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:M}]},f={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:l,rotation:.61}]},e={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:M},{type:"circle",rect:[0,210,90,90],background:M},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:M}]},ej={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:l},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:l}]},fk={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:M}]},Pd={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:l}]},lf={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},Zj={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},nc=function(P){var x=P.touches[0];return x?x:P.changedTouches[0]},jr=function(c,W,i,K){return O(K-W,i-c)},Lp=function(b,J){return{x:b.x*J,y:b.y*J}},Gq=function(W,I){W.each(function(x){return W.isSelected(x)?I(x):void 0})},Sj=function(Y,P){Y.reverseEach(function(E){return Y.isSelected(E)?P(E):void 0})},Jn=function(l,n,D){var o,W,x,J,Y,E=this,A=n,$=E.gv;if(l instanceof p){x=l.getSegments();var X=$.getDataUI(l);Y=X._55O.$15l,x&&x.size()||(x=Xq(Y)),l.isClosePath()&&x.indexOf(5)<0&&(x=new s(x._as),x.add(5)),o=Mh(l,X,A),W=Y[o]}else{var U=$.getDataUI(l);Y=ac(U,l.s("edge.points")),x=l.s("edge.segments"),x&&x.size()||(x=Xq(Y)),Y=Y._as,o=Mh(l,U,A),W=Y[o]}if(x&&(J=x.get(A)),2===J||1===J||5===J){var y=Y[o+1];5===J&&(y=Y[0]);var H=gr(W,D,y);return H}return D},Ll=function(Z,Y,f,t){var b=Y/2,K=f/2,T=Lf(Z,-b,-K,t),x=Lf(Z,b,-K,t),G=Lf(Z,-b,K,t),R=Lf(Z,b,K,t),n=Lf(Z,0,-K,t),i=Lf(Z,b,0,t),s=Lf(Z,0,K,t),g=Lf(Z,-b,0,t);return[T,x,G,R,n,i,s,g]},gr=function(G,T,B){var P={x:T.x-G.x,y:T.y-G.y},i={x:B.x-G.x,y:B.y-G.y},h=K(a(B.x-G.x,2)+a(B.y-G.y,2)),e={x:i.x/h,y:i.y/h},W=P.x*e.x+P.y*e.y,U={x:e.x*W,y:e.y*W};return{x:G.x+U.x,y:G.y+U.y}},Lf=function(_,e,O,j){var R=q(j)*e-V(j)*O,Y=V(j)*e+q(j)*O;return _?{x:_.x+R,y:_.y+Y}:{x:R,y:Y}},gd=function(Y,F){return F>2*Y?Y:F/2},zp=function(R,O,k,g){var P=C(R,O);return k=g?m(k,P):gd(k,P),P?k/=P:k=0,{x:R.x+(O.x-R.x)*k,y:R.y+(O.y-R.y)*k}},Dk=function(h,r){var J,L,a=h.gv,k=h._data,q=k._40I,D=k._41I,I=k.s("edge.offset"),M=k.s("edge.source.position"),d=k.s("edge.target.position"),e=k.s("edge.source.offset.x"),Q=k.s("edge.source.offset.y"),U=k.s("edge.target.offset.x"),j=k.s("edge.target.offset.y"),o=k.s("edge.source.anchor.x"),p=k.s("edge.source.anchor.y"),w=k.s("edge.target.anchor.x"),X=k.s("edge.target.anchor.y");if(r?(J=c.getEdgeAgentPosition(a,q,M,e,Q,o,p),L=c.getEdgeAgentPosition(a,D,d,U,j,w,X)):(J=c.getEdgeAgentPosition(a,q,M,0,0,o,p),L=c.getEdgeAgentPosition(a,D,d,0,0,w,X)),"points"===k.s("edge.type")&&I&&!k.s("edge.center")&&J){var G=k.s("edge.points")||new s,m=G.size(),F=zp(J,m?G.get(0):L,I,m),y=zp(L,m?G.get(m-1):J,I,m);J=F,L=y}return[J,L]},ac=function(f,r,w){var j=f._78o,T=f._data,S=T.s("edge.type"),x=[j.sourcePoint,j.targetPoint];return"points"===S?w&&(x=Dk(f)):x=j.center?S?w?Dk(f):Dk(f,!0):w?Dk(f):[j.c1,j.c2]:w?Dk(f):Dk(f,!0),r=new s(r?r._as:Y),r.add(x[0],0),r.add(x[1]),r},Tc=function(Y){return Y=new s(Y._as),Y.removeAt(0),Y.removeAt(Y.size()-1),Y},Xq=function(L){L._as||(L=new s(L));var D=new s;D.add(1);for(var V=1;V<L.size();V++)D.add(2);return D},Am=function(H,s){return{x:(H.x+s.x)/2,y:(H.y+s.y)/2}},ue=function(D,R){return{x:D.x+1*(R.x-D.x)/4,y:D.y+1*(R.y-D.y)/4}},Kk=function(m,n){return{x:m.x+3*(n.x-m.x)/4,y:m.y+3*(n.y-m.y)/4}},Ac=function(M,c,X,f){var $=c.x+c.width/2,Y=c.y+c.height/2,T=K($*$+Y*Y),v=O(Y,$)+X;return{x:f.x+T*q(v),y:f.y+T*V(v)}},$i=t.validateImpl,jk=t.isRectEditable,Xk=t.isPointEditable,Em=t._42,Xp=g._79o,bq=x._79o,Gc=g._48O,am=g._47O,Eo=$._48O,nl=$._80o,Ui=g._80o,ei=$.getSelectWidth,Vo=$._47O,yp=x._47O,Qe=t.isEditable,Ne=["northwest","north","northeast","east","southeast","south","southwest","west"],Ap=function(f,i,y,w,h,D,U,t,n,l){var I=f.x,p=f.y,P=f.width,G=f.height,Q={x:I+P/2,y:p+G/2};w=w||0,i=Lf(Q,i.x-Q.x,i.y-Q.y,-w),U&&!t&&(i.x+=n,i.y+=l);var W=.01;if("northwest"===y?(i.x+h>I+P-W&&(i.x=I+P-h-W),i.y+h>p+G-W&&(i.y=p+G-h-W),f=o(i,{x:I+P,y:p+G})):"north"===y?(i.y+h>p+G-W&&(i.y=p+G-h-W),f=o({x:I,y:i.y},{x:I+P,y:p+G})):"northeast"===y?(i.x<I+h+W&&(i.x=I+h+W),i.y+h>p+G-W&&(i.y=p+G-h-W),f=o({x:I,y:i.y},{x:i.x,y:p+G})):"west"===y?(i.x+h>I+P-W&&(i.x=I+P-h-W),f=o({x:i.x,y:p},{x:I+P,y:p+G})):"east"===y?(i.x<I+h+W&&(i.x=I+h+W),f=o({x:I,y:p},{x:i.x,y:p+G})):"southwest"===y?(i.x+h>I+P-W&&(i.x=I+P-h-W),i.y<p+h+W&&(i.y=p+h+W),f=o({x:i.x,y:p},{x:I+P,y:i.y})):"south"===y?(i.y<p+h+W&&(i.y=p+h+W),f=o({x:I,y:p},{x:I+P,y:i.y})):"southeast"===y&&(i.x<I+h+W&&(i.x=I+h+W),i.y<p+h+W&&(i.y=p+h+W),f=o({x:I,y:p},i)),"keepRatio"===D&&(!U&&t||U&&!t)&&("northeast"===y||"southeast"===y||"northwest"===y||"southwest"===y)){var S=f.width,K=f.height,$=S/P,T=K/G,E=m($,T);f.width=P*E,f.height=G*E,"northeast"===y?f.y=p+(G-f.height):"northwest"===y?(f.y=p+(G-f.height),f.x=I+(P-f.width)):"southwest"===y&&(f.x=I+(P-f.width))}f.x-=Q.x,f.y-=Q.y;var C=Ac(Y,f,w,Q);return f.x=C.x-f.width/2,f.y=C.y-f.height/2,f},yh=function(R,T,v,P){var z=R.getRotation(),B=T,L=B.x,Q=B.y,i=B.width,m=B.height,G={x:L+B.width/2,y:Q+B.height/2};P=Lf(G,P.x-G.x,P.y-G.y,-z),"northwest"===v?B=o(P,{x:L+i,y:Q+m}):"north"===v?B=o({x:L,y:P.y},{x:L+i,y:Q+m}):"northeast"===v?B=o({x:L,y:P.y},{x:P.x,y:Q+m}):"west"===v?B=o({x:P.x,y:Q},{x:L+i,y:Q+m}):"east"===v?B=o({x:L,y:Q},{x:P.x,y:Q+m}):"southwest"===v?B=o({x:P.x,y:Q},{x:L+i,y:P.y}):"south"===v?B=o({x:L,y:Q},{x:L+i,y:P.y}):"southeast"===v&&(B=o({x:L,y:Q},P)),R.setRect(B),B.x-=G.x,B.y-=G.y;var t=Ac(R,B,z,G);R.p(t.x,t.y)},xi=function(p,I,D,O,L,N,W,z){var U=Y;N?(U=Lf(Y,L.x-I.x,L.y-I.y,-D),U.x-=W.x,U.y-=W.y):U=Lf(Y,L.x-I.x,L.y-I.y,0);var E={x:I.x+U.x,y:I.y+U.y};z&&(E=z(E.x,E.y)),E.e=p.getPoints().get(O).e,p.setPoint(O,E);var c=p.getWidth(),k=p.getHeight(),a=p.p().x-c/2,B=p.p().y-k/2;a-=I.x,B-=I.y;var v=Ac(p,{x:a,y:B,width:c,height:k},D,I);p.p(v.x,v.y)},Mh=function(q,v,e){var K,L;if(q instanceof p?(K=q.getPoints(),L=q.getSegments()):q instanceof w&&"points"===q.s("edge.type")&&(K=q.s("edge.points"),L=q.s("edge.segments"),K=ac(v,K)),L&&L.size()||(L=Xq(K)),q instanceof p&&q.isClosePath()&&L.indexOf(5)<0&&(L=new s(L._as),L.add(5)),L)for(var H=-1,G=0;G<L.size();G++){if(G===e)return H;var o=L.get(G);1===o?H+=1:2===o?H+=1:3===o?H+=2:4===o&&(H+=3)}},bc=function(K,X,y){var z,g;if(K instanceof p?(z=K.getPoints(),g=K.getSegments()):K instanceof w&&"points"===K.s("edge.type")&&(z=K.s("edge.points"),g=K.s("edge.segments"),z=ac(X,z)),g&&g.size()||(g=Xq(z)),g)for(var T=-1,L=0;L<g.size();L++){var O=g.get(L);if(1===O?T+=1:2===O?T+=1:3===O?T+=2:4===O&&(T+=3),T===y)return L}},We=function(H,A){var z=[H[0]-A[0],H[1]-A[1],H[2]-A[2]];return z},Fl=function(){var X=new d(16);return X[0]=1,X[1]=0,X[2]=0,X[3]=0,X[4]=0,X[5]=1,X[6]=0,X[7]=0,X[8]=0,X[9]=0,X[10]=1,X[11]=0,X[12]=0,X[13]=0,X[14]=0,X[15]=1,X},Pk=function(J,p){var W=J[0],$=J[1],a=J[2];return J[0]=p[0]*W+p[4]*$+p[8]*a+p[12],J[1]=p[1]*W+p[5]*$+p[9]*a+p[13],J[2]=p[2]*W+p[6]*$+p[10]*a+p[14],J},Ji=function(D,y){if(y){var X=V(y),T=q(y),G=D[0],W=D[1],i=D[2],r=D[3],d=D[8],I=D[9],U=D[10],s=D[11];D[0]=G*T-d*X,D[1]=W*T-I*X,D[2]=i*T-U*X,D[3]=r*T-s*X,D[8]=G*X+d*T,D[9]=W*X+I*T,D[10]=i*X+U*T,D[11]=r*X+s*T}},Rm=function(j,_){for(var H=j.s("grid.row.count"),N=j.s("grid.column.count"),e=0;H>e;e++)for(var R=0;N>R;R++){var h=j.getCellRect(e,R);if(G(h,_))return{rowIndex:e,columnIndex:R,rect:h,grid:j}}return null},Yh=function(I,n,f,K,O,Y){var G={},H=f-I,d=K-n,S=k.sqrt(H*H+d*d),R=H/S,X=d/S,N=(-I+O)*R+(-n+Y)*X;return 0>=N?(G.x=I,G.y=n):N>=S?(G.x=f,G.y=K):(G.x=I+N*R,G.y=n+N*X),H=O-G.x,d=Y-G.y,G.z=k.sqrt(H*H+d*d),G},In=function(A,l){var M,V,q,e,_,U,u,z,i=A.getPoints(),T=A.getSegments(),L=A.p(),y=A.getRotation();if(!T||!(T.indexOf(3)>0||T.indexOf(4)>0)){for(z=0;z<=i.size()-1;z++)if(z===i.size()-1?(_=i.get(0),e=i.get(z)):(e=i.get(z),_=i.get(z+1)),e=Lf(L,e.x-L.x,e.y-L.y,y),_=Lf(L,_.x-L.x,_.y-L.y,y),U=Yh(e.x,e.y,_.x,_.y,l.x,l.y),u=U.z,u<(A.s("shape.border.width")||10)){V=e,q=_,M=z;break}if(M!=Y){var I=Yh(V.x,V.y,q.x,q.y,l.x,l.y),J=C(V,I);return{attachIndex:M,attachOffset:J}}}},aj=function(S){for(var _=S._data,v=_.p(),z=_.getRotation(),U=_.getPoints(),g=Y,Q=[],O=0;O<U.size();O++)g=U.get(O),Q.push(Lf(v,g.x-v.x,g.y-v.y,z));S._55O.$15l=Q};E.setImage("xeditinteractor_parentIcon",J),E.setImage("xeditinteractor_hostIcon",f),E.setImage("xeditinteractor_edgeIcon",e),E.setImage("xeditinteractor_removeIcon",ej),E.setImage("xeditinteractor_sourceIcon",fk),E.setImage("xeditinteractor_targetIcon",Pd),E.setImage("xeditinteractor_elevationIcon",lf),E.setImage("xeditinteractor_tallIcon",Zj),t._editPointSize=n?24:9,t._edgeHelpers=["parent","remove","source","target"],t._leftTopHelpers=["parent"],t._rightTopHelpers=["host"],t._leftBottomHelpers=["edge"],t._rightBottomHelpers=["remove"],Ne=Ne.concat(Ne).concat(Ne),x._79o=function(){var u=this,R=u.gv,P=R.getZoom(),S=R._editInteractor,q=bq.call(u);if(!q)return null;var e=Dk(u,!0),J=e[0],V=e[1],$={x:q.x,y:q.y,width:q.width,height:q.height},n=o(J,V);if(S instanceof i.XEditInteractor){$=z($,n);var B=u._55O,d=R.getEditPointSize()/P+2,s=0;B&&B._43O&&(s+=d/2,D($,s))}return $},x._47O=function(g){var c=this,h=c.gv,v=h._editInteractor;v instanceof i.XEditInteractor||yp.call(c,g)},x.rectIntersects=function(X){var v=this,R=v._data,H=v.gv,O=H.getZoom(),V=v._55O,S=H._editInteractor;if(S instanceof i.XEditInteractor&&H.isEditable(R)&&V&&V._43O&&"points"===R.s("edge.type")){var x=R.s("edge.points"),g=R.s("edge.segments");x=ac(v,x),g&&g.size()||(g=Xq(x)),x=x._as;var _=!1,o=n?5:1,b=X.x+o,y=X.y+o,f={x:b,y:y};if(S._edge===R&&S._hoverSegmentIndex>=0){var W=H._editInteractor._hoverSegmentIndex,I=g.get(W),P=Mh(R,v,W),G=Y;if(P!=Y&&P>=0){var Q=x[P],e=H.getSegmentHoverWidth()/O;if(2===I||1===I){var q=x[P+1];G=Hc(new ns(Q.x,Q.y),new ns(q.x,q.y),new ns(f.x-e,f.y-e),new ns(f.x+2*e,f.y+2*e)),G.$62l===r&&(_=!0)}else if(3===I){var l=x[P+1],q=x[P+2];G=lq(new ns(Q.x,Q.y),new ns(l.x,l.y),new ns(q.x,q.y),new ns(f.x-e,f.y-e),new ns(f.x+2*e,f.y+2*e)),G.$62l===r&&(_=!0)}else if(4===I){var B=x[P+1],j=x[P+2];q=x[P+3],G=jp(new ns(Q.x,Q.y),new ns(B.x,B.y),new ns(j.x,j.y),new ns(q.x,q.y),new ns(f.x-e,f.y-e),new ns(f.x+2*e,f.y+2*e)),G.$62l===r&&(_=!0)}}}if(_)return!0}return Y},g._47O=function(j){var Y=this,Q=Y.gv,L=Q._editInteractor;L instanceof i.XEditInteractor||am.call(Y,j)},g.rectIntersects=function(A){var k=this,B=k._data,c=k.gv,p=c.getZoom(),U=k._55O,P=c._editInteractor;if(P instanceof i.XEditInteractor&&c.isEditable(B)&&U&&U._43O){var q=U.$15l,l=!1,V=n?5:1,a=A.x+V,G=A.y+V,Z={x:a,y:G};if(q&&q.length===B.getPoints().size()||(aj(k),q=U.$15l),P._shape===B&&P._hoverSegmentIndex>=0){var w=B.getSegments();w&&w.size()||(w=Xq(q));var I=c._editInteractor._hoverSegmentIndex,C=w.get(I),H=Mh(B,k,I),K=Y;if(H!=Y&&H>=0){var h=q[H],b=c.getSegmentHoverWidth()/p;if(2===C||1===C){var v=q[H+1];K=Hc(new ns(h.x,h.y),new ns(v.x,v.y),new ns(Z.x-b,Z.y-b),new ns(Z.x+2*b,Z.y+2*b)),K.$62l===r&&(l=!0)}else if(3===C){var j=q[H+1],v=q[H+2];K=lq(new ns(h.x,h.y),new ns(j.x,j.y),new ns(v.x,v.y),new ns(Z.x-b,Z.y-b),new ns(Z.x+2*b,Z.y+2*b)),K.$62l===r&&(l=!0)}else if(4===C){var t=q[H+1],W=q[H+2];v=q[H+3],K=jp(new ns(h.x,h.y),new ns(t.x,t.y),new ns(W.x,W.y),new ns(v.x,v.y),new ns(Z.x-b,Z.y-b),new ns(Z.x+2*b,Z.y+2*b)),K.$62l===r&&(l=!0)}}}if(l)return!0}return Y},g._48O=function(){var e=this,c=e.gv,V=c._editInteractor;V instanceof i.XEditInteractor?($._48O.call(e),e._55O._43O&&aj(e)):Gc.call(e)},g._79o=function(){var K=this,e=K.gv,h=e.getZoom(),c=e._editInteractor,p=Xp.call(K);if(p){var H={x:p.x,y:p.y,width:p.width,height:p.height};if(c instanceof i.XEditInteractor){var M=K._55O,o=e.getEditPointSize()/h+2,g=0;M&&M._43O&&(g+=o/2,D(H,g))}return H}},$._47O=function(H){var d=this,v=d.gv,e=v._editInteractor;if(e instanceof i.XEditInteractor);else{var D=d._55O;D&&D._98o&&Vo.call(d,H)}},$.getSelectWidth=function(){var Y=this,s=Y.gv,a=s._editInteractor,j=Y._data;return s.isEditable(j)&&a instanceof i.XEditInteractor?0:ei.call(Y)},$._80o=function(k){var g=this,f=g.gv._editInteractor;if(nl.call(g,k),f&&f._debug){k.save(),k.beginPath(),k.lineWidth=1,k.strokeStyle="green";var H=g._79o();H&&(k.rect(H.x,H.y,H.width,H.height),k.stroke()),k.restore()}},g._80o=function(M){var j=this,n=j.gv._editInteractor;if(Ui.call(j,M),n&&n._debug){M.save(),M.beginPath(),M.lineWidth=1,M.strokeStyle="green";var Y=j._79o();M.rect(Y.x,Y.y,Y.width,Y.height),M.stroke(),M.restore()}},$._48O=function(){var A=this,h=A.gv,m=A._data,D=h._editInteractor,d=A._55O,p=m.p(),w=m.getRotation();if(D instanceof i.XEditInteractor){if(d._42O){var t=Ll(p,m.getWidth(),m.getHeight(),w),u=t[0],R=t[1],I=t[2],C=t[3],W=t[4],T=t[5],G=t[6],X=t[7];d.$45l=[u,W,R,T,C,G,I,X]}}else Eo.call(A)},t.getResizeMode=function(){return this.$25l||"normal"},t.setResizeMode=function(M){var o=this.$25l;this.$25l=M,this.fp("resizeMode",o,M)},t.getSnapAngle=function(){return this.$26l||Math.PI/36},t.setSnapAngle=function($){var h=this.$26l;this.$26l=$,this.fp("snapAngle",h,$)},t.getSnapSpacing=function(){return this.$27l},t.setSnapSpacing=function(F){var W=this.$27l;this.$27l=F,this.fp("snapSpacing",W,F)},t.getPointSnapSpacing=function(){return this._pointSnapSpacing},t.setPointSnapSpacing=function(w){var l=this._pointSnapSpacing;this._pointSnapSpacing=w,this.fp("pointSnapSpacing",l,w)},t.setHelperEditableFunc=function(c){var B=this._helperEditableFunc;this._helperEditableFunc=c,this.fp("helperEditableFunc",B,c)},t.getHelperEditableFunc=function(){return this._helperEditableFunc},t.setLeftTopHelpers=function(L){var k=this._leftTopHelpers;this._leftTopHelpers=L,this.fp("leftTopHelpers",k,L)},t.getLeftTopHelpers=function(){return this._leftTopHelpers},t.setLeftTopHelpersAlign=function(i){var G=this._leftTopHelpersAlign;this._leftTopHelpersAlign=i,this.fp("leftTopHelpersAlign",G,i)},t.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},t.setRightTopHelpers=function(a){var o=this._rightTopHelpers;this._rightTopHelpers=a,this.fp("rightTopHelpers",o,a)},t.getRightTopHelpers=function(){return this._rightTopHelpers},t.setRightTopHelpersAlign=function(T){var l=this._rightTopHelpersAlign;this._rightTopHelpersAlign=T,this.fp("rightTopHelpersAlign",l,T)},t.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},t.setLeftBottomHelpers=function(r){var K=this._leftBottomHelpers;this._leftBottomHelpers=r,this.fp("leftBottomHelpers",K,r)},t.getLeftBottomHelpers=function(){return this._leftBottomHelpers},t.setLeftBottomHelpersAlign=function(D){var h=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=D,this.fp("leftBottomHelpersAlign",h,D)},t.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},t.setRightBottomHelpers=function(Y){var r=this._rightBottomHelpers;this._rightBottomHelpers=Y,this.fp("rightBottomHelpers",r,Y)},t.getRightBottomHelpers=function(){return this._rightBottomHelpers},t.setRightBottomHelpersAlign=function(Z){var F=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=Z,this.fp("rightBottomHelpersAlign",F,Z)},t.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},t.setEdgeHelpers=function(S){var o=this._edgeHelpers;this._edgeHelpers=S,this.fp("edgeHelpers",o,S)},t.getEdgeHelpers=function(){return this._edgeHelpers},t.isHelperEditable=function(b,D){return b instanceof w&&("host"===D||"edge"===D||"elevation"===D||"tall"===D)?!1:b instanceof I&&("source"===D||"target"===D)?!1:"pointElevation"===D?this._helperEditableFunc?this._helperEditableFunc(b,D):!1:this._helperEditableFunc?this._helperEditableFunc(b,D):!0},t.getEditHelperSize=function(){return this._editHelperSize||(n?28:16)},t.setEditHelperSize=function(C){var d=this._editHelperSize;this._editHelperSize=C,this.fp("editHelperSize",d,C)},t.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},t.setEditRectBorderColor=function(v){var q=this.$28l;this.$28l=v,this.fp("editRectBorderColor",q,v)},t.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},t.setNodeBorderColor=function(X){var A=this.$29l;this.$29l=X,this.fp("nodeBorderColor",A,X)},t.getEditRectBorderStyle=function(){return this.$30l||"dashed"},t.setEditRectBorderStyle=function(P){var W=this.$30l;this.$30l=P,this.fp("editRectBorderStyle",W,P)},t.getControlPointBackground=function(){return this.$31l||"#ff0"},t.setControlPointBackground=function(x){var X=this.$31l;this.$31l=x,this.fp("controlPointBackground",X,x)},t.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},t.setControlPointBorderColor=function(S){var D=this.$32l;this.$32l=S,this.fp("controlPointBorderColor",D,S)},t.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},t.setJoinPointBackground=function(o){var K=this.$33l;this.$33l=o,this.fp("joinPointBackground",K,o)},t.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},t.setJoinPointBorderColor=function(W){var p=this.$34l;this.$34l=W,this.fp("joinPointBorderColor",p,W)},t.getDirectionLineColor=function(){return this.$35l||"#888"},t.setDirectionLineColor=function(E){var q=this.$35l;this.$35l=E,this.fp("directionLineColor",q,E)},t.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},t.setSegmentHoverColor=function(n){var r=this.$36l;this.$36l=n,this.fp("segmentHoverColor",r,n)},t.getSegmentHoverWidth=function(){return this.$22l||(n?16:8)},t.setSegmentHoverWidth=function(d){var f=this.$22l;this.$22l=d,this.fp("segmentHoverWidth",f,d)},t.getSnapPointBorderColor=function(){return this.$38l||"#f00"},t.setSnapPointBorderColor=function(Z){var q=this.$38l;this.$38l=Z,this.fp("snapPointBorderColor",q,Z)},t.getEditRectPadding=function(){return this.$39l!=Y?this.$39l:6},t.setEditRectPadding=function(g){var c=this.$39l;this.$39l=g,this.fp("editRectPading",c,g)},t.isRectEditable=function(u){var q=this,l=q._editInteractor;return l instanceof i.XEditInteractor?q._rectEditableFunc?q._rectEditableFunc(u):!0:jk.call(q,u)},t.isPointEditable=function(M){var q=this,W=q._editInteractor;return W instanceof i.XEditInteractor?q._pointEditableFunc?q._pointEditableFunc(M):!0:Xk.call(q,M)},t.validateImpl=function(){var t=this,N=t.$14l,F=t._editInteractor;if(N){var H=t.getWidth(),M=t.getHeight();(H!==N.clientWidth||M!==N.clientHeight)&&(F&&(F._68I=1),c.setCanvas(N,H,M),t._32I=1)}$i.call(this)},t.isEditable=function(I){var L=Qe.call(this,I),V=this._editInteractor;if(V instanceof i.XEditInteractor&&I instanceof w){if(!I.s("2d.editable"))return!1;var s=this.getEditableFunc();L=s?s(I):!0}return L},t._42=function(U,v){var o=this,t=o._editInteractor;Em.call(o,U,v),t instanceof i.XEditInteractor&&t._68I&&t._42()},t.isSnapPoint=function(){return!0};var _b=function(R){arguments.length>0&&this.$58l(R)},Um=_b.prototype;Um.$58l=function(s){this.$62l=s,this.points=new Array},Um.$56l=function(I){this.points.push(I)},Um.$57l=function(g){this.points=this.points.concat(g)};var ns=function($,M){arguments.length>0&&this.$58l($,M)},Sp=ns.prototype;Sp.$58l=function(p,n){this.x=p,this.y=n},Sp.add=function(p){return new ns(this.x+p.x,this.y+p.y)},Sp.addEquals=function(O){return this.x+=O.x,this.y+=O.y,this},Sp.$55l=function(o){return new ns(this.x*o,this.y*o)},Sp.eq=function(w){return this.x==w.x&&this.y==w.y},Sp.lt=function(s){return this.x<s.x&&this.y<s.y},Sp.lte=function(h){return this.x<=h.x&&this.y<=h.y},Sp.gt=function(P){return this.x>P.x&&this.y>P.y},Sp.gte=function(k){return this.x>=k.x&&this.y>=k.y},Sp.lerp=function(g,R){return new ns(this.x+(g.x-this.x)*R,this.y+(g.y-this.y)*R)},Sp.distanceFrom=function(c){var V=this.x-c.x,p=this.y-c.y;return K(V*V+p*p)},Sp.min=function(o){return new ns(m(this.x,o.x),m(this.y,o.y))},Sp.max=function(S){return new ns(Z(this.x,S.x),Z(this.y,S.y))},Sp.toString=function(){return this.x+","+this.y};var ii=function(){this.$58l(arguments)},iq=ii.prototype;ii.TO=1e-6,ii.AC=6,iq.$58l=function(K){this.co=new Array;for(var B=K.length-1;B>=0;B--)this.co.push(K[B])},iq.$55l=function(X){for(var C=new ii,w=0;w<=this.$50l()+X.$50l();w++)C.co.push(0);for(var w=0;w<=this.$50l();w++)for(var n=0;n<=X.$50l();n++)C.co[w+n]+=this.co[w]*X.co[n];return C},iq.$59l=function(){for(var k=this.$50l();k>=0&&h(this.co[k])<=ii.TO;k--)this.co.pop()},iq.$50l=function(){return this.co.length-1},iq.$51l=function(){var e;switch(this.$59l(),this.$50l()){case 0:e=new Array;break;case 1:e=this.$52l();break;case 2:e=this.$53l();break;case 3:e=this.$54l();break;case 4:e=this.$63l();break;default:e=new Array}return e},iq.$52l=function(){var g=new Array,D=this.co[1];return 0!=D&&g.push(-this.co[0]/D),g},iq.$53l=function(){var Y=new Array;if(2==this.$50l()){var Z=this.co[2],Q=this.co[1]/Z,u=this.co[0]/Z,s=Q*Q-4*u;if(s>0){var E=K(s);Y.push(.5*(-Q+E)),Y.push(.5*(-Q-E))}else 0==s&&Y.push(.5*-Q)}return Y},iq.$63l=function(){var N=new Array;if(4==this.$50l()){var u=this.co[4],Q=this.co[3]/u,B=this.co[2]/u,A=this.co[1]/u,e=this.co[0]/u,p=new ii(1,-B,Q*A-4*e,-Q*Q*e+4*B*e-A*A).$54l(),J=p[0],$=Q*Q/4-B+J;if(h($)<=ii.TO&&($=0),$>0){var d=K($),o=3*Q*Q/4-d*d-2*B,W=(4*Q*B-8*A-Q*Q*Q)/(4*d),O=o+W,z=o-W;if(h(O)<=ii.TO&&(O=0),h(z)<=ii.TO&&(z=0),O>=0){var Z=K(O);N.push(-Q/4+(d+Z)/2),N.push(-Q/4+(d-Z)/2)}if(z>=0){var Z=K(z);N.push(-Q/4+(Z-d)/2),N.push(-Q/4-(Z+d)/2)}}else if(0>$);else{var W=J*J-4*e;if(W>=-ii.TO){if(0>W&&(W=0),W=2*K(W),o=3*Q*Q/4-2*B,o+W>=ii.TO){var q=K(o+W);N.push(-Q/4+q/2),N.push(-Q/4-q/2)}if(o-W>=ii.TO){var q=K(o-W);N.push(-Q/4+q/2),N.push(-Q/4-q/2)}}}}return N},iq.$54l=function(){var x=new Array;if(3==this.$50l()){var N=this.co[3],P=this.co[2]/N,F=this.co[1]/N,p=this.co[0]/N,A=(3*F-P*P)/3,S=(2*P*P*P-9*F*P+27*p)/27,M=P/3,f=S*S/4+A*A*A/27,d=S/2;if(h(f)<=ii.TO&&(f=0),f>0){var L,s,e=K(f);L=-d+e,s=L>=0?a(L,1/3):-a(-L,1/3),L=-d-e,L>=0?s+=a(L,1/3):s-=a(-L,1/3),x.push(s-M)}else if(0>f){var J=K(-A/3),D=O(K(-f),-d)/3,i=q(D),Q=V(D),o=K(3);x.push(2*J*i-M),x.push(-J*(i+o*Q)-M),x.push(-J*(i-o*Q)-M)}else{var L;L=d>=0?-a(d,1/3):a(-d,1/3),x.push(2*L-M),x.push(-L-M)}}return x};var Le=function(W,Q){arguments.length>0&&this.$58l(W,Q)},zk=Le.prototype;zk.$58l=function(b,r){this.x=b,this.y=r},zk.length=function(){return K(this.x*this.x+this.y*this.y)},zk.$60l=function(q){return this.x*q.x+this.y*q.y};var Gp=function(S,F,i,n){var b,G=(n.x-i.x)*(S.y-i.y)-(n.y-i.y)*(S.x-i.x),V=(F.x-S.x)*(S.y-i.y)-(F.y-S.y)*(S.x-i.x),w=(n.y-i.y)*(F.x-S.x)-(n.x-i.x)*(F.y-S.y);if(0!=w){var Q=G/w,k=V/w;Q>=0&&1>=Q&&k>=0&&1>=k?(b=new _b(r),b.points.push(new ns(S.x+Q*(F.x-S.x),S.y+Q*(F.y-S.y)))):b=new _b(u)}else b=0==G||0==V?new _b("C"):new _b("P");return b},Xo=function(T,x,n,i,c){var w,X,k,Q,D,V,K,B=i.min(c),O=i.max(c),l=new _b(u);w=x.$55l(-2),k=T.add(w.add(n)),w=T.$55l(-2),X=x.$55l(2),Q=w.add(X),D=new ns(T.x,T.y),K=new Le(i.y-c.y,c.x-i.x),V=i.x*c.y-c.x*i.y;for(var j=new ii(K.$60l(k),K.$60l(Q),K.$60l(D)+V).$51l(),J=0;J<j.length;J++){var g=j[J];if(g>=0&&1>=g){var N=T.lerp(x,g),W=x.lerp(n,g),Z=N.lerp(W,g);i.x==c.x?B.y<=Z.y&&Z.y<=O.y&&(l.$62l=r,l.$56l(Z)):i.y==c.y?B.x<=Z.x&&Z.x<=O.x&&(l.$62l=r,l.$56l(Z)):Z.gte(B)&&Z.lte(O)&&(l.$62l=r,l.$56l(Z))}}return l},lq=function(E,G,f,p,C){var O=p.min(C),o=p.max(C),F=new ns(o.x,O.y),x=new ns(O.x,o.y),n=Xo(E,G,f,O,F),X=Xo(E,G,f,F,o),Q=Xo(E,G,f,o,x),R=Xo(E,G,f,x,O),g=new _b(u);return g.$57l(n.points),g.$57l(X.points),g.$57l(Q.points),g.$57l(R.points),g.points.length>0&&(g.$62l=r),g},wf=function(L,s,D,j,P,V){var A,m,S,k,B,T,Q,F,i,c,x=P.min(V),q=P.max(V),t=new _b(u);A=L.$55l(-1),m=s.$55l(3),S=D.$55l(-3),k=A.add(m.add(S.add(j))),B=new Le(k.x,k.y),A=L.$55l(3),m=s.$55l(-6),S=D.$55l(3),k=A.add(m.add(S)),T=new Le(k.x,k.y),A=L.$55l(-3),m=s.$55l(3),S=A.add(m),Q=new Le(S.x,S.y),F=new Le(L.x,L.y),c=new Le(P.y-V.y,V.x-P.x),i=P.x*V.y-V.x*P.y;for(var d=new ii(c.$60l(B),c.$60l(T),c.$60l(Q),c.$60l(F)+i).$51l(),J=0;J<d.length;J++){var l=d[J];if(l>=0&&1>=l){var C=L.lerp(s,l),y=s.lerp(D,l),H=D.lerp(j,l),M=C.lerp(y,l),R=y.lerp(H,l),W=M.lerp(R,l);P.x==V.x?x.y<=W.y&&W.y<=q.y&&(t.$62l=r,t.$56l(W)):P.y==V.y?x.x<=W.x&&W.x<=q.x&&(t.$62l=r,t.$56l(W)):W.gte(x)&&W.lte(q)&&(t.$62l=r,t.$56l(W))}}return t},jp=function(o,$,Z,G,O,A){var d=O.min(A),U=O.max(A),E=new ns(U.x,d.y),v=new ns(d.x,U.y),t=wf(o,$,Z,G,d,E),z=wf(o,$,Z,G,E,U),X=wf(o,$,Z,G,U,v),N=wf(o,$,Z,G,v,d),s=new _b(u);return s.$57l(t.points),s.$57l(z.points),s.$57l(X.points),s.$57l(N.points),s.points.length>0&&(s.$62l=r),s},Hc=function(c,n,O,X){var B=O.min(X),H=O.max(X),v=new ns(H.x,B.y),t=new ns(B.x,H.y),x=Gp(B,v,c,n),J=Gp(v,H,c,n),m=Gp(H,t,c,n),z=Gp(t,B,c,n),k=new _b(u);return k.$57l(x.points),k.$57l(J.points),k.$57l(m.points),k.$57l(z.points),k.points.length>0&&(k.$62l=r),k},Id=i.XEditInteractor=function(O){var C=this,r=C._view=document.createElement("canvas");r.className="editCanvas",r.style.position="absolute",Id.superClass.constructor.call(C,O)};E.def(Id,i.Interactor,{ms_edit:1,setUp:function(){var K=this,i=K.gv,A=i.getView(),Z=K._view;Id.superClass.setUp.call(K),i.setEditInteractor(K),i.$14l=Z,i._79O?A.insertBefore(Z,i._79O):A.appendChild(Z);var l=K.$49l=K.$11l.bind(K);i.dm().md(l),i.sm().ms(l),i.mp(l)},tearDown:function(){var y=this,D=y.gv,F=D.getView(),X=y.$49l;Id.superClass.tearDown.call(y),D.setEditInteractor(Y),D.$14l=Y,F.removeChild(y._view),D.dm().umd(X),D.sm().ums(X),D.ump(X)},clear:function(){var u=this,t=u.gv;delete u._hoverSegmentIndex,delete u._edge,delete u._shape,delete t._editing,delete u.$10l,delete u.$13l,delete u.$9l,delete u._removePointIndex,delete u._lp,u.$12l="",delete u.$40l,delete u.$67l,delete u.$72l,delete u.$73l,delete u.$75l,delete u.$1l,delete u.$3l,delete u.$2l,delete u.$92l,delete u.$93l,delete u.$94l,u.clearDragging()},handle_keydown:function(p){this.$48l!==p.shiftKey&&(this.$48l=p.shiftKey,this.handle_mousemove(p,U,!0))},handle_keyup:function($){this.$48l!==$.shiftKey&&(this.$48l=$.shiftKey,this.handle_mousemove($,U,!0))},handle_touchstart:function(R){this.handle_mousemove(R),this.handle_mousedown(R)},handle_mousedown:function(a){T(a);var n=this,D=n.$13l,A=n.gv,s=A.dm(),U=A.sm(),S=A.getZoom(),P=A.lp(a),m=E.isDoubleClick(a),j=E.isLeftButton(a),W=n.$7l,R=n._shape,x=n._hoverSegmentIndex,L=n._edge,u=n.$87l,p=n.$88l,h=function(){n._68I||u===n.$87l&&p===n.$88l||n.$43l()};if(7!==n.$67l&&(delete n.$87l,delete n.$88l),j&&(R||L)&&x>=0&&m&&(R&&U.contains(R)||L&&U.contains(L))){var Q=Jn.call(n,R||L,x,P);return n.addShapePoint(R||L,x,Q),B(function(){n.handle_mousemove(a)},40),void 0}if(j&&(R||L)&&n._removePointIndex>=0&&m)return n.removeShapePoint(),n.$5l=1,B(function(){n.handle_mousemove(a)},40),void 0;if(!j||!A._editing)return h(),void 0;if(R&&D>=0){var e=R.getPoints().get(D),O=R.p(),C=Lf(O,e.x-O.x,e.y-O.y,-W+R.getRotation());k=Lf(O,P.x-O.x,P.y-O.y,-W),n.$24l={x:k.x-C.x,y:k.y-C.y},n.startDragging(a),s.beginTransaction(),n.fi({kind:"beginEditPoint",event:a,data:R,index:D}),n.$88l=D,n.$87l=R}else if(n.$10l){var q=A.sm().getSelection(),o=n.$6l,M=n.$1l={},l=n.$3l={},X=n.$16l[v[n.$10l]],t={x:o.x,y:o.y},G={x:o.x+o.width/2,y:o.y+o.height/2};n.$24l={x:P.x-X.x/S,y:P.y-X.y/S},n.$2l=_(n.$8l),n.$4l=_(o),q.each(function($){if($ instanceof I){var Z=$.p(),i=$.getWidth(),V=$.getHeight(),w=Lf(G,Z.x-G.x,Z.y-G.y,-W);M[$.getId()]={x:Z.x-i/2,y:Z.y-V/2,width:i,height:V},l[$.getId()]={x:(w.x-t.x)/o.width,y:(w.y-t.y)/o.height}}}),n.startDragging(a),s.beginTransaction(),n.fi({kind:"beginEditRect",event:a,direction:n.$10l})}else if(L&&D>=0){var K=ac(A.getDataUI(L),L.s("edge.points")),e=K.get(D);n.$24l={x:P.x-e.x,y:P.y-e.y},n.startDragging(a),s.beginTransaction(),n.fi({kind:"beginEditPoint",event:a,data:L,index:D}),n.$88l=D,n.$87l=L}else if(n.$40l){var o=n.$6l,G={x:o.x+o.width/2,y:o.y+o.height/2},c=_(n.$23l);c.x/=S,c.y/=S;var r=Lf(G,c.x-G.x,c.y-G.y,-W),k=Lf(G,P.x-G.x,P.y-G.y,-W);n.$24l={x:k.x-r.x,y:k.y-r.y},n.startDragging(a),s.beginTransaction(),n.fi({kind:"beginEditRotation",event:a,data:n._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(n.$67l)>=0){var N=n.$67l;(7===N||8===N||9===N)&&s.beginTransaction(),n.startDragging(a)}else if(n.$71l&&m&&n.$79l(n.$71l,P)){var w=U.toSelection();s.beginTransaction(),w.each(function(u){s.remove(u)}),s.endTransaction()}h()},$11l:function(){var e=this,L=e.gv;L._editing&&(e.$13l==Y||e._shape==Y&&e._edge==Y)&&(e.$73l==Y||1!==e.$67l&&5!==e.$67l&&6!==e.$67l)||(e.$5l=1),e._68I=1},$46l:function(u){var P=this,p=P.gv,m=p.lp(u),v=[];return Sj(p,function(I){var U=p.getDataUI(I);if(U){var E=U._79o();G(E,m)&&v.push(I)}}),v},$47l:function(T){var D=this,u=D.$13l,Z=D.gv.dm();D.$10l?(D.fi({kind:"endEditRect",event:T,direction:D.$10l}),Z.endTransaction()):D._shape&&u>=0?(D.fi({kind:"endEditPoint",event:T,data:D._shape,index:u}),Z.endTransaction()):D._edge&&u>=0?(D.fi({kind:"endEditPoint",event:T,data:D._edge,index:u}),Z.endTransaction()):D.$23l&&D.$40l&&(D.fi({kind:"endEditRotation",event:T}),Z.endTransaction())},handleWindowTouchEnd:function(O){this.handleWindowMouseUp(O)},handleWindowMouseUp:function(S){var u=this,J=u.gv,i=J.dm(),f=u._shape,K=u._edge,$=u.$13l,G=u.$40l,F=u.$9l,T=u.$10l,Z=u.$67l;if((f||K)&&$>=0&&F>=0){var h,o;if(f){var g=f.p(),e=f.getRotation();h=f.getPoints(),o=h.get(F),xi(f,g,e,$,o,!1)}else if(h=ac(J.getDataUI(K),K.s("edge.points"),!0),o=h.get(F),0===$){var P=h.get(0);K.s("edge.source.offset.x",o.x-P.x),K.s("edge.source.offset.y",o.y-P.y)}else if($===h.size()-1){var O=h.get(h.size()-1);K.s("edge.target.offset.x",o.x-O.x),K.s("edge.target.offset.y",o.y-O.y)}else"points"===K.s("edge.type")&&(h.set($,o),K.s("edge.points",Tc(h)))}u.$47l(S);var c=u.$73l;1===Z?(i.beginTransaction(),c?J.sm().each(function(V){if(V.setHost&&J.isHelperEditable(V,"host")){V.setHost(c);
var n=u.$75l,Y=u.$74l;n&&(V.s("attach.row.index",n.rowIndex),V.s("attach.column.index",n.columnIndex)),Y&&(V.s("attach.index",Y.attachIndex),V.s("attach.offset",Y.attachOffset),V.s("attach.offset.relative",!1),V.s("attach.offset.opposite",!1))}}):J.sm().each(function(X){X.setHost&&J.isHelperEditable(X,"host")&&(X.setHost(Y),X.s("attach.row.index",U),X.s("attach.column.index",U),X.s("attach.index",U),X.s("attach.offset",U),X.s("attach.offset.relative",!1),X.s("attach.offset.opposite",!1))}),i.endTransaction()):2===Z?(i.beginTransaction(),c?J.sm().each(function(B){B.setParent&&J.isHelperEditable(B,"parent")&&B.setParent(c)}):J.sm().each(function(F){F.setParent&&J.isHelperEditable(F,"parent")&&F.setParent(Y)}),i.endTransaction()):3===Z?c&&(i.beginTransaction(),J.sm().each(function(U){if(J.isHelperEditable(U,"edge")&&U instanceof I&&c instanceof I){var d=new W.Edge;i.add(d),d.setSource(U),d.setTarget(c),u.onEdgeCreated&&u.onEdgeCreated(S,d)}}),i.endTransaction()):5===Z||6===Z?c&&(i.beginTransaction(),J.sm().each(function(D){D instanceof w&&c instanceof I&&(5===Z&&J.isHelperEditable(D,"source")?D.setSource(c):6===Z&&J.isHelperEditable(D,"source")&&D.setTarget(c))}),i.endTransaction()):(7===Z||8===Z||9===Z)&&i.endTransaction(),(T||G)&&u.$43l(!0),n?(u.clear(),delete u.$64l,u._68I||u.$43l()):(u.handle_mousemove(S,!0),Z&&!u._68I&&u.$43l())},handleWindowTouchMove:function(j){this.handleWindowMouseMove(j)},handleWindowMouseMove:function($){this._78I($)},handle_mousemove:function(t,N,u){if(!this._pause){if(!u){var C=n?nc(t):t;this.$61l={clientX:C.clientX,clientY:C.clientY}}if(N===!0||!X()){var $=this,L=$.gv,K=!1,g=Y;$.clear(),L.sm().size()>0&&(g=L.lp(u?$.$61l:t),K=$._79I(t,g)),K&&(L._editing=1),$.$12l!==$.$65l&&($.$65l=$.$12l,$.setCursor($.$12l)),$.$40l!==$.$64l&&($.$64l=$.$40l,$._68I||$.$43l()),$._hoverSegmentIndex!==$.$66l&&($.$66l=$._hoverSegmentIndex,$._68I||$.$43l())}}},_78I:function(Q){this.autoScroll(Q);var s=this,$=s.gv,u=$.lp(Q),d=$.getZoom(),H=s.$13l;if((s._shape||s._edge)&&H>=0){var J,v,t,m=s._shape,j=s._edge,c=s.$24l,M=$.getPointSnapSpacing(),N=function(D,R){return M==Y||isNaN(M)?{x:D,y:R}:{x:A(D/M)*M,y:A(R/M)*M}};if(m){J=m.getPoints();var n=m.p(),y=m.getRotation(),r=0;v=Lf(n,u.x-n.x,u.y-n.y,-y),xi(m,n,y,H,u,!0,c,N),s.fi({kind:"betweenEditPoint",event:Q,data:m,index:H})}else if(j){J=ac($.getDataUI(j),j.s("edge.points"),!0),u.x-=c.x,u.y-=c.y,v=u;var F,D,k=j.s("edge.offset"),e=J.size(),T=e>2;if(0===H){var x=J.get(0);k&&(x=zp(x,J.get(1),-k,T),u=zp(u,J.get(1),-k,T)),F=u.x-x.x,D=u.y-x.y,t=N(F,D),j.s("edge.source.offset.x",t.x),j.s("edge.source.offset.y",t.y)}else if(H===e-1){var o=J.get(e-1);k&&(o=zp(o,J.get(e-2),-k,T),u=zp(u,J.get(e-2),-k,T)),F=u.x-o.x,D=u.y-o.y,t=N(F,D),j.s("edge.target.offset.x",t.x),j.s("edge.target.offset.y",t.y)}else"points"===j.s("edge.type")&&(t=N(u.x,u.y),t.e=J.get(H).e,J.set(H,t),j.s("edge.points",Tc(J)));s.fi({kind:"betweenEditPoint",event:Q,data:j,index:H})}if(delete s.$9l,$.isSnapPoint(m)||$.isSnapPoint(j))for(r=0;r<J.size();r++)if(r!==H){var V=J.get(r);if(C(V,v)<$.getEditPointSize()/d){s.$9l=r;break}}}else if(s.$10l){var c=s.$24l;u.x-=c.x,u.y-=c.y;var f=$.sm().getSelection(),g=s.$1l,G=s.$7l,U=s.$10l,_=s.$4l,S=s.$2l,R=$.getEditRectPadding()/d,a=2*R,z=$.getSnapSpacing(),l=z!=Y&&!isNaN(z),Z=Ap(S,u,U,G,2*R,$.getResizeMode(),l,!0),W=s.$6l;if(l){var q=Z.width-a,i=Z.height-a,X=A(q/z)*z,So=A(i/z)*z,mc=X-q,gs=So-i;("west"===U||"northwest"===U||"southwest"===U)&&(mc=-mc),("north"===U||"northwest"===U||"northeast"===U)&&(gs=-gs),Z=Ap(S,u,U,G,2*R,$.getResizeMode(),l,!1,mc,gs)}s.$8l=Z,W.x=Z.x+R,W.y=Z.y+R,W.width=Z.width-a,W.height=Z.height-a;var eo=Z.x+Z.width/2,_g=Z.y+Z.height/2,Jj=W.x,Rc=W.y,Fh=W.width/_.width,Op=W.height/_.height;f.each(function(l){if(l instanceof I&&$.isEditable(l)&&$.isRectEditable(l)){var y=g[l.getId()],Z=s.$3l[l.getId()],j={x:y.x+y.width/2,y:y.y+y.height/2},X=0,T=0,Y=U,Q=180*h(G-l.getRotation())/L;"northeast"===U?Q>=315||45>Q?(X=y.width*Fh+y.x,T=y.height*(1-Op)+y.y,Y="northeast"):Q>=45&&135>Q?(X=y.width*(1-Op)+y.x,T=y.height*(1-Fh)+y.y,Y="northwest"):Q>=135&&225>Q?(X=y.width*(1-Fh)+y.x,T=y.height*Op+y.y,Y="southwest"):(X=y.width*Op+y.x,T=y.height*Fh+y.y,Y="southeast"):"north"===U?Q>=315||45>Q?(T=y.height*(1-Op)+y.y,Y="north"):Q>=45&&135>Q?(X=y.width*(1-Op)+y.x,Y="west"):Q>=135&&225>Q?(T=y.height*Op+y.y,Y="south"):(X=y.width*Op+y.x,Y="east"):"northwest"===U?Q>=315||45>Q?(X=y.width*(1-Fh)+y.x,T=y.height*(1-Op)+y.y,Y="northwest"):Q>=45&&135>Q?(X=y.width*(1-Op)+y.x,T=y.height*Fh+y.y,Y="southwest"):Q>=135&&225>Q?(X=y.width*Fh+y.x,T=y.height*Op+y.y,Y="southeast"):(X=y.width*Op+y.x,T=y.height*(1-Fh)+y.y,Y="northeast"):"west"===U?Q>=315||45>Q?(X=y.width*(1-Fh)+y.x,Y="west"):Q>=45&&135>Q?(T=y.height*Fh+y.y,Y="south"):Q>=135&&225>Q?(X=y.width*Fh+y.x,Y="east"):(T=y.height*(1-Fh)+y.y,Y="north"):"southwest"===U?Q>=315||45>Q?(X=y.width*(1-Fh)+y.x,T=y.height*Op+y.y,Y="southwest"):Q>=45&&135>Q?(X=y.width*Op+y.x,T=y.height*Fh+y.y,Y="southeast"):Q>=135&&225>Q?(X=y.width*Fh+y.x,T=y.height*(1-Op)+y.y,Y="northeast"):(X=y.width*(1-Op)+y.x,T=y.height*(1-Fh)+y.y,Y="northwest"):"east"===U?Q>=315||45>Q?(X=y.width*Fh+y.x,Y="east"):Q>=45&&135>Q?(T=y.height*(1-Fh)+y.y,Y="north"):Q>=135&&225>Q?(X=y.width*(1-Fh)+y.x,Y="west"):(T=y.height*Fh+y.y,Y="south"):"south"===U?Q>=315||45>Q?(T=y.height*Op+y.y,Y="south"):Q>=45&&135>Q?(X=y.width*Op+y.x,Y="east"):Q>=135&&225>Q?(T=y.height*(1-Op)+y.y,Y="north"):(X=y.width*(1-Op)+y.x,Y="west"):"southeast"===U&&(Q>=315||45>Q?(X=y.width*Fh+y.x,T=y.height*Op+y.y,Y="southeast"):Q>=45&&135>Q?(X=y.width*Op+y.x,T=y.height*(1-Fh)+y.y,Y="northeast"):Q>=135&&225>Q?(X=y.width*(1-Fh)+y.x,T=y.height*(1-Op)+y.y,Y="northwest"):(X=y.width*(1-Op)+y.x,T=y.height*Fh+y.y,Y="southwest"));var q=Lf(j,X-j.x,T-j.y,l.getRotation());yh(l,y,Y,{x:q.x,y:q.y});var A=Jj+W.width*Z.x,N=Rc+W.height*Z.y,M={x:A,y:N};M=Lf({x:eo,y:_g},M.x-eo,M.y-_g,G),l.p(M.x,M.y)}}),s.fi({kind:"betweenEditRect",event:Q,direction:U})}else if(s.$23l&&s.$40l){var Fo=s.$8l,fo=Fo.width,rd=Fo.height,n={x:Fo.x+fo/2,y:Fo.y+rd/2},c=s.$24l,df=s.$23l,Yb=df.x/d-n.x,ig=df.y/d-n.y,sl=K(Yb*Yb+ig*ig),Ml=Math.asin(c.x/sl),dh=$.sm().getSelection(),Wf=b+O(u.y-n.y,u.x-n.x)-Ml,Jf=$.getSnapAngle(),Wf=A(Wf/Jf)*Jf;0>Wf&&(Wf+=P);var le=Wf-s.$7l,Lb=[n.x,0,n.y];dh.each(function(q){if($.isEditable(q)&&$.isRotationEditable(q)&&$.isVisible(q)){var M=We(q.p3(),Lb),i=Fl();Ji(i,-le),q.setRotation(q.getRotation()+le),Pk(M,i),q.p3(Lb[0]+M[0],Lb[1]+M[1],Lb[2]+M[2])}}),s.$7l=Wf,s.fi({kind:"betweenEditRotation",event:Q})}else if([1,2,3,5,6].indexOf(s.$67l)>=0)s.$72l=Q,s.$78l||(s.$78l=1,B(function(){E.isDragging()&&s.$43l(),delete s.$78l},12));else if(7===s.$67l){if(s.$87l instanceof p){var m=s.$87l,ti=s.$88l,Ng=E.clone(m.getPoints().get(ti)),qd=u.y-Ng.y;Ng.e||(Ng.e=0),s.$92l||(s.$92l=Ng.e),Ng.e=s.$92l-qd,m.setPoint(ti,Ng)}else if(s.$87l instanceof w){var j=s.$87l,ti=s.$88l,J=ac($.getDataUI(j),j.s("edge.points")),Ng=J.get(ti),qd=u.y-Ng.y;Ng.e||(Ng.e=0),s.$92l||(s.$92l=Ng.e),Ng.e=s.$92l-qd,J.set(ti,Ng),j.s("edge.points",Tc(J))}}else if(8===s.$67l){var dh=$.sm().getSelection(),Pb=s.$93l;Pb||(Pb=s.$93l={}),dh.each(function(t){if(t.p3){var l=t.p3(),m=Pb[t.getId()];m==Y&&(m=Pb[t.getId()]=l[1]),t.p3([l[0],m-(u.y-s.$90l.y/d),l[2]])}})}else if(9===s.$67l){var dh=$.sm().getSelection(),cq=s.$94l;cq||(cq=s.$94l={}),dh.each(function(t){if(t.s3){var w=t.s3(),E=cq[t.getId()];E==Y&&(E=cq[t.getId()]=w[1]);var Q=E-(u.y-s.$91l.y/d);0>Q&&(Q=.01),t.s3([w[0],Q,w[2]])}})}},$79l:function(S,E){var $=this,O=$.gv,K=O.getZoom(),R=O.getEditHelperSize(),t=S.x/K,u=S.y/K,f=R/K,z=f/2;return G({x:t-z,y:u-z,width:f,height:f},E)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(L,l){for(var E=this,k=E.gv,S=k.getZoom(),r=k.getEditPointSize(),F=r/S,y=F/2,W=E.$46l(L),B=0;B<W.length;B++){var n,u,i=W[B],s=k.getDataUI(i);if(s&&s._55O){var Q=s._55O;if(Q._43O&&i instanceof w){if(n=i.s("edge.points"),n=ac(s,n),u=i.s("edge.segments"),u&&u.size()||(u=Xq(n)),E.$42l(i,l,n._as,u,"edge"))return!0;if("points"===i.s("edge.type")&&E.$41l(i,l,n._as,u,"edge"))return}if(Q._43O&&i instanceof p&&Q.$15l&&Q.$15l.length===i.getPoints().size()){if(n=Q.$15l,u=i.getSegments(),u&&u.size()||(u=Xq(n)),E.$42l(i,l,n,u,"shape"))return!0;if(E.$41l(i,l,n,u,"shape"))return}}}if(E.$16l){var n,o=E.$16l,C=o[3].x-o[7].x,H=o[3].y-o[7].y,T=K(C*C+H*H),U=o[1].x-o[5].x,D=o[1].y-o[5].y,R=K(U*U+D*D),M={x:l.x*S,y:l.y*S};if(E._80I(M,0,o[0],"northwest",T,R)||E._80I(M,1,o[1],"north",T,R)||E._80I(M,2,o[2],"northeast",T,R)||E._80I(M,7,o[7],"west",T,R)||E._80I(M,3,o[3],"east",T,R)||E._80I(M,6,o[6],"southwest",T,R)||E._80I(M,5,o[5],"south",T,R)||E._80I(M,4,o[4],"southeast",T,R))return!0}if(E.$23l){var I=E.$23l,J=I.x/S,N=I.y/S;if(G({x:J-y,y:N-y,width:F,height:F},l))return E.$40l=1,E.$12l=E.getHelperCursor("rotation")||"crosshair",!0}return E.$68l&&E.$79l(E.$68l,l)?(E.$67l=1,E.$12l=E.getHelperCursor("host")||"crosshair",!0):E.$69l&&E.$79l(E.$69l,l)?(E.$67l=2,E.$12l=E.getHelperCursor("parent")||"crosshair",!0):E.$70l&&E.$79l(E.$70l,l)?(E.$67l=3,E.$12l=E.getHelperCursor("edge")||"crosshair",!0):E.$71l&&E.$79l(E.$71l,l)?(E.$67l=4,E.$12l=E.getHelperCursor("remove")||"crosshair",!0):E.$82l&&E.$79l(E.$82l,l)?(E.$67l=5,E.$12l=E.getHelperCursor("source")||"crosshair",!0):E.$83l&&E.$79l(E.$83l,l)?(E.$67l=6,E.$12l=E.getHelperCursor("target")||"crosshair",!0):E._pointElevationHelperPoint&&E.$79l(E._pointElevationHelperPoint,l)?(E.$67l=7,E.$12l=E.getHelperCursor("pointElevation")||"crosshair",!0):E.$90l&&E.$79l(E.$90l,l)?(E.$67l=8,E.$12l=E.getHelperCursor("elevation")||"crosshair",!0):E.$91l&&E.$79l(E.$91l,l)?(E.$67l=9,E.$12l=E.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(H,n,Y,R,E,P){var X=this,f=X.gv,_=f.getEditPointSize(),b=_/2,W=f.sm(),J=f.isDirectionEditable;if(J&&1===W.size()){var A=W.ld();if(J=J.bind(f),A instanceof I){if(!J(A,R))return!1;if("east"===R){if(J(A,"northeast")&&J(A,"southeast")&&2*_>=P)return!1}else if("west"===R){if(J(A,"northwest")&&J(A,"southwest")&&2*_>=P)return!1}else if("north"===R){if(J(A,"northwest")&&J(A,"northeast")&&2*_>=E)return!1}else if("south"===R&&J(A,"southwest")&&J(A,"southeast")&&2*_>=E)return!1}}else{if(2*_>=E&&("north"===R||"south"===R))return!1;if(2*_>=P&&("east"===R||"west"===R))return!1}if(G({x:Y.x-b,y:Y.y-b,width:_,height:_},H)){if(X.$10l!==R){var y=180*X.$7l/L,h="";y>=337.5||22.5>y?h="north":y>=22.5&&67.5>y?h="northeast":y>=67.5&&112.5>y?h="east":y>=112.5&&157.5>y?h="southeast":y>=157.5&&202.5>y?h="south":y>=202.5&&247.5>y?h="southwest":y>=247.5&&292.5>y?h="west":y>=292.5&&337.5>y&&(h="northwest");var D=Ne.indexOf(h),h=Ne[n-(1-D)+8];switch(h){case"northwest":X.$12l="nwse-resize";break;case"northeast":X.$12l="nesw-resize";break;case"southwest":X.$12l="nesw-resize";break;case"southeast":X.$12l="nwse-resize";break;case"north":X.$12l="ns-resize";break;case"east":X.$12l="ew-resize";break;case"south":X.$12l="ns-resize";break;case"west":X.$12l="ew-resize"}X.$10l=R}return!0}return!1},$42l:function(K,M,R,H,V){var j,Y=this,g=Y.gv,F=g.getEditPointSize(),a=F/g.getZoom(),A=-1,B={x:M.x,y:M.y,width:0,height:0},u=function(Q){"shape"===V?Y._shape=K:Y._edge=K,Y._removePointIndex=Q},Z=function(l){"shape"===V?Y._shape=K:Y._edge=K,Y.$13l=l,Y.$12l="crosshair"};for(D(B,a/2),A=R.length-1,j=H.size()-1;j>=0;j--){var O=H.get(j);if(1===O||2===O)A-=1;else if(3===O){var J=R[A-1];if(G(B,J))return Z(A-1),!0;A-=2}else if(4===O){var N=R[A-1],E=R[A-2];if(G(B,N))return Z(A-1),!0;if(G(B,E))return Z(A-2),!0;A-=3}}for(A=R.length-1,j=H.size()-1;j>=0;j--){var O=H.get(j),n=R[A];if(G(B,n))return u(A),Z(A),!0;1===O||2===O?A-=1:3===O?A-=2:4===O&&(A-=3)}return!1},$41l:function(O,K,q,_,M){var F=this,U=F.gv,Y=-1,V=0,h={x:K.x,y:K.y,width:0,height:0},Q=function(B,w){F._hoverSegmentIndex=w,F._lp=K,"shape"===M?F._shape=O:F._edge=O};for(D(h,U.getSegmentHoverWidth()/2/U.getZoom()),O instanceof p&&O.isClosePath()&&_.indexOf(5)<0&&(_=new s(_._as),_.add(5));V<_.size();V++){var u=_.get(V);if(1===u){var d=q[Y],y=q[Y+1];if(d){var g=Hc(new ns(d.x,d.y),new ns(y.x,y.y),new ns(h.x,h.y),new ns(h.x+h.width,h.y+h.height));if(g.$62l===r&&g.points.length>0)return Q(g,V),!0}Y+=1}else if(2===u){var d=q[Y],y=q[Y+1],g=Hc(new ns(d.x,d.y),new ns(y.x,y.y),new ns(h.x,h.y),new ns(h.x+h.width,h.y+h.height));if(g.$62l===r&&g.points.length>0)return Q(g,V),!0;Y+=1}else if(3===u){var d=q[Y],A=q[Y+1],X=q[Y+2],g=lq(new ns(d.x,d.y),new ns(A.x,A.y),new ns(X.x,X.y),new ns(h.x,h.y),new ns(h.x+h.width,h.y+h.height));if(g.$62l===r)return Q(g,V),!0;Y+=2}else if(4===u){var d=q[Y],j=q[Y+1],l=q[Y+2],X=q[Y+3],g=jp(new ns(d.x,d.y),new ns(j.x,j.y),new ns(l.x,l.y),new ns(X.x,X.y),new ns(h.x,h.y),new ns(h.x+h.width,h.y+h.height));if(g.$62l===r)return Q(g,V),!0;Y+=3}else if(5===u){var d=q[Y],y=q[0];if(d){var g=Hc(new ns(d.x,d.y),new ns(y.x,y.y),new ns(h.x,h.y),new ns(h.x+h.width,h.y+h.height));if(g.$62l===r&&g.points.length>0)return Q(g,V),!0}}}return!1},addShapePoint:function(e,W,c){var i=this,R=i.gv,q=R.dm();if(q.beginTransaction(),0===arguments.length&&(e=i._shape||i._edge,W=i._hoverSegmentIndex,c=i._lp),e instanceof p||e instanceof w){var Z=Mh(e,R.getDataUI(e),W);if(!isNaN(W)&&c&&!isNaN(Z)){var $=c;if(e instanceof p){var g=e.p(),t=e.getRotation(),V=e.toSegments();V&&V.size()||(V=Xq(e.getPoints())),e.isClosePath()&&V.indexOf(5)<0&&(V=new s(V._as),V.add(5));var h=V.get(W),E="addPoint",A="removePointAt";if(2===h||1===h){var D={x:$.x,y:$.y};V.add(h,W),D=Lf(g,D.x-g.x,D.y-g.y,-t),e[E](D,Z+1)}else if(3===h){var b=e.getPoints(),r=b.get(Z),H=b.get(Z+2),D={x:$.x,y:$.y};D=Lf(g,D.x-g.x,D.y-g.y,-t);var z=Am(r,D),o=Am(D,H);V.removeAt(W),V.add(3,W),V.add(3,W),e.setPoint(Z+1,D),e[E](o,Z+2),e[E](z,Z+1)}else if(4===h){var b=e.getPoints(),r=b.get(Z),H=b.get(Z+3),D={x:$.x,y:$.y};D=Lf(g,D.x-g.x,D.y-g.y,-t);var z=ue(r,D),o=Kk(r,D),B=ue(D,H),k=Kk(D,H);V.removeAt(W),V.add(4,W),V.add(4,W),e[A](Z+1),e[A](Z+1),e[E](D,Z+1),e[E](k,Z+2),e[E](B,Z+2),e[E](o,Z+1),e[E](z,Z+1)}else if(5===h){var D={x:$.x,y:$.y};V.add(2,W),D=Lf(g,D.x-g.x,D.y-g.y,-t),e[E](D,Z+1)}e.isClosePath()&&V.remove(5),e.setSegments(V);var n=e.getWidth(),d=e.getHeight(),X=e.p().x-n/2,I=e.p().y-d/2;X-=g.x,I-=g.y;var J=Ac(e,{x:X,y:I,width:n,height:d},t,g);e.p(J.x,J.y)}else if(e instanceof w){if("points"!==e.s("edge.type"))return q.endTransaction(),void 0;var b=e.s("edge.points");V=e.s("edge.segments"),b=ac(R.getDataUI(e),b),V&&V.size()||(V=Xq(b)),V=new s(V._as.slice(0)),b=new s(b._as.slice(0));var h=V.get(W);if(2===h||1===h){var D={x:$.x,y:$.y};V.add(h,W),b.add(D,Z+1)}else if(3===h){var r=b.get(Z),H=b.get(Z+2),D={x:$.x,y:$.y},z=Am(r,D),o=Am(D,H);V.removeAt(W),V.add(3,W),V.add(3,W),b.set(Z+1,D),b.add(o,Z+2),b.add(z,Z+1)}else if(4===h){var r=b.get(Z),H=b.get(Z+3),D={x:$.x,y:$.y},z=ue(r,D),o=Kk(r,D),B=ue(D,H),k=Kk(D,H);V.removeAt(W),V.add(4,W),V.add(4,W),b.removeAt(Z+1),b.removeAt(Z+1),b.add(D,Z+1),b.add(k,Z+2),b.add(B,Z+2),b.add(o,Z+1),b.add(z,Z+1)}e.s("edge.points",Tc(b)),e.s("edge.segments",V)}}}q.endTransaction()},removeShapePoint:function(Q,t){var y=this,J="removeAt",q=y.gv,n=q.dm();if(n.beginTransaction(),0===arguments.length&&(Q=y._shape||y._edge,t=y._removePointIndex),t>=0&&(Q instanceof p||Q instanceof w)){var i=bc(Q,y.gv.getDataUI(Q),t),K=t;if(Q instanceof p){var u=Q.p(),k=Q.toSegments();k&&k.size()||(k=Xq(Q.getPoints()));var I=k.get(i),H="removePointAt";if(1===I&&0===K)if(Q.getPoints().size()>1){var v=k.get(i+1);k[J](i+1),3===v?Q[H](K+1):4===v&&(Q[H](K+2),Q[H](K+1)),Q[H](K)}else Q.dm().remove(Q);else 2===I||1===I?(k[J](i),Q[H](K)):3===I?(k[J](i),Q[H](K),Q[H](K-1)):4===I&&(k[J](i),Q[H](K),Q[H](K-1),Q[H](K-2));Q.setSegments(k);var V=Q.getWidth(),A=Q.getHeight(),U=Q.p().x-V/2,j=Q.p().y-A/2;U-=u.x,j-=u.y;var g=Ac(Q,{x:U,y:j,width:V,height:A},Q.getRotation(),u);Q.p(g.x,g.y)}else if(Q instanceof w){if("points"!==Q.s("edge.type"))return n.endTransaction(),void 0;var N=Q.s("edge.points");if(k=Q.s("edge.segments"),N&&(N=ac(y.gv.getDataUI(Q),N),k&&k.size()||(k=Xq(N))),0===t||t===N.size()-1)return n.endTransaction(),void 0;k=new s(k._as.slice(0)),N=new s(N._as.slice(0));var I=k.get(i);2===I||1===I?(k[J](i),N[J](K)):3===I?(k[J](i),N[J](K),N[J](K-1)):4===I&&(k[J](i),N[J](K),N[J](K-1),N[J](K-2)),Q.s("edge.segments",k),Q.s("edge.points",Tc(N))}}n.endTransaction()},changeShapeSegment:function(b,m,v){var c=this,F=c.gv,Y=F.dm();if(Y.beginTransaction(),1!==arguments.length||isNaN(b)||(v=b,b=c._shape||c._edge,m=c._hoverSegmentIndex),b instanceof p||b instanceof w){var r=Mh(b,c.gv.getDataUI(b),m);if(!isNaN(m)&&!isNaN(r))if(b instanceof p){var P=b.p(),K=b.toSegments();K&&K.size()||(K=Xq(b.getPoints()));var O=K.get(m),Q=b.toPoints();if(1===v||2===v)1===O||2===O?K.set(m,v):3===O?(K.set(m,v),Q.removeAt(r+1)):4===O&&(K.set(m,v),Q.removeAt(r+1),Q.removeAt(r+1));else if(3===v){var I=function(){var J=Q.get(r),t=Q.get(r+1),s=Am(J,t);K.set(m,3),Q.add(s,r+1)};2===O||1===O?I():4===O&&(Q.removeAt(r+1),Q.removeAt(r+1),I())}else if(4===v){var z=function(){var Y=Q.get(r),E=Q.get(r+1),s=ue(Y,E),d=Kk(Y,E);K.set(m,4),Q.add(s,r+1),Q.add(d,r+2)};2===O||1===O?z():3===O&&(Q.removeAt(r+1),z())}b.setSegments(K),b.setPoints(Q);var M=b.getWidth(),R=b.getHeight(),y=b.p().x-M/2,x=b.p().y-R/2;y-=P.x,x-=P.y;var l=new Ac(b,{x:y,y:x,width:M,height:R},b.getRotation(),P);b.p(l.x,l.y)}else if(b instanceof w){if("points"!==b.s("edge.type"))return Y.endTransaction(),void 0;var Q=b.s("edge.points");K=b.s("edge.segments"),Q&&(Q=ac(c.gv.getDataUI(b),Q),K&&K.size()||(K=Xq(Q))),K=new s(K._as.slice(0)),Q=new s(Q._as.slice(0));var O=K.get(m);if(1===v||2===v)1===O||2===O?K.set(m,v):3===O?(K.set(m,v),Q.removeAt(r+1)):4===O&&(K.set(m,v),Q.removeAt(r+1),Q.removeAt(r+1));else if(3===v){var I=function(){var d=Q.get(r),k=Q.get(r+1),x=Am(d,k);K.set(m,3),Q.add(x,r+1)};2===O||1===O?I():4===O&&(Q.removeAt(r+1),Q.removeAt(r+1),I())}else if(4===v){var z=function(){var Z=Q.get(r),Y=Q.get(r+1),W=ue(Z,Y),k=Kk(Z,Y);K.set(m,4),Q.add(W,r+1),Q.add(k,r+2)};2===O||1===O?z():3===O&&(Q.removeAt(r+1),z())}b.s("edge.points",Tc(Q)),b.s("edge.segments",K)}}Y.endTransaction()},getDefaultSegments:function(T){var e=this.gv,Q=e.getDataUI(T);if(T instanceof w){var N=T.s("edge.points");return N=ac(Q,N),Xq(N)}if(T instanceof p){var N=T.getPoints(),U=T.getSegments();return U&&U.size()>0?U:Xq(N)}},$43l:function(U){var m=this;U&&(m.$5l=1),m._68I=1,m._42()},_42:function(){var r=this;if(r._68I){delete r._68I;var A=r.gv,g=r.$5l,f=A.getZoom(),e=A.getEditPointSize(),u=e/2,v=new s,q=r._view,t=r._edge,m=r._shape,G=q.getContext("2d"),Q=A.tx(),h=A.ty(),C=Y,d=A.getEditPointBackground(),b=A.getControlPointBackground(),k=A.getControlPointBorderColor(),x=A.getEditPointBorderColor(),V=A.getEditRectBorderColor(),B=A.getDirectionLineColor(),L=A.getSegmentHoverColor(),O=A.getSnapPointBorderColor(),N=A.getJoinPointBackground(),T=A.getJoinPointBorderColor(),n=A.getSegmentHoverWidth(),R=[5,5],J=A.getEditRectBorderStyle();Gq(A,function(h){A.isSelected(h)&&A.isVisible(h)&&v.add(h)}),G.clearRect(0,0,j(q.width),j(q.height)),G.save(),c.translateAndScale(G,Q,h,1);var F=Y,Z={x:0,y:0,width:0,height:0},H=0,X=0,U=0,i=0,a=0,$=0,bq=0,qk=0,xb=0,qg=0,Ap=[];if(g?(delete r.$6l,delete r.$8l,delete r.$7l,delete r.$16l,delete r.$23l):(F=r.$6l,C=r.$7l),delete r.$68l,delete r.$69l,delete r.$71l,delete r.$70l,delete r.$82l,delete r.$83l,delete r._pointElevationHelperPoint,delete r.$90l,delete r.$91l,delete r.$75l,delete r.$74l,v.each(function(d){var f=A.getDataUI(d);if(f){var D=f._55O;if(A.isEditable(d))D._56O&&d instanceof I&&X++,Ap.push(d),D._42O&&d instanceof I&&H++,A.isHelperEditable(d,"host")&&i++,A.isHelperEditable(d,"parent")&&U++,A.isHelperEditable(d,"remove")&&a++,A.isHelperEditable(d,"edge")&&$++,A.isHelperEditable(d,"source")&&bq++,A.isHelperEditable(d,"target")&&qk++,A.isHelperEditable(d,"elevation")&&xb++,A.isHelperEditable(d,"tall")&&qg++;else if(d instanceof S&&d.isExpanded()){var h=!0,c=A.getEditableFunc();c&&(h=c(d)),h&&(A.isHelperEditable(d,"host")&&i++,A.isHelperEditable(d,"parent")&&U++,A.isHelperEditable(d,"remove")&&a++,A.isHelperEditable(d,"edge")&&$++,A.isHelperEditable(d,"source")&&bq++,A.isHelperEditable(d,"target")&&qk++,A.isHelperEditable(d,"elevation")&&xb++,A.isHelperEditable(d,"tall")&&qg++,Ap.push(d))}}}),G.beginPath(),G.lineWidth=1,G.strokeStyle=A.getNodeBorderColor(),Ap.forEach(function(N){var b=A.getDataUI(N),D=b._55O;if(g)if(C==Y&&(C=N instanceof w?0:N instanceof S&&N.isExpanded()?0:N.getRotation(),r.$7l=C),F==Y){var n,v,R;if(N instanceof S&&N.isExpanded()||N instanceof w){var i=A.getDataUIBounds(N);v=i.width,R=i.height,n={x:i.x+v/2,y:i.y+R/2}}else n=N.p(),v=N.getWidth(),R=N.getHeight();F={x:n.x,y:n.y,width:0,height:0},Z.x=n.x-v/2,Z.y=n.y-R/2,Z.width=v,Z.height=R,F=z(F,Z)}else{var n,v,R,L,O=F.x+F.width/2,t=F.y+F.height/2,c={x:O,y:t};if(N instanceof S&&N.isExpanded()||N instanceof w){L=0;var i=A.getDataUIBounds(N);v=i.width,R=i.height,n={x:i.x+v/2,y:i.y+R/2}}else n=N.p(),v=N.getWidth(),R=N.getHeight(),L=N.getRotation();var U={x:n.x-v/2,y:n.y-R/2,width:v,height:R},P={x:U.x,y:U.y},k={x:U.x+U.width,y:U.y},_={x:U.x,y:U.y+U.height},K={x:U.x+U.width,y:U.y+U.height},P=Lf(n,P.x-n.x,P.y-n.y,L),_=Lf(n,_.x-n.x,_.y-n.y,L),K=Lf(n,K.x-n.x,K.y-n.y,L),k=Lf(n,k.x-n.x,k.y-n.y,L),E=-C,Q=Lf(c,P.x-c.x,P.y-c.y,E),X=Lf(c,k.x-c.x,k.y-c.y,E),B=Lf(c,_.x-c.x,_.y-c.y,E),$=Lf(c,K.x-c.x,K.y-c.y,E),y=o([Q,X,B,$]);F=z(F,y),F.x-=O,F.y-=t;var x=Ac(Y,F,C,c);F.x=x.x-F.width/2,F.y=x.y-F.height/2}if(H>1&&A.isEditable(N)&&A.isRectEditable(N)&&N instanceof I){var J=N.getRect(),e=D.$45l,m=Lp(e[0],f),V=Lp(e[2],f),s=Lp(e[4],f),d=Lp(e[6],f);N.getRotation()?(G.moveTo(m.x,m.y),G.lineTo(V.x,V.y),G.lineTo(s.x,s.y),G.lineTo(d.x,d.y),G.lineTo(m.x,m.y)):G.rect(J.x*f,J.y*f,J.width*f,J.height*f)}}),G.stroke(),F){r.$6l=_(F),D(F,A.getEditRectPadding()/f);var ks={x:F.x+F.width/2,y:F.y+F.height/2},hc=Ll(ks,F.width,F.height,C),Bh=hc[0],Ig=hc[1],jd=hc[2],br=hc[3],fc=hc[4],Sd=hc[5],gm=hc[6],tb=hc[7];if(Bh=Lp(hc[0],f),Ig=Lp(hc[1],f),jd=Lp(hc[2],f),br=Lp(hc[3],f),fc=Lp(hc[4],f),Sd=Lp(hc[5],f),gm=Lp(hc[6],f),tb=Lp(hc[7],f),r.$8l=F,H>0&&(r.$16l=[Bh,fc,Ig,Sd,br,gm,jd,tb],G.beginPath(),G.lineWidth=1,G.strokeStyle=V,"dashed"===J&&G.setLineDash&&G.setLineDash(R),G.moveTo(Bh.x,Bh.y),G.lineTo(Ig.x,Ig.y),G.lineTo(br.x,br.y),G.lineTo(jd.x,jd.y),G.lineTo(Bh.x,Bh.y),G.stroke(),"dashed"===J&&G.setLineDash&&G.setLineDash([])),G.beginPath(),G.lineWidth=1,G.fillStyle=d,G.strokeStyle=x,H>0){var Iq=Sd.x-tb.x,Pk=Sd.y-tb.y,ro=K(Iq*Iq+Pk*Pk),Qd=fc.x-gm.x,ub=fc.y-gm.y,hs=K(Qd*Qd+ub*ub),rd=2*e;if(A.isDirectionEditable&&1===Ap.length){var pl=Ap[0],Go=A.getDataUI(pl),me=Go._55O,Kg=A.isDirectionEditable.bind(A);if(me._42O){var ic,Jm,gr,En;Kg(pl,"northwest")&&(ic=!0,G.rect(Bh.x-u,Bh.y-u,e,e)),Kg(pl,"northeast")&&(Jm=!0,G.rect(Ig.x-u,Ig.y-u,e,e)),Kg(pl,"southwest")&&(gr=!0,G.rect(jd.x-u,jd.y-u,e,e)),Kg(pl,"southeast")&&(En=!0,G.rect(br.x-u,br.y-u,e,e)),Kg(pl,"north")&&(ic&&Jm?ro>rd&&G.rect(fc.x-u,fc.y-u,e,e):G.rect(fc.x-u,fc.y-u,e,e)),Kg(pl,"south")&&(En&&gr?ro>rd&&G.rect(gm.x-u,gm.y-u,e,e):G.rect(gm.x-u,gm.y-u,e,e)),Kg(pl,"west")&&(gr&&ic?hs>rd&&G.rect(tb.x-u,tb.y-u,e,e):G.rect(tb.x-u,tb.y-u,e,e)),Kg(pl,"east")&&(En&&Jm?hs>rd&&G.rect(Sd.x-u,Sd.y-u,e,e):G.rect(Sd.x-u,Sd.y-u,e,e))}}else ro>rd&&(G.rect(fc.x-u,fc.y-u,e,e),G.rect(gm.x-u,gm.y-u,e,e)),hs>rd&&(G.rect(Sd.x-u,Sd.y-u,e,e),G.rect(tb.x-u,tb.y-u,e,e)),G.rect(Bh.x-u,Bh.y-u,e,e),G.rect(Ig.x-u,Ig.y-u,e,e),G.rect(jd.x-u,jd.y-u,e,e),G.rect(br.x-u,br.y-u,e,e)}if(X>0){var Rj=r.$23l=Lf(fc,0,2*-e,C);G.moveTo(Rj.x+u,Rj.y),G.arc(Rj.x,Rj.y,u,0,P,!1)}G.fill(),G.stroke(),r.$40l&&r.$44l(G,F,C);var be,Uo,wb=A.getLeftTopHelpers(),eb=A.getRightTopHelpers(),Lm=A.getLeftBottomHelpers(),Mm=A.getRightBottomHelpers(),Sp=A.getEdgeHelpers(),kp=A.getEditHelperSize(),Yo=kp/2,js=function(p,v,N,g){"leftTop"===v?(be=F.x*f-kp-u-("h"===g?N*(kp+u):0)-1,Uo=F.y*f-kp-u-("v"===g?N*(kp+u):0)-1):"rightTop"===v?(be=(F.x+F.width)*f+u+("h"===g?N*(kp+u):0)+1,Uo=F.y*f-kp-u-("v"===g?N*(kp+u):0)-1):"leftBottom"===v?(be=F.x*f-kp-u-("h"===g?N*(kp+u):0)-1,Uo=(F.y+F.height)*f+u+("v"===g?N*(kp+u):0)+1):"rightBottom"===v&&(be=(F.x+F.width)*f+u+("h"===g?N*(kp+u):0)+1,Uo=(F.y+F.height)*f+u+("v"===g?N*(kp+u):0)+1);var m=be+Yo,D=Uo+Yo,h=(F.x+F.width/2)*f,Q=(F.y+F.height/2)*f,n=Lf({x:h,y:Q},m-h,D-Q,C);if("host"===p){if(i>0)return r.$77l(G,C,n),!0}else if("edge"===p){if($>0)return r.$80l(G,C,n),!0}else if("remove"===p){if(a>0)return Ap&&1===Ap.length&&Ap[0]instanceof w?r.$81l(G,C,{x:h+kp/2+5,y:Q}):r.$81l(G,C,n),!0}else if("parent"===p){if(U>0)return Ap&&1===Ap.length&&Ap[0]instanceof w?r.$76l(G,C,{x:h-kp/2-5,y:Q}):r.$76l(G,C,n),!0}else if("elevation"===p){if(xb>0)return r.$85l(G,C,n),!0}else if("tall"===p){if(qg>0)return r.$86l(G,C,n),!0}else if("source"===p||"target"===p){var x=Ap[0],V=A.getDataUI(x),q=Dk(V,!0),t=q[0],d=q[1];if(bq&&"source"===p)return r.$84l(G,F,t,!0,x.isLooped(),v,N,g),!0;if(qk&&"target"===p)return r.$84l(G,F,d,!1,x.isLooped(),v,N,g),!0}};if(wb&&wb.length>0){var fr=0;wb.forEach(function(n){js(n,"leftTop",fr,A.getLeftTopHelpersAlign()||"h")&&fr++})}if(eb&&eb.length>0){var fr=0;eb.forEach(function(f){js(f,"rightTop",fr,A.getRightTopHelpersAlign()||"h")&&fr++})}if(Lm&&Lm.length>0){var fr=0;Lm.forEach(function(K){js(K,"leftBottom",fr,A.getLeftBottomHelpersAlign()||"h")&&fr++})}if(Mm&&Mm.length>0){var fr=0;Mm.forEach(function(M){js(M,"rightBottom",fr,A.getRightBottomHelpersAlign()||"h")&&fr++})}if(Sp&&Sp.length>0&&((bq||qk)&&Ap&&1===Ap.length&&Ap[0]instanceof w?!0:!1)){var fr=0;Sp.forEach(function(o){js(o,"edge",fr,"h")&&fr++})}if(r.$72l){var ug,Hh=r.$67l,em=r.$68l,dp=r.$69l,Im=(r.$71l,r.$70l),Hg=r.$82l,Oh=r.$83l;if(1===Hh?ug=em:2===Hh?ug=dp:3===Hh?ug=Im:5===Hh?ug=Hg:6===Hh&&(ug=Oh),ug){var qs=A.lp(r.$72l),ys=A.getDataAt(r.$72l);if(ys&&ys instanceof I){var Zd,vg,kj;if(r.$73l=ys,1===Hh)if(ys instanceof W.Grid)Zd=r.$75l=Rm(ys,qs);else if(ys instanceof W.Shape){kj=r.$74l=In(ys,qs);var mq=ys.getPoints();if(kj){var Ko=kj.attachIndex,Fp=Mh(ys,A.getDataUI(ys),Ko)+1,pg=Fp+1>=mq.size()?0:Fp+1,Yn=mq.get(Fp),Ir=mq.get(pg),Wk=ys.p(),qc=ys.getRotation();Yn=Lf(Wk,Yn.x-Wk.x,Yn.y-Wk.y,qc),Ir=Lf(Wk,Ir.x-Wk.x,Ir.y-Wk.y,qc),G.beginPath(),G.strokeStyle=L,G.lineWidth=n,G.moveTo(Yn.x*f,Yn.y*f),G.lineTo(Ir.x*f,Ir.y*f),G.stroke()}}Zd?vg=Zd.rect:(vg=E.clone(A.getDataUIBounds(ys)),E.grow(vg,2)),G.beginPath(),G.rect(vg.x*f,vg.y*f,vg.width*f,vg.height*f),G.strokeStyle=1===Hh||4===Hh||6===Hh?l:M,G.lineWidth=2,G.setLineDash&&G.setLineDash([8,8]),G.stroke()}else delete r.$73l;qs.x=qs.x*f,qs.y=qs.y*f;var mj=jr(ug.x,ug.y,qs.x,qs.y),Ln=Lf(ug,qs.x-ug.x,qs.y-ug.y,-mj),Lc=Ln.x-ug.x;G.save(),G.translate(ug.x,ug.y),G.rotate(mj),y.width=Lc,y.height=40;var Wp=M;(1===Hh||4===Hh||6===Hh)&&(Wp=l),y.comps[0].gradientColor=Wp,E.drawImage(G,y,0,-20,Lc,40),G.restore()}}}if(v.each(function(D){var y=A.getDataUI(D);if(y){var Z,U,R=y._55O,F=y._78o;if(R&&R._43O&&D instanceof p?(Z=R.$15l,U=D.getSegments(),U&&U.size()||(U=Xq(Z)),D.isClosePath()&&U.indexOf(5)<0&&(U=new s(U._as),U.add(5))):R&&F&&R._43O&&(Z=D.s("edge.points"),U=D.s("edge.segments"),Z=ac(y,Z),U&&U.size()||(U=Xq(Z)),Z&&(Z=Z._as)),Z&&U){var I=0,i=U.size(),_=r._hoverSegmentIndex;Z=Z.slice(0);for(var c=0;c<Z.length;c++)Z[c]=Lp(Z[c],f);G.beginPath(),G.strokeStyle=B,G.lineWidth=1,I=0;for(var c=0;i>c;c++){var J=U.get(c);if(1===J||2===J)I++;else if(3===J){var l=Z[I-1],W=Z[I],e=Z[I+1];G.moveTo(l.x,l.y),G.lineTo(W.x,W.y),G.lineTo(e.x,e.y),I+=2}else if(4===J){var l=Z[I-1],v=Z[I],x=Z[I+1],e=Z[I+2];G.moveTo(l.x,l.y),G.lineTo(v.x,v.y),G.moveTo(x.x,x.y),G.lineTo(e.x,e.y),I+=3}}if(G.stroke(),m===D||t===D&&"points"===t.s("edge.type")){G.beginPath(),I=0,G.strokeStyle=L,G.lineWidth=n;for(var c=0;i>c;c++){var J=U.get(c);if(1===J||2===J){if(_===c){var l=Z[I-1],e=Z[I];G.moveTo(l.x,l.y),G.lineTo(e.x,e.y);break}I++}else if(3===J){if(_===c){var l=Z[I-1],W=Z[I],e=Z[I+1];G.moveTo(l.x,l.y),G.quadraticCurveTo(W.x,W.y,e.x,e.y);break}I+=2}else if(4===J){if(_===c){var l=Z[I-1],v=Z[I],x=Z[I+1],e=Z[I+2];G.moveTo(l.x,l.y),G.bezierCurveTo(v.x,v.y,x.x,x.y,e.x,e.y);break}I+=3}else if(5===J&&_===c){var l=Z[I-1],e=Z[0];G.moveTo(l.x,l.y),G.lineTo(e.x,e.y);break}}G.stroke()}G.beginPath(),I=0,G.strokeStyle=T,G.lineWidth=1,G.fillStyle=N;for(var c=0;i>c;c++){var J=U.get(c);if(1===J||2===J){var e=Z[I];G.moveTo(e.x+u,e.y),G.arc(e.x,e.y,u,0,P,!0),I++}else if(3===J){var e=Z[I+1];G.moveTo(e.x+u,e.y),G.arc(e.x,e.y,u,0,P,!0),I+=2}else if(4===J){var e=Z[I+2];G.moveTo(e.x+u,e.y),G.arc(e.x,e.y,u,0,P,!0),I+=3}}G.fill(),G.stroke(),G.beginPath(),I=0,G.strokeStyle=k,G.lineWidth=1,G.fillStyle=b;for(var c=0;i>c;c++){var J=U.get(c);if(1===J||2===J)I++;else if(3===J){var W=Z[I];G.moveTo(W.x+u,W.y),G.arc(W.x,W.y,u,0,P,!0),I+=2}else if(4===J){var v=Z[I],x=Z[I+1];G.moveTo(v.x+u,v.y),G.arc(v.x,v.y,u,0,P,!0),G.moveTo(x.x+u,x.y),G.arc(x.x,x.y,u,0,P,!0),I+=3}}if(G.fill(),G.stroke(),G.beginPath(),I=0,G.strokeStyle=O,G.lineWidth=2,(m===D||t===D)&&r.$9l!=Y){var e=Z[r.$9l];G.moveTo(e.x+u,e.y),G.arc(e.x,e.y,u,0,P,!0),G.stroke()}}}}),r.$87l&&A.sm().contains(r.$87l)){var Ci,Zr=r.$87l,_j=r.$88l,kp=A.getEditHelperSize(),Yo=kp/2;if(A.isHelperEditable(Zr,"pointElevation"))if(Zr instanceof p){var uh=Zr.getPosition();Ci=E.clone(Zr.getPoints().get(_j)),Ci=Lf({x:uh.x,y:uh.y},Ci.x-uh.x,Ci.y-uh.y,Zr.getRotation()),Ci.x*=f,Ci.y*=f,G.translate(Ci.x,Ci.y),E.drawImage(G,E.getImage("xeditinteractor_elevationIcon"),Yo,-Yo,kp,kp),G.translate(-Ci.x,-Ci.y),r._pointElevationHelperPoint={x:Ci.x+kp,y:Ci.y}}else if(Zr instanceof w){var Wj=ac(A.getDataUI(Zr),Zr.s("edge.points")),Ci=E.clone(Wj.get(_j));Ci.x*=f,Ci.y*=f,G.translate(Ci.x,Ci.y),E.drawImage(G,E.getImage("xeditinteractor_elevationIcon"),Yo,-Yo,kp,kp),G.translate(-Ci.x,-Ci.y),r._pointElevationHelperPoint={x:Ci.x+kp,y:Ci.y}}}G.restore(),r.$5l=0}},$89l:function(C,x,Q,r){C.save();var l=this,O=l.gv,b=O.getEditHelperSize(),J=b/2;C.beginPath(),C.translate(Q.x,Q.y),C.rotate(x),E.drawImage(C,r,-J,-J,b,b),C.restore()},$85l:function(T,B,d){var Z=this;Z.$90l=d,Z.$89l(T,B,d,E.getImage("xeditinteractor_elevationIcon"))},$86l:function(e,z,C){var j=this;j.$91l=C,j.$89l(e,z,C,E.getImage("xeditinteractor_tallIcon"))},$77l:function(L,c,v){var m=this;m.$68l=v,m.$89l(L,c,v,E.getImage("xeditinteractor_hostIcon"))},$80l:function(Y,U,$){var N=this;N.$70l=$,N.$89l(Y,U,$,E.getImage("xeditinteractor_edgeIcon"))},$81l:function(M,N,S){var g=this;g.$71l=S,g.$89l(M,N,S,E.getImage("xeditinteractor_removeIcon"))},$76l:function(O,x,i){var l=this;l.$69l=i,l.$89l(O,x,i,E.getImage("xeditinteractor_parentIcon"))},$84l:function(Y,$,c,l,h){var V,G=this,d=G.gv,W=d.getZoom(),t=d.getEditHelperSize(),X=t/2;c.x*=W,c.y*=W,h&&(l?c.x-=X+5:c.x+=X+5),c.y-=t-2,l?(G.$82l=c,V=E.getImage("xeditinteractor_sourceIcon")):(G.$83l=c,V=E.getImage("xeditinteractor_targetIcon")),Y.beginPath(),Y.translate(c.x,c.y),E.drawImage(Y,V,-X,-X,t,t),Y.translate(-c.x,-c.y)},$44l:function(g,X,t){g.save();var R=this.gv.getZoom(),i=K(a(X.width,2)+a(X.height,2))/2*R+10,T=i,p=T+8,e=T+18,S=t,y=X.x+X.width/2,F=X.y+X.height/2;g.translate(y*R,F*R),g.beginPath(),g.strokeStyle="rgb(150, 150, 150)";for(var w=0,u=0,E=0,I=0,G=0,Q=0;360>Q;Q++)w=Q*L/180,0===Q%5&&(u=q(w)*T,E=V(w)*T,I=q(w)*p,G=V(w)*p,g.moveTo(u,E),g.lineTo(I,G)),0===Q%45&&(u=q(w)*T,E=V(w)*T,I=q(w)*e,G=V(w)*e,g.moveTo(u,E),g.lineTo(I,G));g.stroke(),g.beginPath(),g.rotate(-b),g.beginPath(),g.fillStyle="rgba(255, 0, 0, 0.1)",g.strokeStyle="rgb(157, 157, 157)",g.moveTo(0,0),g.arc(0,0,e,0,t,!1),g.fill(),g.beginPath(),g.moveTo(0+e,0),g.arc(0,0,e,0,t,!1),g.stroke(),g.rotate(b),g.font="bold 12px Verdana, Arial";var s=20*V(S),f=20*q(S),B=A(180*S/L)+"°";g.textAlign="center",g.textBaseline="middle",g.beginPath();var k=g.measureText("365.°").width;g.fillStyle="white",g.rect(s-k/2,-f-10,k,20),g.fill(),g.beginPath(),g.fillStyle="rgb(79,79,79)",g.fillText(B,s,-f),g.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);