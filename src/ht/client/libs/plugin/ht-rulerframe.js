!function(A,d){"use strict";var I="position",l="absolute",S="relative",y="px",T="left",U="right",q="top",H="bottom",w="display",F="none",L="block",o=ht.Default,v=o.getInternal(),D=Math.floor,r=Math.ceil,P=Math.PI,x=null,s=A.parseInt,e=function(q){return q.getContext("2d")},u=function(){return document},Q=function(d){return u().createElement(d)},K=function(){return Q("canvas")},N=function(l,o,G){l.style.setProperty(o,G,x)},$=function(R,S,L){o.def(ht.widget[R],S,L)},C=function(l,f){l.appendChild(f)},t=function(i,Q){i.removeChild(Q)},_=o.eventListenerOptionsFalse,B=(o.eventListenerOptionsTrue,function(r,g,E,y){r.addEventListener(g,E,y?_:_)}),O=function(d,X,S,w){d.removeEventListener(X,S,w?_:_)};ht.widget.RulerFrame=function(G){var g=this,i=g._view=v.createView(null,g),w=g.$1k=K(),s=g.$2k=K(),F=g.$3k=K(),X=g.$4k=K();g._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},g._topRulerConfig={visible:!0},g._rightRulerConfig={visible:!1},g._bottomRulerConfig={visible:!1},g._leftRulerConfig={visible:!0},C(i,w),C(i,F),C(i,s),C(i,X),N(i,I,S),N(i,"box-sizing","border-box"),N(i,"-moz-box-sizing","border-box"),N(w,I,l),N(s,I,l),N(F,I,l),N(X,I,l),g.$14k=function(){g.$13k=1,g.iv()},g.$15k=function(r){if(g._topRulerConfig.guideVisible||g._rightRulerConfig.guideVisible||g._bottomRulerConfig.guideVisible||g._leftRulerConfig.guideVisible||g._defaultRulerConfig.guideVisible||(g._topRulerConfig.guideTipVisible||g._rightRulerConfig.guideTipVisible||g._bottomRulerConfig.guideTipVisible||g._leftRulerConfig.guideTipVisible||g._defaultRulerConfig.guideTipVisible)&&g._component){var $=i.getBoundingClientRect();g.$16k={x:r.clientX-$.left,y:r.clientY-$.top},g.$5k()}},g.setComponent(G)},$("RulerFrame",d,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(u){var Q=this,r=Q._component,i=Q.getView();if(i){if(Q._component=u,Q.fp("component",r,u),r){var J=Q.getComponentView(r);t(i,J),O(i,"mousemove",Q.$15k),Q.removeComponentPropertyChangeListener(r,Q.$14k)}if(u){var L=Q.getComponentView(u);C(i,L),N(L,I,l),B(i,"mousemove",Q.$15k),Q.addComponentPropertyChangeListener(u,Q.$14k)}}},addComponentPropertyChangeListener:function(P,z){P&&P.mp&&P.mp(z)},removeComponentPropertyChangeListener:function(P,R){P&&P.ump&&P.ump(R)},getComponentHZoom:function(x){return x&&x.getZoom?x.getZoom():1},getComponentVZoom:function(h){return h&&h.getZoom?h.getZoom():1},getComponentViewRect:function(q){return q&&q.getViewRect?q.getViewRect():void 0},getComponentView:function(g){return g&&g.getView?g.getView():g},invalidateComponent:function(B){B&&B.iv&&B.iv()},validateComponent:function(c){c&&c.validate&&c.validate()},$7k:function(e,p,X,b,i,C,K,d,A,S,D,z){if(p.visible){var T=this._defaultRulerConfig,H="borderStyle",V="borderColor",l="borderWidth",Q="background",W=p[H]||T[H],r=p[V]||T[V],J=p[l]||T[l],I=p.size!=x?p.size:T.size,y=p[Q]||T[Q],g=I+J,G=this.$6k(J,W,r,e,X,i,g,K,d,A,S,D,z);N(e,i,"0px"),C?v.setCanvas(e,b-G,I):v.setCanvas(e,I,b-G),N(e,"background",y),N(e,w,L)}else N(e,w,F),N(this.getComponentView(this._component),i,"0px")},$6k:function(o,l,V,m,z,w,p,g,G,S,j,Z,s){var q=0;return N(m,z,o+"px "+l+" "+V),N(this.getComponentView(this._component),w,p+y),g?(N(m,G,S+y),q+=S):N(m,G,"0px"),j?(N(m,Z,s+y),q+=s):N(m,Z,"0px"),q},validateImpl:function(){var k=this,z=k._component,u=k.$1k,D=k.$2k,G=k.$3k,Z=k.$4k,J=k._view,d=k._defaultRulerConfig,Y=k._topRulerConfig,b=k._rightRulerConfig,Q=k._bottomRulerConfig,R=k._leftRulerConfig,a=d.size;if(J&&z){var r=Y.size!=x?Y.size:a,I=b.size!=x?b.size:a,V=Q.size!=x?Q.size:a,L=R.size!=x?R.size:a;k.$7k(u,Y,"border-bottom",J.offsetWidth,q,!0,R.visible,T,L,b.visible,U,I),k.$7k(D,b,"border-left",J.offsetHeight,U,!1,Y.visible,q,r,Q.visible,H,V),k.$7k(G,Q,"border-top",J.offsetWidth,H,!0,R.visible,T,L,b.visible,U,I),k.$7k(Z,R,"border-right",J.offsetHeight,T,!1,Y.visible,q,r,Q.visible,H,V),k.$13k?delete k.$13k:k.invalidateComponent(z),k.validateComponent(z),k.$5k()}},$5k:function(){function C(d,E,o,v,w,P){if(E.visible){var S=e(d),y=E[H]||a,p=E[J]!=x?E[J]:f,C=E[Z]||B,U=E[n]||_,W=E.size!=x?E.size:Y,ys=E[b]||F,Kb=E[u]||k,Bp=E[Q]||L,Zm=E[r]!=x?E[r]:M,Or=E[A]!=x?E[A]:I,yp=E[R]!=x?E[R]:K,Jd=E[N]!=x?E[N]:X,Hg=E[V]!=x?E[V]:q,kq=E[h]!=x?E[h]:$,Sm=E[t]||Cl,nr=E[g]||ff;p&&(y=i[P]=i.$8k(i[P]||y,E[j]||s,E[O]||D,v?c:m,Kb)),o.call(i,S,T,z,l,G,W,v?c:m,y,C,U,w,ys,Bp);var Fk=i.$16k;(Zm||Or)&&Fk&&(v?i.$9k(S,Fk.x,W,Sm,nr,Zm,Or,yp,Jd,Hg,kq):i.$10k(S,Fk.y,W,Sm,nr,Zm,Or,yp,Jd,Hg,kq,w))}}var i=this,o=i.$1k,P=i.$2k,U=i.$3k,E=i.$4k,S=i._topRulerConfig,w=i._rightRulerConfig,W=i._bottomRulerConfig,d=i._leftRulerConfig,p=i._defaultRulerConfig,y=i._component,v=i.getComponentViewRect(y),c=i.getComponentHZoom(y),m=i.getComponentVZoom(y),T=v.x*c,l=T+v.width*c,z=v.y*m,G=z+v.height*m,Y=i._defaultRulerConfig.size,H="defaultMajorTickSpacing",j="maxPhysicalMajorTickSpacing",O="minPhysicalMajorTickSpacing",J="tickSpacingAdaptable",Z="majorTickTextFont",n="majorTickTextColor",b="majorTickColor",Q="minorTickColor",r="guideVisible",A="guideTipVisible",R="guideTipBorderColor",N="guideTipTextColor",V="guideTipTextFont",h="guideTipBackground",t="guideColor",g="guideWidth",u="minMajorTickSpacing",a=p[H],s=p[j],D=p[O],f=p[J],B=p[Z],_=p[n],F=p[b],k=p[u],L=p[Q],M=p[r],I=p[A],K=p[R],X=p[N],q=p[V],$=p[h],Cl=p[t],ff=p[g];i._view&&y&&(C(o,S,i.$11k,!0,!1,"_currentTopMajorTickSpacing"),C(P,w,i.$12k,!1,!0,"_currentRightMajorTickSpacing"),C(U,W,i.$11k,!0,!0,"_currentBottomMajorTickSpacing"),C(E,d,i.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(n,h,Z,H,g){return Z>n*H?n=D(h/H/g)*g:n*H>h&&(n=r(Z/H/g)*g),n},getHTipText:function(i){var d=this,q=d._component,o=0,b=d._view.getBoundingClientRect();return q.lp?o=s(q.lp({x:i.x+b.left,y:i.y}).x):o-=s(this.getComponentView(q).style.left)||0,o},$9k:function(n,A,a,T,g,k,b,t,w,o,V){var E=this,p=E._component;n.save(),v.translateAndScale(n,0,0,1);var e=A-(s(this.getComponentView(p).style.left)||0),r=0;if(A=E.getHTipText(E.$16k),k&&(n.beginPath(),n.fillStyle=T,n.rect(e,r,g,a),n.fill()),b){n.beginPath(),n.textAlign="center",n.textBaseline="middle",n.font=o;var d=n.measureText(A).width+6;n.fillStyle=V,n.rect(e-d/2,r,d,a),n.fill(),n.strokeStyle=t,n.stroke(),n.beginPath(),n.fillStyle=w,n.fillText(A,e,r+a/2)}n.restore()},getVTipText:function(X){var d=this,y=d._component,C=0,j=d._view.getBoundingClientRect();return y.lp?C=s(y.lp({x:X.x,y:X.y+j.top}).y):C-=s(this.getComponentView(y).style.top)||0,C},formatScaleText:function(v){return Math.round(v)},$10k:function(L,S,l,q,Y,B,f,x,J,i,Q,O){var H=this,z=H._component;L.save(),v.translateAndScale(L,0,0,1);var c=l/2,o=S-(s(this.getComponentView(z).style.top)||0);if(S=H.getVTipText(H.$16k),B&&(L.beginPath(),L.fillStyle=q,L.rect(c-l/2,o,l,Y),L.fill()),f){L.translate(c,o),L.rotate((O?90:-90)*P/180),L.translate(-c,-o),L.beginPath(),L.textAlign="center",L.textBaseline="middle",L.font=i;var b=L.measureText(S).width+6;L.fillStyle=Q,L.rect(c-b/2,o-l/2,b,l),L.fill(),L.strokeStyle=x,L.stroke(),L.fillStyle=J,L.fillText(S,c,o)}L.restore()},$11k:function(Q,c,e,T,Z,S,l,X,K,y,N,o,G){Q.save(),e=0;var b=c,h=T,$=(b+h)/2;c=0,T=h-b,v.translateAndScale(Q,0,0,1);var z=0,_=0,j=s(S/2),k=S-j,n=N?0:j,f=X*l,q=f/10;c-=f,T+=f,Q.clearRect(c,0,T-c,S),Q.beginPath(),Q.fillStyle=G;var P=D($/q)*q-b;for(z=P;T>z;z+=q)Q.rect(z,e+n,1,k);for(z=P;z>c;z-=q)Q.rect(z,e+n,1,k);for(Q.fill(),n=N?0:1,Q.beginPath(),Q.fillStyle=o,P=D($/f)*f-b,z=P;T>z;z+=f)Q.rect(z,e+n,1,S-1);for(z=P;z>c;z-=f)Q.rect(z,e+n,1,S-1);Q.fill();var m=s(/\d+px/.exec(K)[0]),E=(m||10)/2;Q.textBaseline="middle",n=N?S-E-2:E+2,Q.beginPath(),Q.fillStyle=y,Q.font=K;var L=D($/f)*f/l;for(z=P,_=L;T>z;z+=f,_+=X){var O=this.getHScaleText?this.getHScaleText(z):_;Q.fillText(this.formatScaleText(O),z+2,e+n)}for(z=P,_=L;z>c;z-=f,_-=X){var O=this.getHScaleText?this.getHScaleText(z):_;Q.fillText(this.formatScaleText(O),z+2,e+n)}Q.restore()},$12k:function(S,i,W,n,j,b,C,O,u,B,m,G,E){function g(k,t,O,A,_,C){_=M.getVScaleText?M.getVScaleText(O):_,_=M.formatScaleText(_),S.translate(k+t,O),S.rotate(-A),S.translate(-k-t,-O),S.fillText(_,k+t+(C?2:1),O),S.translate(k+t,O),S.rotate(A),S.translate(-k-t,-O)}S.save(),i=0;var l=W,h=j,t=(l+h)/2;W=0,j=h-l,v.translateAndScale(S,0,0,1);var K=0,M=this,Q=0,k=s(b/2),L=b-k,p=m?0:k,F=O*C,A=F/10;W-=F,j+=F,S.clearRect(i,0,b,j-W),S.beginPath(),S.fillStyle=E;var Y=D(t/A)*A-l;for(K=Y;j>K;K+=A)S.rect(i+p,K,L,1);for(K=Y;K>W;K-=A)S.rect(i+p,K,L,1);for(S.fill(),p=m?0:1,S.beginPath(),S.fillStyle=G,Y=D(t/F)*F-l,K=Y;j>K;K+=F)S.rect(i+p,K,b-1,1);for(K=Y;K>W;K-=F)S.rect(i+p,K,b-1,1);S.fill();var X=s(/\d+px/.exec(u)[0]),o=(X||10)/2,$=90*P/180;S.textBaseline="middle",p=m?b-o:o+2,$=m?-$:$,S.beginPath(),S.fillStyle=B,S.font=u;var z=D(t/F)*F/C;for(K=Y,Q=z;j>K;K+=F,Q+=O)g(i,p,K,$,Q,m);for(K=Y,Q=z;K>W;K-=F,Q-=O)g(i,p,K,$,Q,m);S.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var z=this,R=z._component,L=z._view;R&&z.removeComponentPropertyChangeListener(R,z.$14k),L&&(O(L,"mousemove",z.$15k),t(L.parentNode,L),z._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);