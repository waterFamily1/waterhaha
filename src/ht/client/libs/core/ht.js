!function(S,O,n){"use strict";var J="ht";if(!S[J]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),S.performance&&S.performance.now||function(){var K=Date.now();S.performance||(S.performance={}),S.performance.now=function(){return Date.now()-K}}();for(var c=Date.now(),k=16,T=["ms","moz","webkit","o"],K=0;K<T.length&&!S.requestAnimationFrame;++K)S.requestAnimationFrame=S[T[K]+"RequestAnimationFrame"],S.cancelAnimationFrame=S[T[K]+"CancelAnimationFrame"]||S[T[K]+"CancelRequestAnimationFrame"];S.requestAnimationFrame||(S.requestAnimationFrame=function($){var p=Date.now(),o=k+c-p;return 0>o&&(o=0),c=p,S.setTimeout(function(){c=Date.now(),$(performance.now())},o)}),S.cancelAnimationFrame||(S.cancelAnimationFrame=function(l){return S.clearTimeout(l)}),O.assign===n&&(O.assign=function(I){if(I===n||null===I)throw new TypeError("Cannot convert undefined or null to object");for(var E=O(I),S=1;S<arguments.length;S++){var Y=arguments[S];if(Y!==n&&null!==Y)for(var N in Y)O.prototype.hasOwnProperty.call(Y,N)&&(E[N]=Y[N])}return E})}();var W=S.document,E=null,B=S[J]={},u=S[J+"config"],$=B.Default=u&&u.Default||{},r=B.Style=u&&u.Style||{},j=B.Attr=u&&u.Attr||{},D=B.Color=u&&u.Color||{},G=B.IsGetter=u&&u.IsGetter||{};!function(){var j=!1;try{var o=O.defineProperty({},"passive",{get:function(){j=!0}});S.addEventListener("test",o,o),S.removeEventListener("test",o,o)}catch(D){j=!1}$.passiveSupported=j}();var e,l,o,K,V=$.passiveSupported,k=$.eventListenerOptionsFalse=V?{passive:!1,capture:!1}:!1,R=$.eventListenerOptionsTrue=V?{passive:!1,capture:!0}:!0,v=Math,C=v.round,A=v.floor,d=v.ceil,i=v.sqrt,N=v.max,s=v.min,F=v.abs,T=v.cos,g=v.acos,y=v.sin,_=v.pow,h=v.asin,t=v.PI,f=2*t,H=t/2,L=v.tan,U=v.atan2,I=v.random,X=v.log,w=!1,q=!1,Y=S.parseInt||global.parseInt,c="2019-02-15",M=S.navigator?S.navigator.platform.indexOf("Win")>-1:!1,p=function(P){return P*P},x=S.setTimeout,P=S.clearTimeout,m=S.location,z=S.navigator?S.navigator.userAgent.toLowerCase():"",Q=function(B){return B.test(z)},Z=Q(/msie/),b=Q(/msie/)||Q(/trident/),a=Q(/msie 10/),gf=Q(/edge/),$m=Q(/firefox/),Cn=Q(/mac/),im=$.isTouchable===n?M?!1:W?"ontouchend"in W:!1:$.isTouchable,hm="default",hn="single",bp="multiple",Gr="front",hq="back",Pi="left",tl="right",Ui="top",Ki="bottom",Lr="center",Pc="eye",Jm="middle",mh="east",Lf="west",oq="north",Uo="none",sb="px",Ob="absolute",Kb="border",pk="triangle",Fe="rect",bg="circle",dk="cylinder",xc="shape",Zd="items",Ae="normal",ab="remove",Wb="clear",og="width",ur="height",Am="ingroup",Je="check",vf="uncheck",_j="radio",gq="radioOn",Rq="radioOff",mc="points",Mj="values",zd="series",Mk="body",Eo="label",re="label2",No="note",ss="note2",ep="icons",Kj="labelFont",Kk="labelColor",id="labelSelectColor",Gf="note.expanded",Oe="note2.expanded",Me="edge.expanded",Og="edge.points",Qr="edge.type",_c="rotation",ko="hidden",vh="visible",Jd="tuv",Nq="no",xf="draw",Qn="select",$i="currentSubGraph",Iq="selectBackground",wd="autoMakeVisible",fi="autoHideScrollBar",ir="scrollBarColor",Ab="scrollBarSize",vi="indent",Pk="rowHeight",Jo="columnLineColor",je="rowLineColor",Xf="columnLineVisible",Cq="rowLineVisible",Eg="visibleFunc",an="expandIcon",yf="collapseIcon",iq="checkMode",Rf="sortFunc",Zh="editable",lf="batchEditable",$d="tristate",Hm="asc",Xg="desc",xl="position",br="elevation",vo="children",Xd="translateX",rk="translateY",Td="dataModel",Fi="maxSize",cd="shape3d",jn="shape3d.resolution",Gm="shape3d.visible",me="shape3d.from.visible",Vk="shape3d.to.visible",pf="shape3d.top.visible",af="shape3d.bottom.visible",Ol="repeat.uv.length",wm="serializeValue",sk="deserializeValue",oi="centerUniform",rn="uniform",To="rgba(255,255,255,0)",th="style",Nn="attr",Qe="field",eh="string",Hr="boolean",Ep="color",Qh="int",Ch="number",Cp="ew-resize",Mf="ns-resize",Ho="pointer",hs="auto",Rl="mousedown",Lg="mousemove",Gh="mouseup",xg="mouseout",sl="touchstart",lc="touchmove",Mi="touchend",Pp="keydown",Ag="keyup",We=["DOMMouseScroll","mousewheel"],wn=$m?We[0]:We[1],Di=im?[sl,lc,Mi,Pp,Ag,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[Pp,Ag,"keypress","input",Rl,Lg,Gh,xg,wn,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],_i=E,Bs=E,ds=E,rg=Gh.length,Vh=function(){ds&&(P(ds.timeout),ds=E)},Zr=function(){ds&&Pf(ds.e,ds.info)};S.addEventListener&&(im||(S.addEventListener(xg,function(){Vh()},k),S.addEventListener(wn,function(){ij()},k)),S.addEventListener(Ag,function(t){91===t.keyCode?tq={}:delete tq[t.keyCode]},R),S.addEventListener(Pp,function(q){tq[q.keyCode]=!0},R),S.addEventListener("blur",function(){tq={}},k));var rd,qr,zq,ng=0,jj=E,Tn=function(C,o){var g=x(function(){delete jj[g],si(jj)&&(jj=E),C()},o);return g},Vr=E,Ei=E,Ij={},Xr={},he={},Ee={},ef={},tq={},Xl={},Zp={},Fr={},vk={},$n=/.json$/,Ul=/^data:image\/svg\+xml/,eo={},As=[],mf={},Ie=E,Ao=E,Xe=function(){},Sp=function(){throw"Oops!"},$g=[0,0,0],sm={x:0,y:0,width:0,height:0},yq=E,Cl=E,If=E,Un=function(l,f){Xr[l]=f,f&&f.comps&&!f.uuid&&(f.uuid=B.Math.generateUUID()),Sq[l]&&(f.cacheRule=Sq[l],delete Sq[l])},mp=function(k){Cl&&!k._72O&&(If||(If={}),If[k._72O=oj()]=k),rd!=E?zc()<.05&&K&&!qr&&(of=Vh):of=Uf},qh=function(A,D,e,t){Cl||(Cl={});var u=Cl[A];if(u){if(u.url===D)return;u.image?(u.image.onload=Xe,u.image.onerror=Xe):u.request&&(u.request.onload=Xe,u.request.onerror=Xe)}if($n.test(D)){var g=new Ql;if(Cl[A]={request:g,url:D},D=$.beforeLoadURL(D),D.data){var U=$.parse(D.data);ne(A,U),$.handleImageLoaded(A,U)}else{g.onload=function(u){if(200===this.status||0===this.status){var c=$.parse(u.target.response||u.target.responseText);ne(A,c),$.handleImageLoaded(A,c)}else ne(A,$.handleUnfoundImage(A,D)||E)},g.onerror=function(){ne(A,$.handleUnfoundImage(A,D)||E)};var m={};m.url=encodeURI(D),m.sync=!1,g.send(m)}}else{var U=new Image;Cl[A]={image:U,url:D},/^data:image/.test(D)||(D=$.beforeLoadURL(D),D=$.appendTimeStamp(D),D=encodeURI(D),U.crossOrigin=$.crossOrigin),$.convertImageSrc(D,function(Z){b&&(D.toLowerCase().indexOf(".svg")>0||Ul.test(D))?(W.body.appendChild(U),U.style.visibility="hidden",U.onload=function(){x(function(){if(e&&(U.width=e),t&&(U.height=t),!U.width||!U.height){var Y=U.width||U.clientWidth,G=U.height||U.clientHeight;U.width=Y,U.height=G}$.handleImageLoaded(A,U),ne(A,U),W.body.removeChild(U),U.style.visibility=""},180)},U.onerror=function(){ne(A,$.handleUnfoundImage(A,D)||E),W.body.removeChild(U),U.style.visibility=""}):(U.onload=function(){e&&(U.width=e),t&&(U.height=t),$.handleImageLoaded(A,U),ne(A,U)},U.onerror=function(){ne(A,$.handleUnfoundImage(A,D)||E)}),U.src=Z})}},ne=function(k,t){if(Un(k,t),delete Cl[k],si(Cl)&&(Cl=E,If)){for(var F in If){var O=If[F];O._2O&&(O._2O={}),O.invalidateAll&&O.invalidateAll(n,"imageLoaded",k),O.redraw&&O.redraw(),O.iv(),delete O._72O}If=E}if(t&&If)for(var F in If){var O=If[F];O.invalidateAll&&O.invalidateAll(n,"imageLoading",k),O.redraw&&O.redraw(),O.iv()}},xq=function(){return X=v&&Date,function(){return S.performance&&S.performance.now?S.performance.now():Date.now()}}(),gl=function(_,U){U?P(_):S.cancelAnimationFrame(_)},Mm=function(Y,i,X){return{width:Y,height:i,comps:Km(X)?X:[X]}},Zq=function(w,E){return{type:bg,rect:[w,E,1.6,1.6],borderWidth:1,borderColor:Gl,gradient:ri,gradientColor:zo,background:Gl}},np=function(i,A){return Mm(16,16,{type:pk,rect:[4,4,10,8],background:i,rotation:A?1.57:3.14})},cs=function(m,n){return Mm(16,16,{type:pk,rect:[4,4,8,7],background:m,rotation:n?3.14:0})},Ni=function(c){var F=c._orientation;return"horizontal"===F||"h"===F},Hh=function(P){var k=E||4,d=E||1,H=E||1;0>k?k=0:k>.25&&(k=.25);var G,B,q,Q,o,h,c,Y=.5,V=[],u=[],_=[],R=f/H,N=f/d,m=Y-k;for(B=0;d>=B;B++)for(Q=-t+B*N,h=T(Q),o=y(Q),G=0;H>=G;G++)q=G*R,c=m+k*h,V.push(T(q)*c,o*k,-y(q)*c),(l=P)&&u.push(G/H,1-B/d);for(B=0;d>B;B++){var W=B*(H+1),S=(B+1)*(H+1);for(G=0;H>G;G++)_.push(W+G,S+G+1,S+G,W+G,W+G+1,S+G+1),Er.z=up.z=P}},ge=function(u){var K=2,Q=0;for(var _ in u)_.length===K&&Y(_,32)===Vm&&(Ie=Ao=u[_]),Q++;return Q},ti=function(d,Y,j,f){return j||(j=im?5:3,j/=f||1),{x:d-j,y:Y-j,width:2*j,height:2*j}},Jb=function(E,s,z,x){var W=this;s||(s=im?5:3,z=20,x=20);var B={x:E,y:s,width:z,height:x};if(z)for(var V=0;z>V;V++)if(3===z)x=20;else for(var o=0;x>o;o++)W=S?S:z;var q={x:t,y:2*t};if(Yr(B,q)){var v=ur[0]+Ui[0]+Wb[1]+(Hm.length-1);De[Pc]=W[v],W[v]=gm[Pc]}},Bc=function(W){return(/ble$/.test(W)||/ed$/.test(W)||G[W]?"is":"get")+W.charAt(0).toUpperCase()+W.slice(1)},gm=function(g){return"set"+g.charAt(0).toUpperCase()+g.slice(1)},Qo=function(n){return typeof n===eh||n instanceof String},Ib=function(d){return typeof d===Ch},Uf=function(t){return typeof t===Hr},Kq=function(q){return q&&"object"==typeof q},hp=function(h){return"function"==typeof h},Km=function(Y){return Y instanceof Array},om=function(L){return L instanceof yb},Xj=function(p){return Km(p)?new yb(p):p},fk=function(b){return b instanceof Ur},Ll=function(K){return K instanceof zi},Xi=function(H){return H instanceof we},Bh=function(p,N){if(!(p instanceof B.Group))return!1;if(!N)return p.isExpanded();var C=N.getDataUI(p);return C&&C._88I?!0:!1},Fh=function(d){return d instanceof Go},Qq=function(C){return C&&"IFRAME"===C.tagName},on=function(A){return A==E||$.numberDigits==E?A:parseFloat(A.toFixed($.numberDigits))},mb=function(x,F,R){var U,M=F.length;if(R)for(var o=0;R>o;o++)if(3===M)x.push(F[0]),x.push(F[1]),x.push(F[2]);else for(U=0;M>U;U++)x.push(F[U]);else if(3===M)x.push(F[0]),x.push(F[1]),x.push(F[2]);else for(U=0;M>U;U++)x.push(F[U])},_q=function(Z){return Z?Kq(Z)?Z:{}:!1},yp=function(W,B,i){var d,y=Kq(W)?W:W.prototype;for(d in B)i&&y[d]!==n||(y[d]=B[d]);return W},bo=function(N){return String.fromCharCode(N)},Gp=function(A){for(var Y,q=0,W="";q<A.length;q++)Y=A[A.length-1-q],"%"===Y?Y="'":"a"===Y?Y='"':"]"===Y&&(Y="\\"),W+=bo(Y.charCodeAt(0)-1);return W},bs=function(S,$,Z){S.superClass.constructor.apply($,Z)},si=function(s){for(var O in s)return!1;return!0},wk=function(Y){return Y?0===Y.length:!0},zr=function(){var k="";return[vf[0],je[0],Eo[0]].forEach(function(B){k+=gm(B).slice(3)}),rn=W&&W[k]||oi,function(r,E){return r===E?!0:r.x===E.x&&r.y===E.y&&r.width===E.width&&r.height===E.height}}(),js=function(y,j,U){return j>y?j:y>U?U:y},or=function(v){return 0>v?-1:v>0?1:0},zc=function(){var E=1e4*y(rg++);return E-A(E)},ae=function(D,c,P){return oh(D.x,D.y,c.x,c.y,P.x,P.y,P.x+P.width,P.y,!0)||oh(D.x,D.y,c.x,c.y,P.x+P.width,P.y,P.x+P.width,P.y+P.height,!0)||oh(D.x,D.y,c.x,c.y,P.x+P.width,P.y+P.height,P.x,P.y+P.height,!0)||oh(D.x,D.y,c.x,c.y,P.x,P.y+P.height,P.x,P.y,!0)},oh=function(H,C,n,r,K,Q,L,a,J){var e=(L-K)*(C-Q)-(a-Q)*(H-K),f=(a-Q)*(n-H)-(L-K)*(r-C);if(0!==f){var k=e/f,d=H+k*(n-H),S=C+k*(r-C);return J&&(d+Yk<s(H,n)||d-Yk>N(H,n)||d+Yk<s(K,L)||d-Yk>N(K,L)||S+Yk<s(C,r)||S-Yk>N(C,r)||S+Yk<s(Q,a)||S-Yk>N(Q,a))?E:[d,S]}return E},Se=function(W,b,r){if(W&&r)if(b){if(b===th)return W.getStyle(r);if(b===Nn)return W.getAttr(r);if(b===Qe)return W[r]}else if(r=Bc(r),W[r])return W[r]();return n},tr=function(v,i,P,B){if(v&&P)if(i){if(i===th)v.s(P,B);else if(i===Nn)v.a(P,B);else if(i===Qe){var G=v[P];v[P]=B,v.fp("f:"+P,G,B)}}else P=gm(P),v[P]&&v[P](B)},op=function(Y,h,l){return h&&"top"!==h?"bottom"===h?{x:Y.x,y:Y.y,width:Y.width,height:Y.height*l}:"right"===h?{x:Y.x,y:Y.y,width:Y.width*l,height:Y.height}:"left"===h?{x:Y.x+Y.width*(1-l),y:Y.y,width:Y.width*l,height:Y.height}:void 0:{x:Y.x,y:Y.y+Y.height*(1-l),width:Y.width,height:Y.height*l}},as=function(P,b,G,T,u){b&&Fp(P,G,T,1,u,b)},uo=function(E,A,g,R){var D=1-E;return D*D*A+2*E*D*g+E*E*R},Er=function(p,U,c,T,F){var e=1-p;return e*e*e*U+3*e*e*p*c+3*e*p*p*T+p*p*p*F},kf=function(c){var C,d,M,Q,q=0;return c.forEach(function(J){if(C=J.length,C>0)for(d=J[0],Q=1;C>Q;Q++)M=J[Q],q+=gn(d,M),d=M}),q},Sc=function(l,h,W){var Y="__"+l,B=function(B){W.disabled||W["handle_"+l](B)};W[Y]||(W[Y]=B,h.addEventListener(l,B,k))},Pm=function(O,$,j){var X="__"+O,_=j[X];_&&($.removeEventListener(O,_,k),delete j[X])},Nh=function(v,O){var L="_"+O;v[Bc(O)]=function(){return this[L]},v[gm(O)]=function(S){var y=this[L];this[L]=S,this.fp(O,y,S)}},qf=function(L){return O.create(L)},qp=function(n){if(!n.element){var s,b;(s=n.textField)?b=mq(hd.TextField,s):(s=n.textArea)?b=mq(hd.TextArea,s):(s=n.button)?b=mq(hd.Button,s):(s=n.comboBox)?b=mq(hd.ComboBox,s):(s=n.checkBox)?b=mq(hd.CheckBox,s):(s=n.radioButton)?b=mq(hd.RadioButton,s):(s=n.slider)?b=mq(hd.Slider,s):(s=n.colorPicker)?b=mq(hd.ColorPicker,s):(s=n.image)&&(b=mq(hd.Image,s)),b&&(n.element=b)}},Hn=function(x,E){var p=Rd(x);return p._ht=E,p},Rd=function(v,P){var O=W.createElement("div"),k=O.style;return O.tabIndex=-1,O.onkeydown=ki,k.msTouchAction=Uo,El(O,E,0),im&&k.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",E),v&&(k.overflow=ko),P&&Hi(P,O),O},Fj=function(l,$){var q=W.createElement("canvas"),s=q.style;return s.msTouchAction=Uo,$||(s.pointerEvents=Uo),El(q,E,0),l&&Hi(l,q),q},El=function(c,s,u){var J=c.style;J.border=s?s+" solid 1px":0,J.outline=0,J.padding=u?"0 "+u+sb:0,Mn(c)},Mn=function(d){var z=d.style;z.position=Ob,z.margin=0,z.setProperty("box-sizing","border-box",E),z.setProperty("-moz-box-sizing","border-box",E)},nf=function(_,K,S,B){B||(B=ll),K!=E&&(_.width=K*B,_.style.width=K+sb),S!=E&&(_.height=S*B,_.style.height=S+sb)},Hi=function(Z,s,L){Z.appendChild(s),L&&(s.style.position=Ob)},Qi=function(v,c){c.split||(c+="");for(var H,S=c.split("\n"),U=0,T=S.length,g=0;T>g;g++){var f=er(v.font,S[g]);f.width>U&&(U=f.width),H||(H=f.height)}return v.ss=S,{width:U,height:H*T}},qn=function(m,D,K,Q,k,c){var g=D.length;if(1===g)ah(m,D[0],K,Q,k);else for(var P=K.height/g,M={x:K.x,y:K.y,width:K.width,height:P},j=0;j<D.length;j++)c?Cd(m,D[j],Q,k,M.x,M.y,M.width,M.height,c):ah(m,D[j],M,Q,k),M.y+=P},ah=function(r,$,c,h,t){r.font=h?h:Mr,r.fillStyle=t?t:Wn,r.textAlign=Lr,r.textBaseline=Jm;var T,R;c?c.width===n?(T=c.x,R=c.y):(T=c.x+c.width/2,R=c.y+c.height/2):(T=0,R=0),r.fillText($,C(T),C(R))},Wl=function(Q){Q.getView&&(Q=Q.getView());var $=Q.offsetWidth||Q.scrollWidth;return!$&&Q.style.width&&($=Y(Q.style.width)),$},lk=function(F){F.getView&&(F=F.getView());var A=F.offsetHeight||F.scrollHeight;return!A&&F.style.height&&(A=Y(F.style.height)),A},Sd=function(Q,K,n){var d=K[0].toUpperCase()+K.substring(1,K.length);Q["webkit"+d]=n,Q["moz"+d]=n,Q["ms"+d]=n,Q["o"+d]=n,Q[K]=n},xs=function(){var B=function(k){ki(k),k.stopPropagation()},R=function(Z){ki(Z)},X=im?[sl]:[Pp,Rl];return function(H,T){var Y=Rd(),P=Y.style;return P.backgroundColor=$.disabledBackground,H&&(P.backgroundImage="url("+H+")",P.backgroundPosition="50% 50%",P.backgroundRepeat="no-repeat no-repeat"),T===!1?X.forEach(function(V){Y.addEventListener(V,R,k)}):X.forEach(function(g){Y.addEventListener(g,B,k)}),Y}}(),Qc=function(U){var I=U.getContext("2d");return I.save(),I.lineCap=Wr,I.lineJoin=Dq,I},of=function(O,H,o,q){Gg(O,H*ll,o*ll),q*=ll,1!==q&&O.scale(q,q)},Gg=function(x,k,A){x.translate(k,A)},Ke=function(v,$){$&&v.rotate($)},Sl=function(A,D,L){D===n&&(D=1),L===n&&(L=1),(1!==D||1!==L)&&A.scale(D,L)},Rp=!1,Gk=function(g){var P=W.activeElement;if(W.activeElement!==g){P&&P.forceOnblur&&P.forceOnblur();for(var D=[],k=g.parentNode;k;)D.push([k,k.scrollLeft,k.scrollTop]),k=k.parentNode;if(!Rp){var u=[],U=[];try{for(var o=S.parent,O=S;o!==O;)u.push([o,o.scrollX,o.scrollY]),O=o,o=S.parent;var e=S.frameElement;if(e)for(var a=e.parentNode;a;)U.push([a,a.scrollLeft,a.scrollTop]),a=a.parentNode}catch(L){Rp=!0}}if(im)g.focus();else{var $=Ac(),Q=$.target;g.focus(),Q.scrollLeft=$.left,Q.scrollTop=$.top}D.forEach(function(I){I[0].scrollLeft=I[1],I[0].scrollTop=I[2]}),Rp||(u.forEach(function(d){d[0].scrollTo(d[1],d[2])}),U.forEach(function(T){T[0].scrollLeft=T[1],T[0].scrollTop=T[2]}))}},Jg=function(d){return d&&d.getView?d.getView():d},ib=function(B,y,L,w,X){if(2===arguments.length&&(L=y.y,w=y.width,X=y.height,y=y.x),B.isSelfViewEvent)B.setX(y),B.setY(L),B.setWidth(w),B.setHeight(X);else{var Y=Jg(B),A=Y.style;if((W.fullscreenElement||W.mozFullScreenElement||W.webkitFullscreenElement||W.msFullscreenElement)!==Y)y!==n&&(A.left=y+sb),L!==n&&(A.top=L+sb),w!==n&&(A.width=w+sb),X!==n&&(A.height=X+sb);else{var R=$.getWindowInfo();A.left=(y=R.left)+sb,A.top=(L=R.top)+sb,A.width=(w=R.width)+sb,A.height=(X=R.height)+sb}B.endEditing&&!im&&B.endEditing(),B.redraw&&B.redraw(),B.invalidate&&B.invalidate(),B.onLayouted&&B.onLayouted(y,L,w,X),B.fireViewEvent&&B.fireViewEvent("layout")}},pp=function(m){if(!m.touches)return m;var x=m.touches[0];return x?x:m.changedTouches[0]},Md=function(B){return im?pp(B).target:B.target},Rh=function(G){$.popup&&$.popup.close(),$.popup=G},df=E,jk=function(b){df.handleWindowTouchMove(b)},ph=function(W){df.handleWindowTouchEnd(W),S.removeEventListener(lc,jk,k),S.removeEventListener(Mi,ph,k),df=E},ak=function(Q){df.handleWindowMouseMove(Q)},nl=function(T){df.handleWindowMouseUp(T),S.removeEventListener(Lg,ak,k),S.removeEventListener(Gh,nl,k),df=E},lm=function(h){return 1===Bf(h)},kk=function(X,l){return l?l.keyCode===X:tq[X]},kj=function(Z){return In(Z)&&kk(65,Z)},Bb=function(I){return kk(46,I)||kk(8,I)},Cf=function(w){return function(B){return B?B.keyCode===w:tq[w]}},Vm=573,zh=[65,83,68,87,37,38,39,40,32,13,27],Fk=Cf(zh[0]),um=Cf(zh[1]),Vc=Cf(zh[2]),kh=Cf(zh[3]),Hf=Cf(zh[4]),uh=Cf(zh[5]),eg=Cf(zh[6]),ps=Cf(zh[7]),dg=Cf(zh[8]),Qd=Cf(zh[9]),$j=Cf(zh[10]),yk={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},xr=[2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,8971],_n=E,gg=E,yl=function(h,T){_n||(_n=Fj()),nf(_n,h,T,1);var l=Qc(_n);return l.clearRect(0,0,h,T),l},ue=function(){var b,k={};for(var j in S){var Z=bp.length;if(j.length==Z&&j[0]===bp[2]&&j[1]===Uo[1]&&j[4]===bp[3]&&j[5]===bp[4]&&j.substr(Z-2)===Uo[1]+Uo[2]){var t=S[j];for(var h in t)h.length===Z&&h.substr(0,3)===tl[3]+ab[3]+Qn[0]&&h.substr(Z-2)===bp[0]+No[3]&&(We=t[h])}}return function(O){var F,a=k[O];return a||(b||(b=Fj(),nf(b,1,1,1)),F=b.getContext("2d"),F.clearRect(0,0,1,1),Fp(F,0,0,1,1,O),a=F.getImageData(0,0,1,1).data,a=k[O]=[a[0],a[1],a[2],a[3]]),a}}(),oo=function(K){if(!Qo(K))return K;var Y=ue(K);return Y.CA||(Y.CA=[Y[0]/255,Y[1]/255,Y[2]/255,Y[3]/255]),Y.CA},te=function(B,M,d,Y,y){var T=Fj();T.width=d,T.height=Y;var a=T.getContext("2d");a.drawImage(B,0,0,d,Y);try{for(var w=a.getImageData(0,0,d,Y),G=w.data,e=0,W=G.length;W>e;e+=4){var V=G[e+0],b=G[e+1],v=G[e+2],h=G[e+3];"override_a"===y?G[e+3]=255*M[3]:"override_rgb"===y?(G[e+0]=255*M[0],G[e+1]=255*M[1],G[e+2]=255*M[2]):"override"===y?(G[e+0]=255*M[0],G[e+1]=255*M[1],G[e+2]=255*M[2],G[e+3]=255*M[3]):(G[e+0]=M[0]*V,G[e+1]=M[1]*b,G[e+2]=M[2]*v,G[e+3]=M[3]*h)}a.putImageData(w,0,0)}catch(k){return B}return T},De=function(L,s,D){return s&&(s="miter"===D?8*s+20:s+1,L&&ip(L,s)),s},cl=function(u,T){if(T){var A=new Ng(T),W=u.width/2,n=u.height/2,V=Vn([A.tf(-W,-n),A.tf(W,-n),A.tf(W,n),A.tf(-W,n)]);return V.x+=u.x+W,V.y+=u.y+n,V}return u},_p=function(F,A,v,w,x,I,z,m){w*=Math.PI/180;var S={x:Math.cos(w)*(F.x-z.x)/2+Math.sin(w)*(F.y-z.y)/2,y:-Math.sin(w)*(F.x-z.x)/2+Math.cos(w)*(F.y-z.y)/2},q=Math.pow(S.x,2)/Math.pow(A,2)+Math.pow(S.y,2)/Math.pow(v,2);q>1&&(A*=Math.sqrt(q),v*=Math.sqrt(q));var B=(x==I?-1:1)*Math.sqrt((Math.pow(A,2)*Math.pow(v,2)-Math.pow(A,2)*Math.pow(S.y,2)-Math.pow(v,2)*Math.pow(S.x,2))/(Math.pow(A,2)*Math.pow(S.y,2)+Math.pow(v,2)*Math.pow(S.x,2)));isNaN(B)&&(B=0);var l={x:B*A*S.y/v,y:B*-v*S.x/A},U={x:(F.x+z.x)/2+Math.cos(w)*l.x-Math.sin(w)*l.y,y:(F.y+z.y)/2+Math.sin(w)*l.x+Math.cos(w)*l.y},P=function(g){return Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2))},g=function(K,Z){return(K[0]*Z[0]+K[1]*Z[1])/(P(K)*P(Z))},Z=function(H,M){return(H[0]*M[1]<H[1]*M[0]?-1:1)*Math.acos(g(H,M))},H=Z([1,0],[(S.x-l.x)/A,(S.y-l.y)/v]),Y=[(S.x-l.x)/A,(S.y-l.y)/v],K=[(-S.x-l.x)/A,(-S.y-l.y)/v],d=Z(Y,K);g(Y,K)<=-1&&(d=Math.PI),g(Y,K)>=1&&(d=0);var g=A>v?A:v,E=A>v?1:A/v,p=A>v?v/A:1;if(null==m){var D={x:0,y:0,width:0,height:0};ip(D,g),D.x*=E,D.width*=E,D.y*=p,D.height*=p;var b=new Ng(w);return D=Vn([b.tf(D.x,D.y),b.tf(D.x+D.width,D.y),b.tf(D.x+D.width,D.y+D.height),b.tf(D.x,D.y+D.height)]),D.x+=U.x,D.y+=U.y,[{x:D.x,y:D.y},{x:D.x+D.width,y:D.y},{x:D.x+D.width,y:D.y+D.height},{x:D.x,y:D.y+D.height}]}m.translate(U.x,U.y),m.rotate(w),m.scale(E,p),m.arc(0,0,g,H,H+d,1-I),m.scale(1/E,1/p),m.rotate(-w),m.translate(-U.x,-U.y)},mj=function(R,G){R&&R.beginPath();for(var U,x,M,f=[],d=function(p){for(var m,a=/(\-{0,1}[\d\.]+)/gi,R=[];m=a.exec(p);)R.push(parseFloat(m[0]));return R},P=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,F={x:0,y:0};U=P.exec(G);){var $=U[0],n=$.substr(0,1);if("M"===n||"m"===n){for(var C=d($),u=0;u<C.length;u+=2){var v=C[u],A=C[u+1];"m"===n&&(v+=F.x,A+=F.y),R&&R.moveTo(v,A),f.push({x:v,y:A}),F.x=v,F.y=A}x=M=null}else if("H"===n||"h"===n){for(var C=d($),u=0;u<C.length;u+=1){var v=C[u];"h"===n&&(v+=F.x),R&&R.lineTo(v,F.y),f.push({x:v,y:F.y}),F.x=v}x=M=null}else if("C"===n||"c"===n){for(var C=d($),u=0;u<C.length;u+=6){var t=C[u],E=C[u+1],S=C[u+2],B=C[u+3],v=C[u+4],A=C[u+5];"c"===n&&(t+=F.x,E+=F.y,S+=F.x,B+=F.y,v+=F.x,A+=F.y),R&&R.bezierCurveTo(t,E,S,B,v,A),f.push({x:t,y:E}),f.push({x:S,y:B}),f.push({x:v,y:A}),F.x=v,F.y=A}x=[t,E,S,B,v,A],M=null}else if("S"===n||"s"===n){for(var C=d($),u=0;u<C.length;u+=4){var t,E;x?(t=2*x[4]-x[2],E=2*x[5]-x[3]):(t=F.x,E=F.y);var S=C[u],B=C[u+1],v=C[u+2],A=C[u+3];"s"===n&&(S+=F.x,B+=F.y,v+=F.x,A+=F.y),R&&R.bezierCurveTo(t,E,S,B,v,A),f.push({x:t,y:E}),f.push({x:S,y:B}),f.push({x:v,y:A}),F.x=v,F.y=A}x=[t,E,S,B,v,A],M=null}else if("Q"===n||"q"===n){for(var C=d($),u=0;u<C.length;u+=4){var t=C[u],E=C[u+1],v=C[u+2],A=C[u+3];"q"===n&&(t+=F.x,E+=F.y,v+=F.x,A+=F.y),R&&R.quadraticCurveTo(t,E,v,A),f.push({x:t,y:E}),f.push({x:v,y:A}),F.x=v,F.y=A}x=null,M=[t,E,v,A]}else if("T"===n||"t"===n){for(var C=d($),u=0;u<C.length;u+=2){var t,E;M?(t=2*M[2]-M[0],E=2*M[3]-M[1]):(t=F.x,E=F.y);var v=C[u],A=C[u+1];"t"===n&&(v+=F.x,A+=F.y),R&&R.quadraticCurveTo(t,E,v,A),f.push({x:t,y:E}),f.push({x:v,y:A}),F.x=v,F.y=A}x=null,M=[t,E,v,A]}else if("V"===n||"v"===n){for(var C=d($),u=0;u<C.length;u+=1){var A=C[u];"v"===n&&(A+=F.y),R&&R.lineTo(F.x,A),f.push({x:F.x,y:A}),F.y=A}x=M=null}else if("L"===n||"l"===n){for(var C=d($),u=0;u<C.length;u+=2){var v=C[u],A=C[u+1];"l"===n&&(v+=F.x,A+=F.y),R&&R.lineTo(v,A),f.push({x:v,y:A}),F.x=v,F.y=A}x=M=null}else if("A"===n||"a"===n){for(var C=d($),u=0;u<C.length;u+=7){var _=C[u],i=C[u+1],l=C[u+2],e=C[u+3],m=C[u+4],v=C[u+5],A=C[u+6];"a"===n&&(v+=F.x,A+=F.y);var s=_p(F,_,i,l,e,m,{x:v,y:A},R);s&&(f=f.concat(s)),F.x=v,F.y=A}x=M=null}var L=$.substr($.length-1);("z"===L||"Z"===L)&&R&&R.closePath()}return f},Nf=function(b,Y){var J,Z,i="L"===Y[0],k=Y.length;b.save(),i?(b.transform(Y[5],Y[6],Y[7],Y[8],Y[9],Y[10]),J=b.createLinearGradient(Y[1],Y[2],Y[3],Y[4]),Z=11):(b.transform(Y[7],Y[8],Y[9],Y[10],Y[11],Y[12]),J=b.createRadialGradient(Y[1],Y[2],Y[3],Y[4],Y[5],Y[6]),Z=13);for(var Q=b.compGray;k>Z;)J.addColorStop(Y[Z],Q?$.toGrayColor(Y[Z+1]):Y[Z+1]),Z+=2;b.fillStyle=J},up=function(i,j){var A=i.s("shape.gradient.pack");if(A){for(var T=A.length,k=new Array(T),o=0;T>o;o++)k[o]=A[o];var p,n,C,s,V,S,P,g,x,U,B,q,f,O="L"===k[0];p=O?5:7,n=k[p],C=k[p+1],s=k[p+2],V=k[p+3],S=k[p+4],P=k[p+5],g=j[0],x=j[1],U=j[2],B=j[3],q=j[4],f=j[5],k[p]=g*n+U*C,k[p+1]=x*n+B*C,k[p+2]=g*s+U*V,k[p+3]=x*s+B*V,k[p+4]=g*S+U*P+q,k[p+5]=x*S+B*P+f,i.s("shape.gradient.pack",k)}},Sb=function(R,Y,A,S){var j=!1;if(R.beginPath?R.beginPath():j=!0,om(Y)&&(Y=Y._as),om(A)&&(A=A._as),A&&A.length){for(var z,$,T,I,e=0,J=0,n=A.length;n>J;J++)z=A[J],1===z?($=Y[e++],R.moveTo($.x,j?-$.y:$.y)):2===z?($=Y[e++],R.lineTo($.x,j?-$.y:$.y)):3===z?($=Y[e++],T=Y[e++],R.quadraticCurveTo($.x,j?-$.y:$.y,T.x,j?-T.y:T.y)):4===z?($=Y[e++],T=Y[e++],I=Y[e++],R.bezierCurveTo($.x,j?-$.y:$.y,T.x,j?-T.y:T.y,I.x,j?-I.y:I.y)):5===z&&R.closePath();S&&5!==z&&R.closePath()}else{var t,Z,m,v=Y.length;if(v>0){for(t=Y[0],R.moveTo(t.x,j?-t.y:t.y),Z=1;v>Z;Z++)m=Y[Z],R.lineTo(m.x,j?-m.y:m.y);S&&R.closePath()}}},vm=function(B,w,u,F){if(om(B)&&(B=B._as),om(w)&&(w=w._as),w&&w.length){u=u||$p;for(var n,v,W,k,U,h,b,s,G=[],Z=E,K=0,y=0,R=w.length;R>y;y++)if(n=w[y],1===n)G.push(Z=[]),Z.push(B[K++]);else if(2===n)Z.push(B[K++]);else if(3===n){for(v=Z[Z.length-1],W=B[K++],k=B[K++],h=1;u>h;h++)b=uo(h/u,v.x,W.x,k.x),s=uo(h/u,v.y,W.y,k.y),Z.push({x:b,y:s,b:!0});Z.push(k)}else if(4===n){for(v=Z[Z.length-1],W=B[K++],k=B[K++],U=B[K++],h=1;u>h;h++)b=Er(h/u,v.x,W.x,k.x,U.x),s=Er(h/u,v.y,W.y,k.y,U.y),Z.push({x:b,y:s,b:!0});Z.push(U)}else 5===n&&Z.push(Z[0]);return F&&5!==n&&Z&&Z.length>2&&Z.push(Z[0]),G}return F&&B.length>2&&(B=B.slice(),B.push(B[0])),B?[B]:[]},is=function(r,A,t,l,u,K){var J,h,U,E=ue(A),F=l,W=E[0],V=E[1],b=E[2];if(t){var m=ue(t);J=m[0]-W,h=m[1]-V,U=m[2]-b}else J=255-W,h=255-V,U=255-b;for(K||(K=l>10?1:.5,K=1>u?s(K/u,2):K);(l-=K)>0;){var i=1-l/F,S=W+J*i,O=V+h*i,c=b+U*i;S=s(d(S),255),O=s(d(O),255),c=s(d(c),255),r.strokeStyle="rgb("+S+","+O+","+c+")",r.lineWidth=l,r.stroke()}},Kh=function(){var W={};return function(K,q){var P=K+"-"+q,h=W[P];if(h)return h;var S,H,T,j=ue(K);return 0>q?(q=(100+q)/100,S=d(j[0]*q),H=d(j[1]*q),T=d(j[2]*q)):(q/=100,S=j[0],H=j[1],T=j[2],S+=(255-S)*q,H+=(255-H)*q,T+=(255-T)*q,S=s(d(S),255),H=s(d(H),255),T=s(d(T),255)),W[P]="rgb("+S+","+H+","+T+")"}}(),Fp=function(l,y,i,_,C,N){N&&(l.fillStyle=N),l.beginPath(),l.rect(y,i,_,C),l.fill()},ap=function(F,u,W,f,l,C,M){F.beginPath(),yi[u](F,W.x,W.y,W.width,W.height,f,l,C,M)},Rr=function(P,F,p,C,m){var w=yi[p];P.fillStyle=w?w(P,F,C?C:zo,m.x,m.y,m.width,m.height):F},dj=function(r,L,c,F,_,l){try{if(!L.tagName&&L.comps){L._cacheImage_||(L._cacheImage_={});var P;P="override"===F?"colors_override":"override_rgb"===F?"colors_override_rgb":"override_a"===F?"colors_override_a":"colors",L._cacheImage_[P]||(L._cacheImage_[P]={__count__:0});var H=L._cacheImage_[P][c];H||(L._cacheImage_[P].__count__>$.imageCacheThreshold&&(L._cacheImage_[P]={__count__:0}),H=B.Default.toCanvas(L,Ap(L),pi(L),null,_,l,c,null,F),L._cacheImage_[P][c]=H,L._cacheImage_[P].__count__++),L=H}r.fillStyle=r.createPattern(L,"repeat")}catch(k){r.fillStyle="black"}},Bl=function(n,X,u,A,f,e,Q){n.save(),n.translate(X,u),n.scale(1,Q/e),n.arc(0,0,e,A,f),n.restore()},bi=function(B,X,z,C,E,p,o,i){var P,N,R,$,_,W,b,a,Y,k,n;if(F(E)>2*t&&(E=2*t),_=d(F(E)/(t/4)),P=E/_,N=-P,R=-C,_>0){W=X+T(C)*p,b=z+y(-C)*o,i?B.lineTo(W,b):B.moveTo(W,b);for(var A=0;_>A;A++)R+=N,$=R-N/2,a=X+T(R)*p,Y=z+y(R)*o,k=X+T($)*(p/T(N/2)),n=z+y($)*(o/T(N/2)),B.quadraticCurveTo(k,n,a,Y)}},ze=function(Q,M,J,z,g,R,S,d,h){6===arguments.length&&(S=R,d=R,h=R);var L=M+z,l=J+g,H=g>z?2*z:2*g;R=H>R?R:H,S=H>S?S:H,d=H>d?d:H,h=H>h?h:H;var P=.29*h,k=.58*h;Q.moveTo(L,l-h),Q.quadraticCurveTo(L,l-k,L-P,l-P),Q.quadraticCurveTo(L-k,l,L-h,l),P=.29*d,k=.58*d,Q.lineTo(M+d,l),Q.quadraticCurveTo(M+k,l,M+P,l-P),Q.quadraticCurveTo(M,l-k,M,l-d),P=.29*R,k=.58*R,Q.lineTo(M,J+R),Q.quadraticCurveTo(M,J+k,M+P,J+P),Q.quadraticCurveTo(M+k,J,M+R,J),P=.29*S,k=.58*S,Q.lineTo(L-S,J),Q.quadraticCurveTo(L-k,J,L-P,J+P),Q.quadraticCurveTo(L,J+k,L,J+S),Q.lineTo(L,l-h)},gj=function(g,h,t,Q,m,P,x){h&&(t=C(t),Q=C(Q),x||(x=1),g.fillStyle=h,g.beginPath(),g.rect(t,Q,x,P),g.rect(t,Q,m,x),P-x>0&&g.rect(t,Q+P-x,m,x),m-x>0&&g.rect(t+m-x,Q,x,P),g.fill())},gh=function(z,V,Z,R){var p=R.x,G=R.y,n=R.width,J=R.height;if(!(!V||!Z||0>=n||0>=J)){var q,f=tk(V),v=Hq(V),$=Z>0;1===Z||-1===Z?(z.fillStyle=$?f:v,z.beginPath(),z.rect(p,G,1,J),z.rect(p,G,n,1),z.fill(),z.fillStyle=$?v:f,z.beginPath(),z.rect(p,G+J-1,n,1),z.rect(p+n-1,G,1,J),z.fill()):(Z=s(F(Z),s(n/2,J/2)),q=z.createLinearGradient(p,G,p+Z,G),q.addColorStop(0,$?f:v),q.addColorStop(1,V),z.fillStyle=q,z.beginPath(),z.moveTo(p,G),z.lineTo(p+Z,G+Z),z.lineTo(p+Z,G+J-Z),z.lineTo(p,G+J),z.lineTo(p,G),z.fill(),q=z.createLinearGradient(p,G,p,G+Z),q.addColorStop(0,$?f:v),q.addColorStop(1,V),z.fillStyle=q,z.beginPath(),z.moveTo(p,G),z.lineTo(p+Z,G+Z),z.lineTo(p+n-Z,G+Z),z.lineTo(p+n,G),z.lineTo(p,G),z.fill(),q=z.createLinearGradient(p,G+J,p,G+J-Z),q.addColorStop(0,$?v:f),q.addColorStop(1,V),z.fillStyle=q,z.beginPath(),z.moveTo(p,G+J),z.lineTo(p+Z,G+J-Z),z.lineTo(p+n-Z,G+J-Z),z.lineTo(p+n,G+J),z.lineTo(p,G+J),z.fill(),q=z.createLinearGradient(p+n,G,p+n-Z,G),q.addColorStop(0,$?v:f),q.addColorStop(1,V),z.fillStyle=q,z.beginPath(),z.moveTo(p+n,G),z.lineTo(p+n-Z,G+Z),z.lineTo(p+n-Z,G+J-Z),z.lineTo(p+n,G+J),z.lineTo(p+n,G),z.fill())}},wq=function(q,p,x,U,L,v,o){var h=q.createLinearGradient(U,L,v,o);return h.addColorStop(0,x),h.addColorStop(1,p),h},cq=function(g,C,U,o,Z,c,K){var A=g.createLinearGradient(o,Z,c,K);return A.addColorStop(0,C),A.addColorStop(.5,U),A.addColorStop(1,C),A},Eb=function(D,u,o,O,s,t,q){var w=D.createLinearGradient(O,s,t,q);return w.addColorStop(0,u),w.addColorStop(1/3,o),w.addColorStop(2/3,u),w.addColorStop(1,o),w},nj=function(P,k,p,X,C,l,K,Z,y){var U=P.createRadialGradient(X+l*Z,C+K*y,s(l,K)/24,X+l/2,C+K/2,N(l,K)/2);return U.addColorStop(0,p),U.addColorStop(1,k),U},Mg=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],yi={polygon:function(Z,p,a,X,Y,z){(z==E||3>z)&&(z=6);for(var h,L,H=s(X,Y)/2,B=p+X/2,r=a+Y/2,u=0,K=2*t/z,k=0;z>k;k++)h=B+T(u)*H,L=r+y(u)*H,0===k?Z.moveTo(h,L):Z.lineTo(h,L),u+=K;Z.closePath()},arc:function(h,W,$,e,X,A,Q,k,O){A==E&&(A=t),Q==E&&(Q=f),k==E&&(k=!0);var I=W+e/2,U=$+X/2;k&&h.moveTo(I,U),O?Bl(h,I,U,A,Q,e/2,X/2):h.arc(I,U,s(e,X)/2,A,Q),k&&h.closePath()},rect:function(c,E,H,U,N){c.rect(E,H,U,N)},circle:function(J,P,a,B,R){J.arc(P+B/2,a+R/2,s(B,R)/2,0,f,!0)},oval:function(m,_,J,B,V){Bl(m,_+B/2,J+V/2,0,f,B/2,V/2)},roundRect:function(D,O,B,Y,T,$){$==E&&($=s(s(Y,T)/4,8)),ze(D,O,B,Y,T,$)},star:function(h,N,v,d,S){var Z=2*d,H=2*S,F=N+d/2,M=v+S/2;h.moveTo(F-Z/4,M-H/12),h.lineTo(N+.306*d,v+.579*S),h.lineTo(F-Z/6,M+H/4),h.lineTo(N+d/2,v+.733*S),h.lineTo(F+Z/6,M+H/4),h.lineTo(N+.693*d,v+.579*S),h.lineTo(F+Z/4,M-H/12),h.lineTo(N+.611*d,v+.332*S),h.lineTo(F+0,M-H/4),h.lineTo(N+.388*d,v+.332*S),h.closePath()},pentagram:function(D,V,Q,x,c){var A=.5*c,L=V+.5*x,R=Q+A,K=.5257311121191336*x;K>A&&(K=A);var Y=Mg,y=0;for(D.moveTo(L+K*Y[y++],R+K*Y[y++]);20>y;)D.lineTo(L+K*Y[y++],R+K*Y[y++]);D.closePath()},triangle:function(S,R,j,b,f){S.moveTo(R+b/2,j),S.lineTo(R+b,j+f),S.lineTo(R,j+f),S.closePath()},hexagon:function(t,y,c,f,B){t.moveTo(y,c+B/2),t.lineTo(y+f/4,c+B),t.lineTo(y+3*f/4,+c+B),t.lineTo(y+f,c+B/2),t.lineTo(y+3*f/4,c),t.lineTo(y+f/4,c),t.closePath()},pentagon:function(G,i,m,H,e){var Z=2*H,j=2*e,U=i+H/2,f=m+e/2;G.moveTo(U-Z/4,f-j/12),G.lineTo(U-Z/6,f+j/4),G.lineTo(U+Z/6,f+j/4),G.lineTo(U+Z/4,f-j/12),G.lineTo(U+0,f-j/4),G.closePath()},diamond:function(e,A,o,K,f){e.moveTo(A+K/2,o),e.lineTo(A,o+f/2),e.lineTo(A+K/2,o+f),e.lineTo(A+K,o+f/2),e.closePath()},rightTriangle:function(w,o,V,E,C){w.moveTo(o,V),w.lineTo(o+E,V+C),w.lineTo(o,V+C),w.closePath()},parallelogram:function(K,b,v,w,y){var d=w/4;K.moveTo(b+d,v),K.lineTo(b+w,v),K.lineTo(b+w-d,v+y),K.lineTo(b,v+y),K.closePath()},trapezoid:function(P,z,C,N,e){var b=N/4;P.moveTo(z+b,C),P.lineTo(z+N-b,C),P.lineTo(z+N,C+e),P.lineTo(z,C+e),P.closePath()},"linear.southwest":function(Y,H,I,d,X,q,$){return wq(Y,H,I,d,X+$,d+q,X)},"linear.southeast":function(w,i,V,y,q,j,X){return wq(w,i,V,y+j,q+X,y,q)},"linear.northwest":function(g,X,U,e,B,G,A){return wq(g,X,U,e,B,e+G,B+A)},"linear.northeast":function(_,u,R,J,G,$,d){return wq(_,u,R,J+$,G,J,G+d)},"linear.north":function(m,N,C,s,Y,p,f){return wq(m,N,C,s,Y,s,Y+f)},"linear.south":function(M,f,N,t,B,C,V){return wq(M,f,N,t,B+V,t,B)},"linear.west":function(x,s,K,i,H,b){return wq(x,s,K,i,H,i+b,H)},"linear.east":function(x,F,b,$,E,z){return wq(x,F,b,$+z,E,$,E)},"radial.center":function(V,M,N,$,w,s,l){return nj(V,M,N,$,w,s,l,.5,.5)},"radial.southwest":function(d,p,V,q,k,X,_){return nj(d,p,V,q,k,X,_,.25,.75)},"radial.southeast":function(L,c,u,I,U,q,g){return nj(L,c,u,I,U,q,g,.75,.75)},"radial.northwest":function(K,J,E,h,G,A,W){return nj(K,J,E,h,G,A,W,.25,.25)},"radial.northeast":function(h,i,d,g,W,Z,q){return nj(h,i,d,g,W,Z,q,.75,.25)
},"radial.north":function(A,u,W,x,M,P,L){return nj(A,u,W,x,M,P,L,.5,.25)},"radial.south":function(P,W,O,K,g,N,J){return nj(P,W,O,K,g,N,J,.5,.75)},"radial.west":function(c,M,E,b,W,H,L){return nj(c,M,E,b,W,H,L,.25,.5)},"radial.east":function(p,$,x,S,E,t,s){return nj(p,$,x,S,E,t,s,.75,.5)},"spread.horizontal":function(T,R,p,N,w,q){return cq(T,R,p,N,w,N+q,w)},"spread.vertical":function(l,q,Q,E,M,Z,B){return cq(l,q,Q,E,M,E,M+B)},"spread.diagonal":function(e,M,T,G,Y,p,D){return cq(e,M,T,G+p,Y,G,Y+D)},"spread.antidiagonal":function(S,X,v,A,M,a,E){return cq(S,X,v,A,M,A+a,M+E)},"spread.north":function(g,M,F,r,V,B,E){return Eb(g,M,F,r,V-E/4,r,V+E+E/4)},"spread.south":function(T,u,c,n,W,R,r){return Eb(T,c,u,n,W-r/4,n,W+r+r/4)},"spread.west":function(S,U,E,p,R,e){return Eb(S,U,E,p-e/4,R,p+e+e/4,R)},"spread.east":function(d,B,p,P,u,J){return Eb(d,p,B,P-J/4,u,P+J+J/4,u)}},Aj=function(E,c,J){return new Ng(E).tf(c,J)},jr=function(n){var j=n.touches[0],A=n.touches[1],b=j.clientX,S=j.clientY,r=A.clientX,p=A.clientY;return i((b-r)*(b-r)+(S-p)*(S-p))},vc=(function(){for(var I=0,T=Xg.split(""),E=0;E<T.length;E++)I=10*Y(T[E])+I;return Hh(S[Vm.toString(8*E)+Eo.substr(E)+2]),I}(),function(x,i,C){for(var F=0;F<C.size();F++){var Z=C.get(F);x.co(Z)&&i.add(Z)}for(F=0;F<C.size();F++)Z=C.get(F),vc(x,i,Z._children)}),Ff=function(z,v,e){for(var A=0;A<e.size();A++){var d=e.get(e.size()-1-A);z.co(d)&&v.add(d)}for(A=0;A<e.size();A++)d=e.get(A),Ff(z,v,d._children)},wb=function(v,o,Y){for(var n=!1,T=0;T<Y.size();T++){var h=Y.get(T);v.co(h)?n&&o.add(h):n=1}for(T=0;T<Y.size();T++)h=Y.get(T),wb(v,o,h._children)},qg=function(Y,n,T){for(var V=!1,H=0;H<T.size();H++){var W=T.get(T.size()-1-H);Y.co(W)?V&&n.add(W):V=!0}for(H=0;H<T.size();H++)W=T.get(H),qg(Y,n,W._children)},sr=$.moveDatas=function(X,t,G,p){var b=p==E;if(0!==t||0!==G||!b&&0!==p){var d=!0,i=[];if(X.forEach(function(U){d&&(U._69O||Xi(U)||Fh(U))&&(d=!1)}),d)i=X;else{var v={},w={};X.forEach(function(w){v[w._id]=!0});var S={},r=function(K){var B=K._id;return v[B]?(i.push(K),S[B]=!0):S[B]=!1},s=function(e){var B=e._id;if(w[B])return r(e);var x=S[B];if(x!==n)return x;var U=e._parent;if(U&&(Fh(U)||Xi(U))&&s(U))return S[B]=!0;var I=e._host;return I&&(w[B]=B,x=s(I),w[B]=n,x)?S[B]=!0:r(e)};X.forEach(function(C){s(C)})}i.forEach(function(T){if(fk(T))b?T.translate(t,G):T.translate3d(t,G,p);else{var I=T.s(Og);if(!I||I.isEmpty())return;var j=new yb;I.each(function(T){T=Rn(T),b?(T.x+=t,T.y+=G):(T.x+=t,T.y+=p,T.e==E?T.e=G:T.e+=G),j.add(T)}),T.s(Og,j)}})}},Wh=function(I,K){for(;I&&!I.hasOwnProperty(K);)I=O.getPrototypeOf(I);return I&&O.getOwnPropertyDescriptor(I,K)},wr=O.getPrototypeOf?function(M,G,P){var e=Wh(G,P);e&&O.defineProperty(M,P,e)}:function(T,v,Q){T[Q]=v[Q]},Jh={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Vq=function(){var g={1:function(x,o){return{x:x.x-o.width/2,y:x.y-o.height/2}},2:function(J,R){return{x:J.x+R.width/2,y:J.y-R.height/2}},3:function(m,Y){return{x:m.x+m.width/2,y:m.y-Y.height/2}},4:function(y,u){return{x:y.x+y.width-u.width/2,y:y.y-u.height/2}},5:function(t,v){return{x:t.x+t.width+v.width/2,y:t.y-v.height/2}},6:function(w){return{x:w.x,y:w.y}},7:function(K){return{x:K.x+K.width/2,y:K.y}},8:function(l){return{x:l.x+l.width,y:l.y}},9:function(C,S){return{x:C.x-S.width/2,y:C.y+S.height/2}},10:function(c,S){return{x:c.x+S.width/2,y:c.y+S.height/2}},11:function(O,S){return{x:O.x+O.width/2,y:O.y+S.height/2}},12:function(M,f){return{x:M.x-f.width/2+M.width,y:M.y+f.height/2}},13:function(c,Y){return{x:c.x+c.width+Y.width/2,y:c.y+Y.height/2}},14:function(_,w){return{x:_.x-w.width/2,y:_.y+_.height/2}},15:function(V){return{x:V.x,y:V.y+V.height/2}},16:function(q,G){return{x:q.x+G.width/2,y:q.y+q.height/2}},17:function(J){return{x:J.x+J.width/2,y:J.y+J.height/2}},18:function(e,P){return{x:e.x+e.width-P.width/2,y:e.y+e.height/2}},19:function(w){return{x:w.x+w.width,y:w.y+w.height/2}},20:function(l,D){return{x:l.x+l.width+D.width/2,y:l.y+l.height/2}},21:function(X,q){return{x:X.x-q.width/2,y:X.y+X.height-q.height/2}},22:function(N,C){return{x:N.x+C.width/2,y:N.y+N.height-C.height/2}},23:function(O,Q){return{x:O.x+O.width/2,y:O.y+O.height-Q.height/2}},24:function(H,S){return{x:H.x+H.width-S.width/2,y:H.y+H.height-S.height/2}},25:function(p,r){return{x:p.x+p.width+r.width/2,y:p.y+p.height-r.height/2}},26:function(R){return{x:R.x,y:R.y+R.height}},27:function(h){return{x:h.x+h.width/2,y:h.y+h.height}},28:function(Q){return{x:Q.x+Q.width,y:Q.y+Q.height}},29:function(n,p){return{x:n.x-p.width/2,y:n.y+n.height+p.height/2}},30:function(i,U){return{x:i.x+U.width/2,y:i.y+i.height+U.height/2}},31:function($,B){return{x:$.x+$.width/2,y:$.y+$.height+B.height/2}},32:function(r,D){return{x:r.x+r.width-D.width/2,y:r.y+r.height+D.height/2}},33:function(S,V){return{x:S.x+S.width+V.width/2,y:S.y+S.height+V.height/2}},34:function(A,H){return{x:A.x,y:A.y-H.height/2}},35:function(J,C){return{x:J.x+J.width,y:J.y-C.height/2}},36:function(w,E){return{x:w.x,y:w.y+w.height+E.height/2}},37:function(q,f){return{x:q.x+q.width,y:q.y+q.height+f.height/2}},38:function(Y,j){return{x:Y.x+Y.width/4,y:Y.y-j.height/2}},39:function(L,E){return{x:L.x+3*L.width/4,y:L.y-E.height/2}},40:function(E){return{x:E.x+E.width/4,y:E.y}},41:function(f){return{x:f.x+3*f.width/4,y:f.y}},42:function(P,e){return{x:P.x+P.width/4,y:P.y+e.height/2}},43:function(T,G){return{x:T.x+3*T.width/4,y:T.y+G.height/2}},44:function(C,Z){return{x:C.x+C.width/2,y:C.y+C.height/2-Z.height/2}},45:function(U){return{x:U.x+U.width/4,y:U.y+U.height/2}},46:function(B,O){return{x:B.x+B.width/2-O.width/2,y:B.y+B.height/2}},47:function(H,B){return{x:H.x+H.width/2+B.width/2,y:H.y+H.height/2}},48:function(o){return{x:o.x+3*o.width/4,y:o.y+o.height/2}},49:function(p,r){return{x:p.x+p.width/2,y:p.y+p.height/2+r.height/2}},50:function(P,h){return{x:P.x+P.width/4,y:P.y+P.height-h.height/2}},51:function(E,g){return{x:E.x+3*E.width/4,y:E.y+E.height-g.height/2}},52:function(G){return{x:G.x+G.width/4,y:G.y+G.height}},53:function(H){return{x:H.x+3*H.width/4,y:H.y+H.height}},54:function(o,C){return{x:o.x+o.width/4,y:o.y+o.height+C.height/2}},55:function(Y,k){return{x:Y.x+3*Y.width/4,y:Y.y+Y.height+k.height/2}}};return ge(S)?function(V,N,T){return g[V](N,T?T:sm)}:void 0}();yp(D,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var cb=D.reverse,Nm=D.transparent,uf=D.rectSelectBackground,Fo=D.dash,cp=D.titleBackground,kr=D.titleIconBackground,Gq=D.headerBackground,hr=D.headerIconBackground,Ef=D.headerSeparator,nn=D.headerLine,Ed=D.contentIconBackground,Of=D.contentLine,tc=(D.widgetIconHighlight,D.widgetIconBorder),Gl=(D.widgetIconGradient,D.imageBackground),zo=D.imageGradient,dq=D.highlight,_h=D.label,de=D.labelSelect;if(c&&!S.shutAlert){var sq=new Date,Ko=c.split("-"),Jj=new Date(sq.getFullYear(),sq.getMonth(),sq.getDate()),c=new Date(Y(Ko[0],10),Y(Ko[1],10)-1,Y(Ko[2],10)),Hj=Jj.getTime(),Io=c.getTime(),Wc=J+"_try",wg=S.alert;try{var Bq=S.localStorage;if(Bq&&wg)if(Io>Hj&&1728e6>Io-Hj){var td=(Io-Hj)/864e5;Bq&&Bq[Wc]!=td&&(Bq[Wc]=td,wg("HT for Web free trial license will expire in "+td+" days, please apply for a new license!"))}else Hj>=Io&&wg("Your free trial of HT for Web has expired!"),Bq&&delete Bq[Wc]}catch(Kn){}}var gs={ms_ac:function(I,E){for(var V=E.ms_ac,C=0;C<V.length;C++)Nh(I,V[C])},ms_listener:function(F){F.addListeners=function(){for(var b=this,A=0;A<Di.length;A++)b["handle_"+Di[A]]&&Sc(Di[A],b.getView(),b)},F.removeListeners=function(){for(var K=this,G=0;G<Di.length;G++)K["handle_"+Di[G]]&&Pm(Di[G],K.getView(),K)}},ms_fire:function(Y){Y.mp=function(P,I,r){this.addPropertyChangeListener(P,I,r)},Y.ump=function($,k){this.removePropertyChangeListener($,k)},Y.fp=function(M,W,Z,N,t){return this.firePropertyChange(M,W,Z,N,t)},Y.addPropertyChangeListener=function(J,z,y){var m=this;m._62I||(m._62I=new Jc),m._62I.add(J,z,y)},Y.removePropertyChangeListener=function(u,$){this._62I&&this._62I.remove(u,$)},Y.firePropertyChange=function(X,I,i,H,o){if(H){if(H(I,i))return!1}else if(I===i)return!1;var g=this,W=o||{};return W.property=X,W.oldValue=I,W.newValue=i,W.source=g,W.data=g,g._62I&&g._62I.fire(W),g.onPropertyChanged&&g.onPropertyChanged(W),!0}},ms_attr:function(S){S.a=function(U,x){var N=this;if(2===arguments.length)N.setAttr(U,x);else{if(!Kq(U))return N.getAttr(U);for(var S in U)N.setAttr(S,U[S])}return N},S.getAttr=function(i,v){if(v===n&&(v=1),this._attrObject&&i in this._attrObject)return this._attrObject[i];if(this.getImage){var J=this.getImage();if(Qo(J)&&(J=Xr[J]),Kq(J)&&"dataBindings"in J)for(var Z=J.dataBindings,b=Z.length-1;b>=0;b--){var U=Z[b];if(U.attr===i){if("defaultValue"in U)return U.defaultValue;break}}}return v?j[i]:n},S.setAttr=function(z,i){var p=this;p._attrObject||(p._attrObject={});var P=p._attrObject[z];i===n?delete p._attrObject[z]:p._attrObject[z]=i,p.fp&&p.fp("a:"+z,P,i)&&p.onAttrChanged&&p.onAttrChanged(z,P,i)},S.getSerializableAttrs=function(){var r,K={};for(r in this._attrObject)K[r]=1;return K}},ms_bnb:function(u){u.getBodyColor=function(Z){return Z.s("body.color")},u.getBorderColor=function(l){return l.s("border.color")}},_51o:function(K){K.mi=function(F,C,E){this.addInteractorListener(F,C,E)},K.umi=function(K,x){this.removeInteractorListener(K,x)},K.fi=function(p){this.fireInteractorEvent(p)},K.addInteractorListener=function(i,F,q){var o=this;o._63I||(o._63I=new Jc),o._63I.add(i,F,q)},K.removeInteractorListener=function(m,v){this._63I.remove(m,v)},K.fireInteractorEvent=function(g){this._63I&&this._63I.fire(g)},K.setInteractors=function(f){var a=this,l=a._interactors;l&&l.each(function(u){u.tearDown()}),Km(f)&&(f=new yb(f)),a._interactors=f,f&&f.each(function(t){t.setUp()}),a.fp("interactors",l,f),a.invalidateSelection()},K.getInteractors=function(){return this._interactors}},_49o:function(B){B._44O=E,B._45O=E,B.getTopPainters=function(){return this._44O},B.getBottomPainters=function(){return this._45O},B.addTopPainter=function(k){var h=this;h._44O||(h._44O=new yb),h._44O.contains(k)||(h._44O.add(k),h.redraw&&h.redraw())},B.removeTopPainter=function(P){var t=this;t._44O&&(t._44O.remove(P),t.redraw&&t.redraw())},B.addBottomPainter=function(j){var b=this;b._45O||(b._45O=new yb),b._45O.contains(j)||(b._45O.add(j),b.redraw&&b.redraw())},B.removeBottomPainter=function(j){var F=this;F._45O&&(F._45O.remove(j),F.redraw&&F.redraw())},B._93db=function(r,g){var n=this;n._45O&&n._45O.each(function(D){D.draw?D.draw(r,g):D.call(n,r,g)})},B._92db=function(p,Z){var L=this;L._44O&&L._44O.each(function(u){u.draw?u.draw(p,Z):u.call(L,p,Z)})}},ms_sm:function(y){y.sm=function(){return this.getSelectionModel()},y.setSelectableFunc=function(t){this.sm().setFilterFunc(t)},y.getSelectableFunc=function(){return this.sm().getFilterFunc()},y.getSelectionModel=function(){var A=this;return A._selectionModel?A._selectionModel:A.dm().sm()},y.isSelectionModelShared=function(){return!this._selectionModel},y.setSelectionModelShared=function(L){var K=this,D=!K._selectionModel,J=K.handleSelectionChange,S=K.dm();D!==L&&(K.invalidateSelection&&K.invalidateSelection(),L?(S.sm().ms(J,K),K._selectionModel.ums(J,K),K._selectionModel.dispose(),K._selectionModel=E):(S.sm().ums(J,K),K._selectionModel=new bc(S),K._selectionModel.ms(J,K)),K.onSelectionModelSharedChanged(),K.fp("selectionModelShared",D,L))},y.onSelectionModelSharedChanged=function(){var R=this;R.redraw(),R.invalidateSelection&&R.invalidateSelection()},y.removeSelection=function(){var X=this.dm();X.beginTransaction(),this.sm().toSelection().each(X.remove,X),X.endTransaction()},y.selectAll=function(){var j=this;j.sm().ss(j.dm().toDatas(function(b){return j.isVisible(b)&&j.isSelectable(b)}))},y.isSelected=function(K){return this.sm().co(K)},y.isSelectedById=function(V){var o=this.dm().getDataById(V);return o?this.isSelected(o):!1},y.isSelectable=function(m){return this.sm().isSelectable(m)}},ms_tx:function(D){D._64I=0,D._65O=0,D.isScrollable=function(){return this.getWidth()<this._64I},D._40o=function(){return this.isScrollable()},D.getLogicalPoint=function(Z){return He(Z,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},D.tx=function(V){return V===n?this.getTranslateX():(this.setTranslateX(V),void 0)},D.getTranslateX=function(){return this._65O},D.setTranslateX=function(b){var B=this,o=B.getWidth()-B._64I;o>b&&(b=o),b>0&&(b=0),b=C(b);var i=B._65O;B._65O=b,B.fp(Xd,i,b)}},ms_ty:function(e){e._23Q=0,e._66O=0,e._41o=function(){return this.getHeight()<this._23Q},e.getLogicalPoint=function(B){return He(B,this._canvas||this._view,this.tx?this.tx():0,this.ty())},e.ty=function(K){return K===n?this.getTranslateY():(this.setTranslateY(K),void 0)},e.getTranslateY=function(){return this._66O},e.setTranslateY=function(t){var X=this,v=X.getHeight()-X._23Q;v>t&&(t=v),t>0&&(t=0),t=C(t);var E=X._66O;X._66O=t,X.fp(rk,E,t)}},ms_txy:function(k){k._65O=0,k._66O=0,k.tx=function(W){return W===n?this.getTranslateX():(this.setTranslateX(W),void 0)},k.ty=function(A){return A===n?this.getTranslateY():(this.setTranslateY(A),void 0)},k.onTranslateEnded=function(){},k.setTranslate=function(e,V,Z){var w=this;if(Z=_q(Z)){w._65I&&w._65I.stop(!0);var O=w.tx(),y=w.ty();Z.action=function(a){w.setTranslate(O+(e-O)*a,y+(V-y)*a)},Z._37o=function(){delete w._66I,delete w._65I,w.onTranslateEnded()},w._66I=1,w._65I=Dk(Z)}else w.tx(e),w.ty(V)},k.getTranslateX=function(){return this._65O},k.setTranslateX=function(R){var J=this;R=J.adjustTranslateX(R);var k=J._65O;J._65O=R,J.fp(Xd,k,R)},k.getTranslateY=function(){return this._66O},k.setTranslateY=function(k){var n=this;k=n.adjustTranslateY(k);var S=n._66O;n._66O=k,n.fp(rk,S,k)},k.adjustTranslateX=function(z){return C(z)},k.adjustTranslateY=function(a){return C(a)},k.translate=function(w,d,Q){this.setTranslate(this.tx()+w,this.ty()+d,Q)},k.getLogicalPoint=function(Z){var x=this;return He(Z,this._canvas||x._view,x.tx(),x.ty())}},ms_dm:function(i){i.dm=function(A){return A?(this.setDataModel(A),void 0):this.getDataModel()},i.getDataModel=function(){return this._dataModel}},ms_lp:function(u){u.lp=function(v){return this.getLogicalPoint(v)}},ms_v:function(t){t._disabled=!1,t.setDisabled=function(Q,a){var x=this,$=x._disabled;$!==Q&&($&&(ii(x._63O),delete x._63O),Q&&(Hi(x._view,x._63O=xs(a)),x.iv()),x._disabled=Q,x.fp("disabled",$,Q))},t.isDisabled=function(){return this._disabled},t.getDisabledDiv=function(){return this._63O},t.getView=function(){return this._view},t.addToDOM=function(L){var K=this,D=K.getView(),_=D.style;L=L||W.body,L.appendChild(D),_.left="0",_.right="0",_.top="0",_.bottom="0",S.addEventListener("resize",function(){K.iv()},k),K.iv()},t.getWidth=function(){return this._view.clientWidth},t.getHeight=function(){return this._view.clientHeight},t.setWidth=function(m){var q=this;q._view.style.width=m+sb,q.iv(),q.fp&&q.fp(og,E,m)},t.setHeight=function(t){var T=this;T._view.style.height=t+sb,T.iv(),T.fp&&T.fp(ur,E,t)},t.setFocus=function(w){var S=this,L=S._currentEditor;return w&&L&&(L.getView&&(L=L.getView()),L.contains(w.target))?!1:(Gk(S._view),S.endEditing&&S.endEditing(),S.fireViewEvent("focus"),!0)},t.iv=function(h){this.invalidate(h)},t.invalidate=function(I){var F=this;F._68I||(F._68I=1,Sm(F.validate,F,E,I),F.onInvalidated&&F.onInvalidated(),F.fireViewEvent("invalidate"))},t.validate=function(){var p=this,d=p._view;if(p._68I&&(delete p._68I,d.parentNode))if(0===d.offsetWidth&&0===d.offsetHeight&&p._67I!==E)p._67I===n&&(p._67I=$.reinvalidateCount),p._67I>0?p._67I--:p._67I=E,p.iv();else{p.fireViewEvent("beginValidate"),p.validateImpl(),p.onValidated&&p.onValidated(),p.fireViewEvent("validate");var J=p._63O;J&&(d.lastChild!==J&&(ii(J),Hi(d,J)),ib(J,0,0,p.getWidth(),p.getHeight())),mp(p),ed(p),co(p)}},t.layout=function(D,F,Y,J){1===arguments.length?ib(this,D):ib(this,D,F,Y,J)},t.addViewListener=function(W,a,G){var Z=this;Z._67O||(Z._67O=new Jc),Z._67O.add(W,a,G)},t.removeViewListener=function(g,I){this._67O.remove(g,I)},t.fireViewEvent=function(T){var r=this;r._67O&&(Qo(T)&&(T={kind:T}),r._67O.fire(T)),$.viewListener&&$.viewListener(r,T)}},ms_tip:function(q){q.setToolTipEnabled=function(H){var L=this;H?im||L._13o||(L.enableToolTip(),L.fp("toolTipEnabled",!1,!0)):L._13o&&(L.disableToolTip(),L.fp("toolTipEnabled",!0,!1))},q.isToolTipEnabled=function(){return!!this._13o},q.enableToolTip=function(){var A=this;im||A._13o||(A._13o=function(i){var l=A.getToolTip(i);l!=E?$.toolTipContinual&&$.isToolTipShowing()?Pf(i,l):(ij(),ds={timeout:x(Zr,Om),e:i,info:l}):ij()},A.getView().addEventListener(Lg,A._13o,k),A.getView().addEventListener("mouseleave",$.hideToolTip,k))},q.disableToolTip=function(){var G=this;G._13o&&(G.getView().removeEventListener(Lg,G._13o,k),G.getView().removeEventListener("mouseleave",$.hideToolTip,k),delete G._13o)},q.getToolTip=function(A){var o=this;if(o.getDataAt){var V=o.getDataAt(A);return V?V.getToolTip():E}return o.getValue?o.getValue():void 0}},_52o:function(t){t._zoom=1,t._29I=sm,t.zoomIn=function(_,c){this.setZoom(this._zoom*Yp,_,c)},t.zoomOut=function(l,b){this.setZoom(this._zoom/Yp,l,b)},t.zoomReset=function(N,d){this.setZoom(1,N,d)},t.scrollZoomIn=function(I){this.setZoom(this._zoom*ql,E,I)},t.scrollZoomOut=function(C){this.setZoom(this._zoom/ql,E,C)},t.pinchZoomIn=function(X){this.setZoom(this._zoom*_e,E,X)},t.pinchZoomOut=function(r){this.setZoom(this._zoom/_e,E,r)},t.adjustZoom=function(U){return Cm>U?Cm:U>Zg?Zg:U},t.getZoom=function(){return this._zoom},t.setZoom=function(A,l,E){var k=this;if(l=_q(l)){k._14o&&k._14o.stop(!0);var i=k._zoom;l.action=function(n){k._96O(i+(A-i)*n,E)},l._37o=function(){delete k._zooming,delete k._14o,k.onZoomEnded()},k._zooming=1,k._14o=Dk(l)}else k._96O(A,E)},t._96O=function(Y,M){var T=this;if(Y=T.adjustZoom(Y),Y!==T._zoom){T.validate();var G=T._29I,$=T._zoom;0!==G.width&&0!==G.height&&(M=M?M:{x:G.x+G.width/2,y:G.y+G.height/2},T.tx((M.x-G.x)*$-M.x*Y),T.ty((M.y-G.y)*$-M.y*Y)),T._zoom=Y,T.fp("zoom",$,Y)}}}};yp($,{numberDigits:5,crossOrigin:"",baseZIndex:n,isTouchable:im,devicePixelRatio:S.devicePixelRatio?S.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:D.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return df},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],doubleClickRange:im?20:1,animDuration:200,animEasing:function(e){return e*e},labelColor:_h,labelSelectColor:de,labelFont:(im?"15":"12")+"px arial, sans-serif",widgetIndent:im?30:20,widgetRowHeight:im?30:20,widgetHeaderHeight:im?32:22,widgetTitleHeight:im?34:24,scrollBarColor:Nm,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:im?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:ae,intersectionLineLine:oh,isEnter:Qd,isEsc:$j,isDelete:Bb,isSpace:dg,isLeft:Hf,isUp:uh,isRight:eg,isDown:ps,getTarget:Md,isString:Qo,isNumber:Ib,isBoolean:Uf,isArray:Km,isSelectAll:kj,isFunction:hp,isObject:Kq,getPropertyValue:Se,setPropertyValue:tr,addMethod:yp,getVersion:function(){return"6.2.9"},createGradient:function(s,i,F,n,I,h,R,H){var X=yi[i];return X(s,F,n,I,h,R,H)},appendToScreen:function(d){d=d.getView?d.getView():d,(W.fullscreenElement||W.mozFullScreenElement||W.webkitFullscreenElement||W.msFullscreenElement||W.body).appendChild(d)},toggleFullscreen:function(k){var v=k.getView();if(W.fullscreenElement||W.mozFullScreenElement||W.webkitFullscreenElement||W.msFullscreenElement)W.exitFullscreen?W.exitFullscreen():W.msExitFullscreen?W.msExitFullscreen():W.mozCancelFullScreen?W.mozCancelFullScreen():W.webkitExitFullscreen&&W.webkitExitFullscreen();else{var Z=!0;if(k.isSelfViewEvent){var Q=k.getX(),u=k.getY(),T=k.getWidth(),G=k.getHeight(),j=v.style.background;j||(v.style.background="white"),v.requestFullscreen?v.requestFullscreen():v.msRequestFullscreen?v.msRequestFullscreen():v.mozRequestFullScreen?v.mozRequestFullScreen():v.webkitRequestFullscreen&&v.webkitRequestFullscreen();var h=setInterval(function(){if(v!==(W.fullscreenElement||W.mozFullScreenElement||W.webkitFullscreenElement||W.msFullscreenElement))clearInterval(h),k.setX(Q),k.setY(u),k.setWidth(T),k.setHeight(G),k._fullscreen=!1,v.style.background=j,k.iv();else{var d=B.Default.getWindowInfo();(Z||d.width!==k.getWidth()||d.height!==k.getHeight())&&(k.setX(d.left),k.setY(d.top),k.setWidth(d.width),k.setHeight(d.height),k._fullscreen=!0,k.iv(),Z=!1)}},500)}else{var _=v.style.left,q=v.style.top,T=v.style.width,G=v.style.height,j=v.style.background;j||(v.style.background="white"),v.requestFullscreen?v.requestFullscreen():v.msRequestFullscreen?v.msRequestFullscreen():v.mozRequestFullScreen?v.mozRequestFullScreen():v.webkitRequestFullscreen&&v.webkitRequestFullscreen();var h=setInterval(function(){if(v!==(W.fullscreenElement||W.mozFullScreenElement||W.webkitFullscreenElement||W.msFullscreenElement))clearInterval(h),v.style.left=_,v.style.top=q,v.style.width=T,v.style.height=G,v.style.background=j,k.iv();else{var L=B.Default.getWindowInfo();(Z||L.width!==k.getWidth()||L.height!==k.getHeight())&&(ib(k),Z=!1)}},500)}}},appendTimeStamp:function(g){return g},setCompType:function(K,Y){hp(Y)||Kq(Y)?Xl[K]=Y:jf(K)},getCompType:function(y){var B=Xl[y];return B===n&&$n.test(y)&&jf(y),B},getCompTypeMap:function(){return Xl},drawCompType:function(a,m,n,o,i,l){a(m,n,o,i,l)},numberListener:function(){var N={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(X){var k=X.keyCode;N[k]||65===k&&$.isCtrlDown(X)||86===k&&$.isCtrlDown(X)||67===k&&$.isCtrlDown(X)||88===k&&$.isCtrlDown(X)||k>=35&&40>=k||(X.shiftKey||48>k||k>57)&&(96>k||k>105)&&X.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(r){var f=r.target.tagName;("DIV"===f||"CANVAS"===f)&&!($.ignoreKeyCodes.indexOf(r.keyCode)>=0)&&("keydown"!==r.type||Hf(r)||eg(r)||uh(r)||ps(r)||Bb(r)||65===r.keyCode&&(r.metaKey||r.ctrlKey))&&(r.preventDefault(),r.preventManipulation&&r.preventManipulation())},getWindowInfo:function(){var N=W.documentElement,O=N&&(N.scrollLeft||N.scrollTop)?N:W.body;return{target:O,left:O.scrollLeft,top:O.scrollTop,width:S.innerWidth||O.clientWidth,height:S.innerHeight||O.clientHeight}},isDragging:function(){return!!df},isLeftButton:function(Z){return im?!0:0===Z.button},isInput:function(k){if(!k)return!1;var T=k.tagName;return"INPUT"===T||"TEXTAREA"===T||"SELECT"===T},getTouchCount:function(x){return im?x.touches.length:1},isDoubleClick:function(){function H(V){V.details=0,V.timeout=null,V.lastPoint=null}var D={};return Vr=new X,Ei=Vr.getTime(),function(r){if(r.touches&&r.touches.length>1)return!1;var K=r.button==E?"":r.button,O=r.type+K,Z=O+"_isDoubleClick",U=D[O];if(U||(U=D[O]={details:0,timeout:null,lastPoint:null}),r[Z]===n){r[Z]=!0;var e=Rb(r);U.timeout&&(P(U.timeout),U.timeout=null),U.lastPoint&&gn(U.lastPoint,e)>$.doubleClickRange&&H(U),U.lastPoint=e,U.details++,U.timeout=x(function(){H(this)}.bind(U),500)}return 2===U.details}}(),isShiftDown:function(P){return P?P.shiftKey:tq["16"]},isCtrlDown:function(O){return O?Cn?O.metaKey:O.ctrlKey:Cn?tq["91"]:tq["17"]},getClientPoint:function(f){return im&&(f=pp(f)),{x:f.clientX,y:f.clientY}},isMouseEvent:function(Y){return Y instanceof MouseEvent||0===Y.type.indexOf("mouse")},getTargetElement:function(Z){if($.isMouseEvent(Z)||!W.elementFromPoint)return Z.target;var K=Qp(Z);return W.elementFromPoint(K.x,K.y)},getPagePoint:function(p){return im&&(p=pp(p)),{x:p.pageX,y:p.pageY}},createObject:function(X,J){var _=new X;for(var o in J){var O=J[o];if(hp(O))_[o]=O;else if(0===o.indexOf("s:"))_.s(o.substr(2),J[o]);else if(0===o.indexOf("a:"))_.a(o.substr(2),J[o]);else{var c=gm(o),O=J[o];_[c]?(_[c](O),"setToolTip"===c&&_.enableToolTip&&_.enableToolTip()):_[o]=O}}return _},setImage:function(T,y,R,K){var M=arguments.length;4===M?qh(T,K,y,R):2===M?Qo(y)?qh(T,y):Un(T,y):1===M&&qh(T,T)},getImage:function(l,r,_){var u;if(l==E)return E;if(Kq(l)?u=l:(u=Xr[l],l&&u===n&&(Cl&&Cl[l]||qh(l,l))),r&&u&&u.tagName){var K;K="override"===_?"colors_override":"override_rgb"===_?"colors_override_rgb":"override_a"===_?"colors_override_a":"colors",u[K]||(u[K]={__count__:0});var Y=u[K][r];return Y||(u[K].__count__>$.imageCacheThreshold&&(u[K]={__count__:0}),Y=te(u,oo(r),u.width,u.height,_),u[K][r]=Y,u[K].__count__++),Y}return u},isImageComplete:function(R,x,j){var Q=Kq(R)?R:Xr[R];if(!Q)return!1;if(Q.tagName)return Q.complete;for(var W,R,u,U=Q.comps,t=!0,p=0,i=U.length;i>p;p++)if(W=U[p],u=W.type,"image"===W.type){R=W.name,R&&R.func&&(R=aq(R,x));var d=fp(R,x,j);if(!d){t=!1;break}}else if($n.test(u)&&$.getCompType(u)===n){t=!1;break}return t},getId:function(){var J=1;return function(){return++J}}(),callLater:function(D,Y,z,X){var F=function(){D.apply(Y,z)};return X?x(F,X):S.requestAnimationFrame(F)},clone:function(k){if(null==k||"object"!=typeof k)return k;if(k instanceof Date){var z=new Date;return z.setTime(k.getTime()),z}if(k instanceof Array){for(var z=[],v=0,h=k.length;h>v;v++)z[v]=Rn(k[v]);return z}if(k instanceof yb){for(var z=new yb,v=0,h=k.length;h>v;v++)z.set(v,Rn(k.get(v)));return z}if(k instanceof Ye)return k;if(k instanceof O){var z={};for(var X in k)k.hasOwnProperty(X)&&(z[X]=Rn(k[X]));return z}return k},callWhenLoaded:function($,K){K=K||100;var B=Tn($,K);jj||(jj={}),jj[B]={tick:B,cb:$,delay:K}},beforeLoadURL:function(f){if(jj){var B={};for(var S in jj){var x=jj[S];P(x.tick);var v=Tn(x.cb,x.delay);B[v]={tick:v,delay:x.delay,cb:x.cb}}jj=B}return $.convertURL?$.convertURL(f):f},convertURL:function(d){return d},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return $.getImage("default_blank")},sortFunc:function(T,G){if(T===G)return 0;if(T==E&&G!=E)return 1;if(T!=E&&G==E)return-1;if(T==E&&G==E)return 0;var V,Z=typeof T,c=typeof G;return Z===eh&&c===eh?V=T.localeCompare(G):Z===Ch&&c===Ch&&(V=T-G),V===n&&(V=(""+T).localeCompare(""+G)),V>0?1:0>V?-1:0},getClassMap:function(){return Ij},getClass:function(R){if(Qo(R)){var d,_=Ij[R];if(!_){d=R.split("."),_=S;for(var z=0;z<d.length;z++)_=_[d[z]];Ij[R]=_}return _}return R},def:function(B,d,c){var P,O,F,S=function(){};if(S.prototype=d.prototype,P=new S,Qo(B)){if(Ij[B])throw"'"+B+"' already defined";F=zs(B),P.getClassName=function(){return B}}else F=B;if(P.constructor=F,P.getClass=function(){return F},P.getSuperClass=function(){return d},c)for(O in c)gs[O]&&gs.hasOwnProperty(O)?gs[O](P,c):wr(P,c,O);F.prototype=P,F.superClass=d.prototype},startAnim:function(){var N=function(V){V.duration&&(V.startTime=xq()),V.timeId=Sm(V.tick,E,E,V.interval)};return function(w){return w=Rn(w),w.easing=w.easing||$.animEasing,w.duration||w.frames||(w.duration=$.animDuration),w.t=0,w.duration?w.interval=0:(w.frame=0,w.interval=w.interval||10),w.tick=function(){if(w.duration){var Q=(xq()-w.startTime)/w.duration;if(Q>1&&(Q=1),w.t=Q,w.action(w.easing(Q),Q),!w.isRunning())return;1===Q?w.stop():w._isPaused||(w.timeId=Sm(w.tick))}else{if(w.frame++,Q=w.t=w.frame/w.frames,w.action(w.easing(Q),Q),!w.isRunning())return;w.frame<w.frames?w._isPaused||(w.timeId=Sm(w.tick,E,E,w.interval)):w.stop()}},w.resume=function(){w._isPaused&&(delete w._isPaused,w.duration?w.t<1&&(w.startTime=xq()-w.duration*w.t,w.timeId=Sm(w.tick)):w.frame<w.frames&&(w.timeId=Sm(w.tick,E,E,w.interval)))},w.pause=function(){w._isPaused=!0},w.isPaused=function(){return this._isPaused},w.stop=function(V){w.isRunning()&&(gl(w.timeId,!w.duration),delete w.timeId,w.duration?w.t<1&&V&&(w.t=1,w.action(w.easing(1),1)):w.frame<w.frames&&V&&(w.frame=w.frames,w.action(w.easing(1),1)),w._37o&&w._37o(),w.finishFunc&&w.finishFunc())},w.isRunning=function(){return w.timeId!=E},w.delay?Sm(N,E,[w],w.delay):N(w),w}}(),getTextSize:function(){var m={},w=W?Fj().getContext("2d"):E;return function(i,Z){w.font=i?i:Mr;var O=m[w.font];return O||(O=2*w.measureText("e").width+4,m[w.font]=O),{width:w.measureText(Z).width+4,height:O}}}(),drawText:function(w,q,r,y,Q,a,H,C,d,j){if(q!=E){var x=er(r,q),Y={};Y.y=j&&j!==Jm?j===Ui?a+x.height/2:a+C-x.height/2:a+C/2,Y.x=d&&d!==Pi?d===tl?Q+H-x.width/2:Q+H/2:Q+x.width/2,ah(w,q,Y,r,y)}},getDistance:function(y,u){var $=y.length;return u?3===$?i(p(y[0]-u[0])+p(y[1]-u[1])+p(y[2]-u[2])):2===$?i(p(y[0]-u[0])+p(y[1]-u[1])):y.z===n?i(p(u.x-y.x)+p(u.y-y.y)):i(p(u.x-y.x)+p(u.y-y.y)+p(u.z-y.z)):3===$?i(p(y[0])+p(y[1])+p(y[2])):2===$?i(p(y[0])+p(y[1])):void 0},brighter:function(p,Y){return 0>Y&&(Y=-Y),Kh(p,Y?Y:40)},darker:function(n,e){return e>0&&(e=-e),Kh(n,e?e:-40)},unionPoint:function(l,y){if(!l)return E;if(2===arguments.length)return l&&y?{x:s(l.x,y.x),y:s(l.y,y.y),width:F(l.x-y.x),height:F(l.y-y.y)}:E;var c=l;if(c._as&&(c=c._as),c.length===n)return E;var I=c.length;if(0>=I)return E;for(var r=1,j=c[0],A={x:j.x,y:j.y,width:0,height:0};I>r;r++){j=c[r];var q=s(A.x,j.x),b=N(A.x+A.width,j.x),z=s(A.y,j.y),f=N(A.y+A.height,j.y);A.x=q,A.y=z,A.width=b-q,A.height=f-z}return A},unionRect:function(i,A){if(i&&!A)return Rn(i);if(!i&&A)return Rn(A);if(i&&A){var y={x:s(i.x,A.x),y:s(i.y,A.y)};return y.width=N(i.x+i.width,A.x+A.width)-y.x,y.height=N(i.y+i.height,A.y+A.height)-y.y,y}return E},containsPoint:function(h,p,Q,v){if(v!=E&&1!==v){var D=h.x+h.width/2,M=h.y+h.height/2;h={x:D-h.width/2*v,y:M-h.height/2*v,width:h.width*v,height:h.height*v}}if(Q){var X=h.width/2,i=h.height/2,W=y(-Q),b=T(-Q),L=p.x-h.x-X,d=p.y-h.y-i;return p={x:b*L-W*d,y:W*L+b*d},Yr({x:-X,y:-i,width:h.width,height:h.height},p)}return!(!h||p.x<h.x||p.y<h.y||p.x>h.x+h.width||p.y>h.y+h.height)},containsRect:function(c,Y){if(!c||!Y)return!1;var O=Y.x,X=Y.y,s=Y.width,v=Y.height,y=c.width,i=c.height;if(0>(y|i|s|v))return!1;var I=c.x,n=c.y;if(I>O||n>X)return!1;if(y+=I,s+=O,O>=s){if(y>=I||s>y)return!1}else if(y>=I&&s>y)return!1;if(i+=n,v+=X,X>=v){if(i>=n||v>i)return!1}else if(i>=n&&v>i)return!1;return!0},intersectsRect:function(Z,X){if(!Z||!X)return!1;var v=X.width,f=X.height,p=Z.width,C=Z.height;if(0>=p||0>=C||0>=v||0>=f)return!1;var i=X.x,w=X.y,$=Z.x,Q=Z.y;return p+=$,C+=Q,v+=i,f+=w,p>i&&C>w&&v>$&&f>Q},intersection:function(K,Z){if(!K||!Z)return E;var G=Z.x,v=Z.y,Y=K.x,s=K.y,D=G,U=v,R=Y,q=s;return D+=Z.width,U+=Z.height,R+=K.width,q+=K.height,Y>G&&(G=Y),s>v&&(v=s),D>R&&(D=R),U>q&&(U=q),D-=G,U-=v,0>=D||0>=U?E:{x:G,y:v,width:D,height:U}},grow:function(g,s,Q){Q===n&&(Q=s),g.x-=s,g.y-=Q,g.width=g.width+2*s,g.height=g.height+2*Q},getScreenPoint:function(y,X,F,p,C,a,k){var Q,S,U=F.getBoundingClientRect(),N=y*(a||1)+U.left-F.scrollLeft+(p||0),s=X*(k||1)+U.top-F.scrollTop+(C||0),P={x:N,y:s};return(Q=F.parentElement)&&(S=Q.maxtrixAppend)?S.applyInverse(P,{}):P},getLogicalPoint:function(t,_,A,p,P,N){var H,Y,y=_.getBoundingClientRect();t.target?(In(t)?Cn?tq["91"]=!0:tq["17"]=!0:Cn?tq["91"]=!1:tq["17"]=!1,tq["16"]=Cj(t)?!0:!1,t=im?pp(t):t,H=t.clientX,Y=t.clientY):(H=t.x,Y=t.y);var V,i;if((V=_.parentElement)&&(i=V.maxtrixAppend)){var Z=i.apply({x:H,y:Y},{});
return Z.x=(Z.x+_.scrollLeft-(A||0))/(P||1),Z.y=(Z.y+_.scrollTop-(p||0))/(N||1),Z}return{x:(H-y.left+_.scrollLeft-(A||0))/(P||1),y:(Y-y.top+_.scrollTop-(p||0))/(N||1)}},removeHTML:function(){var w;return function(p){return p&&p.getView&&(p=p.getView()),p&&p.parentNode?w===p?!0:(w=p,p.parentNode.removeChild(p),w=E,!0):!1}}(),getToolTipDiv:function(){if(!_i){_i=Rd(),Bs=Rd();var e=_i.style;$.baseZIndex!=E&&(e.zIndex=Y($.baseZIndex)+3+""),e.whiteSpace="nowrap",e.color=$.toolTipLabelColor,e.background=$.toolTipBackground,e.font=$.toolTipLabelFont,e.padding="5px",e.boxShadow="0px 0px 3px "+$.toolTipShadowColor}return _i},isToolTipShowing:function(){return _i&&_i.parentNode?!0:Bs&&Bs.parentNode?!0:!1},hideToolTip:function(){ii(_i),ii(Bs),Vh()},showToolTip:function(q,u){if(!q||u==E)return ij(),void 0;$.getToolTipDiv();var b,I;if(u.html?(u=u.html,b=Bs,ii(_i)):(b=_i,ii(Bs)),I=b.style,b.innerHTML=u,b.parentNode||B.Default.appendToScreen(b),q.target){q=Qp(q);var t=Ac(),O=q.x,L=q.y,w=im?60:12;if(im){var p=b.getBoundingClientRect();I.left=O-p.width/2+sb,I.top=L-p.height-w<t.top?L+w+sb:L-p.height-w+sb}else{I.left=O+w+sb,I.top=L+w+sb;var p=b.getBoundingClientRect();p.left+p.width>t.width&&(I.left=O-w-p.width+sb),p.top+p.height>t.height&&(I.top=L-w-p.height+sb),p.left<0&&(I.left=O+w+sb),p.top<0&&(I.top=L+w+sb)}}else I.left=q.x+sb,I.top=q.y+sb;Vh()},startDragging:function(G,C,K){K==n&&(K=!0),G!==df&&(df?K&&(im?df.handleWindowTouchEnd(C):df.handleWindowMouseUp(C)):im?(S.addEventListener(lc,jk,k),S.addEventListener(Mi,ph,k)):(S.addEventListener(Lg,ak,k),S.addEventListener(Gh,nl,k)),df=G)},getImageMap:function(){return Xr},toBoundaries:function($,q,R,u){var V=[];return vm($,q,R,u).forEach(function(R){var i=[];R.forEach(function(l){i.push(l.x,l.y)}),V.push(i)}),V},getCurrentKeyCodeMap:function(){return tq},drawCenterImage:function(I,_,b,H,f,u,S,h){var T=Ap(_,f,u),k=pi(_,f,u);uq(I,_,C(b-T/2),C(H-k/2),T,k,f,u,S,h)},drawStretchImage:function(B,U,d,I,r,$,N,h,M,A,O,W){var R,L=Ap(U,h,M,$),k=pi(U,h,M,N);"uniform"===d?(R=s($/L,N/k),L*=R,k*=R,I+=C(($-L)/2),r+=C((N-k)/2),$=L,N=k):"centerUniform"===d&&((L>$||k>N)&&(R=s($/L,N/k),L*=R,k*=R),I+=C(($-L)/2),r+=C((N-k)/2),$=L,N=k);var c=B.interactiveInfo;if(c){var Z;if(Z="center"===d?{x:I+$/2-L/2,y:r+N/2-k/2,width:L,height:k}:{x:I,y:r,width:$,height:N},c.rect){var w=c.compInfos,P=w.length;P&&(w[P-1].rect.image=U)}else c.rect=Z}if("center"===d){var Q=O!==!1&&(L>$||k>N);Q&&(B.save(),B.beginPath(),B.rect(I,r,$,N),B.clip()),uq(B,U,I+$/2-L/2,r+N/2-k/2,L,k,h,M,A,W),Q&&B.restore()}else uq(B,U,I,r,$,N,h,M,A,W)},toCanvas:function(S,x,p,h,C,B,$,o,O){S=wc(S,$),x=x||Ap(S,C),p=p||pi(S,C);var y=Fj(),w=Qc(y);return o?(nf(y,x,p,o),w.scale(o,o)):nf(y,x,p,1),zm(w,S,h,0,0,x,p,C,B,$,O),S&&S.clampToEdge&&(y.clampToEdge=S.clampToEdge),w.restore(),y},toGrayColor:function(n){if(!n)return n;var p=ue(n),Q=.299*p[0]+.587*p[1]+.114*p[2];return"rgba("+Q+","+Q+","+Q+","+p[3]/255+")"},createGradientImage:function(S,O,Q,n){for(var R=["L",0,0,S,0,1,0,0,1,0,0],x=0,m=Math.min(O.length,Q.length);m>x;x++)R.push(Q[x],O[x]);var g=B.Default.toCanvas({width:S,height:S,clampToEdge:!0,comps:[{type:"shape",rotation:n||0,points:[0,0,S,0,S,S,0,S],background:"#ffffff",gradientPack:R}]});return g},createElement:function(G,V,i,M){var d=W.createElement(G);return El(d,V||D.widgetBorder,2),d.style.font=i?i:Mr,M!=E&&(d.value=M),$.onElementCreated&&$.onElementCreated(d),d},containedInView:function(K,v){var m=Jg(v).getBoundingClientRect();return Yr({x:m.left,y:m.top,width:m.width,height:m.height},Rb(K))},isIsolating:function(){return ng>0},setIsolating:function(o){o?ng++:ng--},getMSMap:function(){return gs},stringify:function(l,x){var P=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var S=JSON.stringify(l,function(G,y){return"function"==typeof y?"__ht__"+(y.__ht__||y.toString()):Ib(y)?on(y):y instanceof B.List?"__ht__list"+(y.__ht__list||$.stringify(y._as)):y},x==E?2:x);return Date.prototype.toJSON=P,S},parse:function(Q){return Qo(Q)?JSON.parse(Q,function(U,s){if(Qo(s))if("__ht__function"==s.substr(0,14)){var d=s.indexOf("{")+1,o=s.lastIndexOf("}"),B=s.indexOf("(")+1,F=s.indexOf(")");if(d&&o&&B&&F){var l=new Function(s.substring(B,F),s.substring(d,o));return l.__ht__=s.substr(6),l}}else{if("__ht__date"==s.substr(0,10))return new Date(Y(s.substr(10)));if("__ht__list"===s.substr(0,10))return new yb($.parse(s.substr(10)))}return s}):Q},loadJS:function(j,U){U&&j.push(U);var T=j.shift();if(Km(T))j=T.contact(j),$.loadJS(j);else if(hp(T))T(),$.loadJS(j);else if(Qo(T)){var v=W.createElement("script");v.onload=function(){$.loadJS(j)},v.setAttribute("src",T),W.getElementsByTagName("head")[0].appendChild(v)}else j.length&&$.loadJS(j)},toRoundedCorner:function(j,X){var D=j.size();if(0>=X)return{points:j};var g,Z=new yb,L=new yb,R=j.get(0);Z.add(R),L.add(1);for(var P=1;D>P;P++)if(D>P+1){var Q=j.get(P),E=j.get(P+1),i=R.x,z=R.y,q=Q.x,r=Q.y,h=r-z,M=q-i,n=U(h,M);g=s(.99*gn(R,Q),X),Z.add({x:q-g*T(n),y:r-g*y(n)}),Z.add(Q),i=Q.x,z=Q.y,q=E.x,r=E.y,h=r-z,M=q-i,n=U(h,M),g=s(.99*gn(Q,E),X),R={x:i+g*T(n),y:z+g*y(n)},Z.add(R),L.addAll([2,3])}else Z.add(j.get(P)),L.add(2);return{points:Z,segments:L}},toColorData:ue,setCanvas:nf,createDiv:Rd,createDisabledDiv:xs,createView:Hn,createCanvas:Fj,appendChild:Hi,initContext:Qc,checkLoadingImage:mp,translateAndScale:of,layout:ib,getPosition:Vq,drawPoints:Sb,drawRoundRect:ze,drawBorder:gj,setFocus:Gk,getter:Bc,setter:gm,isEmptyObject:si},!0),yp(G,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Dh=$.disabledOpacity,Om=$.toolTipDelay,ll=$.devicePixelRatio,ks=$.autoMakeVisible,ul=$.autoHideScrollBar,ri=$.imageGradient,Pf=$.showToolTip,ij=$.hideToolTip,hf=$.dashPattern,Wr=$.lineCap,Dq=$.lineJoin,Wn=$.labelColor,cj=$.labelSelectColor,Mr=$.labelFont,Sh=$.widgetIndent,dm=$.widgetRowHeight,Kr=$.widgetHeaderHeight,hg=$.widgetTitleHeight,jl=$.scrollBarColor,bn=$.scrollBarSize,kb=$.scrollBarTimeout,mr=$.scrollBarMinLength,kp=$.scrollBarInteractiveSize,Yp=$.zoomIncrement,ql=$.scrollZoomIncrement,_e=$.pinchZoomIncrement,Zg=$.zoomMax,Cm=$.zoomMin,mq=$.createObject,ki=$.preventDefault,yc=$.setImage,wc=$.getImage,fp=$.isImageComplete,Wf=$.drawCenterImage,zm=$.drawStretchImage,oj=$.getId,Sm=$.callLater,Xh=$.sortFunc,Rn=$.clone,zs=$.getClass,Dk=$.startAnim,tk=$.brighter,Hq=$.darker,Cd=$.drawText,er=$.getTextSize,rq=$.isLeftButton,Bf=$.getTouchCount,nd=$.isDoubleClick,Cj=$.isShiftDown,In=$.isCtrlDown,Rb=$.getClientPoint,Qp=$.getPagePoint,gn=$.getDistance,Vn=$.unionPoint,tf=$.unionRect,Yr=$.containsPoint,rr=$.containsRect,vn=$.intersectsRect,$r=$.intersection,Ac=$.getWindowInfo,ip=$.grow,He=$.getLogicalPoint,hl=$.getScreenPoint,to=$.startDragging,ii=$.removeHTML,pd=$.createElement,$p=$.segmentResolution,Dr=$.shapeResolution,jo=$.shapeSide,yr=$.def,Ig=function(O,G,R){yr(J+"."+O,G,R)},ee=function(T,r){T.childNodes.forEach(function(p){r(p),ee(p,r)})};yp($,{toolTipLabelColor:Wn,toolTipLabelFont:Mr,toolTipBackground:D.toolTipBackground,toolTipShadowColor:Nm,drawBreakableText:qn,setDevicePixelRatio:function(v){ll=$.devicePixelRatio="number"==typeof v?v:S.devicePixelRatio,ee(W.body,function(s){var $=s._ht;$&&$._canvas&&(nf($._canvas,$.getWidth(),$.getHeight()),$.redraw?$.redraw():$.iv())})}},!0);var Yk=1e-6,Fb="undefined"!=typeof Uint16Array?Uint16Array:Array,Vi="undefined"!=typeof Float32Array?Float32Array:Array,qi=function(W,U,b){var N=[W[0]-U[0],W[1]-U[1],W[2]-U[2]];if(b){var o=gn(N);o>0&&(N[0]/=o,N[1]/=o,N[2]/=o)}return N},ld=function(){var l="charCodeAt",i=2*(2*Ob.length+1);for(var c in S)if(c===J+Pi[0]+sb.length){var P=S[c];if(!P)break;for(var F=P.length,k=0;F>k;k++)if(P[k][l](0)===i&&P[k+1]!=E&&P[k+1]===sb[0]&&P[k+2]!=E&&P[k+2][l](0)===i){for(var v=k+3;F>v;v++)if(P[v][l](0)===i){if(0==P[v+1])for(var Q,$=v+2;F>$;$++){if(P[$][l](0)===i){0==P[$-1]&&Q&&(Z=Q.substr(0,Q.length-1));break}Q==E?Q=P[$]:Q+=P[$]}break}break}break}return function(Q){return[-Q[0],-Q[1],-Q[2]]}}(),il=function(n,u){return 3===n.length?n[0]*u[0]+n[1]*u[1]+n[2]*u[2]:n[0]*u[0]+n[1]*u[1]},ig=function(){var N=new Vi(16);return N[0]=1,N[1]=0,N[2]=0,N[3]=0,N[4]=0,N[5]=1,N[6]=0,N[7]=0,N[8]=0,N[9]=0,N[10]=1,N[11]=0,N[12]=0,N[13]=0,N[14]=0,N[15]=1,N},uk=ig(),bk=function(N){var S=new Vi(16);return S[0]=N[0],S[1]=N[1],S[2]=N[2],S[3]=N[3],S[4]=N[4],S[5]=N[5],S[6]=N[6],S[7]=N[7],S[8]=N[8],S[9]=N[9],S[10]=N[10],S[11]=N[11],S[12]=N[12],S[13]=N[13],S[14]=N[14],S[15]=N[15],S},Ld=function(O,E){return O[0]=E[0],O[1]=E[1],O[2]=E[2],O[3]=E[3],O[4]=E[4],O[5]=E[5],O[6]=E[6],O[7]=E[7],O[8]=E[8],O[9]=E[9],O[10]=E[10],O[11]=E[11],O[12]=E[12],O[13]=E[13],O[14]=E[14],O[15]=E[15],O},wo=function(K){return K[0]=1,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=1,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[10]=1,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K},_b=function($,o){var Z=$[0],U=$[1],O=$[2];return $[0]=o[0]*Z+o[4]*U+o[8]*O+o[12],$[1]=o[1]*Z+o[5]*U+o[9]*O+o[13],$[2]=o[2]*Z+o[6]*U+o[10]*O+o[14],$},ug=function(I,m){var H=I[0],W=I[1],j=I[2],z=I[3];return I[0]=m[0]*H+m[4]*W+m[8]*j+m[12]*z,I[1]=m[1]*H+m[5]*W+m[9]*j+m[13]*z,I[2]=m[2]*H+m[6]*W+m[10]*j+m[14]*z,I[3]=m[3]*H+m[7]*W+m[11]*j+m[15]*z,I},pc=function(){var E,l,s,v,Z=bo(zh[1]+zh[7]),r=bo(zh[0]+zh[3]-zh[10]),m=bo(zh[8]+2),t=function(){return l=s.charAt(E),E+=1,l},T=function(){var q="";if(l===m)for(;t();){if(l===m)return t(),q;q+=l}else t()},k=function(){for(;l&&" ">=l;)t()},A=function(){var N,n={};if(l===Z){if(t(),k(),l===r)return t(),n;for(;l;){if(N=T(),k(),t(),n[N]=v(),k(),l===r)return t(),n;t(),k()}}};return v=function(){switch(k(),l){case Z:return A();default:return T()}},function(V){if(K={},V){var j;if(s=V,E=0,l=" ",j=v(),k(),!l)return j}}}(),Oq=function(x,u){if(u){var A=y(u),m=T(u),B=x[4],t=x[5],G=x[6],E=x[7],P=x[8],Y=x[9],k=x[10],w=x[11];x[4]=B*m+P*A,x[5]=t*m+Y*A,x[6]=G*m+k*A,x[7]=E*m+w*A,x[8]=P*m-B*A,x[9]=Y*m-t*A,x[10]=k*m-G*A,x[11]=w*m-E*A}},qm=function(E,g){if(g){var v=y(g),O=T(g),I=E[0],f=E[1],o=E[2],e=E[3],b=E[8],c=E[9],z=E[10],m=E[11];E[0]=I*O-b*v,E[1]=f*O-c*v,E[2]=o*O-z*v,E[3]=e*O-m*v,E[8]=I*v+b*O,E[9]=f*v+c*O,E[10]=o*v+z*O,E[11]=e*v+m*O}},bf=function(j,V){if(V){var e=y(V),P=T(V),b=j[0],K=j[1],w=j[2],X=j[3],q=j[4],U=j[5],R=j[6],k=j[7];j[0]=b*P+q*e,j[1]=K*P+U*e,j[2]=w*P+R*e,j[3]=X*P+k*e,j[4]=q*P-b*e,j[5]=U*P-K*e,j[6]=R*P-w*e,j[7]=k*P-X*e}},fl=function(A,c,i){return gb(E,i===!1?E:A.getFinalScale3d(),A.getFinalRotation3d(),A.getRotationMode(),A.p3(),E,c)},gb=function(B,k,h,R,P,q,V){return q||(q=ig()),P&&Qf(q,P),ao(q,h,R),V&&so(q,q,V),k&&Kc(q,k),B&&so(q,q,B),q},gi=function(l,u,o){u=Y(u),o=Y(o);var E=this;E.g=l,E._84O=u,E._85O=o,E._70I=!0,E.F=0,E._83O=u+o,E.pen={x:0,y:0}},xi="lineDashOffset",Br="setLineDash",vb=function(d){for(var n in d)1===n.length&&(xi=d[n]);return n?1:0},Be=function(l,z,L){return wk(z)?l:l[Br]?(l[Br](z),L&&(l.lineDashOffset=L),l):new gi(l,z[0],z.length>1?z[1]:z[0])},bl=function(i,N){!wk(N)&&i[Br]&&(i[Br](As),i.lineDashOffset=0)};if(yr(gi,O,{_69I:6,moveTo:function(Y,x){var A=this,z=A.pen;z.x=Y,z.y=x,A.g.moveTo(Y,x),A.start||(A.start={x:Y,y:x})},lineTo:function(a,E){var G=this,Y=G.pen,p=a-Y.x,Z=E-Y.y,l=U(Z,p),n=T(l),f=y(l),R=G._23O(Y.x,Y.y,a,E),v=G._85O,O=G._84O,M=G._83O;if(G.F){if(G.F>R)return G._70I?G._72I(a,E):G.moveTo(a,E),G.F-=R,void 0;if(G._70I?G._72I(Y.x+n*G.F,Y.y+f*G.F):G.moveTo(Y.x+n*G.F,Y.y+f*G.F),R-=G.F,G.F=0,G._70I=!G._70I,!R)return}var j=A(R/M);if(j){for(var C=n*O,S=f*O,Q=n*v,F=f*v,g=0;j>g;g++)G._70I?(G._72I(Y.x+C,Y.y+S),G.moveTo(Y.x+Q,Y.y+F)):(G.moveTo(Y.x+Q,Y.y+F),G._72I(Y.x+C,Y.y+S));R-=M*j}G._70I?R>O?(G._72I(Y.x+n*O,Y.y+f*O),G.moveTo(a,E),G.F=v-(R-O),G._70I=!1):(G._72I(a,E),R===O?(G.F=0,G._70I=!G._70I):(G.F=O-R,G.moveTo(a,E))):R>v?(G.moveTo(Y.x+n*v,Y.y+f*v),G._72I(a,E),G.F=O-(R-v),G._70I=!0):(G.moveTo(a,E),R===v?(G.F=0,G._70I=!G._70I):G.F=v-R)},quadraticCurveTo:function(Z,w,F,H){var u,m=this,f=m.pen,R=f.x,e=f.y,D=m._22O(R,e,Z,w,F,H),b=0,J=0,$=m._85O,G=m._84O;if(m.F){if(m.F>D)return m._70I?m._71I(Z,w,F,H):m.moveTo(F,H),m.F-=D,void 0;if(b=m.F/D,u=m._20O(R,e,Z,w,F,H,b),m._70I?m._71I(u[2],u[3],u[4],u[5]):m.moveTo(u[4],u[5]),m.F=0,m._70I=!m._70I,!D)return}var t=D-D*b,h=A(t/m._83O),y=G/D,d=$/D;if(h)for(var r=0;h>r;r++)m._70I?(J=b+y,u=m._21O(R,e,Z,w,F,H,b,J),m._71I(u[2],u[3],u[4],u[5]),b=J,J=b+d,u=m._21O(R,e,Z,w,F,H,b,J),m.moveTo(u[4],u[5])):(J=b+d,u=m._21O(R,e,Z,w,F,H,b,J),m.moveTo(u[4],u[5]),b=J,J=b+y,u=m._21O(R,e,Z,w,F,H,b,J),m._71I(u[2],u[3],u[4],u[5])),b=J;t=D-D*b,m._70I?t>G?(J=b+y,u=m._21O(R,e,Z,w,F,H,b,J),m._71I(u[2],u[3],u[4],u[5]),m.moveTo(F,H),m.F=$-(t-G),m._70I=!1):(u=m._19O(R,e,Z,w,F,H,b),m._71I(u[2],u[3],u[4],u[5]),D===G?(m.F=0,m._70I=!m._70I):(m.F=G-t,m.moveTo(F,H))):t>$?(J=b+d,u=m._21O(R,e,Z,w,F,H,b,J),m.moveTo(u[4],u[5]),u=m._19O(R,e,Z,w,F,H,J),m._71I(u[2],u[3],u[4],u[5]),m.F=G-(t-$),m._70I=!0):(m.moveTo(F,H),t===$?(m.F=0,m._70I=!m._70I):m.F=$-t)},bezierCurveTo:function(){var Z=arguments;this.pen={x:Z[4],y:Z[5]},this.g.bezierCurveTo(Z[0],Z[1],Z[2],Z[3],Z[4],Z[5])},arc:function(U,B,b,A,G,c){c||(A=-A,G=-G),bi(this,U,B,A,G-A,b,b,!1)},rect:function(Y,z,P,M){var J=this;J.pen={x:Y,y:z},J.moveTo(Y,z),J.lineTo(Y,z+M),J.lineTo(Y+P,z+M),J.lineTo(Y+P,z),J.lineTo(Y,z)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(Z,v,r,G){var X=r-Z,o=G-v;return i(X*X+o*o)},_22O:function(h,F,H,c,d,Y,k){for(var E,b,n,w,N,q,O,X=0,C=h,x=F,V=k>0?k:this._69I,f=1;V>=f;f++)n=f/V,w=1-n,N=w*w,q=2*n*w,O=n*n,E=N*h+q*H+O*d,b=N*F+q*c+O*Y,X+=this._23O(C,x,E,b),C=E,x=b;return X},_21O:function(B,R,C,x,G,M,N,A){var g=this;if(0===N)return g._20O(B,R,C,x,G,M,A);if(1===A)return g._19O(B,R,C,x,G,M,N);var b=g._20O(B,R,C,x,G,M,A);return b.push(N/A),g._19O.apply(g,b)},_20O:function(O,y,u,v,K,b,j){if(1!==j){var U=u+(K-u)*j,h=v+(b-v)*j;u=O+(u-O)*j,v=y+(v-y)*j,K=u+(U-u)*j,b=v+(h-v)*j}return[O,y,u,v,K,b]},_19O:function(s,v,F,t,W,P,z){if(1!==z){var K=s+(F-s)*z,O=v+(t-v)*z;F+=(W-F)*z,t+=(P-t)*z,s=K+(F-K)*z,v=O+(t-O)*z}return[s,v,F,t,W,P]},_72I:function(H,e){var r=this.pen;(H!==r.x||e!==r.y)&&(r.x=H,r.y=e,this.g.lineTo(H,e))},_71I:function(H,Q,G,$){var u=this.pen;(H!==G||Q!==$||G!==u.x||$!==u.y)&&(u.x=G,u.y=$,this.g.quadraticCurveTo(H,Q,G,$))}}),w&&m){var Pn=m.toString();q=Pn.indexOf(ko.substr(0,2))>0&&Pn.indexOf(Ui+Ui.substr(1,1))>1||Pn.indexOf(Qe.substr(0,2)+ko.substr(2,2)+Pi[0]+ko[4])>1?!0:!1}var Vp=E,_l=E,ed=function(d){Vp&&!d._72O&&(_l||(_l={}),_l[d._72O=oj()]=d)},jf=function(l,A){if(A||(A=l),A&&(Vp||(Vp={}),!Vp[l])){var y=new Ql;if(Vp[A]={request:y,url:A},A=$.beforeLoadURL(A),A.data){var g=$.parse(A.data);Bo(l,g),$.handleCompTypeLoaded(l,g)}else{y.onload=function(b){if(200===this.status||0===this.status){var P=$.parse(b.target.response||b.target.responseText);Bo(l,P),$.handleCompTypeLoaded(l,P)}else Bo(l,E)},y.onerror=function(){Bo(l,E)};var j={};j.url=encodeURI(A),j.sync=!1,y.send(j)}}},Bo=function(J,$){if(Xl[J]=$,delete Vp[J],si(Vp)&&(Vp=E,_l)){for(var h in _l){var W=_l[h];W.invalidateAll&&W.invalidateAll(n,"compTypeLoaded",J),W.redraw&&W.redraw(),W.iv(),delete W._72O}_l=E}if($&&_l)for(var h in _l){var W=_l[h];W.invalidateAll&&W.invalidateAll(n,"compTypeLoading",J),W.redraw&&W.redraw(),W.iv()}},Lm=D.chart,jm=$.compStack=[],Co=/^style@/,Uh=/^attr@/,nk=/^field@/,Kl={x:.5,y:.5},Ap=function(X,q,T,D){if(!X)return 0;if(aq(X.fitSize,q,T)&&D)return D;var s=aq(X.width,q,T);return null==s?20:s},pi=function(h,n,D,E){if(!h)return 0;if(aq(h.fitSize,n,D)&&E)return E;var O=aq(h.height,n,D);return null==O?20:O},aq=function(h,T,e){if(!h||!h.func)return h;var G,u=h.func,o=h.value;return G=hp(u)?e&&e.vectorDataBindingDisabled&&!h.isSafeFunc?o:u(T,e):T instanceof Ye?Uh.test(u)?T.a(u.slice(5)):Co.test(u)?T.s(u.slice(6)):nk.test(u)?T[u.slice(6)]:T[u]?T[u](e):o:o,o!==n&&G==E?o:G},uq=$.drawImage=function(){var i,l,j,v,V,U,F=function(l,G){l.getValue&&l.getValue.compType===G||(l.getValue=function(D){var W=o(l,D);if(W===n&&G.properties){var O=G.properties[D];O&&(W=O.defaultValue)}return W},l.getColor=function(S){return H(l.getValue(S))},l.getValue.compType=G)},o=function(O,L,I){var M=O[L];return M&&M.func?(M=aq(M,l,j),I&&(M=I(M))):I&&(M=O[L]=I(M)),M},H=function(D,j){var C;if(C=j?o(D,j):D,i&&i.compGray&&C)return $.toGrayColor(C);if(V&&C){if("override"===U)return V;if("override_rgb"===U){var p=oo(V);return C=ue(C),"rgba("+A(255*p[0])+","+A(255*p[1])+","+A(255*p[2])+","+C[3]/255+")"}if("override_a"===U){var p=oo(V);return C=ue(C),"rgba("+C[0]+","+C[1]+","+C[2]+","+p[3]+")"}var p=oo(V);return C=ue(C),"rgba("+A(C[0]*p[0])+","+A(C[1]*p[1])+","+A(C[2]*p[2])+","+C[3]/255*p[3]+")"}return C},G=function(R){if(Km(R)){for(var j=new yb,K=R.length,U=0;K>U;U+=2)j.add({x:R[U],y:R[U+1]});R=j}return R},q=function(L){var f=o(L,"anchorX"),Y=o(L,"anchorY");if(f!==n||Y!==n)return{x:f===n?Kl.x:f,y:Y===n?Kl.y:Y};var R=o(L,"type"),S=o(L,"name");if("image"!==R||!S)return Kl;var w=wc(S);return w&&w.anchorX!==n&&w.anchorY!==n?{x:w.anchorX,y:w.anchorY}:Kl},z=function(f,n){var s=o(f,Fe),z=q(f);if(Km(s)){var Z=s.length,k=o(f,"relative"),Y=n.width,E=n.height;if(4===Z)s={x:s[0],y:s[1],width:s[2],height:s[3]},k&&(s.x*=Y,s.y*=E,s.width*=Y,s.height*=E);else if(3===Z){var B=s[0];s={width:s[1],height:s[2]},k&&(s.width*=Y,s.height*=E),"object"==typeof B?B.length&&(B={x:B[0],y:B[1]}):B=Vq(B,n,s),s.x=B.x-s.width*z.x,s.y=B.y-s.height*z.y}s.x+=o(f,"offsetX")||0,s.y+=o(f,"offsetY")||0,!k&&n.fitSize&&(s=J(f,s,n))}return s},J=function(g,s,l){if(s){var y,X,h,U={x:s.x,y:s.y,width:s.width,height:s.height},B=q(g),A=o(g,"layoutH"),D=o(g,"layoutV"),V=1,a=1,j=0,e=0,F=1,C=1;switch(A){case"left":break;case"right":U.x+=l.width-l.rw;break;case"center":U.x+=.5*(l.width-l.rw);break;case"scale":case"leftright":default:y=o(g,_c)||0,y&&(j=Math.abs(e=Math.sin(y)),F=Math.abs(C=Math.cos(y))),"leftright"!==A?(V+=F*(l.widthScale-1),a+=j*(l.widthScale-1)):(V+=U.width?F*(l.width-l.rw)/U.width:0,a+=U.height?j*(l.width-l.rw)/U.height:0,X=-Math.min(-B.x*C+B.y*e,-B.x*C-(1-B.y)*e,(1-B.x)*C+B.y*e,(1-B.x)*C-(1-B.y)*e))}switch(D){case"top":break;case"bottom":U.y+=l.height-l.rh;break;case"center":U.y+=.5*(l.height-l.rh);break;case"scale":case"topbottom":default:y==E&&(y=o(g,_c),y&&(j=Math.abs(e=Math.sin(y)),F=Math.abs(C=Math.cos(y)))),"topbottom"!==D?(V+=j*(l.heightScale-1),a+=F*(l.heightScale-1)):(V+=U.width?j*(l.height-l.rh)/U.width:0,a+=U.height?F*(l.height-l.rh)/U.height:0,h=-Math.min(-B.x*e-B.y*C,-B.x*e+(1-B.y)*C,(1-B.x)*e-B.y*C,(1-B.x)*e+(1-B.y)*C))}return(1!==V||1!==a)&&("scale"!==A&&A?"leftright"===A&&(U.x+=U.width*(1-V)*B.x+X*(l.width-l.rw)):U.x+=U.x*(l.widthScale-1)+B.x*U.width*(l.widthScale-V),"scale"!==D&&D?"topbottom"===D&&(U.y+=U.height*(1-a)*B.y+h*(l.height-l.rh)):U.y+=U.y*(l.heightScale-1)+B.y*U.height*(l.heightScale-a),U.width*=V,U.height*=a),U.width<0&&(U.width=0),U.height<0&&(U.height=0),U}},p=function(v){return Km(v)?new yb(v):v},X=function($,b,e,y,w,l,s){var J=i.interactiveInfo,V=$.transform;if(V)return i.save(),i.setTransform(V.a,V.b,V.c,V.d,V.tx,V.ty),J&&J.compInfos.push({comp:$,rect:b,matrix:V.clone()}),!0;w===n&&(w=1),l===n&&(l=1);var A=o($,"clipPercentage"),r=zr(e,b);if(r&&!y&&1===w&&1===l&&!(1>A))return J&&J.compInfos.push({comp:$,rect:b,matrix:J.matrix.clone()}),!1;s=s||Kl;var F=b.x+b.width*s.x,u=b.y+b.height*s.y,g=e.x+e.width*s.x,S=e.y+e.height*s.y,m=e.width?w*(b.width/e.width):1,j=e.height?l*(b.height/e.height):1;if(i.save(),J&&(J.matrix.appendTranslate(F,u).appendRotate(y).appendScale(m,j).appendTranslate(-g,-S),J.compInfos.push({comp:$,rect:b,matrix:J.matrix.clone()})),Gg(i,F,u),Ke(i,y||0),Sl(i,m,j),Gg(i,-g,-S),1>A){0>A&&(A=0);var v=op(e,o($,"clipDirection"),A);i.beginPath(),i.rect(v.x,v.y,v.width,v.height),i.clip()}return!0},B=function(){i.restore()},c=function(n,F,Q){var P=o(n,"path"),c=o(n,_c),W=o(n,"scaleX"),D=o(n,"scaleY"),A=q(n),T=E,b=mj(null,P);if(Q||(Q=n.unionRect,Q||(Q=Vn(b),n.path.func||(n.unionRect=Q)),T=Q),Q){T||(T=n.unionRect,T||(T=Vn(b),n.path.func||(n.unionRect=T)));var l=X(n,Q,T,c,W,D,A),u=o(n,"borderPattern"),L=Be(i,u),f=H(n,"background"),_=H(n,"borderColor"),V=o(n,"borderWidth"),Y=o(n,"gradient"),p=H(n,"gradientColor"),O=o(n,"border3d"),m=o(n,"border3dColor"),k=o(n,"border3dAccuracy"),h=i.lineJoin,d=i.lineCap;if(i.lineJoin=o(n,"borderJoin")||Dq,i.lineCap=o(n,"borderCap")||Wr,f?(Rr(i,f,Y,p,T),mj(i,P),i.fill(),L!==i&&mj(i,P)):mj(i,P),V&&_){var s=o(n,"borderWidthAbsolute");s&&(i.save(),i.setTransform(1,0,0,1,0,0)),i.lineWidth=V,i.strokeStyle=_,i.stroke(),s&&i.restore(),O&&is(i,_,m,V,v,k)}if(bl(i,u),o(n,"dash")){var j=o(n,"dashWidth")||V;if(j>0){u=o(n,"dashPattern")||hf;var L=Be(i,u,o(n,"dashOffset")),U=H(n,"dashColor")||H(Fo);L!==i&&mj(i,P),i.strokeStyle=U,i.lineWidth=j,i.stroke(),o(n,"dash3d")&&is(i,U,H(n,"dash3dColor"),j,v,o(n,"dash3dAccuracy")),bl(i,u)}}F===Fe&&gh(i,f,o(n,"depth"),T),i.lineJoin=h,i.lineCap=d,l&&B()}},g=function(I,r,$,h){var x=o(I,mc,G),m=o(I,_c),z=q(I);if(x&&h.fitSize){var y=new yb,Q=Vn(x),k=J(I,Q,h),w=Q.x+z.x*Q.width,S=Q.y+z.y*Q.height,O=k.x+z.x*k.width,C=k.y+z.y*k.height,_=Q.width?k.width/Q.width:1,s=Q.height?k.height/Q.height:1;x.each(function(e){y.add({x:O+(e.x-w)*_,y:C+(e.y-S)*s})}),x=y,I.unionRect=null}var u=o(I,"scaleX"),b=o(I,"scaleY"),a=r===xc,T=E;if(!$&&a&&($=I.unionRect,$||($=Vn(x),I.points.func||(I.unionRect=$)),T=$),$){a?T||(T=I.unionRect,T||(T=Vn(x),I.points.func||(I.unionRect=T))):T=$;var F,Y,D,e,P=X(I,$,T,m,u,b,z),N=o(I,"borderPattern"),W=Be(i,N),c=H(I,"background"),M=wc(o(I,"repeatImage"),V,U),R=o(I,"gradientPack"),A=H(I,"borderColor"),n=o(I,"borderWidth"),L=o(I,"segments",p),f=o(I,"gradient"),t=H(I,"gradientColor"),d=o(I,"border3d"),K=o(I,"border3dColor"),g=o(I,"border3dAccuracy"),Z=o(I,"closePath"),bi=o(I,"fillRule")||"nonzero",pm=i.lineJoin,og=i.lineCap;if(i.lineJoin=o(I,"borderJoin")||Dq,i.lineCap=o(I,"borderCap")||Wr,a)if(c||M||R){var Tk=o(I,"fillClipPercentage");if(1>Tk){0>Tk&&(Tk=0);var zf=op(T,o(I,"fillClipDirection"),Tk);i.save(),i.beginPath(),i.rect(zf.x,zf.y,zf.width,zf.height),i.clip()}if(Sb(i,x,L,Z),R)Nf(i,R);else if(M){var Lc=i,As=V,jh=U;dj(i,M,V,U,l,j),i=Lc,V=As,U=jh}else{var Lc=i;Rr(i,c,f,t,T),i=Lc}i.fill(bi),1>Tk&&i.restore(),R&&i.restore(),W!==i&&Sb(W,x,L,Z)}else Sb(W,x,L,Z);else if("roundRect"===r?F=o(I,"cornerRadius"):"polygon"===r?F=o(I,"polygonSide"):"arc"===r&&(F=o(I,"arcFrom"),Y=o(I,"arcTo"),D=o(I,"arcClose"),e=o(I,"arcOval")),c||M||R){var Tk=o(I,"fillClipPercentage");if(1>Tk){0>Tk&&(Tk=0);var zf=op(T,o(I,"fillClipDirection"),Tk);i.save(),i.beginPath(),i.rect(zf.x,zf.y,zf.width,zf.height),i.clip()}if(ap(i,r,T,F,Y,D,e),R)Nf(i,R);else if(M){var Lc=i,As=V,jh=U;dj(i,M,V,U,l,j),i=Lc,V=As,U=jh}else Rr(i,c,f,t,T);i.fill(bi),1>Tk&&i.restore(),R&&i.restore(),i!==W&&ap(W,r,T,F,Y,D,e)}else ap(W,r,T,F,Y,D,e);if(n&&A){var Ng=o(I,"borderWidthAbsolute");Ng&&(i.save(),i.setTransform(1,0,0,1,0,0)),i.lineWidth=n,i.strokeStyle=A,i.stroke(),Ng&&i.restore(),d&&is(i,A,K,n,v,g)}if(bl(i,N),o(I,"dash")){var Le=o(I,"dashWidth")||n;if(Le>0){N=o(I,"dashPattern")||hf;var W=Be(i,N,o(I,"dashOffset")),ak=H(I,"dashColor")||H(Fo);W!==i&&(a?Sb(W,x,L,Z):ap(W,r,T,F,Y,D,e)),i.strokeStyle=ak,i.lineWidth=Le,i.stroke(),o(I,"dash3d")&&is(i,ak,H(I,"dash3dColor"),Le,v,o(I,"dash3dAccuracy")),bl(i,N)}}r===Fe&&gh(i,c,o(I,"depth"),T),i.lineJoin=pm,i.lineCap=og,P&&B()}},e=function(C,s){var J=V,B=U,_=V||o(C,Ep),L=U||o(C,"blendMode"),T=wc(o(C,"name"),_,L);T&&(zm(i,T,o(C,"stretch"),s.x,s.y,s.width,s.height,l,j,_,null,L),V=J,U=B)},C=function(d,Z){var u=o(d,"text");u!=E&&Cd(i,u,o(d,"font"),H(d,Ep),Z.x,Z.y,Z.width,Z.height,o(d,"align"),o(d,"vAlign"))},Y=function(V,T){gj(i,H(V,Ep),T.x,T.y,T.width,T.height,o(V,"width"))},Q=function(V,k){var d=o(V,Mj),b=0;if(d&&(d.forEach(function(Q){b+=Q}),b>0)){for(var t=o(V,"colors")||Lm,A=o(V,"startAngle")||0,M=o(V,"hollow"),J=o(V,Eo),Y=o(V,Kj),x=o(V,Kk),q=J?new yb:E,Z=k.x,N=k.y,U=k.width,D=k.height,I=Z+U/2,F=N+D/2,n=s(U,D)/2,O=0,Q=0;Q<d.length;Q++){var j=d[Q],h=f*j/b,p=A+h;if(i.fillStyle=t[O++],O===t.length&&(O=0),i.beginPath(),M){var R=I+T(A)*n/2,C=F+y(A)*n/2,G=I+T(p)*n,u=F+y(p)*n;i.moveTo(R,C),i.arc(I,F,n/2,A,p,!1),i.lineTo(G,u),i.arc(I,F,n,p,A,!0)}else i.moveTo(I,F),i.arc(I,F,n,p,A,!0);q&&(h=(A+p)/2,q.add({text:hp(J)?J(j,Q,b,l):j,x:I+.75*T(h)*n,y:F+.75*y(h)*n})),i.closePath(),i.fill(),A=p}q&&q.each(function(C){Cd(i,C.text,Y,x,C.x,C.y,0,0,Lr)})}},M=function(d,y){var u=o(d,zd);if(u&&u.length>0){var Z=u.length,r=o(d,Eo),X=o(d,Kj),Y=o(d,Kk),Q=r?new yb:E,e=o(d,"minValue")||0,V=o(d,"maxValue");if(V==E&&(V=0,u.forEach(function(c){o(c,Mj).forEach(function(T){V=N(V,T)})})),e===V)return;for(var g=y.height/(V-e),b=y.y+V*g,M=o(u[0],Mj).length,k=y.width/(3*M+1),$=2*k/Z,R=0,z=0;Z>z;z++)for(var P=u[z],v=o(P,Ep),G=o(P,"colors"),O=o(P,Mj),x=0;M>x;x++){G?i.fillStyle=G[x]:v?i.fillStyle=v:(i.fillStyle=Lm[R++],R===Lm.length&&(R=0));var t=O[x],J=t*g,L=y.x+(1+3*x)*k+z*$;if(Fp(i,L,b-J,$,J),Q){var w=hp(r)?r(t,x,P,l):t,A=er(X,w).height;Q.add({x:L,y:b-J-A,width:$,height:A,text:w})}}Q&&Q.each(function(G){Cd(i,G.text,X,Y,G.x,G.y,G.width,G.height,Lr)})}},R=function(Y,O){var D=o(Y,zd);if(D&&D.length>0){var Z=D.length,L=o(D[0],Mj).length,X=O.width/(3*L+1),n=0,P=o(Y,"maxValue"),m=o(Y,Eo),_=o(Y,Kj),d=o(Y,Kk),q=m?new yb:E;if(P==E){P=0;for(var B=0;L>B;B++){for(var Q=0,G=0;Z>G;G++)Q+=o(D[G],Mj)[B];P=N(P,Q)}}if(P>0){for(var B=0;L>B;B++)for(var C=O.y+O.height,G=0;Z>G;G++){var w=D[G],v=o(w,Ep),A=o(w,Mj)[B],h=A/P*O.height;v?i.fillStyle=v:(i.fillStyle=Lm[n++],n===Lm.length&&(n=0)),C-=h;var M={x:O.x+(1+3*B)*X,y:C,width:2*X,height:h};Fp(i,M.x,M.y,M.width,M.height),q&&(M.text=hp(m)?m(A,B,w,l):A,q.add(M))}q&&q.each(function(k){Cd(i,k.text,_,d,k.x,k.y,k.width,k.height,Lr)})}}},r=function(a,$){var p=o(a,zd);if(p&&p.length>0){for(var u=p.length,P=o(p[0],Mj).length,N=$.width/(3*P+1),D=0,T=o(a,Eo),Q=o(a,Kj),t=o(a,Kk),M=T?new yb:E,H=0;P>H;H++){for(var d=0,X=0;u>X;X++)d+=o(p[X],Mj)[H];if(d>0){var K=$.y+$.height;for(X=0;u>X;X++){var g=p[X],m=o(g,Ep),S=o(g,Mj)[H],r=S/d*$.height;m?i.fillStyle=m:(i.fillStyle=Lm[D++],D===Lm.length&&(D=0)),K-=r;var C={x:$.x+(1+3*H)*N,y:K,width:2*N,height:r};Fp(i,C.x,C.y,C.width,C.height),M&&(C.text=hp(T)?T(S,H,g,l):S,M.add(C))}}}M&&M.each(function(S){Cd(i,S.text,Q,t,S.x,S.y,S.width,S.height,Lr)})}},u=function(J,s){var W=o(J,zd);if(W&&W.length>0){var _=W.length,y=o(J,"minValue")||0,R=o(J,"maxValue");if(R==E&&(R=0,W.forEach(function($){o($,Mj).forEach(function(P){R=N(R,P)})})),y===R)return;for(var K=s.height/(R-y),g=s.y+R*K,j=o(W[0],Mj).length,A=s.width/(3*j+1),p=0,m=o(J,"lineWidth")||2,T=o(J,"line3d"),u=o(J,"linePoint"),Q=o(J,Eo),L=o(J,Kj),B=o(J,Kk),Z=0;_>Z;Z++){var P=W[Z],C=o(P,Ep),V=o(P,Mj);C?i.strokeStyle=C:(C=i.strokeStyle=Lm[p++],p===Lm.length&&(p=0)),i.beginPath();for(var M=0;j>M;M++){var k=s.x+(2+3*M)*A,U=g-V[M]*K;0===M?i.moveTo(k,U):i.lineTo(k,U)}if(i.lineWidth=m,i.stroke(),T&&is(i,C,E,m,v),u||Q){var D,d=m/2+2;for(M=0;j>M;M++){var r=V[M];if(k=s.x+(2+3*M)*A,U=g-r*K,hp(u)?u(i,k,U,C,M,P,l):u&&(i.fillStyle=C,i.beginPath(),i.arc(k,U,d,0,f,!0),i.fill()),hp(Q)?D=Q(r,M,P,l):Q&&(D=r),D){var t=er(L,D).height,h=i.shadowBlur;if(h){var O=i.shadowOffsetX,H=i.shadowOffsetY,Y=i.shadowColor;i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=0,i.shadowColor=E}Cd(i,D,L,B,k,U-t-d+2,0,t,Lr),h&&(i.shadowOffsetX=O,i.shadowOffsetY=H,i.shadowBlur=h,i.shadowColor=Y)}}}}}},t=function(){i=null,l=null,j=null},b={border:Y,image:e,text:C,pieChart:Q,columnChart:M,stackedColumnChart:R,percentageColumnChart:r,lineChart:u};return function(A,D,T,x,h,d,P,Q,R,L){if(D&&h&&d){var M=i?!1:!0;i=A,l=P,j=Q,v=j?j._zoom?j._zoom:1:1,V=R,U=L;var f=h,J=d;if(Wk()){var N,K,a;0===i[Fi]?Wk[0]&&(N=!0):N=!0,i.texureImage2D?Wk[1]&&(K=!0):K=!0,i.texureImage3D?Wk[2]&&(a=!0):a=!0,N&&K&&a&&(f=T,J=x)}if(D.tagName)return Qo(Z)&&!S[Z]||i.drawImage(D,f,J,h,d),M&&t(),void 0;if(o(D,"visible")===!1)return M&&t(),void 0;V||(V=aq(D.color,l,j)),L||(U=aq(D.blendMode,l,j)),Qo(Z)&&!S[Z]&&(h=f,d=J);var s=Ap(D,l,j,h),Y=pi(D,l,j,d),C={x:0,y:0,width:s,height:Y,fitSize:o(D,"fitSize")},u=o(D,"clip"),r=o(D,"opacity");if(C.fitSize){var O=C.rw=aq(D.width,l,j)||20;C.widthScale=s/O;var I=C.rh=aq(D.height,l,j)||20;C.heightScale=Y/I}if(i.save(),i.interactiveInfo){var m=i.interactiveInfo.matrix,k=m.clone();m.appendTranslate(f,J).appendScale(h/s,d/Y)}Gg(i,f,J),(s!==h||Y!==d)&&i.scale(h/s,d/Y),u&&(hp(u)?u(i,s,Y,l,j,D):(i.beginPath(),i.rect(0,0,s,Y),i.clip())),r!=E&&(i.globalAlpha*=r),o(D,"comps").forEach(function(t){if(o(t,vh)!==!1){if(jm.splice(0,0,t),i.interactiveInfo)var y=i.interactiveInfo.matrix.clone();var R=o(t,"opacity"),Y=o(t,"shadow"),O=o(t,"type"),J=z(t,C);if(R!=E){var r=i.globalAlpha;i.globalAlpha*=R}if(Y){var x=i.shadowOffsetX,d=i.shadowOffsetY,K=i.shadowBlur,U=i.shadowColor,I=o(t,"shadowOffsetX"),a=o(t,"shadowOffsetY"),L=o(t,"shadowBlur"),e=H(t,"shadowColor");i.shadowOffsetX=(I==E?3:I)*v,i.shadowOffsetY=(a==E?3:a)*v,i.shadowBlur=(L==E?6:L)*v,i.shadowColor=e||H(dq)}if("save"===O)i.save();else if("endClip"===O||"restore"===O)i.restore();else if("clip"===O)i.save(),Sb(i,o(t,"points",G),o(t,"segments",p),!0),i.clip();else if(yi[O])J=J||{x:0,y:0,width:C.width,height:C.height},g(t,O,J,C);else if(O===xc)g(t,O,J,C);else if("SVGPath"===O)c(t,O,J);else{J=J||{x:0,y:0,width:C.width,height:C.height};var P=o(t,_c),h=o(t,"scaleX"),S=o(t,"scaleY"),A=q(t),f=X(t,J,J,P,h,S,A);if(hp(O))F(t,O),$.drawCompType(O,i,J,t,l,j);else if($.getCompType(O)){var M=$.getCompType(O),k=M.func||M;F(t,M),$.drawCompType(k,i,J,t,l,j)}else b[O]?b[O](t,J):$.getCompType(O)===n&&$n.test(O)&&jf(O);f&&B()}Y&&(i.shadowOffsetX=x,i.shadowOffsetY=d,i.shadowBlur=K,i.shadowColor=U),R!=E&&(i.globalAlpha=r),i.interactiveInfo&&(i.interactiveInfo.matrix=y),jm.splice(0,1)}}),i.interactiveInfo&&(i.interactiveInfo.matrix=k),i.restore(),M&&t()}}}();$.getCurrentComp=function(){return jm[0]},$.getParentComp=function(){return jm[1]},$.getInternal=function(){return{isEnter:Qd,isEsc:$j,isSpace:dg,isLeft:Hf,isUp:uh,isRight:eg,isDown:ps,addMethod:yp,superCall:bs,toPointsArray:vm,translateAndScale:of,appendArray:mb,createWorldMatrix:gb,vec3TransformMat4:_b,setCanvas:nf,createDiv:Rd,createView:Hn,createCanvas:Fj,createImage:Mm,initContext:Qc,layout:ib,fillRect:Fp,Mat:Ng,drawBorder:gj,isString:Qo,setBorder:El,getPropertyValue:Se,setPropertyValue:tr,drawVerticalLine:as,draw3DRect:gh,getPinchDist:jr,isSameRect:zr,getPosition:Vq,intersectionLineRect:ae,getNodeRect:Or,getEdgeAgentPosition:Kg,getImageWidth:Ap,getImageHeight:pi,initItemElement:qp,drawPoints:Sb,createG2:Be,closePopup:Rh,isH:Ni,createAnim:_q,createNormalMatrix:Ub,createNormals:jp,toFloatArray:dd,glMV:Yl,batchShape:fn,createNodeMatrix:fl,getFaceInfo:tn,transformAppend:Th,drawFaceInfo:qk,to3dPointsArray:Rc,setGLDebugMode:function(B){ih=B},cube:function(){return{vs:_o,is:xp,uv:Wq}},ui:function(){return{DataUI:ni,NodeUI:wf,EdgeUI:aj,GroupUI:ac,ShapeUI:Mp,GridUI:Zm,Data3dUI:eb,Node3dUI:Yg,Shape3dUI:xm}},getInternalVersion:function(){return"U2FsdGVkX195LqE5D/ZjLyuurqPH2F9pAZb4ZjAn8Bo="},getDragger:function(){return df},addMSMap:function(d){yp(gs,d)},k:e}},function(h){function l(O,w){O!=E&&(w==E&&eh!=typeof O?this._54O(O,256):this._54O(O,w))}function v(){return new l(E)}function M(h,J,w,k,I,V){for(;--V>=0;){var L=J*this[h++]+w[k]+I;I=A(L/67108864),w[k++]=67108863&L}return I}function O(X,q,j,M,I,N){for(var s=32767&q,m=q>>15;--N>=0;){var S=32767&this[X],C=this[X++]>>15,h=m*S+C*s;S=s*S+((32767&h)<<15)+j[M]+(1073741823&I),I=(S>>>30)+(h>>>15)+m*C+(I>>>30),j[M++]=1073741823&S}return I}function w(_,D,w,y,J,Z){for(var h=16383&D,L=D>>14;--Z>=0;){var j=16383&this[_],f=this[_++]>>14,U=L*j+f*h;j=h*j+((16383&U)<<14)+w[y]+J,J=(j>>28)+(U>>14)+L*f,w[y++]=268435455&j}return J}function L(B){return Pn.charAt(B)}function S(s,M){var u=wj[s.charCodeAt(M)];return u==E?-1:u}function p(d){for(var J=this.t-1;J>=0;--J)d[J]=this[J];d.t=this.t,d.s=this.s}function B(V){this.t=1,this.s=0>V?-1:0,V>0?this[0]=V:-1>V?this[0]=V+this.DV:this.t=0}function t(T){var N=v();return N._58O(T),N}function n(P,$){var L,N=this;if(16==$)L=4;else if(8==$)L=3;else if(256==$)L=8;else if(2==$)L=1;else if(32==$)L=5;else{if(4!=$)return N.fromRadix(P,$),void 0;L=2}N.t=0,N.s=0;for(var v=P.length,p=!1,y=0;--v>=0;){var G=8==L?255&P[v]:S(P,v);
0>G?"-"==P.charAt(v)&&(p=!0):(p=!1,0==y?N[N.t++]=G:y+L>N.DB?(N[N.t-1]|=(G&(1<<N.DB-y)-1)<<y,N[N.t++]=G>>N.DB-y):N[N.t-1]|=G<<y,y+=L,y>=N.DB&&(y-=N.DB))}8==L&&0!=(128&P[0])&&(N.s=-1,y>0&&(N[N.t-1]|=(1<<N.DB-y)-1<<y)),N._57O(),p&&l.ZERO._78O(N,N)}function m(){for(var h=this,H=h.s&h.DM;h.t>0&&h[h.t-1]==H;)--h.t}function $(_){var n=this;if(n.s<0)return"-"+n._85O()[Dc](_);var w;if(16==_)w=4;else if(8==_)w=3;else if(2==_)w=1;else if(32==_)w=5;else{if(4!=_)return n.toRadix(_);w=2}var S,k=(1<<w)-1,K=!1,g="",m=n.t,Z=n.DB-m*n.DB%w;if(m-->0)for(Z<n.DB&&(S=n[m]>>Z)>0&&(K=!0,g=L(S));m>=0;)w>Z?(S=(n[m]&(1<<Z)-1)<<w-Z,S|=n[--m]>>(Z+=n.DB-w)):(S=n[m]>>(Z-=w)&k,0>=Z&&(Z+=n.DB,--m)),S>0&&(K=!0),K&&(g+=L(S));return K?g:"0"}function c(){var $=v();return l.ZERO._78O(this,$),$}function F(){return this.s<0?this._85O():this}function K(h){var I=this,t=I.s-h.s;if(0!=t)return t;var G=I.t;if(t=G-h.t,0!=t)return I.s<0?-t:t;for(;--G>=0;)if(0!=(t=I[G]-h[G]))return t;return 0}function k(L){var c,J=1;return 0!=(c=L>>>16)&&(L=c,J+=16),0!=(c=L>>8)&&(L=c,J+=8),0!=(c=L>>4)&&(L=c,J+=4),0!=(c=L>>2)&&(L=c,J+=2),0!=(c=L>>1)&&(L=c,J+=1),J}function X(){var h=this;return h.t<=0?0:h.DB*(h.t-1)+k(h[h.t-1]^h.s&h.DM)}function W(k,S){var p;for(p=this.t-1;p>=0;--p)S[p+k]=this[p];for(p=k-1;p>=0;--p)S[p]=0;S.t=this.t+k,S.s=this.s}function P(B,X){for(var I=B;I<this.t;++I)X[I-B]=this[I];X.t=N(this.t-B,0),X.s=this.s}function G($,P){var E,N=this,M=$%N.DB,f=N.DB-M,U=(1<<f)-1,l=A($/N.DB),J=N.s<<M&N.DM;for(E=N.t-1;E>=0;--E)P[E+l+1]=N[E]>>f|J,J=(N[E]&U)<<M;for(E=l-1;E>=0;--E)P[E]=0;P[l]=J,P.t=N.t+l+1,P.s=N.s,P._57O()}function q(Z,t){var S=this;t.s=S.s;var V=A(Z/S.DB);if(V>=S.t)return t.t=0,void 0;var R=Z%S.DB,x=S.DB-R,r=(1<<R)-1;t[0]=S[V]>>R;for(var $=V+1;$<S.t;++$)t[$-V-1]|=(S[$]&r)<<x,t[$-V]=S[$]>>R;R>0&&(t[S.t-V-1]|=(S.s&r)<<x),t.t=S.t-V,t._57O()}function D(S,$){for(var P=this,v=0,K=0,D=s(S.t,P.t);D>v;)K+=P[v]-S[v],$[v++]=K&P.DM,K>>=P.DB;if(S.t<P.t){for(K-=S.s;v<P.t;)K+=P[v],$[v++]=K&P.DM,K>>=P.DB;K+=P.s}else{for(K+=P.s;v<S.t;)K-=S[v],$[v++]=K&P.DM,K>>=P.DB;K-=S.s}$.s=0>K?-1:0,-1>K?$[v++]=P.DV+K:K>0&&($[v++]=K),$.t=v,$._57O()}function u(f,N){var T=this.abs(),S=f.abs(),E=T.t;for(N.t=E+S.t;--E>=0;)N[E]=0;for(E=0;E<S.t;++E)N[E+T.t]=T.am(0,S[E],N,E,0,T.t);N.s=0,N._57O(),this.s!=f.s&&l.ZERO._78O(N,N)}function j(p){for(var j=this.abs(),s=p.t=2*j.t;--s>=0;)p[s]=0;for(s=0;s<j.t-1;++s){var v=j.am(s,j[s],p,2*s,0,1);(p[s+j.t]+=j.am(s+1,2*j[s],p,2*s+1,v,j.t-s-1))>=j.DV&&(p[s+j.t]-=j.DV,p[s+j.t+1]=1)}p.t>0&&(p[p.t-1]+=j.am(s,j[s],p,2*s,0,1)),p.s=0,p._57O()}function a(S,d,x){var Z=S.abs(),w=this;if(!(Z.t<=0)){var n=w.abs();if(n.t<Z.t)return d!=E&&d._58O(0),x!=E&&w._77O(x),void 0;x==E&&(x=v());var h=v(),J=w.s,M=S.s,$=w.DB-k(Z[Z.t-1]);$>0?(Z._44O($,h),n._44O($,x)):(Z._77O(h),n._77O(x));var P=h.t,D=h[P-1];if(0!=D){var L=D*(1<<w.F1)+(P>1?h[P-2]>>w.F2:0),f=w.FV/L,Q=(1<<w.F1)/L,m=1<<w.F2,s=x.t,H=s-P,V=d==E?v():d;for(h._59O(H,V),x._52O(V)>=0&&(x[x.t++]=1,x._78O(V,x)),l.ONE._59O(P,V),V._78O(h,h);h.t<P;)h[h.t++]=0;for(;--H>=0;){var _=x[--s]==D?w.DM:A(x[s]*f+(x[s-1]+m)*Q);if((x[s]+=h.am(0,_,x,H,0,P))<_)for(h._59O(H,V),x._78O(V,x);x[s]<--_;)x._78O(V,x)}d!=E&&(x._45O(P,d),J!=M&&l.ZERO._78O(d,d)),x.t=P,x._57O(),$>0&&x._46O($,x),0>J&&l.ZERO._78O(x,x)}}}function U(j){var Y=v();return this.abs()._49O(j,E,Y),this.s<0&&Y._52O(l.ZERO)>0&&j._78O(Y,Y),Y}function g(O){this.m=O}function H(B){return B.s<0||B._52O(this.m)>=0?B.mod(this.m):B}function Z(g){return g}function C(G){G._49O(this.m,E,G)}function Q(l,m,P){l._47O(m,P),this._74O(P)}function r(I,H){I._48O(H),this._74O(H)}function z(){if(this.t<1)return 0;var M=this[0];if(0==(1&M))return 0;var P=3&M;return P=15&P*(2-(15&M)*P),P=255&P*(2-(255&M)*P),P=65535&P*(2-(65535&(65535&M)*P)),P=P*(2-M*P%this.DV)%this.DV,P>0?this.DV-P:-P}function R(w){var O=this;O.m=w,O.mp=w._50O(),O.mpl=32767&O.mp,O.mph=O.mp>>15,O.um=(1<<w.DB-15)-1,O.mt2=2*w.t}function b(N){var F=v();return N.abs()._59O(this.m.t,F),F._49O(this.m,E,F),N.s<0&&F._52O(l.ZERO)>0&&this.m._78O(F,F),F}function x(N){var X=v();return N._77O(X),this._74O(X),X}function V(X){for(var r=this;X.t<=r.mt2;)X[X.t++]=0;for(var l=0;l<r.m.t;++l){var U=32767&X[l],L=U*r.mpl+((U*r.mph+(X[l]>>15)*r.mpl&r.um)<<15)&X.DM;for(U=l+r.m.t,X[U]+=r.m.am(0,L,X,l,0,r.m.t);X[U]>=X.DV;)X[U]-=X.DV,X[++U]++}X._57O(),X._45O(r.m.t,X),X._52O(r.m)>=0&&X._78O(r.m,X)}function $o(G,P){G._48O(P),this._74O(P)}function Ff(l,V,$){l._47O(V,$),this._74O($)}function pj(){return 0==(this.t>0?1&this[0]:this.s)}function Wj(q,V){if(q>4294967295||1>q)return l.ONE;var x=v(),f=v(),F=V._73O(this),U=k(q)-1;for(F._77O(x);--U>=0;)if(V._76O(x,f),(q&1<<U)>0)V._75O(f,F,x);else{var A=x;x=f,f=A}return V.revert(x)}function pb(K,X){var l;return l=256>K||X._51O()?new g(X):new R(X),this.exp(K,l)}function Tn(){var N=this;if(N.s<0){if(1==N.t)return N[0]-N.DV;if(0==N.t)return-1}else{if(1==N.t)return N[0];if(0==N.t)return 0}return(N[1]&(1<<32-N.DB)-1)<<N.DB|N[0]}function Vg(c,N){return new l(c,N)}function Ak(){var m=this;m.n=E,m.e=0,m.d=E,m.p=E,m.q=E,m.dmp1=E,m.dmq1=E,m._10A=E}function fc(N){return N._53O(this.e,this.n)}function Hb(d){var h,R,S,O="",X=0;for(h=0;h<d.length&&d.charAt(h)!=pr;++h)S=Cg.indexOf(d.charAt(h)),0>S||(0==X?(O+=L(S>>2),R=3&S,X=1):1==X?(O+=L(R<<2|S>>4),R=15&S,X=2):2==X?(O+=L(R),O+=L(S>>2),R=3&S,X=3):(O+=L(R<<2|S>>4),O+=L(15&S),X=0));return 1==X&&(O+=L(R<<2)),O}function Eo(v){var y=v.split(""),B=Hb(v);return y.forEach(function(O){var j=O.length;j>0&&B&&(rd+=Y(O))}),B}function Ag(x,t){var F=Tl._4O.Util._56O(x,"ss"),D={},w=0;return D.v=F==t,D.t=1,D.s=0>w?-1:0,qr=D.v,w>0?D[0]=w:-1>w?D[0]=w+D.DV:D.t=0,[F,D]}function Dl(V){var F=38,B=V.substring(0,F);if(B&&30==B.indexOf("05000420")){var j=["ss",V.substring(F)];return j}return[]}function Re(P,a){a=a.replace(pn,""),a=a.replace(/[ \n]+/g,"");var p=Vg(a,16);if(p._55O()>this.n._55O())return 0;var J=this._37O(p),o=J[Dc](16).replace(/^1f+00/,""),m=Dl(o);if(0==m.length)return!1;for(var H,_,D,j=.5,U=jo,q=[0,.5,.75,.875,.9375],u=[],E=[],O=[],z=f/U,k=m[1],Y=Ag(P,k)[0],L=0,R=0;L<q.length;L++){var e=0===L%2?0:.5;for(H=0;U>=H;H++)_=(H+e)*z,D=1-q[L],u.push(T(_)*j*D,-j+2*q[L]*j,-y(_)*j*D),E.push((H+e)/U,D)}for(L=0;L<q.length-1;L++){var C=L*(U+1),W=(L+1)*(U+1);for(H=0;U>H;H++)O.push(C+H,W+H+1,W+H,C+H,C+H+1,W+H+1)}return O.forEach(function(y){R+=y}),k==Y&&R>10}var Ck,Mr=0xdeadbeefcafe,Xo=15715070==(16777215&Mr),Dc="toString",eg="",Jf="nat",Fm=function(){};o=h["D"+11182[Dc](_(2,5))];var Jn=l.prototype;Nq+=Lf.substr(0,1);var Cf=h.navigator?h.navigator.appName:"";Xo&&"Microsoft Internet Explorer"==Cf?(Jn.am=O,Ck=30):Xo&&"Netscape"!=Cf?(Jn.am=M,Ck=26):(Jn.am=w,Ck=28),Jn.DB=Ck,Jn.DM=(1<<Ck)-1,Jn.DV=1<<Ck;var Cj=52;Jn.FV=_(2,Cj),Jn.F1=Cj-Ck,Jn.F2=2*Ck-Cj;var Bk,Nb,Pn="0123456789abcdefghijklmnopqrstuvwxyz",wj=[],pl=function(O){return String.fromCharCode(O)};for(Bk="0".charCodeAt(0),Nb=0;9>=Nb;++Nb)wj[Bk++]=Nb;for(Bk="a".charCodeAt(0),Nb=10;36>Nb;++Nb)wj[Bk++]=Nb;for(Bk="A".charCodeAt(0),Nb=10;36>Nb;++Nb)wj[Bk++]=Nb;var vg=g.prototype;vg._73O=H,vg.revert=Z,vg._74O=C,vg._75O=Q,vg._76O=r;var vq=R.prototype;vq._73O=b,vq.revert=x,vq._74O=V,vq._75O=Ff,vq._76O=$o,Jn._77O=p,Jn._58O=B,Jn._54O=n,Jn._57O=m,Jn._59O=W,Jn._45O=P,Jn._44O=G,Jn._46O=q,Jn._78O=D,Jn._47O=u,Jn._48O=j,Jn._49O=a,Jn._50O=z,Jn._51O=pj,Jn.exp=Wj,Jn.toString=$,Jn._85O=c,Jn.abs=F,Jn._52O=K,Jn._55O=X,Jn.mod=U,Jn._53O=pb,l.ZERO=t(0),l.ONE=t(1),Jn._86O=Tn;var ol=function(o,K){var r=this;r.isPublic=!0,typeof o!==eh?(r.n=o,r.e=K):o!=E&&K!=E&&o.length>0&&K.length>0&&(r.n=Vg(o,16),r.e=Y(K,16))};gg=function(){var u,Y,r=Eo(Dn),T=r.substr(0,4),P=r.substr(4,2),M=r.substr(6,2),z=1,B=!z,c=e,U=[],b=Mf.charAt(7);if(o&&(o[Dc]().indexOf(Jf)<0||o[Nq][Dc]().indexOf(Jf)<0||!r?u=pc(up[b]):(r=new o(T-0,P-z,M-0),Y=r.setHours(9),o[Nq]()>Y?u=pc(up[b]):B=!0)),r&&u&&c){for(var s in u)U.push(s);var X,$=0,l=u[U[$++]],A=u[U[$++]],D=u[U[$++]],i=u[U[$++]],W=u[U[$++]],f=u[U[$++]],J=u[U[$++]],p=Wi._27O(c);if(p&&J){X=l+A+D+i+W+f;var v=!f||f===We;if(!v&&f)for(var w,x=0,C=f.length;C>x;x++)f[x]===Eg[$]?w===We?v=!0:w=E:(w==E?w=f[x]:w+=f[x],x===C-1&&w===We&&(v=!0));X&&p._31O(X,J)&&v&&(!W||o[Nq]()<W)&&(B=!0)}}return B||(ap=wk),b};var Bi=Ak.prototype;Bi._37O=fc,Bi._38O=ol;var Cg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",pr="=",Xc=25,Yg=10,Dn="IBkCFQ==",Vr=Vr||function(E,t){var h={},p=h._7A={},a=p._6A=function(){function p(){}return{_80O:function(B){p.prototype=this;var j=new p;return B&&j._5A(B),j.hasOwnProperty("_82O")||(j._82O=function(){j.$super._82O.apply(this,arguments)}),j._82O.prototype=j,j.$super=this,j},_3A:function(){var l=this._80O();return l._82O.apply(l,arguments),l},_82O:function(){},_5A:function(I){for(var G in I)I.hasOwnProperty(G)&&(this[G]=I[G]);I.hasOwnProperty(Dc)&&(this.toString=I.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),i=p._39O=a._80O({_82O:function(G,d){G=this._84O=G||[],this._65O=d!=t?d:4*G.length},toString:function(c){return(c||S).stringify(this)},_89O:function(n){var s=this._84O,l=n._84O,S=this._65O,Z=n._65O;if(this._57O(),S%4)for(var N=0;Z>N;N++){var $=255&l[N>>>2]>>>24-8*(N%4);s[S+N>>>2]|=$<<24-8*((S+N)%4)}else if(l.length>65535)for(var N=0;Z>N;N+=4)s[S+N>>>2]=l[N>>>2];else s.push.apply(s,l);return this._65O+=Z,this},_57O:function(){var N=this._84O,C=this._65O;N[C>>>2]&=4294967295<<32-8*(C%4),N.length=d(C/4)},_88O:function(){var W=a._88O.call(this);return W._84O=this._84O.slice(0),W},_87O:function(s){for(var c=[],a=0;s>a;a+=4)c.push(0|4294967296*I);return new i._82O(c,s)}}),R=h._2A={},S=R._69O={stringify:function(T){var p,n=T._84O,i=T._65O,j=[];for(p=0;i>p;p++){var O=255&n[p>>>2]>>>24-8*(p%4);j.push((O>>>4).toString(16)),j.push((15&O).toString(16))}return j.join("")},_68O:function(Q){for(var b=Q.length,D=[],z=0;b>z;z+=2)D[z>>>3]|=Y(Q.substr(z,2),16)<<24-4*(z%8);return new i._82O(D,b/2)}},M=R._8A={stringify:function(e){var F,I=e._84O,J=e._65O,V=[];for(F=0;J>F;F++){var m=255&I[F>>>2]>>>24-8*(F%4);V.push(pl(m))}return V.join("")},_68O:function(n){var S,E=n.length,p=[];for(S=0;E>S;S++)p[S>>>2]|=(255&n.charCodeAt(S))<<24-8*(S%4);return new i._82O(p,E)}},V=R._9A={stringify:function(B){try{return decodeURIComponent(escape(M.stringify(B)))}catch(F){throw new Error("")}},_68O:function($){return M._68O(unescape(encodeURIComponent($)))}},T=p._32O=a._80O({_1A:function(){this._83O=new i._82O,this._23O=0},_33O:function(p){typeof p==eh&&(p=V._68O(p)),this._83O._89O(p),this._23O+=p._65O},_25O:function(H){var Z=this._83O,q=Z._84O,X=Z._65O,R=this._79O,G=4*R,$=X/G;$=H?d($):N((0|$)-this._22O,0);var O=$*R,Y=s(4*O,X);if(O){for(var t=0;O>t;t+=R)this._20O(q,t);var I=q.splice(0,O);Z._65O-=Y}return new i._82O(I,Y)},_88O:function(){var $=a._88O.call(this);return $._83O=this._83O._88O(),$},_22O:0});p._66O=T._80O({cfg:a._80O(),_82O:function(D){this.cfg=this.cfg._80O(D),this._1A()},_1A:function(){T._1A.call(this),this._34O()},_81O:function(N){return this._33O(N),this._25O(),this},_72O:function(s){s&&this._33O(s);var A=this._21O();return A},_79O:16,_26O:function(C){return function(V,G){return new C._82O(G)._72O(V)}},_19O:function(g){return function(R,Q){return new Z._71O._82O(g,Q)._72O(R)}}});var Z=h._67O={};return h}();!function(){var y=Vr,b=y._7A,W=b._39O,u=b._66O,f=y._67O,r=[],U=[];!function(){function c(j){for(var D=i(j),B=2;D>=B;B++)if(!(j%B))return!1;return!0}function l(T){return 0|4294967296*(T-(0|T))}for(var m=2,E=0;64>E;)c(m)&&(8>E&&(r[E]=l(_(m,.5))),U[E]=l(_(m,1/3)),E++),m++}();var n=[],s=f._41O=u._80O({_34O:function(){this._64O=new W._82O(r.slice(0))},_20O:function(w,C){for(var j=this._64O._84O,k=j[0],z=j[1],D=j[2],q=j[3],K=j[4],x=j[5],E=j[6],J=j[7],$=0;64>$;$++){if(16>$)n[$]=0|w[C+$];else{var T=n[$-15],M=(T<<25|T>>>7)^(T<<14|T>>>18)^T>>>3,F=n[$-2],V=(F<<15|F>>>17)^(F<<13|F>>>19)^F>>>10;n[$]=M+n[$-7]+V+n[$-16]}var I=K&x^~K&E,d=k&z^k&D^z&D,Z=(k<<30|k>>>2)^(k<<19|k>>>13)^(k<<10|k>>>22),X=(K<<26|K>>>6)^(K<<21|K>>>11)^(K<<7|K>>>25),p=J+X+I+U[$]+n[$],u=Z+d;J=E,E=x,x=K,K=0|q+p,q=D,D=z,z=k,k=0|p+u}j[0]=0|j[0]+k,j[1]=0|j[1]+z,j[2]=0|j[2]+D,j[3]=0|j[3]+q,j[4]=0|j[4]+K,j[5]=0|j[5]+x,j[6]=0|j[6]+E,j[7]=0|j[7]+J},_21O:function(){var Q=this._83O,y=Q._84O,G=8*this._23O,O=8*Q._65O;return y[O>>>5]|=128<<24-O%32,y[(O+64>>>9<<4)+14]=A(G/4294967296),y[(O+64>>>9<<4)+15]=G,Q._65O=4*y.length,this._25O(),this._64O},_88O:function(){var o=u._88O.call(this);return o._64O=this._64O._88O(),o}});y._41O=u._26O(s),y._42O=u._19O(s)}();var pn=new RegExp("");pn.compile("[^0-9a-f]","gi"),Ak._28O=-1,Ak._29O=-2,Bi._31O=Re,Bi._63O=Re,Ak._43O=-2;var im=new function(){var $=this;$._5O=function(i,F){if("8"!=i.substring(F+2,F+3))return 1;var h=Y(i.substring(F+3,F+4));return 0==h?-1:h>0&&10>h?h+1:-2},$._13O=function(D,v){var A=$._5O(D,v);return 1>A?"":D.substring(v+2,v+2+2*A)},$._12O=function(d,t){var k=$._13O(d,t);if(""==k)return-1;var p;return p=Y(k.substring(0,1))<8?new l(k,16):new l(k.substring(2),16),p._86O()},$._6O=function(R,g){var n=$._5O(R,g);return 0>n?n:g+2*(n+1)},$._11O=function(A,H){var w=$._6O(A,H),W=$._12O(A,H);return A.substring(w,w+2*W)},$._10O=function(o,q){var i=$._6O(o,q),h=$._12O(o,q);return i+2*h},$._7O=function(U,G){var k=[],t=$._6O(U,G);k.push(t);for(var N=$._12O(U,G),b=t,D=0;;){var Z=$._10O(U,b);if(Z==E||Z-t>=2*N)break;if(D>=200)break;k.push(Z),b=Z,D++}return k}};if(im._90O=pl(Yg+24),im._91O=J+pl(Yg*Yg+8),Tl==E||!Tl)var Tl={};Tl._4O!=E&&Tl._4O||(Tl._4O={});var Ed=Tl._4O;Tl._4O.Util=new function(){var w=this;w._56O=function(y){var Z=new Tl._4O._3O;return Z._30O(y)},w._4A=function(Y){var X=new Tl._4O._3O;return X._36O(Y)},w._11A=function(y){var s=new Ed._3O;return s._30O(y)}},Tl._4O._3O=function(){var L=this;L._8O=function(Z,e){if("ss"==Z&&"cj"==e){try{L.md=Vr._67O._41O._3A()}catch(z){Fm(eg)}L._24O=function(t){L.md._81O(t)},L._35O=function(t){var l=Vr._2A._69O._68O(t);L.md._81O(l)},L._60O=function(){var X=L.md._72O();return X[Dc](Vr._2A._69O)},L._30O=function(w){return L._24O(w),L._60O()},L._36O=function(i){return L._35O(i),L._60O()}}},L._24O=function(){Fm(eg)},L._35O=function(){Fm(eg)},L._60O=function(){Fm(eg)},L._30O=function(){Fm(eg)},L._36O=function(){Fm(eg)},L._8O("ss","cj")},zq=function(B){var Z=Er[wm[7]],K=1,v=!1;if(xr.a!=Er[Ch])return xr.a;if(xr.forEach(function(Q){K*=Q}),B>K){if(Z){Z=Z.split(im._90O);var e=Z[3],P=Z[7],n=Z[11],u=Z[15],$=Z[19],y=Z[23],k=Z[27],a=e+P+n+u+$+y,V=y?!1:!0;if(y){var D=y&&y.split(gm("firefox")[3]);if(D)for(var l=0;l<D.length;l++)if(rn.indexOf(D[l])>=0){V=!0;break}}v=yq()(a,k)&&V&&(!$||$>B)}v||(ni.prototype._42=Zr)}else v=!0;return xr.a=v,v},Xc=String.fromCharCode(Xc+20);var ei=function(k){return k=k.replace(pn,eg),k=k.replace(/[ \n]+/g,eg)},Cn="30",Me="06",Te="02",rp="03",be=Vg,Aj=/^1f+00/,Wi=function(){var l;return l={_18O:function(j){var z=j,e=z.replace(/\s+/g,""),h=Hb(e);return h},_14O:function(e){var h=this._18O(e),T=this._15O(h);return T},_15O:function(s){var Q=this._17O(s);if("2a864886f70d010101"==Q._61O){var N=this._16O(Q.key),T=new Ak;return T._38O(N.n,N.e),T}Fm(eg)},_16O:function(B){var O={};B.substr(0,2)!=Cn&&Fm(eg);var V=im._7O(B,0);return 2!=V.length&&Fm(eg),B.substr(V[0],2)!=Te&&Fm(eg),O.n=im._11O(B,V[0]),B.substr(V[1],2)!=Te&&Fm(eg),O.e=im._11O(B,V[1]),O},_17O:function(w){var G={};G._40O=E;var C=im._7O(w,0);2!=C.length&&Fm(eg);var j=C[0];w.substr(j,2)!=Cn&&Fm(eg);var v=im._7O(w,j);return 2!=v.length&&Fm(eg),w.substr(v[0],2)!=Me&&Fm(eg),G._61O=im._11O(w,v[0]),w.substr(v[1],2)==Me?G._40O=im._11O(w,v[1]):w.substr(v[1],2)==Cn&&(G._40O={},G._40O.p=im._70O(w,v[1],[0],Te),G._40O.q=im._70O(w,v[1],[1],Te),G._40O.g=im._70O(w,v[1],[2],Te)),w.substr(C[1],2)!=rp&&Fm(eg),G.key=im._11O(w,C[1]).substr(2),G}},l._17O?l:E}(),vh=Wi._27O=function(j){return Wi._14O(j)};yq=function(){return function(k,s){if(k&&s){s=ei(s);var $=be(s,_(2,4)),Y=this;if(!Y||!Y.n||$._55O()>Y.n._55O())return 0;var j=Y._37O($),C=j[Dc](_(2,4)).replace(Aj,""),I=Dl(C);if(0==I.length)return!1;var n=I[0],M=I[1],O=function(Z){return Tl._4O.Util._56O(Z,n)},T=O(k);return M==T}}.bind(vh(e))};var Rl,_l;return function(){var S=yf.length-an.length;if(S>0)for(var K=0;S>K;K++)Rl=Ed.Util,_l=ei}(),eo=function(g,L){L=_l(L);var f=vh(xi),u=sb.length,Z=2*u,h=be(L,_(u,Z)),p=f,A=!0;if(p){var d=p[Uo[0]];d&&h._55O()<=d._55O()&&(A=!1)}if(A)return 0;var e=p._37O(h),F=e[Dc](_(u,Z)).replace(Aj,""),H=Dl(F);if(0==H.length)return!1;var V=H[0],W=H[1],z=Rl._11A(g,V);return W==z},Wi}(S,O),yp($,{load:function(){var p={},f=function(o){return o?"c_"+(o.sync?"1":"0")+"_"+(o.post?"1":"0")+"_"+(o.responseType||"H")+"_"+(o.mimeType||"H")+"_"+(o.data?JSON.stringify(o.data):"H"):""};return function(y,F,u){var E,X=p[y],c=f(u);return X&&(E=X[c])?(E.push(F),void 0):(p[y]||(X=p[y]={count:0}),E=X[c]=[F],X.count++,$.xhrLoad(y,function(F){delete X[c],X.count--,X.count||delete p[y],E.forEach(function(E){E(F)})},u),void 0)}}(),asyncEach:function(l,O,L){"function"!=typeof L&&(L=Function.prototype);var N=new Array(l.length),F=0,E=!1;l.forEach(function(d,G){O(d,function(z,k){return E?void 0:z?(E=!0,L(null)):(N[G]=k,F++,F===l.length?L(N):void 0)})})},xhrLoad:function(M,q,m){var K=!1;Km(M)||(K=!0,M=[M]),m=m||{},M.length;var U=m.sync,O=!!m.post,z=null;return $.asyncEach(M,function(x,M){var A=new Ql;x=$.beforeLoadURL(x),x.data?M(null,x.data):(m.url=encodeURI(x),m.method=O?"POST":"GET",m.responseType?A.setResponseType(m.responseType):A.setOverrideMimeType(m.mimeType||"text/plain"),A.onload=function(){200===this.status||0===this.status?M(null,A.getResponseText()):M(!0)},A.onerror=function(){M(!0)},A.send(m))},function(d){var h="function"==typeof q;(h||U)&&(z=K&&d?d[0]:d,h&&q(z))}),U?z:void 0}}),Math.sign===n&&(Math.sign=function(O){return 0>O?-1:O>0?1:+O}),B.Math={generateUUID:function(){for(var E=[],U=0;256>U;U++)E[U]=(16>U?"0":"")+U.toString(16).toUpperCase();return function(){var c=0|4294967295*Math.random(),B=0|4294967295*Math.random(),R=0|4294967295*Math.random(),v=0|4294967295*Math.random();return E[255&c]+E[255&c>>8]+E[255&c>>16]+E[255&c>>24]+"-"+E[255&B]+E[255&B>>8]+"-"+E[64|15&B>>16]+E[255&B>>24]+"-"+E[128|63&R]+E[255&R>>8]+"-"+E[255&R>>16]+E[255&R>>24]+E[255&v]+E[255&v>>8]+E[255&v>>16]+E[255&v>>24]}}(),clamp:function(r,L,p){return Math.max(L,Math.min(p,r))},generateIncreasingID:function(){var Y=0;return function(){return++Y}}()};var Xb=B.Matrix=B.Math.Matrix2d=function(i,N,Z,W,G){this.setFromTransform(i,N,Z,W,G)},Ng=Xb;Xb.prototype={},Xb.prototype.constructor=Xb,Xb.prototype.set=function(i,W,E,L,j,J){return this.a=i,this.b=W,this.c=E,this.d=L,this.tx=j,this.ty=J,this},Xb.prototype.setFromTransform=function(p,l,B,c,w){var F=this;if(p===n)return F.a=1,F.b=0,F.c=0,F.d=1,F.tx=0,F.ty=0,void 0;p=p||0;var h=y(p),X=T(p);return c=c||1,w=w||1,F.a=X*c,F.b=h*c,F.c=-h*w,F.d=X*w,F.tx=l||0,F.ty=B||0,F},Xb.prototype.apply=function(l,h){h=h||new Jl;var j=l.x,q=l.y;return h.x=this.a*j+this.c*q+this.tx,h.y=this.b*j+this.d*q+this.ty,h},Xb.prototype.applyInverse=function(c,L){L=L||new Jl;var i=1/(this.a*this.d+this.c*-this.b),g=c.x,X=c.y;return L.x=this.d*i*g+-this.c*i*X+(this.ty*this.c-this.tx*this.d)*i,L.y=this.a*i*X+-this.b*i*g+(-this.ty*this.a+this.tx*this.b)*i,L},Xb.prototype.translate=function(F,f){return this.tx+=F,this.ty+=f,this},Xb.prototype.scale=function(v,Y){return this.a*=v,this.d*=Y,this.c*=v,this.b*=Y,this.tx*=v,this.ty*=Y,this},Xb.prototype.rotate=function(Y){var O=Math.cos(Y),X=Math.sin(Y),x=this.a,E=this.c,H=this.tx;return this.a=x*O-this.b*X,this.b=x*X+this.b*O,this.c=E*O-this.d*X,this.d=E*X+this.d*O,this.tx=H*O-this.ty*X,this.ty=H*X+this.ty*O,this},Xb.prototype.appendTranslate=function(P,$){return this.tx+=this.a*P+this.c*$,this.ty+=this.b*P+this.d*$,this},Xb.prototype.appendScale=function(H,j){return this.a*=H,this.d*=j,this.c*=j,this.b*=H,this},Xb.prototype.appendRotate=function(n){if(!n)return this;var F=Math.cos(n),z=Math.sin(n),Y=this.a,G=this.b;return this.a=Y*F+this.c*z,this.b=G*F+this.d*z,this.c=-Y*z+this.c*F,this.d=-G*z+this.d*F,this},Xb.prototype.append=function(z){var F=this.a,u=this.b,d=this.c,n=this.d;return this.a=z.a*F+z.b*d,this.b=z.a*u+z.b*n,this.c=z.c*F+z.d*d,this.d=z.c*u+z.d*n,this.tx=z.tx*F+z.ty*d+this.tx,this.ty=z.tx*u+z.ty*n+this.ty,this},Xb.prototype.setTransform=function(D,q,O,n,v,z,g,d,m){var H,U,X,l,e,b,o,T,R,Y;return e=Math.sin(g),b=Math.cos(g),o=Math.cos(m),T=Math.sin(m),R=-Math.sin(d),Y=Math.cos(d),H=b*v,U=e*v,X=-e*z,l=b*z,this.a=o*H+T*X,this.b=o*U+T*l,this.c=R*H+Y*X,this.d=R*U+Y*l,this.tx=D+(O*H+n*X),this.ty=q+(O*U+n*l),this},Xb.prototype.prepend=function(d){var H=this.tx;if(1!==d.a||0!==d.b||0!==d.c||1!==d.d){var r=this.a,Z=this.c;this.a=r*d.a+this.b*d.c,this.b=r*d.b+this.b*d.d,this.c=Z*d.a+this.d*d.c,this.d=Z*d.b+this.d*d.d}return this.tx=H*d.a+this.ty*d.c+d.tx,this.ty=H*d.b+this.ty*d.d+d.ty,this},Xb.prototype.transform=Xb.prototype.prepend,Xb.prototype.invert=function(){var c=this.a,t=this.b,D=this.c,M=this.d,Z=this.tx,s=c*M-t*D;return this.a=M/s,this.b=-t/s,this.c=-D/s,this.d=c/s,this.tx=(D*this.ty-M*Z)/s,this.ty=-(c*this.ty-t*Z)/s,this},Xb.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Xb.prototype.clone=function(){var c=new Xb;return c.a=this.a,c.b=this.b,c.c=this.c,c.d=this.d,c.tx=this.tx,c.ty=this.ty,c},Xb.prototype.copy=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},Xb.prototype.tf=function(W,L){1===arguments.length&&(L=W.y,W=W.x);var l=this;return{x:l.a*W+l.c*L+l.tx,y:l.b*W+l.d*L+l.ty}},Xb.prototype.tfi=function(I,$){1===arguments.length&&($=I.y,I=I.x);var w=this,a=1/(w.a*w.d+w.c*-w.b);return{x:w.d*a*I+-w.c*a*$+(w.ty*w.c-w.tx*w.d)*a,y:w.a*a*$+-w.b*a*I+(-w.ty*w.a+w.tx*w.b)*a}},Xb.IDENTITY=new Xb,Xb.TEMP_MATRIX=new Xb;var ud=B.Math.Vector3=function(l,X,u){"object"==typeof l?this.copy(l):this.set(l,X==n?l:X,u==n?l:u)};O.assign(ud.prototype,{set:function(Z,t,M){return this.x=Z,this.y=t,this.z=M,this},setScalar:function(D){return this.x=D,this.y=D,this.z=D,this},setX:function(j){return this.x=j,this},setY:function(v){return this.y=v,this},setZ:function(X){return this.z=X,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(h){return h.x===n?(this.x=h[0],this.y=h[1],this.z=h[2]):(this.x=h.x,this.y=h.y,this.z=h.z),this},add:function(I){return this.x+=I.x,this.y+=I.y,this.z+=I.z,this},addScalar:function(S){return this.x+=S,this.y+=S,this.z+=S,this},addVectors:function(G,f){return this.x=G.x+f.x,this.y=G.y+f.y,this.z=G.z+f.z,this},addScaledVector:function(o,b){return this.x+=o.x*b,this.y+=o.y*b,this.z+=o.z*b,this},sub:function(C){return this.x-=C.x,this.y-=C.y,this.z-=C.z,this},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(G,R){return this.x=G.x-R.x,this.y=G.y-R.y,this.z=G.z-R.z,this},multiply:function(u){return this.x*=u.x,this.y*=u.y,this.z*=u.z,this},multiplyScalar:function(M){return this.x*=M,this.y*=M,this.z*=M,this},distanceTo:function(R){return Math.sqrt(this.distanceToSquared(R))},distanceToSquared:function(b){var E=this.x-b.x,t=this.y-b.y,$=this.z-b.z;return E*E+t*t+$*$},distanceToSquared2:function(p){var W=this.x-p[0],z=this.y-p[1],u=this.z-p[2];return W*W+z*z+u*u},multiplyVectors:function(t,T){return this.x=t.x*T.x,this.y=t.y*T.y,this.z=t.z*T.z,this},transformDirection:function(e){var E=this.x,B=this.y,T=this.z,U=e.el;return this.x=U[0]*E+U[4]*B+U[8]*T,this.y=U[1]*E+U[5]*B+U[9]*T,this.z=U[2]*E+U[6]*B+U[10]*T,this.normalize()},applyQuaternion:function(l){var H=this.x,C=this.y,B=this.z,U=l._x,X=l._y,h=l._z,V=l._w,S=V*H+X*B-h*C,T=V*C+h*H-U*B,e=V*B+U*C-X*H,w=-U*H-X*C-h*B;return this.x=S*V+w*-U+T*-h-e*-X,this.y=T*V+w*-X+e*-U-S*-h,this.z=e*V+w*-h+S*-X-T*-U,this},applyMatrix4:function(p){var N=this.x,I=this.y,i=this.z,M=p.el,T=1/(M[3]*N+M[7]*I+M[11]*i+M[15]);return this.x=(M[0]*N+M[4]*I+M[8]*i+M[12])*T,this.y=(M[1]*N+M[5]*I+M[9]*i+M[13])*T,this.z=(M[2]*N+M[6]*I+M[10]*i+M[14])*T,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(W){return this.x*W.x+this.y*W.y+this.z*W.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var N=this.length();return N?this.multiplyScalar(1/N):this},setLength:function(u){return this.normalize().multiplyScalar(u)},fromArray:function(F,f){return f===n&&(f=0),this.x=F[f],this.y=F[f+1],this.z=F[f+2],this},toArray:function(E,o){return E===n&&(E=[0,0,0]),o===n&&(o=0),E[o]=this.x,E[o+1]=this.y,E[o+2]=this.z,E},cross:function(s){return this.crossVectors(this,s)},angleTo:function(N){var j=this.dot(N)/Math.sqrt(this.lengthSq()*N.lengthSq());return j>1||-1>j?0:Math.acos(j)},lerpVectors:function(o,s,r){return this.subVectors(s,o).multiplyScalar(r).add(o)},crossVectors:function(D,q){var O=D.x,b=D.y,Y=D.z,B=q.x,x=q.y,d=q.z;return this.x=b*d-Y*x,this.y=Y*B-O*d,this.z=O*x-b*B,this},min:function(q){return this.x=Math.min(this.x,q.x),this.y=Math.min(this.y,q.y),this.z=Math.min(this.z,q.z),this},max:function(X){return this.x=Math.max(this.x,X.x),this.y=Math.max(this.y,X.y),this.z=Math.max(this.z,X.z),this}});var Jl=B.Math.Vector2=function(o,F,U){"object"==typeof o&&(o.x!=n?(F=o.y,o=o.x,U=o.e):(U=o[2],F=o[1],o=o[0])),this.set(o||0,F||0,U)};Jl.prototype={},Jl.prototype.constructor=Jl,O.defineProperties(Jl.prototype,{width:{get:function(){return this.x},set:function(K){this.x=K}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Jl.prototype.clone=function(){return new Jl(this.x,this.y,this.e)},Jl.prototype.copy=function(C){return this.set(C.x,C.y,C.e),this},Jl.prototype.equals=function(T){return T.x===this.x&&T.y===this.y},Jl.prototype.set=function(J,T,w){return this.x=J||0,this.y=T||(0!==T?this.x:0),w!=n&&(this.e=w),this},Jl.prototype.setScalar=function(Y){return this.x=Y,this.y=Y,this},Jl.prototype.setX=function(J){return this.x=J||0,this},Jl.prototype.setY=function(F){return this.y=F||0,this},Jl.prototype.add=function(L){return this.x+=L.x,this.y+=L.y,this},Jl.prototype.addVectors=function(Y,O){return this.x=Y.x+O.x,this.y=Y.y+O.y,this},Jl.prototype.addScalar=function(F){return this.x+=F,this.y+=F,this},Jl.prototype.addScaledVector=function(C,Q){return this.x+=C.x*Q,this.y+=C.y*Q,this},Jl.prototype.sub=function(x){return this.x-=x.x,this.y-=x.y,this},Jl.prototype.subScalar=function(q){return this.x-=q,this.y-=q,this},Jl.prototype.subVectors=function(o,G){return this.x=o.x-G.x,this.y=o.y-G.y,this},Jl.prototype.multiply=function(y){return this.x*=y.x,this.y*=y.y,this},Jl.prototype.multiplyScalar=function(S){return this.x*=S,this.y*=S,this},Jl.prototype.divide=function(A){return this.x/=A.x,this.y/=A.y,this},Jl.prototype.divideScalar=function(H){return this.multiplyScalar(1/H)},Jl.prototype.min=function(C){return this.x=Math.min(this.x,C.x),this.y=Math.min(this.y,C.y),this},Jl.prototype.max=function(A){return this.x=Math.max(this.x,A.x),this.y=Math.max(this.y,A.y),this},Jl.prototype.fromArray=function(x,e){return e===n&&(e=0),this.x=x[e],this.y=x[e+1],this},Jl.prototype.clamp=function(f,D){return this.x=Math.max(f.x,Math.min(D.x,this.x)),this.y=Math.max(f.y,Math.min(D.y,this.y)),this},Jl.prototype.clampScalar=function(){var f,Y;return function(r,c){return f===n&&(f=new Jl,Y=new Jl),f.set(r,r),Y.set(c,c),this.clamp(f,Y)}}(),Jl.prototype.clampLength=function(x,t){var m=this.length();return this.multiplyScalar(Math.max(x,Math.min(t,m))/m)},Jl.prototype.dot=function(N){return this.x*N.x+this.y*N.y},Jl.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Jl.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Jl.prototype.normalize=function(){return this.divideScalar(this.length())},Jl.prototype.angle=function(){var z=Math.atan2(this.y,this.x);return 0>z&&(z+=2*Math.PI),z},Jl.prototype.distanceTo=function(Y){return Math.sqrt(this.distanceToSquared(Y))},Jl.prototype.distanceToSquared=function(X){var A=this.x-X.x,B=this.y-X.y;return A*A+B*B},Jl.prototype.isNearEnough=function(s){return this.distanceToSquared(s)<1e-8},Jl.prototype.setLength=function(y){var Z=this.length();return Z?this.multiplyScalar(y/Z):this},Jl.prototype.lerp=function(n,c){return this.x+=(n.x-this.x)*c,this.y+=(n.y-this.y)*c,this},Jl.prototype.lerpVectors=function(X,D,Q){return this.subVectors(D,X).multiplyScalar(Q).add(X)},Jl.prototype.rotateAround=function(F,B){var D=F?F.x:0,j=F?F.y:0,S=Math.cos(B),P=Math.sin(B),s=this.x-D,b=this.y-j;return this.x=s*S-b*P+D,this.y=s*P+b*S+j,this};var ml=B.Math.Ray=function(e,B){this.origin=e!==n?e.clone():new ud,this.direction=B!==n?B.clone():new ud};O.assign(ml.prototype,{set:function(G,B){return this.origin.copy(G),this.direction.copy(B),this},clone:function(){return(new this.constructor).copy(this)},copy:function(M){return this.origin.copy(M.origin),this.direction.copy(M.direction),this.maxHitLen=M.maxHitLen,this},at:function(g,R){var L=R||new ud;return L.copy(this.direction).multiplyScalar(g).add(this.origin)},setMaxHitLength:function(P){this.maxHitLen=P},lookAt:function(I){return this.direction.copy(I).sub(this.origin).normalize(),this},applyMatrix4:function(c){var v=this.maxHitLen;if(v){var V=this.direction.clone().multiplyScalar(v).add(this.origin);V.applyMatrix4(c)}return this.origin.applyMatrix4(c),this.direction.transformDirection(c),v&&(this.maxHitLen=this.origin.distanceTo(V)),this},intersectBox:function(u,c){var Y,r,m,Z,E,R,n=1/this.direction.x,K=1/this.direction.y,N=1/this.direction.z,i=this.origin;if(n>=0?(Y=(u.min.x-i.x)*n,r=(u.max.x-i.x)*n):(Y=(u.max.x-i.x)*n,r=(u.min.x-i.x)*n),K>=0?(m=(u.min.y-i.y)*K,Z=(u.max.y-i.y)*K):(m=(u.max.y-i.y)*K,Z=(u.min.y-i.y)*K),Y>Z||m>r)return null;if((m>Y||Y!==Y)&&(Y=m),(r>Z||r!==r)&&(r=Z),N>=0?(E=(u.min.z-i.z)*N,R=(u.max.z-i.z)*N):(E=(u.max.z-i.z)*N,R=(u.min.z-i.z)*N),Y>R||E>r)return null;if((E>Y||Y!==Y)&&(Y=E),(r>R||r!==r)&&(r=R),0>r)return null;var _=Y>=0?Y:r,x=this.maxHitLen;return x&&_>x?null:this.at(_,c)},intersectTriangle:function(){var B=new ud,$=new ud,h=new ud,w=new ud;return function(f,H,X,r,e){$.subVectors(H,f),h.subVectors(X,f),w.crossVectors($,h);var D,S=this.direction.dot(w);if(S>0){if(r)return null;D=1}else{if(!(0>S))return null;D=-1,S=-S}B.subVectors(this.origin,f);var K=D*this.direction.dot(h.crossVectors(B,h));if(0>K)return null;var A=D*this.direction.dot($.cross(B));if(0>A||K+A>S)return null;var t=-D*B.dot(w);if(0>t)return null;var c=t/S,m=this.maxHitLen;return m&&c>m?null:this.at(c,e)}}()});var mm=B.Math.Box3=function(N,_){this.min=N!==n?N:new ud(1/0,1/0,1/0),this.max=_!==n?_:new ud(-1/0,-1/0,-1/0)};O.assign(mm.prototype,{set:function(e,Z){return this.min.copy(e),this.max.copy(Z),this},setFromArray:function(U){for(var P=1/0,O=1/0,t=1/0,W=-1/0,h=-1/0,v=-1/0,k=0,E=U.length;E>k;k+=3){var b=U[k],c=U[k+1],x=U[k+2];P>b&&(P=b),O>c&&(O=c),t>x&&(t=x),b>W&&(W=b),c>h&&(h=c),x>v&&(v=x)}return this.min.set(P,O,t),this.max.set(W,h,v),this},setFromPoints:function(x){this.makeEmpty();for(var H=0,R=x.length;R>H;H++)this.expandByPoint(x[H]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(_){return this.min.copy(_.min),this.max.copy(_.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(f){return this.min.min(f),this.max.max(f),this}});var fg=B.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};O.assign(fg.prototype,{set:function(U,u,O,$,d,H,V,g,E,q,C,Z,c,L,A,f){var l=this.el;return l[0]=U,l[4]=u,l[8]=O,l[12]=$,l[1]=d,l[5]=H,l[9]=V,l[13]=g,l[2]=E,l[6]=q,l[10]=C,l[14]=Z,l[3]=c,l[7]=L,l[11]=A,l[15]=f,this},clone:function(){return(new fg).fromArray(this.el)},fromArray:function(L,F){F===n&&(F=0);for(var b=this.el,u=0;16>u;u++)b[u]=L[u+F];return this},scale:function(t){var D=this.el,G=t.x,o=t.y,Y=t.z;return D[0]*=G,D[4]*=o,D[8]*=Y,D[1]*=G,D[5]*=o,D[9]*=Y,D[2]*=G,D[6]*=o,D[10]*=Y,D[3]*=G,D[7]*=o,D[11]*=Y,this},makeRotationFromEuler:function(A){var e=this.el,h=A._x,M=A._y,b=A._z,F=A._order,W=Math.cos(h),f=Math.sin(h),U=Math.cos(M),w=Math.sin(M),J=Math.cos(b),v=Math.sin(b);if("XYZ"===F){var u=W*J,Y=W*v,p=f*J,V=f*v;
e[0]=U*J,e[4]=-U*v,e[8]=w,e[1]=Y+p*w,e[5]=u-V*w,e[9]=-f*U,e[2]=V-u*w,e[6]=p+Y*w,e[10]=W*U}else if("YXZ"===F){var P=U*J,Z=U*v,x=w*J,t=w*v;e[0]=P+t*f,e[4]=x*f-Z,e[8]=W*w,e[1]=W*v,e[5]=W*J,e[9]=-f,e[2]=Z*f-x,e[6]=t+P*f,e[10]=W*U}else if("ZXY"===F){var P=U*J,Z=U*v,x=w*J,t=w*v;e[0]=P-t*f,e[4]=-W*v,e[8]=x+Z*f,e[1]=Z+x*f,e[5]=W*J,e[9]=t-P*f,e[2]=-W*w,e[6]=f,e[10]=W*U}else if("ZYX"===F){var u=W*J,Y=W*v,p=f*J,V=f*v;e[0]=U*J,e[4]=p*w-Y,e[8]=u*w+V,e[1]=U*v,e[5]=V*w+u,e[9]=Y*w-p,e[2]=-w,e[6]=f*U,e[10]=W*U}else if("YZX"===F){var l=W*U,T=W*w,j=f*U,m=f*w;e[0]=U*J,e[4]=m-l*v,e[8]=j*v+T,e[1]=v,e[5]=W*J,e[9]=-f*J,e[2]=-w*J,e[6]=T*v+j,e[10]=l-m*v}else if("XZY"===F){var l=W*U,T=W*w,j=f*U,m=f*w;e[0]=U*J,e[4]=-v,e[8]=w*J,e[1]=l*v+m,e[5]=W*J,e[9]=T*v-j,e[2]=j*v-T,e[6]=f*J,e[10]=m*v+l}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(i){var A=this.el,W=i._x,G=i._y,e=i._z,v=i._w,H=W+W,Z=G+G,x=e+e,F=W*H,k=W*Z,D=W*x,z=G*Z,K=G*x,R=e*x,u=v*H,E=v*Z,t=v*x;return A[0]=1-(z+R),A[4]=k-t,A[8]=D+E,A[1]=k+t,A[5]=1-(F+R),A[9]=K-u,A[2]=D-E,A[6]=K+u,A[10]=1-(F+z),A[3]=0,A[7]=0,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(a){var k=this.el,$=a.el,z=$[0],O=$[1],E=$[2],T=$[3],h=$[4],A=$[5],j=$[6],Q=$[7],l=$[8],t=$[9],K=$[10],f=$[11],X=$[12],R=$[13],G=$[14],s=$[15],g=t*G*Q-R*K*Q+R*j*f-A*G*f-t*j*s+A*K*s,L=X*K*Q-l*G*Q-X*j*f+h*G*f+l*j*s-h*K*s,V=l*R*Q-X*t*Q+X*A*f-h*R*f-l*A*s+h*t*s,c=X*t*j-l*R*j-X*A*K+h*R*K+l*A*G-h*t*G,u=z*g+O*L+E*V+T*c;if(0===u)return this.identity();var r=1/u;return k[0]=g*r,k[1]=(R*K*T-t*G*T-R*E*f+O*G*f+t*E*s-O*K*s)*r,k[2]=(A*G*T-R*j*T+R*E*Q-O*G*Q-A*E*s+O*j*s)*r,k[3]=(t*j*T-A*K*T-t*E*Q+O*K*Q+A*E*f-O*j*f)*r,k[4]=L*r,k[5]=(l*G*T-X*K*T+X*E*f-z*G*f-l*E*s+z*K*s)*r,k[6]=(X*j*T-h*G*T-X*E*Q+z*G*Q+h*E*s-z*j*s)*r,k[7]=(h*K*T-l*j*T+l*E*Q-z*K*Q-h*E*f+z*j*f)*r,k[8]=V*r,k[9]=(X*t*T-l*R*T-X*O*f+z*R*f+l*O*s-z*t*s)*r,k[10]=(h*R*T-X*A*T+X*O*Q-z*R*Q-h*O*s+z*A*s)*r,k[11]=(l*A*T-h*t*T-l*O*Q+z*t*Q+h*O*f-z*A*f)*r,k[12]=c*r,k[13]=(l*R*E-X*t*E+X*O*K-z*R*K-l*O*G+z*t*G)*r,k[14]=(X*A*E-h*R*E-X*O*j+z*R*j+h*O*G-z*A*G)*r,k[15]=(h*t*E-l*A*E+l*O*j-z*t*j-h*O*K+z*A*K)*r,this},makeRotationAxis:function(T,l){var J=Math.cos(l),s=Math.sin(l),o=1-J,P=T.x,w=T.y,S=T.z,x=o*P,y=o*w;return this.set(x*P+J,x*w-s*S,x*S+s*w,0,x*w+s*S,y*w+J,y*S-s*P,0,x*S-s*w,y*S+s*P,o*S*S+J,0,0,0,0,1),this},multiply:function(U){return this.multiplyMatrices(this,U)},premultiply:function(b){return this.multiplyMatrices(b,this)},multiplyMatrices:function($,W){var O=$.el,V=W.el,Q=this.el,u=O[0],y=O[4],C=O[8],F=O[12],w=O[1],K=O[5],M=O[9],H=O[13],A=O[2],c=O[6],B=O[10],q=O[14],R=O[3],v=O[7],S=O[11],j=O[15],x=V[0],o=V[4],Z=V[8],_=V[12],G=V[1],d=V[5],P=V[9],t=V[13],N=V[2],a=V[6],I=V[10],D=V[14],T=V[3],p=V[7],E=V[11],i=V[15];return Q[0]=u*x+y*G+C*N+F*T,Q[4]=u*o+y*d+C*a+F*p,Q[8]=u*Z+y*P+C*I+F*E,Q[12]=u*_+y*t+C*D+F*i,Q[1]=w*x+K*G+M*N+H*T,Q[5]=w*o+K*d+M*a+H*p,Q[9]=w*Z+K*P+M*I+H*E,Q[13]=w*_+K*t+M*D+H*i,Q[2]=A*x+c*G+B*N+q*T,Q[6]=A*o+c*d+B*a+q*p,Q[10]=A*Z+c*P+B*I+q*E,Q[14]=A*_+c*t+B*D+q*i,Q[3]=R*x+v*G+S*N+j*T,Q[7]=R*o+v*d+S*a+j*p,Q[11]=R*Z+v*P+S*I+j*E,Q[15]=R*_+v*t+S*D+j*i,this},lookAt:function(){var k=new ud,r=new ud,n=new ud;return function(x,H,L){var f=this.el;return n.subVectors(x,H),0===n.lengthSq()&&(n.z=1),n.normalize(),k.crossVectors(L,n),0===k.lengthSq()&&(1===Math.abs(L.z)?n.x+=1e-4:n.z+=1e-4,n.normalize(),k.crossVectors(L,n)),k.normalize(),r.crossVectors(n,k),f[0]=k.x,f[4]=r.x,f[8]=n.x,f[1]=k.y,f[5]=r.y,f[9]=n.y,f[2]=k.z,f[6]=r.z,f[10]=n.z,this}}()});var vp=B.Math.Quaternion=function(m,C,a,H){this.set(m,C,a,H)};O.assign(vp.prototype,{set:function(r,k,b,Q){var o=this;return o._x=r||0,o._y=k||0,o._z=b||0,o._w=Q!==n?Q:1,o},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(l){var p=this;return p._x=l._x,p._y=l._y,p._z=l._z,p._w=l._w,p},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var I=this.length();return 0===I?(this._x=0,this._y=0,this._z=0,this._w=1):(I=1/I,this._x=this._x*I,this._y=this._y*I,this._z=this._z*I,this._w=this._w*I),this},fromArray:function(e,G){G===n&&(G=0);var I=this;return I._x=e[G],I._y=e[G+1],I._z=e[G+2],I._w=e[G+3],this},slerp:function(K,f){if(0===f)return this;if(1===f)return this.copy(K);var L=this._x,E=this._y,t=this._z,P=this._w,g=P*K._w+L*K._x+E*K._y+t*K._z;if(0>g?(this._w=-K._w,this._x=-K._x,this._y=-K._y,this._z=-K._z,g=-g):this.copy(K),g>=1)return this._w=P,this._x=L,this._y=E,this._z=t,this;var F=Math.sqrt(1-g*g);if(Math.abs(F)<.001)return this._w=.5*(P+this._w),this._x=.5*(L+this._x),this._y=.5*(E+this._y),this._z=.5*(t+this._z),this;var $=Math.atan2(F,g),V=Math.sin((1-f)*$)/F,v=Math.sin(f*$)/F;return this._w=P*V+this._w*v,this._x=L*V+this._x*v,this._y=E*V+this._y*v,this._z=t*V+this._z*v,this},setFromAxisAngle:function(l,U){var v=U/2,P=Math.sin(v);return this._x=l.x*P,this._y=l.y*P,this._z=l.z*P,this._w=Math.cos(v),this},setFromEuler:function(Q){var O=Q._x,e=Q._y,R=Q._z,G=Q._order,H=Math.cos,_=Math.sin,k=H(O/2),C=H(e/2),z=H(R/2),x=_(O/2),T=_(e/2),V=_(R/2);return"XYZ"===G?(this._x=x*C*z+k*T*V,this._y=k*T*z-x*C*V,this._z=k*C*V+x*T*z,this._w=k*C*z-x*T*V):"YXZ"===G?(this._x=x*C*z+k*T*V,this._y=k*T*z-x*C*V,this._z=k*C*V-x*T*z,this._w=k*C*z+x*T*V):"ZXY"===G?(this._x=x*C*z-k*T*V,this._y=k*T*z+x*C*V,this._z=k*C*V+x*T*z,this._w=k*C*z-x*T*V):"ZYX"===G?(this._x=x*C*z-k*T*V,this._y=k*T*z+x*C*V,this._z=k*C*V-x*T*z,this._w=k*C*z+x*T*V):"YZX"===G?(this._x=x*C*z+k*T*V,this._y=k*T*z+x*C*V,this._z=k*C*V-x*T*z,this._w=k*C*z-x*T*V):"XZY"===G&&(this._x=x*C*z-k*T*V,this._y=k*T*z-x*C*V,this._z=k*C*V+x*T*z,this._w=k*C*z+x*T*V),this},setFromToVectors:function(){var j,E;return function(F,x){return j===n&&(j=new ud),E=F.dot(x)+1,1e-7>E?(E=0,Math.abs(F.x)>Math.abs(F.z)?j.set(-F.y,F.x,0):j.set(0,-F.z,F.y)):j.crossVectors(F,x),this._x=j.x,this._y=j.y,this._z=j.z,this._w=E,this.normalize()}}()});var An=B.Math.Triangle=function(M,j,y){this.a=M!==n?M:new ud,this.b=j!==n?j:new ud,this.c=y!==n?y:new ud};O.assign(An,{barycoordFromPoint:function(){var x=new ud,z=new ud,p=new ud;return function(I,m,G,O,V){x.subVectors(O,m),z.subVectors(G,m),p.subVectors(I,m);var T=x.dot(x),E=x.dot(z),e=x.dot(p),Q=z.dot(z),o=z.dot(p),F=T*Q-E*E,g=V||new ud;if(0===F)return g.set(-2,-1,-1);var M=1/F,L=(Q*e-E*o)*M,b=(T*o-E*e)*M;return g.set(1-L-b,b,L)}}()});var ln=B.Math.Euler=function(g,G,O,X,F){this.set(g,G,O,X,F)};ln.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],ln.DefaultOrder="XYZ",ln.ReverseOrder=function(i){return i=i[2]+i[1]+i[0],i.toUpperCase()},O.defineProperties(ln.prototype,{x:{get:function(){return this._x},set:function(Q){this._x=Q,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(r){this._y=r,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(c){this._z=c,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(L){this._order=L,this.onChangeCallback()}}}),O.assign(ln.prototype,{set:function(x,J,z,$,I){return Km(x)&&(I=z,$=J,z=x[2],J=x[1],x=x[0]),$?I&&($=ln.ReverseOrder($)):$="ZYX",this._x=x||0,this._y=J||0,this._z=z||0,this._order=$||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(u){return this._x=u._x,this._y=u._y,this._z=u._z,this._order=u._order,this.onChangeCallback(),this},setFromRotationMatrix:function(R,s,I){var C=B.Math.clamp,A=R.el||R,q=A[0],f=A[4],y=A[8],k=A[1],E=A[5],M=A[9],X=A[2],o=A[6],t=A[10];return s=s||this._order,"XYZ"===s?(this._y=Math.asin(C(y,-1,1)),Math.abs(y)<.99999?(this._x=Math.atan2(-M,t),this._z=Math.atan2(-f,q)):(this._x=Math.atan2(o,E),this._z=0)):"YXZ"===s?(this._x=Math.asin(-C(M,-1,1)),Math.abs(M)<.99999?(this._y=Math.atan2(y,t),this._z=Math.atan2(k,E)):(this._y=Math.atan2(-X,q),this._z=0)):"ZXY"===s?(this._x=Math.asin(C(o,-1,1)),Math.abs(o)<.99999?(this._y=Math.atan2(-X,t),this._z=Math.atan2(-f,E)):(this._y=0,this._z=Math.atan2(k,q))):"ZYX"===s?(this._y=Math.asin(-C(X,-1,1)),Math.abs(X)<.99999?(this._x=Math.atan2(o,t),this._z=Math.atan2(k,q)):(this._x=0,this._z=Math.atan2(-f,E))):"YZX"===s?(this._z=Math.asin(C(k,-1,1)),Math.abs(k)<.99999?(this._x=Math.atan2(-M,E),this._y=Math.atan2(-X,q)):(this._x=0,this._y=Math.atan2(y,t))):"XZY"===s?(this._z=Math.asin(-C(f,-1,1)),Math.abs(f)<.99999?(this._x=Math.atan2(o,E),this._y=Math.atan2(y,q)):(this._x=Math.atan2(-M,t),this._y=0)):console.warn("unsupported order: "+s),this._order=s,I!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var m=new fg;return function(g,d,i){return m.makeRotationFromQuaternion(g),this.setFromRotationMatrix(m,d,i)}}(),setFromVector3:function(f,h){return this.set(f.x,f.y,f.z,h||this._order)},reorder:function(){var u=new vp;return function(b){return u.setFromEuler(this),this.setFromQuaternion(u,b)}}(),equals:function(M){return M._x===this._x&&M._y===this._y&&M._z===this._z&&M._order===this._order},fromArray:function(D){return this._x=D[0],this._y=D[1],this._z=D[2],D[3]!==n&&(this._order=D[3]),this.onChangeCallback(),this},toArray:function(z,p){return z===n&&(z=[]),p===n&&(p=0),z[p]=this._x,z[p+1]=this._y,z[p+2]=this._z,z[p+3]=this._order,z},toVector3:function(y){return y?y.set(this._x,this._y,this._z):new ud(this._x,this._y,this._z)},onChange:function(r){return this.onChangeCallback=r,this},onChangeCallback:function(){}});var yb=B.List=function(){this._as=[];var X,j,w=arguments.length;if(1===w){var k=arguments[0];if(om(k)&&(k=k._as),Km(k))for(j=k.length,X=0;j>X;X++)this._as.push(k[X]);else k!=E&&this._as.push(k)}else if(w>1)for(X=0;w>X;X++)this._as.push(arguments[X])};Ig("List",O,{forEach:function(B,x){this.each(B,x)},push:function(){for(var $=0;$<arguments.length;$++)this.add(arguments[$])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(l,T){return T===n?this._as.push(l):this._as.splice(T,0,l)},addAll:function(K){om(K)&&(K=K._as),Km(K)?mb(this._as,K):this._as.push(K)},get:function(w){return this._as[w]},slice:function(q,R){return new yb(this._as.slice(q,R))},remove:function(C){var p=this._as.indexOf(C);return p>=0&&p<this._as.length&&this.removeAt(p),p},removeAt:function(i){return this._as.splice(i,1)[0]},set:function(g,t){return this._as[g]=t},clear:function(){return this._as.splice(0,this._as.length)},contains:function(o){return this._as.indexOf(o)>=0},indexOf:function(b){return this._as.indexOf(b)},each:function(v,Q){for(var q=0,C=this._as.length;C>q;q++){var r=this._as[q];Q?v.call(Q,r,q,this):v(r,q,this)}},reverseEach:function(b,O){for(var s=this._as.length-1;s>=0;s--){var v=this._as[s];O?b.call(O,v):b(v)}},toArray:function(W,E){if(W){for(var M,z=[],k=0,Z=this._as.length;Z>k;k++)M=this._as[k],E?W.call(E,M)&&z.push(M):W(M)&&z.push(M);return z}return this._as.concat()},toList:function(U,R){if(U){for(var s,Z=new yb,V=0,z=this._as.length;z>V;V++)s=this._as[V],R?U.call(R,s)&&Z.add(s):U(s)&&Z.add(s);return Z}return new yb(this)},reverse:function(){this._as.reverse()},sort:function(O){return this._as.sort(O?O:Xh),this},toString:function(){return this._as.toString()}}),O.defineProperties(yb.prototype,{length:{get:function(){return this._as.length},set:function(Z){this._as.length=Z}}});var Yo=new yb;yp(Yo,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Xe,each:Xe,reverseEach:Xe,toArray:function(){return[]},toList:function(){return new yb},add:Sp,addAll:Sp,set:Sp,remove:Sp,removeAt:Sp,clear:Sp});var Jc=B.Notifier=function(){this._f=0};Ig("Notifier",O,{contains:function(M,x){if(this._ls)for(var Q,d=0,T=this._ls.size();T>d;d++)if(Q=this._ls.get(d),M===Q.l&&x===Q.s)return!0;return!1},add:function(I,X,S){var k=this,U={l:I,s:X,a:S};k._ls||(k._ls=new yb),k._f?(k._as||(k._as=new yb),k._as.add(U)):U.a?k._ls.add(U,0):k._ls.add(U)},remove:function(m,e){var G=this;G._ls&&(G._f?(G._rs||(G._rs=new yb),G._rs.add({l:m,s:e})):G._remove(m,e))},_remove:function(h,J){for(var C,f=this._ls,d=0,z=f.size();z>d;d++)if(C=f.get(d),C.l===h&&C.s===J)return f.removeAt(d),void 0},fire:function(J){var x=this,U=x._ls;if(x._b=1e4,U){++x._f;try{for(var W,F=0,Z=U.size();Z>F;F++)W=U.get(F),W.s?W.l.call(W.s,J):W.l(J)}finally{if(--x._f)return;if(x._rs){for(Z=x._rs.size(),F=0;Z>F;F++)W=x._rs.get(F),x._remove(W.l,W.s);delete x._rs}if(x._as){for(Z=x._as.size(),F=0;Z>F;F++)W=x._as.get(F),W.a?U.add(W,0):U.add(W);delete x._as}}}}});var Ye=B.Data=function(){this._id=oj()};Ig("Data",O,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:E,_parent:E,_children:Yo,_childMap:E,_styleMap:E,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return E},_22Q:function(){return E},s:function(l,x){var Z=this;if(2===arguments.length)Z.setStyle(l,x);else{if(!Kq(l))return Z.getStyle(l);for(var w in l)Z.setStyle(w,l[w])}return Z},fp:function(Z,a,_,w,E){return this.firePropertyChange(Z,a,_,w,E)},firePropertyChange:function(O,j,a,G,o){if(G){if(G(j,a))return!1}else if(j===a)return!1;var p=this,y=o||{};return y.property=O,y.oldValue=j,y.newValue=a,y.data=p,p._dataModel&&p._dataModel.handleDataPropertyChange(y),p.onPropertyChanged(y),!0},onPropertyChanged:function(d){var e=this,m=e._parent,c=d.property;if(Xi(m)){var S=e.s(Am),p="s:ingroup"===c;(S&&ym[c]||c===p)&&m._81I(),(S||p)&&m.fp("childChange",!0,!1)}Fh(m)&&ym[c]&&m.updateFromChildren()},_21I:function(H){var e=this;if(H&&e._dataModel)throw"Remove data from dataModel before adding";e._dataModel=H},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var J=0,e=this._children.toArray(),N=e.length;N>J;J++)e[J].removeFromDataModel()},getId:function(){return this._id},setId:function(L){this._id=L},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(m,c){return this._children.toList(m,c)},eachChild:function(W,E){this._children.each(W,E)},addChild:function(I,y){var f=this;I!==f&&(f._children===Yo&&(f._children=new yb,f._childMap={}),y>=0||(y=f._children.size()),f._childMap[I._id]||f.isDescendantOf(I)||(I._parent&&I._parent.removeChild(I),(0>y||y>f._children.size())&&(y=f._children.size()),f._children.add(I,y),f._childMap[I._id]=I,I.setParent(f),f.onChildAdded(I,y),f.fp(vo,E,I)))},onChildAdded:function(){},removeChild:function(x){var S=this;if(S._childMap&&S._childMap[x._id]){var b=S._children.remove(x);delete S._childMap[x._id],S.fp(vo,x,E),x.setParent(E,b),S.onChildRemoved(x,b)}},onChildRemoved:function(){},getChildAt:function(u){return this._children.get(u)},clearChildren:function(){var B=this;if(!B._children.isEmpty())for(var $=0,J=B._children.toArray(),e=J.length;e>$;$++)B.removeChild(J[$])},getParent:function(){return this._parent},setParent:function(h,v){var p=this;if(!(p._73I||p._parent===h||p===h||h&&h.isDescendantOf(p))){var m,V=p._parent;p._parent=h,p._73I=1,V?(v==E&&(v=V.getChildren().indexOf(p)),V.removeChild(p)):p._dataModel&&v==E&&(v=p._dataModel.getRoots().indexOf(p)),h&&(h.addChild(p),m=h.getChildren().indexOf(p)),delete p._73I,p.fp("parent",V,h,n,{oldIndex:v,newIndex:m}),p.onParentChanged(V,h)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(o){return o?this.isDescendantOf(o)||o.isDescendantOf(this):!1},isParentOf:function(v){return v&&this._childMap?!!this._childMap[v._id]:!1},isDescendantOf:function(j){if(!j||j.isEmpty())return!1;for(var R=this._parent;R;){if(j===R)return!0;R=R._parent}return!1},getStyle:function(a,m){m===n&&(m=1);var M=this._styleMap?this._styleMap[a]:n;return M===n&&m?r[a]:M},setStyle:function(V,s){var W=this;W._styleMap||(W._styleMap={});var a=W._styleMap[V];s===n?delete W._styleMap[V]:W._styleMap[V]=s,W.fp("s:"+V,a,s)&&W.onStyleChanged(V,a,s)},onStyleChanged:function(){},iv:function(y){this.invalidate(y)},invalidate:function(T){this.fp(T||"*",!1,!0)},toString:function(){var Z=this;return Z._displayName||Z._name||Z._tag||Z._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(e,N){var M=this,X=M.s(ep);X||M.s(ep,X={}),N?X[e]=N:delete X[e],M.fp(ep,E,X)},removeStyleIcon:function(B){var V=this.s(ep);if(V){var R=V[B];delete V[B],this.fp(ep,E,V)}return R},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var B,g={};for(B in this._styleMap)g[B]=1;return g}});var bq=B.DataModel=function(){var N=this;N._datas=new yb,N._dataMap={},N._roots=new yb,N._rootMap={},N._fsDataMap={},N._78O={},N._36I=new Jc,N._35I=new Jc,N._serializeNotifier=new Jc,N._selectionModel=new bc(N);var n=N._29Q=[],d=N._scheduleCallback=function(){for(var W=Date.now(),l=0;l<n.length;l++){var q=n[l];q.enabled&&W-q.lastTime>q.interval&&(q.beforeAction&&q.beforeAction(),N.each(function(Q){q.action(Q)}),q.afterAction&&q.afterAction(),q.lastTime=W)}n.length&&(N._30Q=S.requestAnimationFrame(d))}};Ig("DataModel",O,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:n,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:n,_init:n,_envmap:n,_postProcessingData:n,sm:function(){return this.getSelectionModel()},mm:function(Y,o,R){this.addDataModelChangeListener(Y,o,R)},umm:function(m,d){this.removeDataModelChangeListener(m,d)},md:function(J,k,S){this.addDataPropertyChangeListener(J,k,S)},umd:function(a,k){this.removeDataPropertyChangeListener(a,k)},mh:function(u,X,K){this.addHierarchyChangeListener(u,X,K)},umh:function(A,i){this.removeHierarchyChangeListener(A,i)},getAttrObject:function(){return this._attrObject},setAttrObject:function(l){return this._attrObject=l},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getDataById:function(m){return this._dataMap[m]},removeDataById:function(t){this.remove(this.getDataById(t))},toDatas:function(z,W){return this._datas.toList(z,W)},each:function(B,V){this._datas.each(B,V)},getDataByTag:function(i){return this._78O[i]},getTagMap:function(){return this._78O},removeDataByTag:function(i){this.remove(this.getDataByTag(i))},add:function(C,m,p){var j=this,V=C._id,$=C._tag,N=j._roots;if(j._dataMap[V])throw"'"+V+"' already exists";$!=E&&(j._78O[$]=C),j._dataMap[V]=C,p>=0?j._datas.add(C,p):j._datas.add(C),C._parent||(j._rootMap[V]=C,m>=0?N.add(C,m):N.add(C)),C.s("fullscreen")!==n&&(j._fsDataMap[V]=C),C._21I(j),j.onAdded(C),j._36I.fire({kind:"add",data:C,rootsIndex:m,datasIndex:p})},onAdded:function(){},remove:function(X,m){if(X){var y=this,s=X._id,V=m&&m.keepStructure,w=m&&m.keepChildren,K=X.getTag();if(X._dataModel===y){this.beginTransaction(),V?y._removingData||(y._removingData=X):y.prepareRemove(X),w||X.toChildren().each(function(j){y.remove(j,m)},y),V?y._removingData===X&&(X._parent&&X._parent.removeChild(X),delete y._removingData):X._parent&&X._parent.removeChild(X);var q=y._datas.remove(X);delete y._dataMap[s],K!=E&&delete y._78O[K];var S;y._rootMap[s]&&(delete y._rootMap[s],S=y._roots.remove(X)),y._fsDataMap[s]&&delete y._fsDataMap[s],X._21I(E),y.onRemoved(X),y._36I.fire({kind:ab,data:X,rootsIndex:S,datasIndex:q}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var G=this;if(G._datas.size()){var M=G._historyManager?this.toJSON():n;G._datas.toArray().forEach(function(Y){Y._21I(E)}),G._datas.clear(),G._dataMap={},G._roots.clear(),G._rootMap={},G._fsDataMap={},G._78O={},G._36I.fire({kind:Wb,json:M})}},contains:function(k){return k&&k._dataModel===this},handleDataPropertyChange:function(O){var v=this,H=O.data,q=O.property;if("parent"===q){var P=H._id,s=v._rootMap,n=v._roots;H._parent?s[P]&&(delete s[P],n.remove(H)):s[P]||(s[P]=H,n.add(H))}else if("tag"===q){var I=O.oldValue,t=O.newValue,C=v._78O;I!=E&&delete C[I],t!=E&&(C[t]=H)}else if("s:fullscreen"===q){var P=H._id,w=v._fsDataMap;O.oldValue!=E&&delete w[P],O.newValue!=E&&(w[P]=H)}this.onDataPropertyChanged(H,O),this._35I.fire(O)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(Z,v,E){this._36I.add(Z,v,E)},removeDataModelChangeListener:function(d,B){this._36I.remove(d,B)},addSerializeListener:function(A,w,C){this._serializeNotifier.add(A,w,C)},removeSerializeListener:function(V,s){this._serializeNotifier.remove(V,s)},fireSerializeEvent:function(F){this._serializeNotifier.fire(F)},addDataPropertyChangeListener:function(R,K,I){this._35I.add(R,K,I)},removeDataPropertyChangeListener:function(o,L){this._35I.remove(o,L)},_38I:function(A,U,c){this._37I&&this._37I.fire({data:A,oldIndex:U,newIndex:c})},addHierarchyChangeListener:function(R,h,$){this._37I||(this._37I=new Jc),this._37I.add(R,h,$)},removeHierarchyChangeListener:function(c,$){this._37I.remove(c,$)},getSiblings:function(D){var y=D._parent;return y?y._children:this._roots},eachByHierarchical:function(S,e,b){if(e)return this._eachByHierarchical(S,e,b);for(var z=0,j=this._roots,T=j.size();T>z;z++)if(this._eachByHierarchical(S,j.get(z),b)===!1)return!1;return!0},_eachByHierarchical:function(P,V,T){if(T){if(P.call(T,V)===!1)return!1}else if(P(V)===!1)return!1;for(var D=V.size(),k=0;D>k;k++)if(this._eachByHierarchical(P,V.getChildAt(k),T)===!1)return!1;return!0},reverseEachByHierarchical:function(v,N,X){if(N)return this._reverseEachByHierarchical(v,N,X);for(var d=this._roots,K=d.size(),p=K-1;p>=0;p--)if(this._reverseEachByHierarchical(v,d.get(p),X)===!1)return!1;return!0},_reverseEachByHierarchical:function(Q,Z,K){for(var E=Z.size(),N=E-1;N>=0;N--)if(this._reverseEachByHierarchical(Q,Z.getChildAt(N),K)===!1)return!1;if(K){if(Q.call(K,Z)===!1)return!1}else if(Q(Z)===!1)return!1;return!0},eachByDepthFirst:function(C,I,e){if(I)return this._11I(C,I,e);for(var X=0,Y=this._roots,o=Y.size();o>X;X++)if(this._11I(C,Y.get(X),e)===!1)return!1;return!0},_11I:function(m,E,G){for(var q=E.size(),a=0;q>a;a++)if(this._11I(m,E.getChildAt(a),G)===!1)return!1;if(G){if(m.call(G,E)===!1)return!1}else if(m(E)===!1)return!1;return!0},eachByBreadthFirst:function(m,F,O){var T=new yb;for(F?T.add(F):this._roots.each(T.add,T);T.size()>0;)if(F=T.removeAt(0),F.eachChild(T.add,T),O){if(m.call(O,F)===!1)return!1}else if(m(F)===!1)return!1;return!0},moveTo:function(T,D){var P=this.getSiblings(T),O=P.indexOf(T);O===D||0>O||D>=0&&D<=P.size()&&(P.remove(T),D>P.size()&&D--,P.add(T,D),this._38I(T,O,D))},moveUp:function(M){this.moveTo(M,this.getSiblings(M).indexOf(M)-1)},moveDown:function(M){this.moveTo(M,this.getSiblings(M).indexOf(M)+1)},moveToTop:function(P){this.moveTo(P,0)},moveToBottom:function(s){this.moveTo(s,this.getSiblings(s).size())},moveSelectionUp:function(v){this.beginTransaction(),v||(v=this.sm());var H=new yb;wb(v,H,this._roots),H.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(W){this.beginTransaction(),W||(W=this.sm());var y=new yb;qg(W,y,this._roots),y.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(O){this.beginTransaction(),O||(O=this.sm());var i=new yb;Ff(O,i,this._roots),i.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(B){this.beginTransaction(),B||(B=this.sm());var k=new yb;vc(B,k,this._roots),k.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(d,E,Y){var D=this.getDatas();null==Y&&(Y=D.indexOf(d)),Y===E||0>Y||E>=0&&E<=D.size()&&(D.remove(d),E>D.size()&&E--,D.add(d,E),this._76I(d,Y,E))},bringForward:function(g){this.moveToIndex(g,this.getDatas().indexOf(g)+1)},bringToFront:function(U){this.moveToIndex(U,this.size())},sendBackward:function(J){this.moveToIndex(J,this.getDatas().indexOf(J)-1)},sendToBack:function(H){this.moveToIndex(H,0)},bringSelectionForward:function(l){this.beginTransaction(),l||(l=this.sm());for(var h=new yb,r=this.getDatas(),z=!1,A=0;A<r.size();A++){var _=r.get(r.size()-1-A);l.contains(_)?z&&h.add(_):z=!0}h.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(s){this.beginTransaction(),s||(s=this.sm());for(var J=new yb,h=this.getDatas(),k=0;k<h.size();k++){var t=h.get(k);s.contains(t)&&J.add(t)}J.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(M){this.beginTransaction(),M||(M=this.sm());for(var J=new yb,i=this.getDatas(),G=!1,l=0;l<i.size();l++){var j=i.get(l);M.contains(j)?G&&J.add(j):G=!0}J.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(q){this.beginTransaction(),q||(q=this.sm());for(var Q=new yb,I=this.getDatas(),v=0;v<I.size();v++){var g=I.get(I.size()-1-v);q.contains(g)&&Q.add(g)}Q.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(W){var z=this;z.removeScheduleTask(W),W.enabled==E&&(W.enabled=!0),W.interval==E&&(W.interval=10),W.action==E&&(W.action=Xe),W.lastTime=Date.now(),z._29Q.push(W),z._30Q==E&&(z._30Q=S.requestAnimationFrame(z._scheduleCallback))},removeScheduleTask:function(t){var y=this,X=y._29Q,j=X.indexOf(t);j>=0&&X.splice(j,1),X.length||y._30Q==E||(S.cancelAnimationFrame(y._30Q),delete y._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(J){this._historyManager||new B.HistoryManager(this),null!=J&&this._historyManager.setMaxHistoryCount(J),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(j){this._historyManager&&this._historyManager.undo(j)},redo:function(V){this._historyManager&&this._historyManager.redo(V)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(H){this._historyManager&&this._historyManager.addHistory(H)},onHistoryManagerChanged:function(){}});var bc=B.SelectionModel=function(D){var W=this;W._68O=bp,W._map={},W._73O=new yb,W._74I=new Jc,W._21I(D)};Ig("SelectionModel",O,{ms_fire:1,ms_dm:1,ms:function(h,v,A){this.addSelectionChangeListener(h,v,A)},ums:function(y,t){this.removeSelectionChangeListener(y,t)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===hn},co:function(m){return this._map[m._id]!=E},ss:function(E){this.setSelection(E)},as:function(Y){this.appendSelection(Y)},rs:function(_){this.removeSelection(_)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(S){var d=this;if(d._68O!==S&&(S===Uo||S===hn||S===bp)){d.cs();var N=d._68O;d._68O=S,d.fp("selectionMode",N,S)}},_21I:function(T){var y=this,l=y._dataModel;l!==T&&(l&&(y.cs(),l.umm(y.handleDataModelChange,y)),y._dataModel=T,T.mm(y.handleDataModelChange,y,!0),y.fp(Td,l,T))},dispose:function(){var I=this;I.cs(),I._dataModel.umm(I.handleDataModelChange,I)},handleDataModelChange:function(F){var Z=this;if(F.kind===ab){var H=F.data;Z.co(H)&&(Z._73O.remove(H),delete Z._map[H._id],Z._75I(ab,new yb(H)))}else F.kind===Wb&&Z.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(m){var M=this;if(M._filterFunc!==m){M.cs();var x=M._filterFunc;M._filterFunc=m,M.fp("filterFunc",x,M._filterFunc)}},_75I:function(c,d,t,K){t&&(this._73O.each(function(i){K[i._id]?t.remove(i):t.add(i)}),d=t.toList()),this._74I.fire({kind:c,datas:new yb(d)})},addSelectionChangeListener:function(E,J,L){this._74I.add(E,J,L)},removeSelectionChangeListener:function(d,e){this._74I.remove(d,e)},_97O:function(r,j){for(var W,a=this,s=0,q=new yb(r);s<q.size();s++)W=q.get(s),(a._filterFunc&&!a._filterFunc(W)||j&&a.co(W)||!j&&!a.co(W)||!a._dataModel.contains(W))&&(q.removeAt(s),s--);return q},appendSelection:function(y){var x=this;if(x._68O!==Uo){var a,U,z=x._73O,j=x._97O(y,!0);j.isEmpty()||(x.sg()&&(a=new yb(z),U=x._map,z.clear(),x._map={},j=new yb(j.get(j.size()-1))),j.each(function(h){z.add(h),x._map[h._id]=h}),x._75I("append",j,a,U))}},removeSelection:function(Z){var s=this,R=s._97O(Z),T=0,l=R.size();if(0!==l){for(;l>T;T++){var D=R.get(T);s._73O.remove(D),delete s._map[D._id]}s._75I(ab,R)}},toSelection:function(E,q){return this._73O.toList(E,q)},getSelection:function(){return this._73O},each:function(c,w){this._73O.each(c,w)},setSelection:function(i){var G=this,S=G._73O;if(G._68O!==Uo&&!(S.isEmpty()&&!i||1===S.size()&&G.ld()===i)){var X=new yb(S),J=G._map;S.clear(),G._map={};var Z=G._97O(i,!0);G.sg()&&Z.size()>1&&(Z=new yb(Z.get(Z.size()-1))),Z.each(function(R){S.add(R),G._map[R._id]=R}),G._75I("set",E,X,J)}},clearSelection:function(){var E=this,n=E._73O;if(n.size()>0){var m=n.toList();n.clear(),E._map={},E._75I(Wb,m)}},selectAll:function(){var u=this;if(u._68O!==Uo){var e,S,y=u._dataModel.toDatas();if(u._filterFunc)for(e=0;e<y.size();e++)S=y.get(e),u._filterFunc(S)||(y.removeAt(e),e--);var X=u._73O,U=new yb(X),m=u._map;X.clear(),u._map={},u.sg()&&y.size()>1&&(y=new yb(y.get(y.size()-1)));var F=y.size();for(e=0;F>e;e++)S=y.get(e),X.add(S),u._map[S._id]=S;u._75I("all",E,U,m)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(I){return this._map[I._id]!=E},getLastData:function(){var s=this._73O;return s.size()>0?s.get(s.size()-1):E},getFirstData:function(){var Q=this._73O;return Q.size()>0?Q.get(0):E},isSelectable:function(b){var m=this;return b&&m._68O!==Uo?m._filterFunc?m._filterFunc(b):!0:!1},getTopSelection:function(){var Z=this,L=new yb;return Z._73O.each(function(y){for(var l=y.getParent();l;){if(Z.contains(l)){y=E;break}l=l.parent}y&&L.add(y)}),L}});var Or=function(){return Jb(0),function(U,w){var n;if(Bh(w)){var P=U.getDataUI(w);P&&P._88I&&(n=P._88I.rect)}return n?n:w.getRect()}}();yp($,{edgeGroupAgentFunc:E,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:D.rectSelectBorder,graphViewRectSelectBackground:uf,graphViewEditPointSize:im?17:7,graphViewEditPointBorderColor:D.editPointBorder,graphViewEditPointBackground:D.editPointBackground,setEdgeType:function(G,_,O){Zp[G]=_,vk[G]=O},getEdgeType:function($){return Zp[$]},getEdgeTypeMap:function(){return Zp},getNodeRect:Or},!0),yp(r,{"layout.h":n,"layout.v":n,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":n,interactive:!1,"image.stretch":"fill",icons:n,ingroup:!0,"body.color":n,"2d.gray":!1,fullscreen:n,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:n,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":dq,"select.width":1,"select.padding":2,"select.type":Fe,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":n,"border.width":2,"border.padding":2,"border.type":Fe,label:n,"label.font":n,"label.color":Wn,"label.background":n,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":n,"label.max":n,"label.opacity":n,"label.scale":1,"label.align":n,"label.selectable":!0,label2:n,"label2.font":n,"label2.color":Wn,"label2.background":n,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":n,"label2.max":n,"label2.opacity":n,"label2.scale":1,"label2.align":n,"label2.selectable":!0,note:n,"note.expanded":!0,"note.font":n,"note.color":cj,"note.background":dq,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":n,"note.toggleable":!0,"note.border.width":1,"note.border.color":n,"note.opacity":n,"note.scale":1,"note.align":n,note2:n,"note2.expanded":!0,"note2.font":n,"note2.color":cj,"note2.background":dq,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":n,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":n,"note2.opacity":n,"note2.scale":1,"note2.align":n,"group.type":n,"group.image":n,"group.image.stretch":"fill","group.repeat.image":n,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":n,"group.title.color":cj,"group.title.background":D.groupTitleBackground,"group.title.align":Pi,"group.title.orientation":Ui,"group.background":D.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":n,"group.border.color":Gl,"group.border.radius":0,"group.border.cap":Wr,"group.border.join":Dq,"group.splitLine":!1,"group.gradient":E,"group.gradient.color":"#FFF",shape:n,"shape.background":Gl,"shape.repeat.image":n,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Gl,"shape.border.3d":!1,"shape.border.3d.color":n,"shape.border.3d.accuracy":n,"shape.border.cap":Wr,"shape.border.join":Dq,"shape.border.pattern":n,"shape.gradient":E,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":hf,"shape.dash.offset":0,"shape.dash.color":Fo,"shape.dash.width":n,"shape.dash.3d":!1,"shape.dash.3d.color":n,"shape.dash.3d.accuracy":n,"shape.polygon.side":6,"shape.arc.from":t,"shape.arc.to":f,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":n,"shape.gradient.pack":n,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":n,"shape.foreground.gradient":E,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":n,"autolayout.hgap":n,"autolayout.vgap":n,"edge.type":n,"edge.points":n,"edge.segments":n,"edge.color":Gl,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":n,"edge.3d.accuracy":n,"edge.cap":Wr,"edge.join":Dq,"edge.source.position":17,"edge.source.anchor.x":n,"edge.source.anchor.y":n,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":n,"edge.target.anchor.y":n,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":n,"edge.dash":!1,"edge.dash.pattern":hf,"edge.dash.offset":0,"edge.dash.color":Fo,"edge.dash.width":n,"edge.dash.3d":!1,"edge.dash.3d.color":n,"edge.dash.3d.accuracy":n,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":n,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":n,"grid.column.percents":n,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":D.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":D.gridCellBorderColor,"grid.block":n,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":D.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Wn,"text.font":Mr,"text.shadow":!1,"text.shadow.color":dq,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1},!0),yp(bq,{_76I:function(Y,o,m){this._39I&&this._39I.fire({data:Y,oldIndex:o,newIndex:m})
},addIndexChangeListener:function(_,U,q){var F=this;F._39I||(F._39I=new Jc),F._39I.add(_,U,q)},removeIndexChangeListener:function(t,e){this._39I.remove(t,e)},prepareRemove:function(I){Ll(I)&&(I.setSource(E),I.setTarget(E)),I._70O&&I._70O.toList().each(this.remove,this),I._69O&&I._69O.toList().each(function(K){K.setHost(E)}),I._host&&I.setHost(E)},onAdded:function(x){this.isAutoAdjustIndex()&&this.adjustIndex(x)},onDataPropertyChanged:function(Y,s){ho[s.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(Y)},isAdjustable:function($){return fk($)||Ll($)},isAdjustedToBottom:function(U){return Xi(U)?U.isExpanded()&&dc(U):!1},adjustIndex:function(r){var j=this;this.isHierarchicalRendering()||(j.isAdjustedToBottom(r)?(j.sendToBottom(r),r.eachChild(j.adjustIndex,j)):j.sendToTop(r))},sendToTop:function(B){var d=this;if(d.contains(B)&&d.isAdjustable(B)){var W=d._datas;if(B!==W.get(d.size()-1)){var n=W.indexOf(B);W.removeAt(n),W.add(B),d._76I(B,n,d.size()-1)}if(Ll(B)){var v=B._40I;v&&!d.isAdjustedToBottom(v)&&d.sendToTop(v),v=B._41I,v&&!d.isAdjustedToBottom(v)&&d.sendToTop(v)}B._69O&&B._69O.each(function(w){w.isRelatedTo(B)||fk(B)&&w.isLoopedHostOn(B)||d.sendToTop(w)}),B.ISubGraph||(!Xi(B)||B.isExpanded())&&B._adjustChildrenToTop&&B.eachChild(function(g){Ll(g)||d.sendToTop(g)})}},sendToBottom:function(p,k){var g=this;if(p!==k&&g.contains(p)&&g.isAdjustable(p)&&(!k||g.contains(k))){var L=g._datas,t=L.remove(p),D=k?g._datas.indexOf(k):0;if(L.add(p,D),t!==D){g._76I(p,t,D);var r=p._parent;!r||r.ISubGraph||Ll(r)||g.sendToBottom(p._parent,p)}}}}),yp(gs,{ms_edit:function(Z){Z._46O=function(_){var N=this,j=N.gv.dm(),F=N._index,i=N._89I,v=N._node,o=N._shape,Z=N._edge,G=N._77I;v&&i?(this.fi({kind:"endEditRect",event:_,data:v,direction:i}),j.endTransaction()):o&&F>=0?(N.fi({kind:"endEditPoint",event:_,data:o,index:F}),j.endTransaction()):Z&&F>=0?(N.fi({kind:"endEditPoint",event:_,data:Z,index:F}),j.endTransaction()):G&&(N.fi({kind:"endEditRotation",event:_,data:G}),j.endTransaction())},Z._78I=function(e){var P=this;P.autoScroll(e);var X=P.gv.lp(e),r=P._index,i=P._89I,K=P._node,m=P._shape,L=P._edge,O=P._77I;if(K&&i)P._80O(X),P.fi({kind:"betweenEditRect",event:e,data:K,direction:i});else if(m&&r>=0)X.e=m.getPoints().get(r).e,m.setPoint(r,X),P.fi({kind:"betweenEditPoint",event:e,data:m,index:r});else if(L&&r>=0){var W=L.s(Og);X.e=W.get(r).e,W.set(r,X),L.fp(Og,E,W),P.fi({kind:"betweenEditPoint",event:e,data:L,index:r})}else if(O){var c=O.p(),k=O.getScale(),q=H+U(X.y-c.y,X.x-c.x);k.y<0&&(q+=t),F(q)<.04&&(q=0),O.setRotation(q),P.fi({kind:"betweenEditRotation",event:e,data:O})}},Z._80O=function($){var k=this,Z=k._node,i=k._rect,H=i.x,z=i.y,h=i.width,K=i.height,C=k._89I,g=k._anchor,O=k._matrix,$=O.tfi($);"northwest"===C?i=Vn($,{x:H+h,y:z+K}):C===oq?i=Vn({x:H,y:$.y},{x:H+h,y:z+K}):"northeast"===C?i=Vn({x:H,y:$.y},{x:$.x,y:z+K}):C===Lf?i=Vn({x:$.x,y:z},{x:H+h,y:z+K}):C===mh?i=Vn({x:H,y:z},{x:$.x,y:z+K}):"southwest"===C?i=Vn({x:$.x,y:z},{x:H+h,y:$.y}):"south"===C?i=Vn({x:H,y:z},{x:H+h,y:$.y}):"southeast"===C&&(i=Vn({x:H,y:z},$)),Z.setPosition(O.tf(i.x+i.width*g.x,i.y+i.height*g.y)),Z.setWidth(i.width),Z.setHeight(i.height)},Z._80I=function(j,H,Z,U){var o=this,x=o.gv._zoom,M=(o.gv.getEditPointSize()+2)/x;return Yr({x:H-M/2,y:Z-M/2,width:M,height:M},j)?(o._89I!==U&&(o._89I=U),!0):!1},Z._79I=function(q,k,S){var R=this,X=R.gv,f=k?X.getDataUI(k):E,_=f?f._55O:E;if(_){var x,g,F,r,G=X._zoom,K=(X.getEditPointSize()+2)/G,O=X.lp(q);if(fk(k)){if(_._56O&&fk(k)&&(g=_._98o,Yr({x:g.x-K/2,y:g.y-K/2,width:K,height:K},O)))return R._77I=k,S&&R.fi({kind:"beginEditRotation",event:q,data:k}),R.setCursor("crosshair"),!0;if(_._43O&&k instanceof wh)for(F=k.getPoints(),x=F.size()-1;x>=0;x--)if(g=F.get(x),Yr({x:g.x-K/2,y:g.y-K/2,width:K,height:K},O))return R._index=x,R._shape=k,S&&R.fi({kind:"beginEditPoint",event:q,data:k,index:x}),R.setCursor("crosshair"),!0;if(_._42O)for(var V=k.getEditControlPoints(),z=["northwest",-1,-1,Lf,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,mh,1,0,"northeast",1,-1,oq,0,-1],x=0,r=V.length;r>x;x++){var w=z[3*x],P=V[x];if(R._80I(O,P.x,P.y,w)){R._node=k;var C=k.getWidth(),J=k.getHeight(),o=k.getAnchor();R._rect={x:-C*o.x,y:-J*o.y,width:C,height:J},R._anchor=o,R._matrix=k.getMatrix();var N=k.getRotation(),Y=T(N),I=y(N),l=z[3*x+1]*or(k.getScale().x),B=z[3*x+2]*or(k.getScale().y),t=Math.atan2(-I*l-Y*B,Y*l-I*B),i=(Math.round(t/(Math.PI/4))+8)%8,j=[Cp,"nesw-resize",Mf,"nwse-resize",Cp,"nesw-resize",Mf,"nwse-resize"][i];return R.setCursor(j),S&&R.fi({kind:"beginEditRect",event:q,data:k,direction:R._89I}),!0}}}if(_._43O&&Ll(k)&&k.s(Qr)===mc&&(F=k.s(Og)))for(x=F.size()-1;x>=0;x--)if(g=F.get(x),Yr({x:g.x-K/2,y:g.y-K/2,width:K,height:K},O))return R._index=x,R._edge=k,S&&R.fi({kind:"beginEditPoint",event:q,data:k,index:x}),R.setCursor("crosshair"),!0}return!1}},ms_gv:function(w){w._currentSubGraph=E,w._fpsInfo={time:0,fps:0,frames:0},w.upSubGraph=function(){this.setCurrentSubGraph(Tc(this._currentSubGraph))},w.isVisible=function(Y){var F=this;if(Tc(Y)!==F._currentSubGraph)return!1;if(Ll(Y)){var e=Y._40I,r=Y._41I;if(!e||!r)return!1;if(!(Y.s("edge.independent")||F.isVisible(e)&&F.isVisible(r)))return!1;if(Y.isEdgeGroupHidden())return!1}else for(var h=Y._parent;h&&!h.ISubGraph;){if(Xi(h)&&(!h.isExpanded()||!F.isVisible(h)))return!1;h=h._parent}if(Y._parent instanceof Go&&!F.isVisible(Y._parent))return!1;if(Y._refGraph instanceof Oi&&!F.isVisible(Y._refGraph))return!1;if(F instanceof Dl){if(!Y.s("3d.visible"))return!1}else{var q=F.getLayersInfo();if(q){var w=q[Y._layer];if(w&&w.visible===!1)return!1}if(!Y.s("2d.visible"))return!1}return F._visibleFunc?F._visibleFunc(Y):!0},w.handleSelectionChange=function(h){var X=this;h.datas.each(function(p){X.invalidateData(p);var v=p._parent;Xi(v)&&fk(p)&&p.s(Am)&&(X.invalidateData(v),v._49I&&v._49I.each(function(c){X.invalidateData(c)}))}),X.onSelectionChanged(h)},w.onSelectionChanged=function(k){var Z=this,H=Z.sm();if(1===H.size()&&("set"===k.kind||"append"===k.kind)){var J=H.ld();Z.isAutoMakeVisible()&&Z.makeVisible(J),Z.adjustIndex&&Z._dataModel.isAutoAdjustIndex()&&Z.adjustIndex(J)}},w.makeVisible=function(p){if(p){var c=this,P=c.getDataUI?c.getDataUI(p):c.getData3dUI(p);if(P){var W=p,x=Tc(p);for(x!==c._currentSubGraph&&c.setCurrentSubGraph(x);(W=W._parent)&&W!==x;)Xi(W)&&W.setExpanded(!0);c._23I=p,c.iv()}}},w.getLabel=function(V){var M=V.getStyle(Eo);return M===n?V.getName():M},w.getLabelBackground=function(z){return z.getStyle("label.background")},w.getLabelColor=function(n){return n.getStyle("label.color")},w.getLabel2=function(k){return k.getStyle("label2")},w.getLabel2Background=function(w){return w.getStyle("label2.background")},w.getLabel2Color=function(C){return C.getStyle("label2.color")},w.getNote=function(c){return c.getStyle(No)},w.getNoteBackground=function(h){return h.getStyle("note.background")},w.getNote2=function(h){return h.getStyle(ss)},w.getNote2Background=function(B){return B.getStyle("note2.background")},w.handleClick=function(v,Y,B){var a=this;Y?(a.fi({kind:"clickData",event:v,data:Y,part:B}),a.onDataClicked(Y,v)):(a.fi({kind:"clickBackground",event:v}),a.onBackgroundClicked(v))},w.handleDoubleClick=function(n,o,v){var D=this;rq(n)&&(o?(D.fi({kind:"doubleClickData",event:n,data:o,part:v}),D.onDataDoubleClicked(o,n,v),D.checkDoubleClickOnNote(n,o,v)||D.checkDoubleClickOnRotation&&D.checkDoubleClickOnRotation(n,o,v)||(Ll(o)?D.onEdgeDoubleClicked(o,n,v):o.ISubGraph?D.onSubGraphDoubleClicked(o,n,v):Xi(o)?D.onGroupDoubleClicked(o,n,v):o.IDoorWindow?D.onDoorWindowDoubleClicked(o,n,v):o.ICSGBox&&D.onCSGBoxDoubleClicked(o,n,v))):(D.fi({kind:"doubleClickBackground",event:n}),D.onBackgroundDoubleClicked(n)))},w.onSubGraphDoubleClicked=function(r){this.setCurrentSubGraph(r)},w.onEdgeDoubleClicked=function(g,B){g.ISubGraph&&!In(B)?this.setCurrentSubGraph(g):g.s("edge.toggleable")&&g.toggle()},w.onGroupDoubleClicked=function(H){H.s("group.toggleable")&&H.toggle()},w.onDoorWindowDoubleClicked=function(R){R.s("dw.toggleable")&&R.toggle(!0)},w.onCSGBoxDoubleClicked=function(R,E){var f=this;if(f instanceof Dl){var P=f.getHitFaceInfo(E);P&&P.face&&R.s(P.face+".toggleable")&&R.toggleFace(P.face,!0)}},w.onBackgroundClicked=function(){},w.onBackgroundDoubleClicked=function(){this.upSubGraph()},w.onDataClicked=function(){},w.onDataDoubleClicked=function(){},w.onAutoLayoutEnded=function(){},w.onMoveEnded=function(){},w.onPanEnded=function(){},w.onPinchEnded=function(){},w.onRectSelectEnded=function(){},w.onZoomEnded=function(){},w.serialize=function(r){return this.dm().serialize(r)},w.toJSON=function(){return this.dm().toJSON()},w.deserialize=function(w,N){return N=N instanceof Ye?{rootParent:N}:Uf(N)?{setId:N}:hp(N)?{finishFunc:N}:N||{},N.view=this,this.dm().deserialize(w,N.rootParent,N)},w.showDebugTip=function(){var Z=this,O=Z._debugDiv;if(!O){O=Z._debugDiv=W.createElement("div"),O.style.position="absolute",O.style.overflow="hidden",O.style.backgroundColor="white",O.style.color="black";var T=Z.getView();Z._79O?T.insertBefore(O,Z._79O):T.appendChild(O);var X=function(){Z.redraw();var z="FPS : "+Z._fpsInfo.fps+"<br/>"+"Datas : "+Z.dm().getDatas().length,M=Z.getDebugTip();M&&(z+="<br/>------<br/>"+M),O.innerHTML=z,Z._isDebugging&&requestAnimationFrame(X)};requestAnimationFrame(X),Z._isDebugging=!0}},w.hideDebugTip=function(){var R=this,K=R._debugDiv;K&&(delete R._debugDiv,R.getView().removeChild(K),R._isDebugging=!1)},w.countFrame=function(){if(this._isDebugging){var g=Date.now(),z=this._fpsInfo;g-z.time>1e3?(z.fps=Math.round(1e5*(z.frames+1)/(g-z.time))/100,z.time=g,z.frames=0):z.frames++}}},ms_icons:function(b){b.getRotation=function(o){return o==E?0:o},b._15O=function(){var V=this,u=V.s(ep);if(u){var T=V,W=V.data||V._data,d=V._38o={icons:u,rects:{}};for(var $ in u){var L=u[$],A=aq(L.shape3d,W,T);if(!(aq(L.visible,W,T)===!1||aq(L.for3d,W,T)&&!V.I3d||A&&!V.I3d)){var j=A?[A]:aq(L.names,W,T),t=j?j.length:0,h=aq(L.position,W,T)||3,n=aq(L.offsetX,W,T)||0,O=aq(L.offsetY,W,T)||0,b=aq(L.direction,W,T)||mh,m=aq(L.gap,W,T),l=m!=E?m:1,J=aq(L.rotation,W,T),v=aq(L.keepOrien,W,T),Y=aq(L.rotationFixed,W,T)?J:V.getRotation(J,v,h),G=E,y=d.rects[$]=new Array(t);y.rotation=Y;for(var B=0;t>B;B++){var c,s,a,I,p=j[B];if(A)a=0,I=0;else{var Z=wc(p);a=aq(L.width,W,T),I=aq(L.height,W,T),a==E&&(a=Ap(Z,W)),I==E&&(I=pi(Z,W))}if(G?b===mh?n+=a/2:b===Lf?n-=a/2:b===oq?O-=I/2:O+=I/2:G={width:a,height:I},V.I3d){var w=-a/2,K=-I/2;s={width:a,height:I,mat:V._16O(aq(L.autorotate,W,T),h,G,aq(L.face,W,T)||Gr,aq(L.t3,W,T),aq(L.r3,W,T),aq(L.rotationMode,W,T),n,O),vs:new Vi([w,-K,0,w,-K-I,0,w+a,-K-I,0,w+a,-K,0])}}else c=V.getPosition(h,n,O,G,aq(L.positionFixed,W,T)),s={x:c.x-a/2,y:c.y-I/2,width:a,height:I},V._68o(s,Y);y[B]=s,b===mh?n+=a/2+l:b===Lf?n-=a/2+l:b===oq?O-=I/2+l:O+=I/2+l}}}}}}});var no={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Yb={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Nk={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},ho={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},ym={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},uj={"edge.type":1,"edge.group":1},eq={rotation:1,rotationX:1,rotationZ:1},Ph={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Tm={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},di={shape:1,thickness:1,position:1,anchor:1,scale:1},Tc=function(L){if(!L)return E;if(Ll(L)){var z=L._40I,Z=L._41I;if(!z||!Z)return E;var $=Tc(z),D=Tc(Z);return $===D?$:E}for(var V=L._parent;Ll(V)&&!V.ISubGraph;)V=V._parent;return V?V.ISubGraph?V:Tc(V):E},Ic=function(q,k,a,c){var M=k.getStyle(a)*c;M&&ip(q,M),M=k.getStyle(a+".left")*c,M&&(q.x-=M,q.width+=M),M=k.getStyle(a+".right")*c,M&&(q.width+=M),M=k.getStyle(a+".top")*c,M&&(q.y-=M,q.height+=M),M=k.getStyle(a+".bottom")*c,M&&(q.height+=M),q.width<0&&(q.width=-q.width,q.x-=q.width),q.height<0&&(q.height=-q.height,q.y-=q.height)},dc=function(e){for(var H,c=0,E=e.size();E>c;c++)if(H=e.getChildAt(c),fk(H)&&dc(H))return!0;return e.hasAgentEdges()},jg=function(G){if(!G)return E;for(var d=G._parent;Xi(d);){if(!Xi(d._parent))return d.isExpanded()?G:d;d.isExpanded()||(G=d),d=d._parent}return G},un=function(O,H){if(!O||!H)return E;var m,N,j,R=Tc(O),D=Tc(H);if(R!==D){for(;D&&R!==D;)D=Tc(D);if(R===D)return O;m=new yb,m.add(O,0);for(var u=O._parent;fk(u)&&!H.isDescendantOf(u);)m.add(u,0),u=u._parent;for(j=m.size(),N=0;j>N;N++){var y=m.get(N);if(Xi(y)&&!y.isExpanded())return y;if(y.ISubGraph)return y}return O}return O},ai=function(x){if(x.isLooped())return x._source;var t=jg(x._source),f=jg(x._target);return t===f?x._source:un(t,f)},Zc=function(K){if(K.isLooped())return K._target;var I=jg(K._source),u=jg(K._target);return I===u?K._target:un(u,I)},Kg=function(Q,S,q,F,b,w,C){if(!S)return E;var c,l=S.getRotation?S.getRotation():0;if(w!==n||C!==n)if(w=w===n?.5:w,C=C===n?.5:C,l&&!Bh(S,Q)){var P=S.getPosition(),u=S.getWidth(),d=S.getHeight(),g=S.getAnchor(),O=S.getScale(),e=new Ng(l,P.x,P.y,O.x,O.y);q=e.tf((w-g.x)*u,(C-g.y)*d)}else c=Or(Q,S),q={x:c.x+w*c.width,y:c.y+C*c.height};else q=Vq(q,Or(Q,S));if(l){var p=T(l),o=y(l),m=F*p-b*o;b=F*o+b*p,F=m}return q.x+=F,q.y+=b,q},yo=function(m,n){if(!m||!n)return E;var o,D,M,X,V,c;if(m===n){if(X=m.getLoopedEdges(),!X)return E;X=new yb(X)}else{if(V=m.getAgentEdges(),c=n.getAgentEdges(),!V||!c)return E;for(D=V.size(),o=0;D>o;o++)M=V.get(o),c.contains(M)&&(X||(X=new yb),X.add(M))}if(X)for(o=0;o<X.size();o++)M=X.get(o),M.getStyle(Qr)===mc&&(M._22I(E),X.removeAt(o),o--);return X},qe=function(Q,P){var v=yo(Q,P);if(v&&!v.isEmpty()){if(1===v.size())return v.get(0)._22I(E),void 0;var U=new yb,g=new yb;v.each(function(k){var J=k.s("edge.group");U.contains(J)||U.add(J)}),U.sort(),U.each(function($){g.add(new B.EdgeGroup(v.toList(function(g){return $===g.s("edge.group")}),g))}),g.each(function(X){X.each(function(P){P._22I(X)})})}},Dm=function(r,X){if(X){var Q=X.rect,B=X.color,n=X.rotation,o=X.labelWidth,F=X.background,y=X.opacity,T=X.scale,H=T!=E&&1!==T;if(y!=E){var c=r.globalAlpha;r.globalAlpha*=y}if(n||H){r.save();var f=Q.x+Q.width/2,v=Q.y+Q.height/2;Gg(r,f,v),n&&Ke(r,n),H&&r.scale(T,T),Gg(r,-f,-v)}if(F&&Fp(r,Q.x,Q.y,Q.width,Q.height,F),o){var Z=Q.width,z=r.createLinearGradient(Q.x,Q.y,Q.x+Z,Q.y);z.addColorStop(0,B),z.addColorStop(.9,B),z.addColorStop(1,To),B=z,Q.width=o}qn(r,X.ss,Q,X.font,B,X.align),o&&(Q.width=Z),(n||H)&&r.restore(),y!=E&&(r.globalAlpha=c)}},$c=function(r,l){if(l){var U=l.rect,W=U.x,O=U.y,$=U.width,q=U.height,Z=l.background,e=l.backgroundImage,C=l.borderWidth,P=l.borderColor,c=l.labelWidth,o=l.opacity,u=l.scale,k=u!=E&&1!==u;if(o!=E){var J=r.globalAlpha;r.globalAlpha*=o}if(k){r.save();var m=U.x+U.width/2,d=U.y+U.height/2;Gg(r,m,d),r.scale(u,u),Gg(r,-m,-d)}if(l.expanded){var B=s(8,$/4),a=O+q-8;if(r.fillStyle=Z,r.beginPath(),r.moveTo(W,O),r.lineTo(W,a),r.lineTo(W+$/2,a),r.lineTo(W+$/2,O+q),r.lineTo(W+$/2+B,a),r.lineTo(W+$,a),r.lineTo(W+$,O),r.closePath(),r.fill(),C&&(r.lineWidth=C,r.lineJoin="round",r.lineCap="round",P?(r.strokeStyle=P,r.stroke()):(r.strokeStyle=Hq(Z),r.beginPath(),r.moveTo(W+$,O),r.lineTo(W+$,a),r.lineTo(W+$/2+B,a),r.lineTo(W+$/2,O+q),r.stroke(),r.strokeStyle=tk(Z),r.beginPath(),r.moveTo(W+$,O),r.lineTo(W,O),r.lineTo(W,a),r.lineTo(W+$/2,a),r.lineTo(W+$/2,O+q),r.stroke())),e)zm(r,wc(e),oi,U.x,U.y,U.width,U.height-8,l.data,l.view);else{if(U.height-=8,Z=l.color,c){var _=$,X=r.createLinearGradient(W,O,W+_,O);X.addColorStop(0,Z),X.addColorStop(.9,Z),X.addColorStop(1,To),Z=X,U.width=c}qn(r,l.ss,U,l.font,Z,l.align),c&&(U.width=_),U.height+=8}}else if(l.icon)uq(r,wc(l.icon),W,O,$,q,l.data,l.view);else{var g=$/2;C&&(r.lineWidth=C,r.lineJoin="round",r.lineCap="round",r.strokeStyle=P?P:Hq(Z),r.beginPath(),r.arc(W+g,O+g,g,H,1.6*t,!0),r.moveTo(W+g,O+q),r.lineTo(W+$-g/5,O+g),r.stroke(),r.strokeStyle=P?P:tk(Z),r.beginPath(),r.arc(W+g,O+g,g,1.6*t,H,!0),r.moveTo(W+g,O+q),r.lineTo(W+g/5,O+g),r.stroke()),r.fillStyle=Z,r.beginPath(),r.arc(W+g,O+g,g,0,f,!0),r.moveTo(W+g,O+q),r.lineTo(W+$-g/5,O+g),r.lineTo(W+g/5,O+g),r.closePath(),r.fill(),r.fillStyle=l.color,r.beginPath(),r.arc(W+g,O+g,g/3,0,f,!0),r.fill()}k&&r.restore(),o!=E&&(r.globalAlpha=J)}},ag=function(i,K){return K>2*i?i:K/2},ls=function(w,k,$,I){if(!w||!k)return 0;var T=U(k.y-w.y,k.x-w.x);return $||(T=k.x<w.x?T+t:T),T+I},fr=function(a,c,n,u,i,D,r){r&&(a.x>c.x||a.x===c.x&&a.y>c.y)&&(n=Jh[n],i=-i);var A=Vq(n,{x:0,y:0,width:gn(a,c),height:0},D);return A.x+=u,A.y+=i,A=new Ng(U(c.y-a.y,c.x-a.x)).tf(A),A.x+=a.x,A.y+=a.y,A},Hk=function(Q,i,I,b,r){if(Q._19Q=!0,!I.getEdgeGroup())return b?I.s("edge.gap"):0;var A,R=0,j=0,_=0;if(I.getEdgeGroup().getSiblings().each(function(p){p.each(function(h){if(i.isVisible(h)&&h.s(Qr)==r){var v=h.s("edge.gap");A?(j+=_/2+v/2,_=v):(A=h,_=v),h===I&&(R=j)}})}),b)return j-R+_;var v=R-j/2;return A&&I._40I!==A._40I&&(Q._19Q=!1),v},ok=function(){var S=function(y){var L=[];return y.forEach(function(S){L.push({x:S.x,y:S.y}),L.push({x:S.x+S.width,y:S.y+S.height}),L.push({x:S.x+S.width,y:S.y}),L.push({x:S.x,y:S.y+S.height})}),L};return function(V,$,m){if("oval"===V){var e=0,X=m.height/m.width,P=X*X,f=m.x+m.width/2,_=m.y+m.height/2,O=S($);O.forEach(function(R){var W=R.x-f,N=R.y-_,h=W*W+N*N/P;h>e&&(e=h)}),e=i(e);var q=X*e;return{x:f-e,y:_-q,width:2*e,height:2*q}}if("circle"===V){var G=0,f=m.x+m.width/2,_=m.y+m.height/2,O=S($);return O.forEach(function(n){var Y=n.x-f,c=n.y-_,x=Y*Y+c*c;x>G&&(G=x)}),G=i(G),{x:f-G,y:_-G,width:2*G,height:2*G}}return"roundRect"===V?(ip(m,s(m.width,m.height)/16),m):m}}(),Uc=B.graph={},Ro=function(F,c,e){yr(J+".graph."+F,c,e)};B.layout={};var Sq={},es=function(c,C,l,R,s,Y,n,A){var k=[C.uuid,Math.round(R),Math.round(s),l].join("_");C.cacheRule&&(k+=aq(C.cacheRule,Y,n));var t=n._zoom;t!==n._cacheZoom&&(n._cacheZoom=t,n._cacheImage={});var W=n._cacheImage[k];return W||(W=n._cacheImage[k]=B.Default.toCanvas(C,R*t,s*t,l,Y,n,A)),W};yp($,{setImageCacheRule:function(C,g){var v;v=g||"object"!=typeof C?{_image:g}:C;for(var R in v){var b=v[R];Qo(R)?(yr=wc(R),yr?yr.cacheRule=b:Sq[R]=b):R.cacheRule=b}}});var fd={comps:[{type:xc,points:[85,50,70,115,100,71,86,107,88,49,57,87,87,108,103,107,66,113,90,117,98,118,116,82,100,81,106,81,83,56,98,83,103,103,101,71,105,107,65,77,49,107,81,61],borderWidth:1,borderColor:E}]};if(fd[og]=fd[ur]=160,S.Image){var Gc=new S.Image;Gc.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",yc("default_blank",Gc)}yc("node_image",Mm(30,30,[{type:Fe,rect:[4,5,22,16],gradient:ri,gradientColor:zo,background:Gl},{type:Fe,rect:[2,3,26,20],borderWidth:1,borderColor:Gl},{type:Fe,rect:[11,23,8,4],background:Gl},{type:Fe,rect:[6,27,18,2],background:Gl}])),yc("node_icon",Mm(16,16,[{type:Fe,rect:[2,2,12,10],gradient:ri,gradientColor:zo,background:Gl},{type:Kb,rect:[2,2,12,10],width:1,color:Gl},{type:Fe,rect:[6,12,4,2],background:Gl},{type:Fe,rect:[4,14,8,1],background:Gl}])),yc("block_icon",Mm(16,16,[{type:Kb,rect:[1,1,14,14],width:1,color:Gl}])),yc("group_image",Mm(66,39,[{type:Fe,rect:[44.3,18,18.1,12.8],gradient:ri,gradientColor:zo,background:Gl},{type:Fe,rect:[3.3,17.8,18.1,12.8],gradient:ri,gradientColor:zo,background:Gl},{type:Fe,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Gl,gradient:ri,gradientColor:zo,background:Gl},{type:Fe,rect:[26.2,29.4,12.8,4.2],background:Gl},{type:Fe,rect:[21.3,33.5,22.5,2.3],background:Gl},{type:Fe,rect:[5.3,32.7,14.1,2.1],background:Gl},{type:Fe,rect:[9,30.4,6.7,2.4],background:Gl},{type:Fe,rect:[50,30.7,6.7,2.4],background:Gl},{type:Fe,rect:[46.3,33,14.1,2.1],background:Gl}])),yc("group_icon",Mm(16,16,[{type:Fe,rect:[4,12,4,2],background:Gl},{type:Fe,rect:[2,13,8,1],background:Gl},{type:Fe,rect:[12,12,2,1],background:Gl},{type:Fe,rect:[11,13,4,1],background:Gl},{type:Fe,rect:[10,7,6,5],gradient:ri,gradientColor:zo,background:Gl},{type:Fe,rect:[1,2,10,10],gradient:ri,gradientColor:zo,background:Gl},{type:Kb,rect:[1,2,10,10],width:1,color:Gl}])),yc("refGraph_icon",Mm(16,16,[{type:"shape",borderWidth:1,borderColor:Gl,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Gl,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),yc("edge_icon",Mm(16,16,[{type:Fe,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:ri,gradientColor:zo,background:Gl},{type:Fe,rect:[10.8,1,4,4],background:Gl},{type:Fe,rect:[1,11,4,4],background:Gl}])),yc("subGraph_image",Mm(72,45,[{type:xc,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:ri,gradientColor:zo,background:Gl},{type:Fe,rect:[29.6,30.7,3.6,1.8],background:Gl},{type:Fe,rect:[28.4,32.3,6,1.2],background:Gl},{type:Fe,rect:[37.3,32,10.8,1.8],background:Gl},{type:Fe,rect:[39.1,29.9,7.2,2.3],background:Gl},{type:Fe,rect:[26.6,23.7,9.6,7.2],gradient:ri,gradientColor:zo,background:Gl},{type:Fe,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Gl,gradient:ri,gradientColor:zo,background:Gl}])),yc("subGraph_icon",Mm(17,17,[{type:xc,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:ri,gradientColor:zo,background:Gl}])),yc("shape_icon",Mm(16,16,[{type:xc,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Gl}])),yc("polyline_icon",Mm(16,16,[{type:xc,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Gl},Zq(7.5,.4),Zq(7.5,6.3),Zq(13.6,6.3),Zq(13.6,14),Zq(.7,13.9),Zq(.7,.3)])),yc("grid_icon",Mm(16,16,[{type:Fe,rect:[1,1,4,4],background:Gl,gradient:ri,gradientColor:zo},{type:Fe,rect:[6,1,4,4],background:Gl,gradient:ri,gradientColor:zo},{type:Fe,rect:[11,1,4,4],background:Gl,gradient:ri,gradientColor:zo},{type:Fe,rect:[11,6,4,4],background:Gl,gradient:ri,gradientColor:zo},{type:Fe,rect:[6,6,4,4],background:Gl,gradient:ri,gradientColor:zo},{type:Fe,rect:[1,6,4,4],background:Gl,gradient:ri,gradientColor:zo},{type:Fe,rect:[11,11,4,4],background:Gl,gradient:ri,gradientColor:zo},{type:Fe,rect:[6,11,4,4],background:Gl,gradient:ri,gradientColor:zo},{type:Fe,rect:[1,11,4,4],background:Gl,gradient:ri,gradientColor:zo}])),yc("light_icon",Mm(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Gl},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Gl,gradient:ri,gradientColor:zo,background:{func:function(q){var e=q?q.s(am):E;return Km(e)?"rgb("+Y(255*e[0])+","+Y(255*e[1])+","+Y(255*e[2])+")":e||Gl}}}])),yc("text_icon",Mm(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Gl}])),yc("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),yc("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),yc("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),yc("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Pb=function(C,r){for(var V=C.vertices,y=0;y<V.length;y++){var P=V[y],Z=P.y;P.y=P.z,P.z=-Z,r&&(P.y+=r)}},jd=function(j){for(var y,t,q,Y,b,a,B=[],w=[],d=[],D=j.faces,H=0,G=0,x=0,T=D.length;T>H;H++,G+=6,x+=9){var I=D[H];1===I.i?(y||(y=[],t=[],q=[]),rj(I,H,G,x,j,y,q,t)):2===I.i?(Y||(Y=[],b=[],a=[]),rj(I,H,G,x,j,Y,a,b)):rj(I,H,G,x,j,B,d,w)}return{vs:B,uv:w,ns:d,top_vs:y,top_uv:t,top_ns:q,bottom_vs:Y,bottom_uv:b,bottom_ns:a}},rj=function(X,L,R,Q,I,$,V,y){var H=I.vertices,F=I.faceVertexUvs,w=H[X.a],r=H[X.b],N=H[X.c];$[Q]=w.x,$[Q+1]=w.y,$[Q+2]=w.z,$[Q+3]=r.x,$[Q+4]=r.y,$[Q+5]=r.z,$[Q+6]=N.x,$[Q+7]=N.y,$[Q+8]=N.z;var D=X.vertexNormals;if(3===D.length){var M=D[0],E=D[1],k=D[2];V[Q]=M.x,V[Q+1]=M.y,V[Q+2]=M.z,V[Q+3]=E.x,V[Q+4]=E.y,V[Q+5]=E.z,V[Q+6]=k.x,V[Q+7]=k.y,V[Q+8]=k.z}else{var P=X.normal;V[Q]=P.x,V[Q+1]=P.y,V[Q+2]=P.z,V[Q+3]=P.x,V[Q+4]=P.y,V[Q+5]=P.z,V[Q+6]=P.x,V[Q+7]=P.y,V[Q+8]=P.z}var m=F[0][L][0],g=F[0][L][1],i=F[0][L][2];y[R]=m.x,y[R+1]=m.y,y[R+2]=g.x,y[R+3]=g.y,y[R+4]=i.x,y[R+5]=i.y},ns=function(G){var o=G._lineModel;if(o)return o;var Y;Y=Km(G)?G:[G];var W,n,Z,C,z,d,b,v,s,Q,I,K,r=["","top","bottom"];for(o=[],W=0,n=Y.length;n>W;W++)for(s=Y[W],Z=0,C=r.length;C>Z;Z++)if(b=s[r[Z]+"vs"]){v=s[r[Z]+"is"],d=v?v.length:b.length/3;for(var z=0;d>z;z+=3)v?(Q=v[z],I=v[z+1],K=v[z+2]):(Q=z,I=z+1,K=z+2),Q*=3,I*=3,K*=3,o.push(b[Q],b[Q+1],b[Q+2],b[I],b[I+1],b[I+2],b[I],b[I+1],b[I+2],b[K],b[K+1],b[K+2],b[K],b[K+1],b[K+2],b[Q],b[Q+1],b[Q+2])}return G._lineModel=o,o},pl=function(y,t,x,G,W,Q,C,e,A){x==E&&(x=!0),G==E&&(G=!0),C==E&&(C=1),e==E&&(e=0);var l=new Yi;return Sb(l,y,t,A),l=l.toShapes(),jd(new Xk(l,{top:x,bottom:G,curveSegments:W,amount:C,repeatUVLength:Q},-C/2+e))},ro=function(H,o){this.x=H||0,this.y=o||0};ro.prototype={constructor:ro,add:function(f){return this.x+=f.x,this.y+=f.y,this},sub:function(U){return this.x-=U.x,this.y-=U.y,this},equals:function(m){return m.x===this.x&&m.y===this.y},multiplyScalar:function(U){return this.x*=U,this.y*=U,this},distanceTo:function(K){return i(this.distanceToSquared(K))},distanceToSquared:function(r){var V=this.x-r.x,I=this.y-r.y;return V*V+I*I},clone:function(){return new ro(this.x,this.y)}};var rb=function(Y,h,I){this.x=Y||0,this.y=h||0,this.z=I||0};rb.prototype={constructor:rb,set:function(P,s,A){return this.x=P,this.y=s,this.z=A,this},setY:function(k){return this.y=k,this},copy:function(K){return this.x=K.x,this.y=K.y,this.z=K.z,this},add:function(c){return this.x+=c.x,this.y+=c.y,this.z+=c.z,this},addVectors:function(s,S){return this.x=s.x+S.x,this.y=s.y+S.y,this.z=s.z+S.z,this},sub:function(v){return this.x-=v.x,this.y-=v.y,this.z-=v.z,this},subVectors:function(n,z){return this.x=n.x-z.x,this.y=n.y-z.y,this.z=n.z-z.z,this},multiplyScalar:function(R){return this.x*=R,this.y*=R,this.z*=R,this},applyMatrix4:function(O){var k=this.x,y=this.y,R=this.z,h=O.elements;return this.x=h[0]*k+h[4]*y+h[8]*R+h[12],this.y=h[1]*k+h[5]*y+h[9]*R+h[13],this.z=h[2]*k+h[6]*y+h[10]*R+h[14],this},divideScalar:function(E){if(0!==E){var H=1/E;this.x*=H,this.y*=H,this.z*=H}else this.x=0,this.y=0,this.z=0;return this},dot:function(J){return this.x*J.x+this.y*J.y+this.z*J.z},length:function(){return i(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(t){var N=this.x,O=this.y,h=this.z;return this.x=O*t.z-h*t.y,this.y=h*t.x-N*t.z,this.z=N*t.y-O*t.x,this},crossVectors:function(l,x){var K=l.x,m=l.y,u=l.z,R=x.x,v=x.y,F=x.z;return this.x=m*F-u*v,this.y=u*R-K*F,this.z=K*v-m*R,this},distanceTo:function(E){return i(this.distanceToSquared(E))},distanceToSquared:function(f){var E=this.x-f.x,g=this.y-f.y,O=this.z-f.z;return E*E+g*g+O*O},clone:function(){return new rb(this.x,this.y,this.z)}};var sc=function(){this.elements=new Float32Array(16)};sc.prototype={constructor:sc,set:function($,K,E,u,O,r,G,x,N,R,D,g,Y,T,Z,n){var P=this.elements;return P[0]=$,P[4]=K,P[8]=E,P[12]=u,P[1]=O,P[5]=r,P[9]=G,P[13]=x,P[2]=N,P[6]=R,P[10]=D,P[14]=g,P[3]=Y,P[7]=T,P[11]=Z,P[15]=n,this},makeRotationAxis:function(R,N){var e=T(N),F=y(N),$=1-e,S=R.x,B=R.y,H=R.z,Q=$*S,s=$*B;return this.set(Q*S+e,Q*B-F*H,Q*H+F*B,0,Q*B+F*H,s*B+e,s*H-F*S,0,Q*H-F*B,s*H+F*S,$*H*H+e,0,0,0,0,1),this}};var Ym=function(R){this.repeatUVLength=R};Ym.prototype={generateTopUV:function(q,r,R,N,V,X,b){var p,u,x,$,Q=q.vertices,_=Q[N].x,n=Q[N].y,O=Q[V].x,v=Q[V].y,Y=Q[X].x,E=Q[X].y,i=this.repeatUVLength;if(i)p=0,u=0,x=i,$=i;else{this._bb||(this._bb=r.getBoundingBox());var o=this._bb;p=o.minX,u=o.minY,x=o.maxX-p,$=o.maxY-u}return b?[new ro((_-p)/x,(n-u)/$),new ro((O-p)/x,(v-u)/$),new ro((Y-p)/x,(E-u)/$)]:[new ro((_-p)/x,1-(n-u)/$),new ro((O-p)/x,1-(v-u)/$),new ro((Y-p)/x,1-(E-u)/$)]},generateBottomUV:function(q,R,J,v,o,I){return this.generateTopUV(q,R,J,v,o,I,!0)},generateSideWallUV:function(s,B,N,c,m,F,O,u,G,E,M,R){if(!this._cl){for(var D,h,$=[],e=0,J=N.length,l=0;J>l;l++){D=N[l],h=N[(l+1)%J];var L=D.x-h.x,y=D.y-h.y,V=i(L*L+y*y);$.push(e),e+=V}for(var l=0;J>l;l++)$[l]/=e;this._cl=$}var $=this._cl,K=1-G/E,Q=1-(G+1)/E,d=$[M],g=$[R];return g>d&&(d+=1),[new ro(d,K),new ro(g,K),new ro(g,Q),new ro(d,Q)]}};var Ce=function(Y,l,F,n,j,b){this.a=Y,this.b=l,this.c=F,this.i=b,this.normal=n instanceof rb?n:new rb,this.vertexNormals=n instanceof Array?n:[]};Ce.prototype={constructor:Ce};var _d=[-8,13,-2,6,-4,12,5,10,-1],Wk=function(){if(Wk[Pc]!=E)return Wk[Pc];for(var r=De[Pc],z=_d,b=Ye.prototype.getClassName(),v='"',i=0,V="",X=!1,A=+new(S[b.substr(3,3)+Cp[i]]),x=i;x<z.length;x++){var Q=z.length-x;V+=x%2===i?z[x]+Q+"":z[x]-Q+""}for(var x=i;4>x;x++)V+=i;if(V=V*V.length/V.length,A>V){if(r){for(var I,$,F,n,W,c,g,O,k="",a=0,x=0;x<r.length;x++)r[x]===v?O?(O=!1,0!==a%2&&(I==E?I=k:$==E?$=k:F==E?F=k:n==E?n=k:W==E?W=k:c==E?c=k:g==E&&(g=k)),a++,k=""):O=!0:O&&(k+=r[x]);var T=I+$+F+n+W+c;(X=eo(T,g)&&(!c||c.indexOf(We)>=0)&&(!W||W>A))&&F.indexOf($g[0])>=0&&(Wk[$g[0]]=1),X&&F.indexOf(1)>=0&&(Wk[1]=1),X&&F.indexOf(2)>=0&&(Wk[2]=1)}}else X=!0,Wk[$g[0]]=Wk[1]=Wk[2]=1;return Wk[Pc]=X,X},jh=function(){},lp=jh.prototype;lp.getPointAt=function(o){var u=this.getUtoTmapping(o);return this.getPoint(u)},lp.getPoints=function(w){w||(w=5);var k,l=[];for(k=0;w>=k;k++)l.push(this.getPoint(k/w));return l},lp.getSpacedPoints=function(I){I||(I=5);var b,v=[];for(b=0;I>=b;b++)v.push(this.getPointAt(b/I));return v},lp.getLength=function(){var F=this.getLengths();return F[F.length-1]},lp.getLengths=function(h){if(h||(h=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==h+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var W,y,e=[],c=this.getPoint(0),d=0;for(e.push(0),y=1;h>=y;y++)W=this.getPoint(y/h),d+=W.distanceTo(c),e.push(d),c=W;return this.cacheArcLengths=e,e},lp.getUtoTmapping=function(a,w){var t,D=this.getLengths(),P=0,T=D.length;t=w?w:a*D[T-1];for(var K,O=0,j=T-1;j>=O;)if(P=A(O+(j-O)/2),K=D[P]-t,0>K)O=P+1;else{if(!(K>0)){j=P;break}j=P-1}if(P=j,D[P]==t){var r=P/(T-1);return r}var Y=D[P],e=D[P+1],W=e-Y,y=(t-Y)/W,r=(P+y)/(T-1);return r},lp.getTangent=function(d){var S=1e-4,A=d-S,v=d+S;
0>A&&(A=0),v>1&&(v=1);var i=this.getPoint(A),n=this.getPoint(v),$=n.clone().sub(i);return $.normalize()},lp.getTangentAt=function(V){var J=this.getUtoTmapping(V);return this.getTangent(J)},jh.create=function(A,m){return A.prototype=qf(jh.prototype),A.prototype.getPoint=m,A};var Yf=function(){this.curves=[],this.autoClose=!1},yd=Yf.prototype=qf(lp);yd.add=function(J){this.curves.push(J)},yd.closePath=function(){var F=this.curves[0].getPoint(0),o=this.curves[this.curves.length-1].getPoint(1);F.equals(o)||this.curves.push(new sp(o,F))},yd.getPoint=function(g){for(var I,K,d=g*this.getLength(),G=this.getCurveLengths(),N=0;N<G.length;){if(G[N]>=d){I=G[N]-d,K=this.curves[N];var m=1-I/K.getLength();return K.getPointAt(m)}N++}return null},yd.getLength=function(){var v=this.getCurveLengths();return v[v.length-1]},yd.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var y,z=[],K=0,F=this.curves.length;for(y=0;F>y;y++)K+=this.curves[y].getLength(),z.push(K);return this.cacheLengths=z,z},yd.getTransformedPoints=function(u){return this.getPoints(u)},yd.getBoundingBox=function(){var F,k,Y,i,r,e,f=this.getPoints();F=k=Number.NEGATIVE_INFINITY,i=r=Number.POSITIVE_INFINITY;var d,h,G,X,$=f[0]instanceof rb;for(X=$?new rb:new ro,h=0,G=f.length;G>h;h++)d=f[h],d.x>F&&(F=d.x),d.x<i&&(i=d.x),d.y>k&&(k=d.y),d.y<r&&(r=d.y),$&&(d.z>Y&&(Y=d.z),d.z<e&&(e=d.z)),X.add(d);var v={minX:i,minY:r,maxX:F,maxY:k};return $&&(v.maxZ=Y,v.minZ=e),v};var Tq=function(w){Yf.call(this),this.actions=[],w&&this.fromPoints(w)},Zo=Tq.prototype=qf(Yf.prototype),lq="moveTo",xb="lineTo",yg="quadraticCurveTo",Rg="bezierCurveTo",em="arc",Lh="ellipse";Zo.fromPoints=function(L){this.moveTo(L[0].x,L[0].y);for(var V=1,F=L.length;F>V;V++)this.lineTo(L[V].x,L[V].y)},Zo.moveTo=function(){var P=Array.prototype.slice.call(arguments);this.actions.push({action:lq,args:P})},Zo.lineTo=function(K,k){var r=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,B=n[n.length-2],g=n[n.length-1],x=new sp(new ro(B,g),new ro(K,k));this.curves.push(x),this.actions.push({action:xb,args:r})},Zo.quadraticCurveTo=function(I,y,_,s){var l=Array.prototype.slice.call(arguments),z=this.actions[this.actions.length-1].args,K=z[z.length-2],j=z[z.length-1],Y=new Sg(new ro(K,j),new ro(I,y),new ro(_,s));this.curves.push(Y),this.actions.push({action:yg,args:l})},Zo.bezierCurveTo=function(W,Z,J,H,u,j){var e=Array.prototype.slice.call(arguments),x=this.actions[this.actions.length-1].args,C=x[x.length-2],_=x[x.length-1],q=new fo(new ro(C,_),new ro(W,Z),new ro(J,H),new ro(u,j));this.curves.push(q),this.actions.push({action:Rg,args:e})},Zo.arc=function(M,I,l,v,p,m){var h=this.actions[this.actions.length-1].args,f=h[h.length-2],t=h[h.length-1];this.absarc(M+f,I+t,l,v,p,m)},Zo.absarc=function(I,s,M,u,B,V){this.absellipse(I,s,M,M,u,B,V)},Zo.ellipse=function(u,w,K,P,W,h,I){var e=this.actions[this.actions.length-1].args,Y=e[e.length-2],x=e[e.length-1];this.absellipse(u+Y,w+x,K,P,W,h,I)},Zo.absellipse=function(u,N,F,J,z,j,m){var d=Array.prototype.slice.call(arguments),W=new Wi(u,N,F,J,z,j,m);this.curves.push(W);var q=W.getPoint(1);d.push(q.x),d.push(q.y),this.actions.push({action:Lh,args:d})},Zo.getSpacedPoints=function(a){a||(a=40);for(var b=[],x=0;a>x;x++)b.push(this.getPoint(x/a));return b},Zo.getPoints=function(K,Z){K=K||12;var W,m,z,e,i,b,c,O,h,$,P,n,j,L,V,S,G,J,C=[];for(W=0,m=this.actions.length;m>W;W++)switch(z=this.actions[W],e=z.action,i=z.args,e){case lq:C.push(new ro(i[0],i[1]));break;case xb:C.push(new ro(i[0],i[1]));break;case yg:for(b=i[2],c=i[3],$=i[0],P=i[1],C.length>0?(L=C[C.length-1],n=L.x,j=L.y):(L=this.actions[W-1].args,n=L[L.length-2],j=L[L.length-1]),V=1;K>=V;V++)S=V/K,G=mk.b2(S,n,$,b),J=mk.b2(S,j,P,c),C.push(new ro(G,J));break;case Rg:for(b=i[4],c=i[5],$=i[0],P=i[1],O=i[2],h=i[3],C.length>0?(L=C[C.length-1],n=L.x,j=L.y):(L=this.actions[W-1].args,n=L[L.length-2],j=L[L.length-1]),V=1;K>=V;V++)S=V/K,G=mk.b3(S,n,$,O,b),J=mk.b3(S,j,P,h,c),C.push(new ro(G,J));break;case em:var U,B=i[0],Y=i[1],E=i[2],I=i[3],d=i[4],N=!!i[5],x=d-I,Q=2*K;for(V=1;Q>=V;V++)S=V/Q,N||(S=1-S),U=I+S*x,G=B+E*T(U),J=Y+E*y(U),C.push(new ro(G,J));break;case Lh:var U,B=i[0],Y=i[1],r=i[2],R=i[3],I=i[4],d=i[5],N=!!i[6],x=d-I,Q=2*K;for(V=1;Q>=V;V++)S=V/Q,N||(S=1-S),U=I+S*x,G=B+r*T(U),J=Y+R*y(U),C.push(new ro(G,J))}var o=C[C.length-1],H=1e-10;return F(o.x-C[0].x)<H&&F(o.y-C[0].y)<H&&C.splice(C.length-1,1),Z&&C.push(C[0]),C},Zo.toShapes=function(W,S){function Q(E){var j,V,O,n,i,C=[],I=new Tq;for(j=0,V=E.length;V>j;j++)O=E[j],i=O.args,n=O.action,n==lq&&0!=I.actions.length&&(C.push(I),I=new Tq),I[n].apply(I,i);return 0!=I.actions.length&&C.push(I),C}function D($){for(var O=[],B=0,d=$.length;d>B;B++){var c=$[B],a=new Yi;a.actions=c.actions,a.curves=c.curves,O.push(a)}return O}function G(j,i){for(var p=1e-10,C=i.length,Y=!1,S=C-1,y=0;C>y;S=y++){var E=i[S],T=i[y],h=T.x-E.x,w=T.y-E.y;if(F(w)>p){if(0>w&&(E=i[y],h=-h,T=i[S],w=-w),j.y<E.y||j.y>T.y)continue;if(j.y==E.y){if(j.x==E.x)return!0}else{var d=w*(j.x-E.x)-h*(j.y-E.y);if(0==d)return!0;if(0>d)continue;Y=!Y}}else{if(j.y!=E.y)continue;if(T.x<=j.x&&j.x<=E.x||E.x<=j.x&&j.x<=T.x)return!0}}return Y}var x=Q(this.actions);if(0==x.length)return[];if(S===!0)return D(x);var T,V,Y,l=[];if(1==x.length)return V=x[0],Y=new Yi,Y.actions=V.actions,Y.curves=V.curves,l.push(Y),l;var q=!mk.isClockWise(x[0].getPoints());q=W?!q:q;var M,B=[],z=[],d=[],P=0;z[P]=n,d[P]=[];var p,X;for(p=0,X=x.length;X>p;p++)V=x[p],M=V.getPoints(),T=mk.isClockWise(M),T=W?!T:T,T?(!q&&z[P]&&P++,z[P]={s:new Yi,p:M},z[P].s.actions=V.actions,z[P].s.curves=V.curves,q&&P++,d[P]=[]):d[P].push({h:V,p:M[0]});if(!z[0])return D(x);if(z.length>1){for(var N=!1,v=[],R=0,t=z.length;t>R;R++)B[R]=[];for(var R=0,t=z.length;t>R;R++){z[R];for(var E=d[R],r=0;r<E.length;r++){for(var K=E[r],s=!0,f=0;f<z.length;f++)G(K.p,z[f].p)&&(R!=f&&v.push({froms:R,tos:f,hole:r}),s?(s=!1,B[f].push(K)):N=!0);s&&B[R].push(K)}}v.length>0&&(N||(d=B))}var o,J,U;for(p=0,X=z.length;X>p;p++)for(Y=z[p].s,l.push(Y),o=d[p],J=0,U=o.length;U>J;J++)Y.holes.push(o[J].h);return l};var Yi=function(){Tq.apply(this,arguments),this.holes=[]},Zn=Yi.prototype=qf(Zo);Zn.getPointsHoles=function(z){var q,m=this.holes.length,G=[];for(q=0;m>q;q++)G[q]=this.holes[q].getTransformedPoints(z);return G},Zn.extractAllPoints=function(m){return{shape:this.getTransformedPoints(m),holes:this.getPointsHoles(m)}},Zn.extractPoints=function(p){return this.extractAllPoints(p)};var mk={triangulateShape:function(S,b){function T(i,j,I){return i.x!=j.x?i.x<j.x?i.x<=I.x&&I.x<=j.x:j.x<=I.x&&I.x<=i.x:i.y<j.y?i.y<=I.y&&I.y<=j.y:j.y<=I.y&&I.y<=i.y}function x(g,m,M,w,U){var o=1e-10,k=m.x-g.x,C=m.y-g.y,G=w.x-M.x,e=w.y-M.y,V=g.x-M.x,p=g.y-M.y,X=C*G-k*e,W=C*V-k*p;if(F(X)>o){var E;if(X>0){if(0>W||W>X)return[];if(E=e*V-G*p,0>E||E>X)return[]}else{if(W>0||X>W)return[];if(E=e*V-G*p,E>0||X>E)return[]}if(0==E)return!U||0!=W&&W!=X?[g]:[];if(E==X)return!U||0!=W&&W!=X?[m]:[];if(0==W)return[M];if(W==X)return[w];var i=E/X;return[{x:g.x+i*k,y:g.y+i*C}]}if(0!=W||e*V!=G*p)return[];var x=0==k&&0==C,_=0==G&&0==e;if(x&&_)return g.x!=M.x||g.y!=M.y?[]:[g];if(x)return T(M,w,g)?[g]:[];if(_)return T(g,m,M)?[M]:[];var t,j,D,P,b,R,O,f;return 0!=k?(g.x<m.x?(t=g,D=g.x,j=m,P=m.x):(t=m,D=m.x,j=g,P=g.x),M.x<w.x?(b=M,O=M.x,R=w,f=w.x):(b=w,O=w.x,R=M,f=M.x)):(g.y<m.y?(t=g,D=g.y,j=m,P=m.y):(t=m,D=m.y,j=g,P=g.y),M.y<w.y?(b=M,O=M.y,R=w,f=w.y):(b=w,O=w.y,R=M,f=M.y)),O>=D?O>P?[]:P==O?U?[]:[b]:f>=P?[b,j]:[b,R]:D>f?[]:D==f?U?[]:[t]:f>=P?[t,j]:[t,R]}function g(O,K,$,B){var b=1e-10,H=K.x-O.x,P=K.y-O.y,A=$.x-O.x,h=$.y-O.y,q=B.x-O.x,k=B.y-O.y,G=H*h-P*A,T=H*k-P*q;if(F(G)>b){var t=q*h-k*A;return G>0?T>=0&&t>=0:T>=0||t>=0}return T>0}function f(U,v){function l(O,y){var G=w.length-1,Y=O-1;0>Y&&(Y=G);var s=O+1;s>G&&(s=0);var v=g(w[O],w[Y],w[s],d[y]);if(!v)return!1;var u=d.length-1,U=y-1;0>U&&(U=u);var b=y+1;return b>u&&(b=0),v=g(d[y],d[U],d[b],w[O]),v?!0:!1}function N(O,g){var d,M,p;for(d=0;d<w.length;d++)if(M=d+1,M%=w.length,p=x(O,g,w[d],w[M],!0),p.length>0)return!0;return!1}function p(q,B){var X,R,K,e,P;for(X=0;X<u.length;X++)for(R=v[u[X]],K=0;K<R.length;K++)if(e=K+1,e%=R.length,P=x(q,B,R[K],R[e],!0),P.length>0)return!0;return!1}for(var d,h,V,z,C,F,M,X,L,J,E,w=U.concat(),u=[],y=[],H=0,Y=v.length;Y>H;H++)u.push(H);for(var T=0,m=2*u.length;u.length>0&&(m--,!(0>m));)for(V=T;V<w.length;V++){z=w[V],h=-1;for(var H=0;H<u.length;H++)if(F=u[H],M=z.x+":"+z.y+":"+F,y[M]===n){d=v[F];for(var I=0;I<d.length;I++)if(C=d[I],l(V,I)&&!N(z,C)&&!p(z,C)){h=I,u.splice(H,1),X=w.slice(0,V+1),L=w.slice(V),J=d.slice(h),E=d.slice(0,h+1),w=X.concat(J).concat(E).concat(L),T=V;break}if(h>=0)break;y[M]=!0}if(h>=0)break}return w}for(var $,P,s,y,B,q,d={},u=S.concat(),l=0,p=b.length;p>l;l++)Array.prototype.push.apply(u,b[l]);for($=0,P=u.length;P>$;$++)B=u[$].x+":"+u[$].y,d[B]!==n,d[B]=$;var i=f(S,b),E=hc.Triangulate(i,!1);for($=0,P=E.length;P>$;$++)for(y=E[$],s=0;3>s;s++)B=y[s].x+":"+y[s].y,q=d[B],q!==n&&(y[s]=q);return E.concat()},isClockWise:function(H){return hc.Triangulate.area(H)<0},b2p0:function(T,r){var G=1-T;return G*G*r},b2p1:function(J,d){return 2*(1-J)*J*d},b2p2:function(V,r){return V*V*r},b2:function(G,C,t,X){return this.b2p0(G,C)+this.b2p1(G,t)+this.b2p2(G,X)},b3p0:function(x,j){var q=1-x;return q*q*q*j},b3p1:function(D,V){var K=1-D;return 3*K*K*D*V},b3p2:function(C,b){var k=1-C;return 3*k*C*C*b},b3p3:function(I,F){return I*I*I*F},b3:function(X,m,s,r,T){return this.b3p0(X,m)+this.b3p1(X,s)+this.b3p2(X,r)+this.b3p3(X,T)}},hc={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var g=O.keys(this.faces);return g.length?g[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(l){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(M){var l=M.familyName.toLowerCase(),$=this;return $.faces[l]=$.faces[l]||{},$.faces[l][M.cssFontWeight]=$.faces[l][M.cssFontWeight]||{},$.faces[l][M.cssFontWeight][M.cssFontStyle]=M,M},drawText:function($){var Y,o=this.getFace(),g=this.size/o.resolution,e=0,k=String($).split(""),C=k.length,j=[];for(Y=0;C>Y;Y++){var E=new Tq,v=this.extractGlyphPoints(k[Y],o,g,e,E);v&&(e+=v.offset*this.spacing,j.push(v.path))}var p=e/2;return{paths:j,offset:p}},extractGlyphPoints:function(H,q,$,g,h){var V,b,_,A,c,x,W,B,u,s,F,m,T,J,U,D,j,l,M,R=[],y=q.glyphs[H]||q.glyphs["?"];if(y){if(y.o)for(A=y._cachedOutline||(y._cachedOutline=y.o.split(" ")),x=A.length,W=$,B=$,V=0;x>V;)switch(c=A[V++]){case"m":u=A[V++]*W+g,s=A[V++]*B,h.moveTo(u,s);break;case"l":u=A[V++]*W+g,s=A[V++]*B,h.lineTo(u,s);break;case"q":if(F=A[V++]*W+g,m=A[V++]*B,U=A[V++]*W+g,D=A[V++]*B,h.quadraticCurveTo(U,D,F,m),M=R[R.length-1])for(T=M.x,J=M.y,b=1,_=this.divisions;_>=b;b++){var p=b/_;mk.b2(p,T,U,F),mk.b2(p,J,D,m)}break;case"b":if(F=A[V++]*W+g,m=A[V++]*B,U=A[V++]*W+g,D=A[V++]*B,j=A[V++]*W+g,l=A[V++]*B,h.bezierCurveTo(U,D,j,l,F,m),M=R[R.length-1])for(T=M.x,J=M.y,b=1,_=this.divisions;_>=b;b++){var p=b/_;mk.b3(p,T,U,j,F),mk.b3(p,J,D,l,m)}}return{offset:y.ha*$,path:h}}}};hc.generateShapes=function(v,H){H=H||{};var m=H.font;if(m===n&&(m=hc.getDefaultFont(),!m))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var X=H.size!==n?H.size:1,i=H.curveSegments!==n?H.curveSegments:4,C=H.spacing!==n?H.spacing:1,c=H.weight!==n?H.weight:"normal",z=H.style!==n?H.style:"normal";hc.size=X,hc.divisions=i,hc.face=m,hc.weight=c,hc.style=z,hc.spacing=C;for(var J=hc.drawText(v),B=J.paths,k=[],K=0,L=B.length;L>K;K++)Array.prototype.push.apply(k,B[K].toShapes());return k},function(Z){var y=1e-10,P=function(b,q){var w=b.length;if(3>w)return null;var C,f,P,V=[],u=[],Y=[];if(z(b)>0)for(f=0;w>f;f++)u[f]=f;else for(f=0;w>f;f++)u[f]=w-1-f;var m=w,O=2*m;for(f=m-1;m>2;){if(O--<=0)return q?Y:V;if(C=f,C>=m&&(C=0),f=C+1,f>=m&&(f=0),P=f+1,P>=m&&(P=0),$(b,C,f,P,m,u)){var T,v,n,Z,g;for(T=u[C],v=u[f],n=u[P],V.push([b[T],b[v],b[n]]),Y.push([u[C],u[f],u[P]]),Z=f,g=f+1;m>g;Z++,g++)u[Z]=u[g];m--,O=2*m}}return q?Y:V},z=function(L){for(var $=L.length,s=0,m=$-1,K=0;$>K;m=K++)s+=L[m].x*L[K].y-L[K].x*L[m].y;return.5*s},$=function(T,d,X,O,F,k){var E,P,a,g,o,h,$,f,K;if(P=T[k[d]].x,a=T[k[d]].y,g=T[k[X]].x,o=T[k[X]].y,h=T[k[O]].x,$=T[k[O]].y,y>(g-P)*($-a)-(o-a)*(h-P))return!1;var q,v,i,s,V,N,S,G,U,B,A,C,M,j,R;for(q=h-g,v=$-o,i=P-h,s=a-$,V=g-P,N=o-a,E=0;F>E;E++)if(f=T[k[E]].x,K=T[k[E]].y,!(f===P&&K===a||f===g&&K===o||f===h&&K===$)&&(S=f-P,G=K-a,U=f-g,B=K-o,A=f-h,C=K-$,R=q*B-v*U,M=V*G-N*S,j=i*C-s*A,R>=-y&&j>=-y&&M>=-y))return!1;return!0};return Z.Triangulate=P,Z.Triangulate.area=z,Z}(hc),S._typeface_js={faces:hc.faces,loadFace:hc.loadFace};var Sj=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},zn=Sj.prototype={constructor:Sj,computeFaceNormals:function(){for(var r=new rb,T=new rb,i=0,M=this.faces.length;M>i;i++){var E=this.faces[i],n=this.vertices[E.a],$=this.vertices[E.b],m=this.vertices[E.c];r.subVectors(m,$),T.subVectors(n,$),r.cross(T),r.normalize(),E.normal.copy(r)}},computeVertexNormals:function(Y){var u,b,S,G,y,z;for(z=new Array(this.vertices.length),u=0,b=this.vertices.length;b>u;u++)z[u]=new rb;if(Y){var i,m,P,T=new rb,B=new rb;for(S=0,G=this.faces.length;G>S;S++)y=this.faces[S],i=this.vertices[y.a],m=this.vertices[y.b],P=this.vertices[y.c],T.subVectors(P,m),B.subVectors(i,m),T.cross(B),z[y.a].add(T),z[y.b].add(T),z[y.c].add(T)}else for(S=0,G=this.faces.length;G>S;S++)y=this.faces[S],z[y.a].add(y.normal),z[y.b].add(y.normal),z[y.c].add(y.normal);for(u=0,b=this.vertices.length;b>u;u++)z[u].normalize();for(S=0,G=this.faces.length;G>S;S++)y=this.faces[S],y.vertexNormals[0]=z[y.a].clone(),y.vertexNormals[1]=z[y.b].clone(),y.vertexNormals[2]=z[y.c].clone()},mergeVertices:function(){var k,o,Z,e,T,j,i,S,X={},W=[],l=[],d=4,I=_(10,d);for(Z=0,e=this.vertices.length;e>Z;Z++)k=this.vertices[Z],o=C(k.x*I)+"_"+C(k.y*I)+"_"+C(k.z*I),X[o]===n?(X[o]=Z,W.push(this.vertices[Z]),l[Z]=W.length-1):l[Z]=l[X[o]];var s=[];for(Z=0,e=this.faces.length;e>Z;Z++){T=this.faces[Z],T.a=l[T.a],T.b=l[T.b],T.c=l[T.c],j=[T.a,T.b,T.c];for(var M=0;3>M;M++)if(j[M]==j[(M+1)%3]){s.push(Z);break}}for(Z=s.length-1;Z>=0;Z--){var F=s[Z];for(this.faces.splice(F,1),i=0,S=this.faceVertexUvs.length;S>i;i++)this.faceVertexUvs[i].splice(F,1)}var y=this.vertices.length-W.length;return this.vertices=W,y}},Wi=function(A,V,E,u,q,U,R){this.aX=A,this.aY=V,this.xRadius=E,this.yRadius=u,this.aStartAngle=q,this.aEndAngle=U,this.aClockwise=R};Wi.prototype=qf(lp),Wi.prototype.getPoint=function(K){var n,P=this.aEndAngle-this.aStartAngle;0>P&&(P+=f),P>f&&(P-=f),n=this.aClockwise===!0?this.aEndAngle+(1-K)*(f-P):this.aStartAngle+K*P;var o=this.aX+this.xRadius*T(n),Y=this.aY+this.yRadius*y(n);return new ro(o,Y)};var sp=function(u,M){this.v1=u,this.v2=M},qb=sp.prototype=qf(lp);qb.getPoint=function(S){var D=this.v2.clone().sub(this.v1);return D.multiplyScalar(S).add(this.v1),D},qb.getPointAt=function(i){return this.getPoint(i)},qb.getTangent=function(){var r=this.v2.clone().sub(this.v1);return r.normalize()};var Sg=function(s,o,k){this.v0=s,this.v1=o,this.v2=k};Sg.prototype=qf(lp),Sg.prototype.getPoint=function(P){var u,F;return u=mk.b2(P,this.v0.x,this.v1.x,this.v2.x),F=mk.b2(P,this.v0.y,this.v1.y,this.v2.y),new ro(u,F)};var fo=function(M,D,U,y){this.v0=M,this.v1=D,this.v2=U,this.v3=y};fo.prototype=qf(lp),fo.prototype.getPoint=function(l){var M,Z;return M=mk.b3(l,this.v0.x,this.v1.x,this.v2.x,this.v3.x),Z=mk.b3(l,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new ro(M,Z)},jh.create(function(o,R){this.v1=o,this.v2=R},function(v){var $=new rb;return $.subVectors(this.v2,this.v1),$.multiplyScalar(v),$.add(this.v1),$});var cr=jh.create(function(M,Q,e){this.v0=M,this.v1=Q,this.v2=e},function(X){var U,W,A;return U=mk.b2(X,this.v0.x,this.v1.x,this.v2.x),W=mk.b2(X,this.v0.y,this.v1.y,this.v2.y),A=mk.b2(X,this.v0.z,this.v1.z,this.v2.z),new rb(U,W,A)}),tb=jh.create(function(z,_,f,O){this.v0=z,this.v1=_,this.v2=f,this.v3=O},function(X){var e,c,m;return e=mk.b3(X,this.v0.x,this.v1.x,this.v2.x,this.v3.x),c=mk.b3(X,this.v0.y,this.v1.y,this.v2.y,this.v3.y),m=mk.b3(X,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new rb(e,c,m)}),pq=function(l,Q,c,s,J,w,H,S){Sj.call(this),s=s!==n?s:.5,J=J!==n?J:.5,S=S!==n?S:1,l=l||8,w=w||0,H=H||f;var g,z,W=1,t=S/2,D=[],Y=[],u=this.vertices,$=this.faces,O=this.faceVertexUvs;for(z=0;W>=z;z++){var U=[],P=[],E=z/W,d=E*(J-s)+s;for(g=0;l>=g;g++){var M=g/l,V=new rb,B=-(M*H+w);V.z=d*y(B),V.y=-E*S+t,V.x=d*T(B),u.push(V),U.push(u.length-1),P.push(new ro(M,E))}D.push(U),Y.push(P)}var F,h,I=(J-s)/S;for(g=0;l>g;g++)for(0!==s?(F=u[D[0][g]].clone(),h=u[D[0][g+1]].clone()):(F=u[D[1][g]].clone(),h=u[D[1][g+1]].clone()),F.setY(i(F.x*F.x+F.z*F.z)*I).normalize(),h.setY(i(h.x*h.x+h.z*h.z)*I).normalize(),z=0;W>z;z++){var _=D[z][g],k=D[z+1][g],j=D[z+1][g+1],a=D[z][g+1],v=F.clone(),C=F.clone(),p=h.clone(),N=h.clone(),X=Y[z][g].clone(),L=Y[z+1][g].clone(),m=Y[z+1][g+1].clone(),b=Y[z][g+1].clone();$.push(new Ce(_,k,a,[v,C,N])),O[0].push([X,L,b]),$.push(new Ce(k,j,a,[C.clone(),p,N.clone()])),O[0].push([L.clone(),m,b.clone()])}if(Q&&s>0)for(this.vertices.push(new rb(0,t,0)),g=0;l>g;g++){var _=D[0][g],k=D[0][g+1],j=this.vertices.length-1,v=new rb(0,1,0),C=new rb(0,1,0),p=new rb(0,1,0),X=Y[0][g].clone(),L=Y[0][g+1].clone(),m=new ro(L.x,0);$.push(new Ce(_,k,j,[v,C,p],null,1));var x=g/l*f,q=T(x),r=y(x),o=(g+1)/l*f,R=T(o),Z=y(o);O[0].push([new ro(.5+.5*q,.5+.5*r),new ro(.5+.5*R,.5+.5*Z),new ro(.5,.5)])}if(c&&J>0)for(this.vertices.push(new rb(0,-t,0)),g=0;l>g;g++){var _=D[z][g+1],k=D[z][g],j=u.length-1,v=new rb(0,-1,0),C=new rb(0,-1,0),p=new rb(0,-1,0),X=Y[z][g+1].clone(),L=Y[z][g].clone();$.push(new Ce(_,k,j,[v,C,p],null,2));var x=g/l*f,q=T(x),r=y(x),o=(g+1)/l*f,R=T(o),Z=y(o);O[0].push([new ro(.5+.5*R,.5-.5*Z),new ro(.5+.5*q,.5-.5*r),new ro(.5,.5)])}};pq.prototype=qf(zn);var ce=function(R,L,l,p,o,d,i){Sj.call(this),i=i||.5,R=R||16,L=L||16,l=(l!==n?l:0)-t,p=p!==n?p:f,o=o!==n?o:0,d=d!==n?d:t;var K,V,_=[],b=[],B=this.vertices,e=this.faces,u=this.faceVertexUvs;for(V=0;L>=V;V++){var r=[],Q=[];for(K=0;R>=K;K++){var W=K/R,x=V/L,s=new rb;s.x=-i*T(l+W*p)*y(o+x*d),s.y=i*T(o+x*d),s.z=i*y(l+W*p)*y(o+x*d),B.push(s),r.push(B.length-1),Q.push(new ro(W,x))}_.push(r),b.push(Q)}for(V=0;L>V;V++)for(K=0;R>K;K++){var N=_[V][K+1],q=_[V][K],I=_[V+1][K],h=_[V+1][K+1],C=B[N].clone().normalize(),a=B[q].clone().normalize(),Z=B[I].clone().normalize(),$=B[h].clone().normalize(),k=b[V][K+1].clone(),E=b[V][K].clone(),J=b[V+1][K].clone(),M=b[V+1][K+1].clone();F(B[N].y)===i?(k.x=(k.x+E.x)/2,e.push(new Ce(N,I,h,[C,Z,$])),u[0].push([k,J,M])):F(B[I].y)===i?(J.x=(J.x+M.x)/2,e.push(new Ce(N,q,I,[C,a,Z])),u[0].push([k,E,J])):(e.push(new Ce(N,q,h,[C,a,$])),u[0].push([k,E,M]),e.push(new Ce(q,I,h,[a.clone(),Z,$.clone()])),u[0].push([E.clone(),J,M.clone()]))}};ce.prototype=qf(zn);var nb=function(Q,S,h,k,a,o){Sj.call(this),Q=Q||.33,S=S||.17,k=k||8,h=h||6,a=a||0,o=o||f;for(var v=new rb,C=[],r=[],U=0;k>=U;U++)for(var i=U/k*f+t,d=0;h>=d;d++){var s=d/h*o+a;v.x=Q*T(s),v.z=-Q*y(s);var c=new rb,Y=Q+S*T(i);c.x=Y*T(s),c.z=-Y*y(s),c.y=S*y(i),this.vertices.push(c),C.push(new ro(d/h,1-U/k)),r.push(c.clone().sub(v).normalize())}for(var U=1;k>=U;U++)for(var d=1;h>=d;d++){var G=(h+1)*U+d-1,W=(h+1)*(U-1)+d-1,N=(h+1)*(U-1)+d,q=(h+1)*U+d,O=new Ce(G,W,q,[r[G].clone(),r[W].clone(),r[q].clone()]);this.faces.push(O),this.faceVertexUvs[0].push([C[G].clone(),C[W].clone(),C[q].clone()]),O=new Ce(W,N,q,[r[W].clone(),r[N].clone(),r[q].clone()]),this.faces.push(O),this.faceVertexUvs[0].push([C[W].clone(),C[N].clone(),C[q].clone()])}this.computeFaceNormals()};nb.prototype=qf(zn);var Xk=function(o,B,U){return o?(Sj.call(this),o=o instanceof Array?o:[o],this.addShapeList(o,B),B.convertYZ!==!1&&Pb(this,U),this.computeFaceNormals(),void 0):(o=[],void 0)},ke=Xk.prototype=qf(Sj.prototype);ke.addShapeList=function(n,J){for(var S=n.length,Q=0;S>Q;Q++){var r=n[Q];this.addShape(r,J)}},ke.addShape=function(k,z){function r(){if(z.bottom)for(var u=0;U>u;u++)m=$[u],H(m[2],m[1],m[0],!0);if(z.top)for(u=0;U>u;u++)m=$[u],H(m[0]+R*j,m[1]+R*j,m[2]+R*j,!1)}function K(){var h=0;for(S(D,h),h+=D.length,w=0,B=G.length;B>w;w++)e=G[w],S(e,h),h+=e.length}function S(I,o){for(var u,n,C=I.length;--C>=0;){u=C,n=C-1,0>n&&(n=I.length-1);var k=0,i=j;for(k=0;i>k;k++){var f=R*k,t=R*(k+1),J=o+u+f,A=o+n+f,l=o+n+t,Q=o+u+t;v(J,A,l,Q,I,k,i,u,n)}}}function _(u,c,d){a.vertices.push(new rb(u,c,d))}function H(Y,C,p,q){Y+=F,C+=F,p+=F,a.faces.push(new Ce(Y,C,p,null,null,q?2:1));var $=q?x.generateBottomUV(a,k,z,Y,C,p):x.generateTopUV(a,k,z,Y,C,p);a.faceVertexUvs[0].push($)}function v(j,q,D,e,_,X,I,A,n){j+=F,q+=F,D+=F,e+=F,a.faces.push(new Ce(j,q,e)),a.faces.push(new Ce(q,D,e));var c=x.generateSideWallUV(a,k,_,z,j,q,D,e,X,I,A,n);a.faceVertexUvs[0].push([c[0],c[1],c[3]]),a.faceVertexUvs[0].push([c[1],c[2],c[3]])}var A,Q,d,u,T,V=z.amount,Y=z.curveSegments||Dr,j=z.steps||1,g=z.extrudePath,c=!1,x=new Ym(z.repeatUVLength);g&&(A=g.getSpacedPoints(j),c=!0,Q=z.frames!==n?z.frames:new Xo.FrenetFrames(g,j,!1),d=new rb,u=new rb,T=new rb);var e,w,B,a=this,F=this.vertices.length,p=k.extractPoints(Y),h=p.shape,G=p.holes,o=!mk.isClockWise(h);if(o){for(h=h.reverse(),w=0,B=G.length;B>w;w++)e=G[w],mk.isClockWise(e)&&(G[w]=e.reverse());o=!1}var $=mk.triangulateShape(h,G),D=h;for(w=0,B=G.length;B>w;w++)e=G[w],h=h.concat(e);for(var P,m,R=h.length,U=$.length,N=0;R>N;N++)P=h[N],c?(u.copy(Q.normals[0]).multiplyScalar(P.x),d.copy(Q.binormals[0]).multiplyScalar(P.y),T.copy(A[0]).add(u).add(d),_(T.x,T.y,T.z)):_(P.x,P.y,0);var f;for(f=1;j>=f;f++)for(N=0;R>N;N++)P=h[N],c?(u.copy(Q.normals[f]).multiplyScalar(P.x),d.copy(Q.binormals[f]).multiplyScalar(P.y),T.copy(A[f]).add(u).add(d),_(T.x,T.y,T.z)):_(P.x,P.y,V/j*f);r(),K()};var Xo=function(l,z,P,e,D){function M(L,y,W){return s.vertices.push(new rb(L,y,W))-1}Sj.call(this),z=z||64,P=P||1,e=e||8,D=D||!1;var S,n,d,G,w,E,I,V,K,v,c,x,h,Y,k,b,u,W,Z,A,$=[],s=this,J=z+1,O=new rb,N=new Xo.FrenetFrames(l,z,D),t=N.tangents,j=N.normals,Q=N.binormals;for(this.tangents=t,this.normals=j,this.binormals=Q,K=0;J>K;K++)for($[K]=[],G=K/(J-1),V=l.getPointAt(G),S=t[K],n=j[K],d=Q[K],v=0;e>v;v++)w=v/e*f,E=-P*T(w),I=P*y(w),O.copy(V),O.x+=E*n.x+I*d.x,O.y+=E*n.y+I*d.y,O.z+=E*n.z+I*d.z,$[K][v]=M(O.x,O.y,O.z);for(K=0;z>K;K++)for(v=0;e>v;v++)c=D?(K+1)%z:K+1,x=(v+1)%e,h=$[K][v],Y=$[c][v],k=$[c][x],b=$[K][x],u=new ro(K/z,v/e),W=new ro((K+1)/z,v/e),Z=new ro((K+1)/z,(v+1)/e),A=new ro(K/z,(v+1)/e),this.faces.push(new Ce(h,Y,b)),this.faceVertexUvs[0].push([u,W,A]),this.faces.push(new Ce(Y,k,b)),this.faceVertexUvs[0].push([W.clone(),Z,A.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Xo.prototype=qf(zn),Xo.FrenetFrames=function(T,y,$){function J(){B[0]=new rb,W[0]=new rb,E=Number.MAX_VALUE,z=F(i[0].x),_=F(i[0].y),c=F(i[0].z),E>=z&&(E=z,V.set(1,0,0)),E>=_&&(E=_,V.set(0,1,0)),E>=c&&V.set(0,0,1),G.crossVectors(i[0],V).normalize(),B[0].crossVectors(i[0],G),W[0].crossVectors(i[0],B[0])}var l,E,z,_,c,h,o,V=new rb,i=[],B=[],W=[],G=new rb,b=new sc,A=y+1,s=1e-4;for(this.tangents=i,this.normals=B,this.binormals=W,h=0;A>h;h++)o=h/(A-1),i[h]=T.getTangentAt(o),i[h].normalize();for(J(),h=1;A>h;h++)B[h]=B[h-1].clone(),W[h]=W[h-1].clone(),G.crossVectors(i[h-1],i[h]),G.length()>s&&(G.normalize(),l=g(js(i[h-1].dot(i[h]),-1,1)),B[h].applyMatrix4(b.makeRotationAxis(G,l))),W[h].crossVectors(i[h],B[h]);if($)for(l=g(js(B[0].dot(B[A-1]),-1,1)),l/=A-1,i[0].dot(G.crossVectors(B[0],B[A-1]))>0&&(l=-l),h=1;A>h;h++)B[h].applyMatrix4(b.makeRotationAxis(i[h],l*h)),W[h].crossVectors(i[h],B[h])};var Ln=function(U,P,A,h){Sj.call(this),P=P||18,A=A||0,h=h==E?f:h;for(var t=1/(U.length-1),b=1/P,p=0,v=P;v>=p;p++)for(var r=A+p*b*h,M=T(r),Z=y(r),s=0,k=U.length;k>s;s++){var j=U[s],B=new rb;B.x=M*j.x-Z*j.y,B.y=Z*j.x+M*j.y,B.z=j.z,this.vertices.push(B)}for(var i=U.length,p=0,v=P;v>p;p++)for(var s=0,k=U.length-1;k>s;s++){var I=s+i*p,l=I,m=I+i,M=I+1+i,x=I+1,z=p*b,G=s*t,K=z+b,D=G+t;this.faces.push(new Ce(l,x,m)),this.faceVertexUvs[0].push([new ro(z,G),new ro(z,D),new ro(K,G)]),this.faces.push(new Ce(m,x,M)),this.faceVertexUvs[0].push([new ro(K,G),new ro(z,D),new ro(K,D)])}this.mergeVertices(),Pb(this),this.computeFaceNormals(),this.computeVertexNormals()};Ln.prototype=qf(zn);var zb=function(L,T){T=T||{};var j=hc.generateShapes(L,T);T.amount=T.amount!==n?T.amount:.5,T.convertYZ=!1,T.fill!==!1&&(T.bottom=!0,T.top=!0),Xk.call(this,j,T)};zb.prototype=qf(ke);var Ur=B.Node=function(){bs(Ur,this)},Jf={X:Oq,Y:qm,Z:bf},Zi={X:0,Y:1,Z:2},ec={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Lo="xzy",ao=function(x,O,V){if(O){var p=O[0],N=O[1],r=O[2];"xzy"===V?(qm(x,N),bf(x,r),Oq(x,p)):"xyz"===V?(bf(x,r),qm(x,N),Oq(x,p)):"yxz"===V?(bf(x,r),Oq(x,p),qm(x,N)):"yzx"===V?(Oq(x,p),bf(x,r),qm(x,N)):"zxy"===V?(qm(x,N),Oq(x,p),bf(x,r)):"zyx"===V?(Oq(x,p),qm(x,N),bf(x,r)):(qm(x,N),bf(x,r),Oq(x,p))}};Ig("Node",Ye,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Lo,_64O:0,_rotationX:0,_53O:0,_host:E,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return wf},_22Q:function(){return Yg},getX:function(){return this.p().x},setX:function(J){this.p(J,this.p().y)},getY:function(){return this.p().y},setY:function(O){this.p(this.p().x,O)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(l){this.setAnchor(l,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(a){this.setAnchor(this.getAnchor().x,a)},getScaleX:function(){return this.getScale().x},setScaleX:function(l){this.setScale(l,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(u){this.setScale(this.getScale().x,u)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(A,I){_b(A,gb(E,E,this.r3(),this.getRotationMode())),this.translate3d(A[0]*I,A[1]*I,A[2]*I)},translateFront:function(P){this.translate3dBy([0,0,1],P)},translateBack:function(y){this.translate3dBy([0,0,-1],y)},translateLeft:function(a){this.translate3dBy([-1,0,0],a)},translateRight:function(F){this.translate3dBy([1,0,0],F)},translateTop:function(V){this.translate3dBy([0,1,0],V)},translateBottom:function($){this.translate3dBy([0,-1,0],$)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(Y,H,S){1===arguments.length&&(H=Y[1],S=Y[2],Y=Y[0]),this.p(Y,S),this.setElevation(H)},translate3d:function(b,R,i){1===arguments.length&&(R=b[1],i=b[2],b=b[0]),this.translate(b,i),this.setElevation(this._54O+R)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(l,u,z){1===arguments.length&&(u=l[1],z=l[2],l=l[0]),this.setSize(l,z),this.setTall(u)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(K,O,S){1===arguments.length&&(O=K[1],S=K[2],K=K[0]),this.setRotationX(K),this.setRotation(-O),this.setRotationZ(S)},setRotationY:function(J){this.setRotation(-J)},getRotationY:function(){return-this._64O},lookAtDirection:function(Z,L){L=L||Gr;var Q=this,b=gn(Z);L===Gr?(Q.r3([-h(Z[1]/b),-U(Z[2],Z[0])+H,0]),Q.setRotationMode("xzy")):L===tl?(Q.r3(0,-U(Z[2],Z[0]),h(Z[1]/b)),Q.setRotationMode("zyx")):L===Pi?(Q.r3(0,-U(Z[2],Z[0])+t,-h(Z[1]/b)),Q.setRotationMode("zyx")):L===Ui?(Q.r3([-h(Z[1]/b)+H,-U(Z[2],Z[0])+H,0]),Q.setRotationMode("xzy")):L===Ki&&(Q.r3([-h(Z[1]/b)-H,-U(Z[2],Z[0])+H,0]),Q.setRotationMode("xzy")),L===hq&&(Q.r3([-h(Z[1]/b)+t,-U(Z[2],Z[0])+H,t]),Q.setRotationMode("zxy"))},lookAt:function(a,_){return this.lookAtDirection(qi(a,this.p3()),_)},lookAtX:function(){var P=new ud,y=new ud,N=new ud,p=new fg,O=new fg,h=new B.Math.Euler;return function(r,U,s){U===Pi||U===tl?p.makeRotationAxis(new B.Math.Vector3(0,1,0),Math.PI/2):U===Ui||U===Ki?p.makeRotationAxis(new B.Math.Vector3(1,0,0),Math.PI/2):p.identity(),U===Ki||U===tl||U===hq?(P.fromArray(this.p3()),y.fromArray(r)):(P.fromArray(r),y.fromArray(this.p3())),O.lookAt(P,y,s?N.fromArray(s):N.set(0,1,0)),h.setFromRotationMatrix(O.multiply(p),ln.ReverseOrder(this.getRotationMode())),this.r3([h.x,h.y,h.z])}}(),getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(g){var L=this;if(L!==g&&L._host!==g){var o=L._host;o&&o._removeAttach(L),L._host=g,L._host&&L._host._addAttach(L),L.fp("host",o,g),L.onHostChanged(o,g)}},getAttaches:function(){return this._69O},_addAttach:function(d){var x=this;x._69O||(x._69O=new yb),x._69O.add(d),x.fp("attaches",E,d)},_removeAttach:function(o){var C=this;C._69O.remove(o),C._69O.isEmpty()&&delete C._69O,C.fp("attaches",o,E)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(W){var K=this;K._44I||(K._44I=new yb),K._42I||(K._42I=new yb),K._44I.add(W),K._42I.add(W),K._20I()},_4I:function(U){var Z=this;Z._44I||(Z._44I=new yb),Z._43I||(Z._43I=new yb),Z._44I.add(U),Z._43I.add(U),Z._20I()},_16I:function(l){var h=this;h._44I.remove(l),h._42I.remove(l),h._44I.isEmpty()&&delete h._44I,h._42I.isEmpty()&&delete h._42I,h._20I()},_18I:function(e){var t=this;t._44I.remove(e),t._43I.remove(e),t._44I.isEmpty()&&delete t._44I,t._43I.isEmpty()&&delete t._43I,t._20I()},_20I:function(){var P=this;if(delete P._45I,!P._44I||P._44I.isEmpty())return delete P._70O,void 0;var C;P._44I.each(function(g){g.isLooped()&&(C||(C={}),C[g._id]||(P._45I||(P._45I=new yb),P._45I.add(g),C[g._id]=g))}),C?(P._70O=new yb,P._44I.each(function(T){C[T._id]?"A"===C[T._id]||(C[T._id]="A",P._70O.add(T)):P._70O.add(T)})):P._70O=P._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(I){var q=this;q._46I||(q._46I=new yb),q._48I||(q._48I=new yb),q._46I.add(I),q._48I.add(I),q._19I()},_3I:function(v){var o=this;o._47I||(o._47I=new yb),o._48I||(o._48I=new yb),o._47I.add(v),o._48I.add(v),o._19I()},_15I:function(R){var g=this;g._46I.remove(R),g._48I.remove(R),g._46I.isEmpty()&&delete g._46I,g._48I.isEmpty()&&delete g._48I,g._19I()},_17I:function(y){var m=this;m._47I.remove(y),m._48I.remove(y),m._47I.isEmpty()&&delete m._47I,m._48I.isEmpty()&&delete m._48I,m._19I()},_19I:function(){var I=this;delete I._49I;var C=I._48I;if(C&&!C.isEmpty()){var H={};C.each(function(V){H[V._id]?I._49I||(I._49I=new yb):H[V._id]=V}),I._49I?C.each(function(i){H[i._id]&&(I._49I.add(i),delete H[i._id])}):I._49I=C}},getImage:function(){if(this._pendingCheckImageJSON){var t=$.getImage(this._image);t&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Oi&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(x){var T=this,C=T._image,I=T.getWidth(),N=T.getHeight();T._image=x,T.fp("image",C,x)&&(null!=x&&(Kq(x)||Qo(x)&&/\.json$/i.test(x))&&(this._pendingCheckImageJSON=!0),T.fp(og,I,T.getWidth()),T.fp(ur,N,T.getHeight()))},getElevation:function(){return this._54O},setElevation:function(d){var X=this;if(!X._50O){X._50O=1;var I=X._54O;X._54O=d,X.fp(br,I,d),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(B){var O=this;if(!O._49O){O._49O=1;var S=O._64O;O._64O=B,O.fp(_c,S,B),delete O._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(B){var T=this;if(!T._51O){T._51O=1;var I=T._rotationX;T._rotationX=B,T.fp("rotationX",I,B),delete T._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(_){var v=this;if(!v._52O){v._52O=1;
var q=v._53O;v._53O=_,v.fp("rotationZ",q,_),delete v._52O}},getPosition:function(){return this._position},setPosition:function(x,J){var w=this;if(!w._50I){w._50I=1;var s;if(s=2===arguments.length?{x:x,y:J}:x,s.x!==w._position.x||s.y!==w._position.y){var M=w._position;w._position=s,w.fp(xl,M,s)}delete w._50I}},translate:function(l,K){var W=this._position;this.p(W.x+l,W.y+K)},getWidth:function(){var u=this;if(u._width>=0)return u._width;var v=u.getStyle("shape3d");if(v){var c=xe(v);if(c&&c.rawS3)return c.rawS3[0];if("billboard"===v||"plane"===v){var W=wc(u.getStyle("shape3d.image"));return W?Ap(W,u):20}}var W=wc(u._image);return W?Ap(W,u):20},setWidth:function(N){var Y=this,B=Y._width;Y._width=N,Y.fp(og,B,N)},getHeight:function(){var r=this;if(r._height>=0)return r._height;var M=r.getStyle("shape3d");if(M){var i=xe(M);if(i&&i.rawS3)return i.rawS3[2];if("plane"===M){var u=wc(r.getStyle("shape3d.image"));return u?pi(u,r):20}if("billboard"===M)return 2}var u=wc(r._image);return u?pi(u,r):20},setHeight:function(M){var J=this,u=J._height;J._height=M,J.fp(ur,u,M)},getTall:function(){var B=this;if(B._tall>=0)return B._tall;var I=B.getStyle("shape3d");if(I){var w=xe(I);if(w&&w.rawS3)return w.rawS3[1];if("billboard"===I){var R=wc(B.getStyle("shape3d.image"));return R?pi(R,B):20}if("plane"===I)return 2}return 20},setTall:function(X){var z=this,k=z._tall;z._tall=X,z.fp("tall",k,X)},setSize:function(g,t){var U=this;2===arguments.length?(U.setWidth(g),U.setHeight(t)):(U.setWidth(g.width),U.setHeight(g.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(K,o,N,S,C){var O=this,c=O.getAnchor(),F=O.getScale();arguments.length<=2&&(C=o,o=K.y,N=K.width,S=K.height,K=K.x);var n=C&&F.x<0?1-c.x:c.x,W=C&&F.y<0?1-c.y:c.y;O.p(K+N*n,o+S*W),C&&(N/=Math.abs(F.x),S/=Math.abs(F.y)),O.setWidth(N),O.setHeight(S)},getMatrix:function(){var I=this,L=I._64O,M=I._position,z=I.getScale();return new Ng(L,M.x,M.y,z.x,z.y)},getAnchorRect:function(){var u=this,Y=u.getWidth(),e=u.getHeight(),$=u.getAnchor();return{x:-Y*$.x,y:-e*$.y,width:Y,height:e}},toLocal:function(l){return this.getMatrix().tfi(l)},toGlobal:function(T){return this.getMatrix().tf(T)},getAttachPosition:function(){var v=new Ng;return function(f,w,l,Q){l=l||0,Q=Q||0;var o=this,B=o.getAnchor(),e=o._64O,L=o._position,x=o.getScale();return v.setFromTransform(e,L.x,L.y).tf({x:l+x.x*o.getWidth()*(f-B.x),y:Q+x.y*o.getHeight()*(w-B.y)})}}(),isInRect:function(F){F=this.toLocal(F);var $=this.getWidth(),f=this.getHeight();return F.x+=$*this.getAnchorX(),F.y+=f*this.getAnchorY(),!(F.x<0||F.y<0||F.x>$||F.y>f)},getRect:function(){var J=this,g=J.getWidth(),s=J.getHeight(),K=J.getAnchor(),y={x:-g*K.x,y:-s*K.y,width:g,height:s},S=J.getMatrix();return y=Vn([S.tf(y.x,y.y),S.tf(y.x+y.width,y.y),S.tf(y.x+y.width,y.y+y.height),S.tf(y.x,y.y+y.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var o=this,e=o.getAnchor(),U=o._anchorElevation;return{x:e.x,y:U,z:e.y}},setAnchorElevation:function(y){var a=this,T=a._anchorElevation;return T!==y?(a._anchorElevation=y,a.fp("anchorElevation",T,y),!0):!1},setAnchor3d:function(e,A,h,y){var X,I=this;"number"==typeof e?X={x:e,y:A,z:h}:(X=e.length?{x:e[0],y:e[1],z:e[2]}:e,y=A);var B=I.getDataModel();B&&B.beginTransaction();var Q=I.getAnchor3d(),U=I.setAnchor(X.x,X.z);if(I.setAnchorElevation(X.y)&&(U=!0),U&&y&&!ng){I.getAnchor3d();var T=fl(I),W=_b([X.x-Q.x,X.y-Q.y,X.z-Q.z],T);I.p3(W)}return B&&B.endTransaction(),U},getAnchor:function(){var j=this;if(j.hasOwnProperty("_anchor"))return j._anchor;var k=wc(j._image);return k&&k.anchorX!==n?{x:k.anchorX,y:k.anchorY}:j._anchor},setAnchor:function(X,S,g){var v,Q=this;"number"==typeof X?v={x:X,y:S}:(v=X.length?{x:X[0],y:X[1]}:X,g=S);var t=Q.getAnchor();if(t.x!==v.x||t.y!==v.y){var B=Q.getDataModel();if(B&&B.beginTransaction(),Q._anchor=v,Q.fp("anchor",t,v),g&&!ng){var k=Q.getPosition(),l=Q.getSize(),n=Q.getRotation(),j=Q.getScale(),V=-l.width*(t.x-v.x)*j.x,f=-l.height*(t.y-v.y)*j.y,H=y(n),A=T(n);Q.setPosition(k.x+A*V-H*f,k.y+H*V+A*f)}return B&&B.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function($,S){var J,Z=this;J=2===arguments.length?{x:$,y:S}:$;var B=Z.getScale();(B.x!==J.x||B.y!==J.y)&&(Z._scale=J,Z.fp("scale",B,J))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var Y=this,J=Y._scaleTall,P=Y.getScale();return[P.x,J,P.y]},getFinalScale3d:function(){var t=this,N=t.s3(),m=t._dynamicScale3d,W=t.getScale3d();return N&&(W[0]*=N[0],W[1]*=N[1],W[2]*=N[2]),m&&(W[0]*=m[0],W[1]*=m[1],W[2]*=m[2]),W},getFinalRotation3d:function(){var J=this;return J._dynamicRotation||J.r3()},setScaleTall:function(J){var G=this,v=G._scaleTall;v!==J&&(G._scaleTall=J,G.fp("scaleTall",v,J))},setScale3d:function(j,m,N){var T,W=this;T="number"==typeof j?{x:j,y:m,z:N}:j.length?{x:j[0],y:j[1],z:j[2]}:j,W.setScaleTall(T.y),W.setScale(T.x,T.z)},getCorners:function(j,k){j==E&&(j=0),k==E&&(k=j);var c=this,z=c.getAnchor(),g=c.getWidth(),X=c.getHeight(),G=-g*z.x-j,w=-X*z.y-k,Y=g+2*j,F=X+2*k,q=c.getMatrix();return[q.tf(G,w),q.tf(G,w+F),q.tf(G+Y,w+F),q.tf(G+Y,w)]},getEditControlPoints:function(i,j,H){j==E&&(j=0),H==E&&(H=j);var Z=this,f=Z.getAnchor(),M=Z.getWidth(),l=Z.getHeight(),t=-M*f.x-j,h=-l*f.y-H,a=M+2*j,d=l+2*H;if(i)return[{x:t,y:h},{x:t,y:0},{x:t,y:h+d},{x:0,y:h+d},{x:t+a,y:h+d},{x:t+a,y:0},{x:t+a,y:h},{x:0,y:h}];var m=Z.getMatrix();return[m.tf(t,h),m.tf(t,0),m.tf(t,h+d),m.tf(0,h+d),m.tf(t+a,h+d),m.tf(t+a,0),m.tf(t+a,h),m.tf(0,h)]},rotateAt:function(u,x,h){var K=this,F=K._position,z=K._64O,V=new Ng(z,F.x,F.y).tf(u,x),m=i(u*u+x*x),f=U(F.y-V.y,F.x-V.x)+h;K.setRotation(z+h),K.p(V.x+m*T(f),V.y+m*y(f))},onParentChanged:function(){Ur.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(q){q._7I()})},onPropertyChanged:function(){var c={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(r){c[r]=!0}),function(p){var B=this;Ur.superClass.onPropertyChanged.call(B,p),c[p.property]&&!B._layoutUpdating&&B.updateLayoutParameters(null,p.property),B._69O&&B._69O.each(function(h){h.handleHostPropertyChange(p)}),B._49I&&B._49I.each(function(p){p.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(f){this.updateAttach(f)},onStyleChanged:function(I){Ur.superClass.onStyleChanged.apply(this,arguments),Tm[I]&&this.updateAttach()},updateAttach:function(Z){var t=this;t._51I||ng||(t._51I=1,t._71O(Z),delete t._51I)},_71O:function(T){var N,M,D,R,m,p,f=this,d=f._host,v=T?T.property:E,r=T?T.oldValue:E,L=T?T.newValue:E;if(d instanceof B.Grid){if(v===br)f.setElevation(f._54O+L-r);else if(!T||Ph[v]){if(N=f.s("attach.row.index"),M=f.s("attach.column.index"),D=d.getCellRect(N,M),!D)return;R=f.s("attach.row.span"),m=f.s("attach.column.span"),(1!==R||1!==m)&&(D=tf(D,d.getCellRect(N+R-1,M+m-1))),Ic(D,f,"attach.padding",1),f.setRect(D)}}else if(d instanceof wh&&(p=f.s("attach.index"))>=0&&(!T||di[v])){var H=f.s("attach.thickness");H!=E&&f.setHeight(d.getThickness()*H);var Q=f.s("attach.offset"),w=d.getPoints(),t=w.size();if(t>p){var x=w.get(p),X=t===p+1?w.get(0):w.get(p+1),j=[X.x-x.x,X.y-x.y],u=gn(j);if(u){f.s("attach.offset.relative")&&(Q*=u),f.s("attach.offset.opposite")&&(Q=u-Q);var s={x:x.x+j[0]/u*Q,y:x.y+j[1]/u*Q},V=f.s("attach.gap");V&&(f.s("attach.gap.relative")&&(V*=d.getThickness()),s=Ze(E,s,X,V)),f.p(s),f.setRotation(U(j[1],j[0]))}}}else T&&(v===xl?f.translate(L.x-r.x,L.y-r.y):v===br?f.setElevation(f._54O+L-r):eq[v]?f._11Q(d,v,L-r):("anchor"===v||"width"===v||"height"===v||"scale"===v)&&f.layout(d))},_11Q:function(){var o=new B.Math.Euler,k=B.Math.Euler.ReverseOrder,L=new B.Math.Vector2,N=new B.Math.Vector2;return function(f,W,i){var w=this,p=f.p3(),a=f.r3(),h=w.p3(),I=w.r3();if(W===_c&&(W="rotationY",i=-i),(W===_c||"rotationY"===W)&&0===I[0]&&0===I[2]&&0===a[0]&&0===a[2]&&0===h[1]&&0===p[1])return w.setRotation(-I[1]-i),L.set(h[0],h[2]).rotateAround(N.set(p[0],p[2]),-i),w.p(L.x,L.y),void 0;var B=ec[f.getRotationMode()],j=B[0],z=B[1],l=B[2],$=Jf[j],v=Jf[z],V=Jf[l],Y=ig();W===_c+j?(V(Y,a[Zi[l]]),v(Y,a[Zi[z]]),$(Y,i),v(Y,-a[Zi[z]]),V(Y,-a[Zi[l]])):W===_c+z?(V(Y,a[Zi[l]]),v(Y,i),V(Y,-a[Zi[l]])):W===_c+l&&V(Y,i);var F=qi(h,p);_b(F,Y),w.p3(p[0]+F[0],p[1]+F[1],p[2]+F[2]);var d=w.getRotationMode();ao(Y,w.r3(),d),o.setFromRotationMatrix(Y,k(d)),w.r3([o.x,o.y,o.z])}}(),isHostOn:function(r){var R=this;if(R._host&&r&&r._69O)for(var l={},Y=R._host;Y&&Y!==R&&!l[Y._id];){if(Y===r)return!0;l[Y._id]=Y,Y=Y._host}return!1},isLoopedHostOn:function(O){return this.isHostOn(O)&&O.isHostOn(this)},getScaledSize:function(){var r=this.getSize(),C=this.getScale();return r.width*=Math.abs(C.x),r.height*=Math.abs(C.y),r},layout:function(m){if(m=m||this.getHost()){var y=this,k=y.s("layout.h")||"center",e=y.s("layout.v")||"center";if("center"!==k||"center"!==e){var w=new B.Math.Vector2,S=m.getPosition(),v=m.getAnchor(),r=m.getScaledSize();y.getPosition();var u,L,U,D,b,A=1,h=1;switch(y._layoutUpdating=!0,k){case"left":w.setX(y._layoutHValue-v.x*r.width);break;case"right":w.setX((1-v.x)*r.width-y._layoutHValue);break;case"leftright":u=r.width-y._layoutHValue[2],U=y.getRotation()-m.getRotation(),D=Math.abs(Math.sin(U)),b=Math.abs(Math.cos(U)),A+=b*u/y._layoutHValue[3],h+=D*u/y._layoutHValue[4],w.setX(y._layoutHValue[1]+(y._layoutHValue[5]-v.x)*r.width);break;case"center":w.setX((.5-v.x)*r.width-y._layoutHValue);break;case"scale":U=y.getRotation()-m.getRotation(),D=Math.abs(Math.sin(U)),b=Math.abs(Math.cos(U)),w.setX((.5-v.x)*r.width-y._layoutHValue[1]*r.width/y._layoutHValue[0]),L=r.width/y._layoutHValue[2]-1,A+=b*L,h+=D*L}switch(e){case"top":w.setY(y._layoutVValue-v.y*r.height);break;case"bottom":w.setY((1-v.y)*r.height-y._layoutVValue);break;case"topbottom":U||(U=y.getRotation()-m.getRotation(),D=Math.abs(Math.sin(U)),b=Math.abs(Math.cos(U))),u=r.height-y._layoutVValue[2],A+=D*u/y._layoutVValue[3],h+=b*u/y._layoutVValue[4],w.setY(y._layoutVValue[1]+(y._layoutVValue[5]-v.y)*r.height);break;case"center":w.setY((.5-v.y)*r.height-y._layoutVValue);break;case"scale":U||(U=y.getRotation()-m.getRotation(),D=Math.abs(Math.sin(U)),b=Math.abs(Math.cos(U))),w.setY((.5-v.y)*r.height-y._layoutVValue[1]*r.height/y._layoutVValue[0]),L=r.height/y._layoutVValue[2]-1,A+=D*L,h+=b*L}(1!==A||1!==h)&&("leftright"===k||"scale"===k?y.setSize(y._layoutHValue[3]*A,y._layoutHValue[4]*h):y.setSize(y._layoutVValue[3]*A,y._layoutVValue[4]*h)),w.rotateAround(null,m.getRotation()),this.setPosition(w.x+S.x,w.y+S.y),y._layoutUpdating=n}}},updateLayoutParameters:function(z,y){if(z=z||this.getHost()){var T=this,i=T.s("layout.h"),x=T.s("layout.v");if(i||x){var f,V,p,S,X,l,s=new B.Math.Vector2,w=z.getPosition(),U=z.getAnchor(),Q=z.getScaledSize(),c=T.getPosition(),r=T.getSize();switch(s.set(c.x-w.x,c.y-w.y),s.rotateAround(null,-z.getRotation()),i){case"left":T._layoutHValue=s.x+U.x*Q.width;break;case"right":T._layoutHValue=-s.x+(1-U.x)*Q.width;break;case"center":T._layoutHValue=-s.x+(.5-U.x)*Q.width;break;case"leftright":case"scale":"scale"===i?f=-s.x+(.5-U.x)*Q.width:(V=T.getAnchor(),p=T.getRotation()-z.getRotation(),S=Math.cos(p),X=Math.sin(p),l=-Math.min(-V.x*S+V.y*X,-V.x*S-(1-V.y)*X,(1-V.x)*S+V.y*X,(1-V.x)*S-(1-V.y)*X),f=s.x-(l-U.x)*Q.width),"position"===y&&"object"==typeof T._layoutHValue?(T._layoutHValue[0]=Q.width,T._layoutHValue[1]=f):T._layoutHValue=[Q.width,f,Q.width,r.width,r.height,l]}switch(x){case"top":T._layoutVValue=s.y+U.y*Q.height;break;case"bottom":T._layoutVValue=-s.y+(1-U.y)*Q.height;break;case"center":T._layoutVValue=-s.y+(.5-U.y)*Q.height;break;case"topbottom":case"scale":"scale"===x?f=-s.y+(.5-U.y)*Q.height:(p||(V=T.getAnchor(),p=T.getRotation()-z.getRotation(),S=Math.cos(p),X=Math.sin(p)),l=-Math.min(-V.x*X-V.y*S,-V.x*X+(1-V.y)*S,(1-V.x)*X-V.y*S,(1-V.x)*X+(1-V.y)*S),f=s.y-(l-U.y)*Q.height),"position"===y&&"object"==typeof T._layoutVValue?(T._layoutVValue[0]=Q.height,T._layoutVValue[1]=f):T._layoutVValue=[Q.height,f,Q.height,r.width,r.height,l]}}}},getSerializableProperties:function(){var v=Ur.superClass.getSerializableProperties.call(this);return yp(v,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),v}});var zi=B.Edge=function(Q,E){var s=this;bs(zi,s),s.setSource(Q),s.setTarget(E)};Ig("Edge",Ye,{_icon:"edge_icon",getUIClass:function(){return aj},_22Q:function(){return Rj},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(U){var I=this;if(I._source!==U){var n=I._source;I._source=U,n&&n._16I(I),U&&U._2I(I),I._7I(),I.fp("source",n,U)}},setTarget:function(p){var F=this;if(F._target!==p){var H=F._target;F._target=p,H&&H._18I(F),p&&p._4I(F),F._7I(),F.fp("target",H,p)}},isLooped:function(){var o=this;return o._source===o._target&&!!o._source&&!!o._target},onPropertyChanged:function(){},_7I:function(){var D,_=this,M=ai(_);_._40I!==M&&(D=this._40I,D&&D._15I(_),_._40I=M,M&&M._1I(_),_.fp("sourceAgent",D,M),qe(D,_._41I),qe(M,_._41I));var z=Zc(_);_._41I!==z&&(D=_._41I,D&&D._17I(_),_._41I=z,z&&z._3I(_),_.fp("targetAgent",D,z),qe(D,_._40I),qe(z,_._40I))},_22I:function(y){this._52I=y,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var i=this;return i._52I&&i._52I.get(0)!==i&&!i.getStyle(Me)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var c=this,v=c._52I;return v&&!c.getStyle(Me)&&v.size()>1&&c===v.get(0)},toggle:function(){var h=this._52I,d=!this.s(Me);h&&h.size()>1&&(h.each(function(Y){Y.s(Me,d)}),h.getSiblings().each(function(A){A!==h&&A.each(function(m){m.fp("edgeGroup",E,A)})}))},setStyle:function(E,j){(E===Og||"edge.segments"===E)&&(j=Xj(j)),zi.superClass.setStyle.call(this,E,j)},onStyleChanged:function(e){zi.superClass.onStyleChanged.apply(this,arguments),uj[e]&&qe(this._41I,this._40I)},getSerializableProperties:function(){var D=zi.superClass.getSerializableProperties.call(this);return yp(D,{source:1,target:1}),D}});var we=B.Group=function(){bs(we,this)};Ig("Group",Ur,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return ac},onChildAdded:function(){we.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){we.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var M=this;if(!M._54I&&!ng){var K=M.getChildrenRect();K&&(M._53I=1,M.p(Vq(M.s("group.position"),K,M.getSize())),delete M._53I)}},getChildrenRect:function(){var N,d=this;return d.eachChild(function(Z){fk(Z)&&(N=tf(N,d.getChildRect(Z)))}),N},getChildRect:function(K){var Y;return fk(K)&&K.s(Am)&&(Xi(K)&&K.isExpanded()&&K.eachChild(function(T){Y=tf(Y,K.getChildRect(T))}),!Y&&K.getRect&&(Y=K.getRect())),Y},setPosition:function(x,D){var H=this;if(!H._54I){var g;g=2===arguments.length?{x:x,y:D}:x,ng||H._53I||(H._54I=1,sr(H._children,g.x-H._position.x,g.y-H._position.y),delete H._54I),we.superClass.setPosition.call(this,g)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(V){var n=this;if(n._57O!==V){var $=n._57O;n._57O=V,n.fp("expanded",$,n._57O),n._fireInvalidateDeep(),n._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(c){Xi(c)?c._fireInvalidateDeep():c.iv()})},_8I:function(){we.superClass._8I.call(this),this.eachChild(function(z){fk(z)&&z._8I()})},onStyleChanged:function(C){we.superClass.onStyleChanged.apply(this,arguments),"group.position"===C&&this._81I()},getSerializableProperties:function(){var D=we.superClass.getSerializableProperties.call(this);return D.expanded=1,D}});var Go=B.Block=function(){bs(Go,this)};Ig("Block",Ur,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Yq},onChildAdded:function(){Go.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Go.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var W=this;if(!ng&&!W._updatingToChildren&&W._syncSize&&!W._freezeSyncFromChildren){var e,Q,J,M,x,h=[],l=W.getRotation();if(W.eachChild(function(w){fk(w)&&h.push.apply(h,w.getCorners())}),h.length){W._updatingFromChildren=1;var L=T(-l),c=y(-l),I=1/0,o=-1/0,B=1/0,O=-1/0;for(M=0,x=h.length;x>M;M++)J=h[M],e=J.x,Q=J.y,J.x=L*e-c*Q,J.y=c*e+L*Q,I=s(I,J.x),o=N(o,J.x),B=s(B,J.y),O=N(O,J.y);var z=W.getScale();W.setSize(F((o-I)/z.x),F((O-B)/z.y));var t;z.x<0&&(t=I,I=o,o=t),z.y<0&&(t=B,B=O,O=t),L=T(l),c=y(l);var S=W.getAnchor();e=I+(o-I)*S.x,Q=B+(O-B)*S.y,W.setPosition(L*e-c*Q,c*e+L*Q),delete W._updatingFromChildren}}},setPosition:function(k,S){var $=this;if(!$._updatingToChildren){var v;v=2===arguments.length?{x:k,y:S}:k,ng||$._updatingFromChildren||($._updatingToChildren=1,sr($._children,v.x-$._position.x,v.y-$._position.y),delete $._updatingToChildren),Go.superClass.setPosition.call(this,v)}},setWidth:function(A){return this.setSize(A,this.getHeight())},setHeight:function(l){return this.setSize(this.getWidth(),l)},setSize:function(o,g){1>o&&(o=1),1>g&&(g=1);var b=this;if(!b._updatingToChildren){2!==arguments.length&&(g=o.height,o=o.width);var _=b.getWidth(),x=b.getHeight();if(o!==_&&Go.superClass.setWidth.call(b,o),g!==x&&Go.superClass.setHeight.call(b,g),!ng&&!b._updatingFromChildren){b._updatingToChildren=1;var j=o/_,p=g/x;b._adjustChildScaleOrSize(j,p,"size"),delete b._updatingToChildren,b.updateFromChildren()}}},_adjustChildScaleOrSize:function(O,m,x){var P=this;if(P._syncSize){var R=P.getPosition(),p=P.getRotation();P.getScale(),P.eachChild(function(L){if(fk(L)){var Y=L.getPosition(),B=L.getRotation(),Z=L.getWidth(),C=L.getHeight(),K=L.getScale(),k=K.x*Z,S=K.y*C,e=new Ng(B,Y.x,Y.y,k,S);e.translate(-R.x,-R.y),e.rotate(-p),B=U(e.b*Math.sign(k),e.a*Math.sign(k)),e.scale(O,m);var h,d,A,i=T(B);if(Math.abs(i)<.001?(h=y(B),d=e.b/h,A=-e.c/h):(d=e.a/i,A=e.d/i),"scale"===x)L.setScale(d/Z,A/C);else if("size"===x){var u=d/K.x,c=A/K.y;L.setScale(or(d)*Math.abs(K.x),or(A)*Math.abs(K.y)),L.setSize(Math.max(.1,Math.abs(u)),Math.max(.1,Math.abs(c)))}e.rotate(p),e.translate(R.x,R.y),L.setPosition(e.tx,e.ty)}})}},_calcChangeFactor:function(J,S,g,R){var B,E,a,q;return B=F(J),E=F(g),a=B>E?B/E:E/B,B=F(S),E=F(R),q=B>E?B/E:E/B,N(a,q)},setAnchor:function(){var u=this;if(!u._updatingToChildren){var P=u.getAnchor();if(Go.superClass.setAnchor.apply(u,arguments),!ng&&!u._updatingFromChildren&&u._syncSize){u._updatingToChildren=1;var W=u.getAnchor();u.getPosition();var i=u.getSize(),f=u.getScale(),V=u.getRotation(),E=-i.width*f.x*(P.x-W.x),L=-i.height*f.y*(P.y-W.y),Y=y(V),D=T(V),F=D*E-Y*L,x=Y*E+D*L;u.eachChild(function(w){if(fk(w)){var k=w.getPosition();w.setPosition(k.x-F,k.y-x)}}),delete u._updatingToChildren}}},setRotation:function(m){var E=this;if(!E._updatingToChildren){var u=E.getRotation();if(Go.superClass.setRotation.apply(E,arguments),!ng&&!E._updatingFromChildren){E._updatingToChildren=1;var o=E.getPosition(),W=m-u;E.eachChild(function(w){if(fk(w)){var T=w.getMatrix();T.translate(-o.x,-o.y),T.rotate(W),T.translate(o.x,o.y);var H=Math.sign(w.getScale().x);w.setRotation(U(T.b*H,T.a*H)),w.setPosition(T.tx,T.ty)}}),delete E._updatingToChildren}}},setScale:function(k,v){var d=this;if(!d._updatingToChildren){null==v&&(v=k.y,k=k.x);var G=d.getScale();if(F(k)<.01&&(k=.01*(or(k)||or(G.x))),F(v)<.01&&(v=.01*(or(v)||or(G.y))),Go.superClass.setScale.call(d,k,v),!ng&&!d._updatingFromChildren){d._updatingToChildren=1;var S=k/G.x,O=v/G.y;d._adjustChildScaleOrSize(S,O,"size"),delete d._updatingToChildren,d.updateFromChildren()}}},getSerializableProperties:function(){var R=Go.superClass.getSerializableProperties.call(this);return R.clickThroughEnabled=1,R.syncSize=1,R}});var oc=B.Grid=function(){bs(B.Grid,this)};Ig("Grid",Ur,{IRotatable:!1,_icon:"grid_icon",_image:E,getUIClass:function(){return Zm},setRotation:function(){},getCellRect:function(T,Z){var h=this,C=h.s("grid.row.count"),K=h.s("grid.column.count");if(0>=C||0>=K||0>T||T>=C||0>Z||Z>=K)return E;var y,x,$,X=h.getRect(),e=h.s("grid.row.percents"),L=h.s("grid.column.percents");if(Ic(X,h,"grid.border",-1),e&&e._as&&(e=e._as),L&&L._as&&(L=L._as),e&&e.length===C){for($=0,y=0;T>y;y++)$+=X.height*e[y];X.y+=$,X.height=X.height*e[T]}else X.height=X.height/C,X.y+=X.height*T;if(L&&L.length===K){for(x=0,y=0;Z>y;y++)x+=X.width*L[y];X.x+=x,X.width=X.width*L[Z]}else X.width=X.width/K,X.x+=X.width*Z;return ip(X,-h.s("grid.gap")),X}});var vs=B.Text=function(){bs(vs,this),this.setSize(100,50),this.s("text","TEXT")};Ig("Text",Ur,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Ji},setWidth:function(q){q||(q=.001),vs.superClass.setWidth.call(this,q)},setHeight:function(C){C||(C=.001),vs.superClass.setHeight.call(this,C)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),yc("__text__",{width:{value:100,isSafeFunc:!0,func:function(p){return p._width}},height:{value:50,isSafeFunc:!0,func:function(B){return B._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var wh=B.Shape=function(){bs(wh,this),this._59O=new yb};wh.__de__=fd,Ig("Shape",Ur,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Mp},_22Q:function(){return xm},getLength:function(o){return kf(vm(this._59O,this._58O,o,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var e=this._58O;return e?new yb(e._as.slice(0)):e},setSegments:function(j){var J=this._58O;j=j?Km(j)?new yb(j.slice(0)):new yb(j._as.slice(0)):null,(J&&j&&J._as.join(",")!==j._as.join(",")||J!==j)&&(this._58O=j,this.fp("segments",J,j))},getPoints:function(){return this._59O},toPoints:function(){var K=this._59O;return new yb(K._as.slice(0))},setPoints:function(I,w){var g=this,J=g._59O;I=I?Km(I)?new yb(I.slice(0)):new yb(I._as.slice(0)):new yb;var p,n,o,h,Q,M;w&&(p=g.getPosition(),M=new Ng(g.getRotation(),0,0,g.getScale().x,g.getScale().y)),(J&&I&&J._as.join(",")!==I._as.join(",")||J!==I)&&(g._59O=I,g.fs(),g.fp("points",J,I)),w&&(n=g.getPosition(),o=n.x-p.x,h=n.y-p.y,Q=M.tf(o,h),g.setPosition(n.x-o+Q.x,n.y-h+Q.y))},addPoint:function(s,z,k){var Q=this.toPoints();Q.add(s,z),this.setPoints(Q,k)},setPoint:function(u,P,J){var X=this.toPoints();X.set(u,P),this.setPoints(X,J)},removePointAt:function(n){var V=this.toPoints();V.removeAt(n),this.setPoints(V)},setWidth:function(g){var t=this;if(1>g&&(g=1),!t._55I&&!ng&&t.getWidth()){t._55I=1;var F=t._position.x,T=g/t.getWidth(),e=t.toPoints(),b=new yb;e.each(function(z){b.add({x:(z.x-F)*T+F,y:z.y,e:z.e})}),t.setPoints(b),up(t,[T,0,0,1,F*(1-T),0]),t.fs(),delete t._55I}wh.superClass.setWidth.call(t,g)},setHeight:function(V){var M=this;if(1>V&&(V=1),!M._55I&&!ng&&M.getHeight()){M._55I=1;var D=M._position.y,c=V/M.getHeight(),o=M.toPoints(),g=new yb;o.each(function(J){g.add({x:J.x,y:(J.y-D)*c+D,e:J.e})}),M.setPoints(g),up(M,[1,0,0,c,0,D*(1-c)]),M.fs(),delete M._55I}wh.superClass.setHeight.call(M,V)},setAnchorElevation:function(u){var H=this;H._55I=!0;var C=H._updatingAnchor3d,x=!ng&&!C;if(x){var Q,E=u,S=H.getAnchorElevation(),t=H.getTall();Q=t*(S-E),H.shiftPointsElevation(Q)}var W=wh.superClass.setAnchorElevation.apply(H,arguments);return C||delete H._55I,W},getShapeElevation:function(){var m=this,I=m._54O;return I-(m.getTall()||0)*(m._anchorElevation-.5)},setAnchor3d:function($,q,H,I){var l,G=this;"number"==typeof $?l={x:$,y:q,z:H}:(l=$.length?{x:$[0],y:$[1],z:$[2]}:$,I=q),G._55I=!0,G._updatingAnchor3d=!0;var v=G.getDataModel();if(v&&v.beginTransaction(),!ng){var Y=G.getAnchor3d(),n=G.getSize(),V=G.getTall(),A=n.width*(Y.x-l.x),N=n.height*(Y.z-l.z),R=V*(Y.y-l.y);I||G.shiftPoints(A,N,R);var a=G.p3()}var j=wh.superClass.setAnchor3d.apply(G,arguments);if(!ng&&I){var i=G.p3();G.shiftPoints(i[0]-a[0]+A,i[2]-a[2]+N,i[1]-a[1]+R)}return v&&v.endTransaction(),delete G._updatingAnchor3d,delete G._55I,j},setAnchor:function(f,S,l){var H=this;H._55I=!0;var d=H._updatingAnchor3d,N=!ng&&!d;if(N){var x,h,L;"number"==typeof f?L={x:f,y:S}:(L=f.length?{x:f[0],y:f[1]}:f,l=S);var O=H.getAnchor(),_=H.getSize();x=_.width*(O.x-L.x),h=_.height*(O.y-L.y),l||H.shiftPoints(x,h);var w=H.getPosition()}var q=wh.superClass.setAnchor.apply(H,arguments);if(N){var g=H.getPosition();l&&H.shiftPoints(g.x-w.x+x,g.y-w.y+h)}return d||delete H._55I,q},shiftPoints:function(H,x,M){var k=this,R=k.getElevation()||0,T=k.toPoints(),s=new yb;T.each(function(i){var b=i.e;M&&(b=(b==E?R:b)+M),s.add({x:i.x+H,y:i.y+x,e:b})}),k.setPoints(s),k.fs()},shiftPointsElevation:function(U){return this.shiftPoints(0,0,U)},setPosition:function(R,Y){var t,h=this;if(!h._28Q){if(h._28Q=1,!h._55I&&!ng){t=2===arguments.length?{x:R,y:Y}:R;var i=t.x-h._position.x,G=t.y-h._position.y;if(0===i&&0===G)return delete h._28Q,void 0;h._55I=1,h.shiftPoints(i,G),up(h,[1,0,0,1,i,G]),delete h._55I}wh.superClass.setPosition.apply(h,arguments),delete h._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var I=this;if(2!==I._59O.size())return!1;var w=I._58O;return w?2===w.size()&&1===w.get(0)&&2===w.get(1)?!0:!1:!0},fireShapeChange:function(){var M=this;if(!M._55I&&!ng){var v=Vn(M._59O);v&&(M._55I=1,M.setRect(v),delete M._55I)}M.fp(xc,!1,!0)},getSerializableProperties:function(){var X=wh.superClass.getSerializableProperties.call(this);return X.segments=1,X.points=1,X.thickness=1,X.closePath=1,X}});var gc=B.Polyline=function(){bs(gc,this),this.s({"shape.background":null,"shape.border.width":2})};Ig("Polyline",wh,{_icon:"polyline_icon",_22Q:function(){return Jq},getUIClass:function(){return Yh},setClosePath:function(){},setTall:function(c){var b=this;if(!b._55I&&!b._24Q&&!ng&&b.getTall()){b._24Q=1;var G=b._54O,x=c/b.getTall();b._59O.each(function(r){r.e=r.e==E?G:(r.e-G)*x+G}),b.fs(),delete b._24Q}gc.superClass.setTall.call(b,c)},setElevation:function(z){var r=this;if(!r._55I&&!r._24Q&&!ng){r._24Q=1;var C=z-r._54O;r._59O.each(function(o){o.e==E?o.e=z:o.e+=C}),r.fs(),delete r._24Q}gc.superClass.setElevation.apply(r,arguments)},fireShapeChange:function(){var V=this,v=V._59O;if(!V._55I&&!V._24Q&&!ng){var S=v.size();if(S){var k=1,m=v.get(0),n=V._54O;m.e==E&&(m.e=n);for(var p=m.e,B=0;S>k;k++){m=v.get(k),m.e==E&&(m.e=n);var e=s(p,m.e),Y=N(p+B,m.e);p=e,B=Y-e}V._24Q=1,V.setTall(B),V.setElevation(p+B*V._anchorElevation),delete V._24Q}}gc.superClass.fireShapeChange.apply(V,arguments)}});var zl=B.SubGraph=function(){bs(zl,this)};Ig("SubGraph",Ur,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){zl.superClass._8I.call(this),this.eachChild(function(j){fk(j)&&j._8I()})}}),$.loadingRefGraph=0;var Oi=B.RefGraph=function(){bs(Oi,this)};Ig("RefGraph",Go,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(A){var d=this._ref;this._ref=A,this.fp("ref",d,A),this.updateRef()},_21I:function(){Oi.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var b=this;if($.loadingRefGraph++,b.clearChildrenFromDataModel(),$.loadingRefGraph--,b._ref&&b._dataModel){b._xhrLoadHandler&&(b._xhrLoadHandler.cancel=!0);var D=ng,e=b._xhrLoadHandler=function(C){if(C&&b._dataModel){$.loadingRefGraph++;var k=b._pendingUpdateInfo={needToRestore:D};D&&(k.position=b.p(),k.width=b.getWidth(),k.height=b.getHeight(),k.rotation=b.getRotation(),k.anchor=b.getAnchor(),k.scale=b.getScale()),b.p(0,0),b.setAnchor(.5,.5),b.setRotation(0),b.setScale(1,1);var Z=$.parse(C),U=b._dataModel.deserialize(Z,b,{justDatas:!0});U.each(function(y){y._refGraph=b}),b.checkPendingUpdateInfo(),$.loadingRefGraph--,$.handleRefGraphLoaded(b,U,Z)}};e.xhrLoadCalled=!1,$.load(b._ref,function(N){e.cancel||(e.xhrLoadCalled?e(N):Sm(function(){e(N)}))}),e.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var J=this,U=J._pendingUpdateInfo;if(!U)return J.onPendingUpdated&&($.loadingRefGraph++,J.onPendingUpdated(),$.loadingRefGraph--),void 0;var t=!0;this.eachChild(function(Q){(Q._pendingCheckImageJSON||Q._pendingUpdateInfo)&&(t=!1)}),t&&($.loadingRefGraph++,J._pendingUpdateInfo=null,J.updateFromChildren(),U.needToRestore&&(J.setSize(U.width,U.height),J.setAnchor(U.anchor),J.setRotation(U.rotation),J.setScale(U.scale),J.p(U.position)),this.getParent()instanceof Oi&&this.getParent().checkPendingUpdateInfo(),J.onPendingUpdated&&J.onPendingUpdated(),$.loadingRefGraph--)},getSerializableProperties:function(){var G=Oi.superClass.getSerializableProperties.call(this);return G.ref=1,G}}),B.EdgeGroup=function(m,B){this._70O=m,this._siblings=B;for(var w,X,h=0,j=m.size(),l=r[Me];j>h;h++)if(w=m.get(h).getStyle(Me,!1),w!=E){l=w;break}l==E&&(l=!0);var q=$.edgeGroupAgentFunc;for(q&&(X=q(m),X&&X!==m.get(0)&&(m.remove(X),m.add(X,0))),h=0;j>h;h++)m.get(h).s(Me,l)},Ig("EdgeGroup",O,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(a){return this._70O.get(a)},indexOf:function(w){return this._70O.indexOf(w)},each:function(_,m){this._70O.each(_,m)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(a,$){this._siblings.each(function(M){M._70O.each(a,$)})}});var Dc=function(s,l,q){var z=Fr[s]={type:s,action:l};if(q)for(var c in q)z[c]=q[c]};yp($,{setConnectAction:Dc,getConnectAction:function(u,F){if(!F){if(!u)return null;F=u.getCurrentConnectActionType()}return Fr[F]},doConnectAction:function(S,v,x,L){L=L||S.getCurrentConnectActionType();var E=Fr[L];if(!E)return!1;var D=E.action;return D?(v instanceof pn.Group?S.sm().getSelection().each(function(b){D.call(null,S,b,x)}):D.call(null,S,v,x),!0):!1},doDeleteConnectionAction:function(X,O,I){I=I||X.getCurrentConnectActionType();var F=Fr[I];if(!F||!F.delete)return!1;var W=F.delete.action;return W?(O instanceof pn.Group?X.sm().getSelection().each(function(E){W.call(null,X,E)}):W.call(null,X,O),!0):!1}});var ws=B.JSONSerializer=function(l,L){this.dm=this._dataModel=l,this._hierarchical=$.forceHierarchicalSerialization?!0:L==E?l.isHierarchicalRendering():L};Ig("JSONSerializer",O,{ms_ac:["hierarchical"],serialize:function(u){return $.stringify(this.toJSON(),u)},toJSON:function(){var v=this,N=v.dm,m=N.getRoots(),b=v.json={v:$.getVersion(),p:{},a:{},d:[]},H=N.getSerializableAttrs();N.getInit()&&(b.init=N.getInit()),N.getName()&&(b.p.name=N.getName()),N.getBackground()&&(b.p.background=N.getBackground()),N.getLayers()&&(b.p.layers=N.getLayers()),N.getEnvmap()&&(b.p.envmap=N.getEnvmap()),b.p.autoAdjustIndex=N.isAutoAdjustIndex(),b.p.hierarchicalRendering=N.isHierarchicalRendering();for(var _ in H){var F=N.a(_);F!==n&&v[wm](_,F,b.a)}return si(b.a)&&delete b.a,v._hierarchical?m.each(v.serializeData,this):N.each(function(f){v.serializeData(f)}),N.fireSerializeEvent({type:"serialize",json:b}),N.getPostProcessingData()&&(b.p.postProcessingData=N.getPostProcessingData()),b},isSerializable:function(){return!0},getProperties:function(Q){return Q.getSerializableProperties()},getStyles:function(Z){return Z.getSerializableStyles()},getAttrs:function(h){return h.getSerializableAttrs()},serializeData:function(A){var N=this;if(N.isSerializable(A)&&!A._refGraph){var q,t,r,c,F=zs(A.getClassName())||A.getClass(),d=new F,a={c:A.getClassName(),i:A.getId(),p:{},s:{},a:{}};N.json.d.push(a),q=N.getProperties(A);for(t in q)if(/^_/.test(t)){if(r=A[t],("_width"===t||"_height"===t)&&r===n){var Z;((A.s("layout.h")||A.s("layout.v"))&&A.getHost()||A instanceof B.Node&&(Z=A.getParent())&&Z instanceof B.Block||A.s("fullscreen"))&&(r=A[t]="_width"===t?A.getWidth():A.getHeight())
}r!==d[t]&&N[wm](t.substr(1),r,a.p)}else c=Bc(t),A[c]&&(r=A[c](),r!==d[c]()&&N[wm](t,r,a.p));q=N.getStyles(A);for(t in q)r=A.s(t),r!==d.s(t)&&N[wm](t,r,a.s);q=N.getAttrs(A);for(t in q)r=A.a(t),r!==d.a(t)&&N[wm](t,r,a.a);si(a.p)&&delete a.p,si(a.s)&&delete a.s,si(a.a)&&delete a.a}N._hierarchical&&A.getChildren().each(N.serializeData,N)},serializeValue:function(k,j,y){om(j)?j={__a:j._as}:j instanceof Ye&&(j={__i:j.getId()}),y[k]=j},deserialize:function(d,I,M){var w=this;return Qo(d)&&/.json$/.test(d)?($.xhrLoad(d,function(Q){w.deserializeImpl(Q,I,M)}),void 0):w.deserializeImpl(d,I,M)},deserializeImpl:function(V,p,T){var S=this,F=S.dm;T=Uf(T)?{setId:T}:hp(T)?{finishFunc:T}:T||{},V=S.json=Qo(V)?$.parse(V):V,V.a&&V.a.onPreDeserialize&&!T.disableOnPreDeserialize&&V.a.onPreDeserialize(V,F,T.view),F.beginTransaction(),ng++,S._82I={};var P=new yb,W=new yb,O=0,t=V.d.length;if(T.justDatas||(hp(V.init)&&V.init(F),F.setInit(V.init)),!T.justDatas){for(var A in V.a)F.a(A,S[sk](V.a[A]));for(var v in V.p)F[gm(v)](V.p[v])}for(;t>O;O++){var m=V.d[O],_=zs(m.c),l=new _,x=m.i;T.setId&&x!=E&&(l._id=x),S._82I[x]=l,P.add(l),W.add(m)}for(O=0;t>O;O++)S.deserializeData(P.get(O),W.get(O));return P.each(function(b){p&&!b.getParent()&&b.setParent(p),F.add(b)}),F.fireSerializeEvent({type:"deserialize",json:V}),ng--,F.endTransaction(),V.a&&V.a.onPostDeserialize&&!T.disableOnPostDeserialize&&V.a.onPostDeserialize(V,F,T.view,P),T.finishFunc&&T.finishFunc(V,F,T.view,P),P},deserializeData:function(J,Q){for(var T in Q.p)J[gm(T)](this[sk](Q.p[T]));for(T in Q.s)J.s(T,this[sk](Q.s[T]));for(T in Q.a)J.a(T,this[sk](Q.a[T]))},deserializeValue:function(v){if(Kq(v)){var o=v.__i;if(o!=E)return this._82I[o];if(o=v.__a,Km(o))return new yb(o)}return v}}),yp(bq,{serialize:function(Z,P){return new ws(this,P).serialize(Z)},toJSON:function(S){return new ws(this,S).toJSON()},deserialize:function(u,d,y){return new ws(this).deserialize(u,d,y)}});var Qj=B.OverlappingBox=function(C){this.gv=C,this.boxes={}};Ig("OverlappingBox",O,{clear:function(){var t,Z,d=this.boxes;for(t in d)Z=d[t],Z.length=0},isOverlapping:function(H,h){var J,S,w=this,X=w.boxes,E=X[H];E?(J=E.rects,S=E.length):E=X[H]={rects:J=[],length:S=0};var V,o,h;for(V=0;S>V;V++)if(o=J[V],o.x<h.x+h.w&&o.x+o.w>h.x&&o.y<h.y+h.h&&o.h+o.y>h.y)return!0;return J.length<=S?(J.push(h),E.length++):J[E.length++]=h,!1}}),yp($,{fetch:function(d,w){var C="GET",M=!1,T=null,i="";w&&(C=w.method||"GET",M=w.sync,i=w.url,T=w.data||null),d.open(C,i,!M),w.responseType?d.responseType=w.responseType:w.overrideMimeType&&d.overrideMimeType&&d.overrideMimeType(w.overrideMimeType),d.send(T)},convertImageSrc:function(U,k){k&&"function"==typeof k||(k=function(){}),k(U)}});var Ql=B.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Ig("Request",O,{_responseType:null,_overrideMimeType:"text/plain",send:function(o){var V=this._xhr,z=this.onload,M=this.onerror;this.getResponseType()?o.responseType=this.getResponseType():this.getOverrideMimeType()&&(o.overrideMimeType=this.getOverrideMimeType()),V.onload=z,V.onerror=M,$.fetch(V,o)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(g){this._responseType=g},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(b){this._overrideMimeType=b},getResponseText:function(){var Q=this._xhr;return Q.response||Q.responseText}}),Uc.GraphView=function(q){var C=this;C._24I={},C._34I=new yb,C._25I={},C._56I={},C._view=Hn(1,C),C._canvas=Fj(C._view),C.dm(q?q:new bq),this._coreInteractor=new zj(this),C.setEditable(!1),C.setScrollBarVisible($.graphViewScrollBarVisible)},Ro("GraphView",O,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[ir,Ab,wd,fi,"resettable","editInteractor",$i,"pannable","rectSelectable","autoScrollZone",Eg,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:$.graphViewResettable,_pannable:$.graphViewPannable,_rectSelectable:$.graphViewRectSelectable,_autoScrollZone:$.graphViewAutoScrollZone,_rectSelectBackground:$.graphViewRectSelectBackground,_rectSelectBorderColor:$.graphViewRectSelectBorderColor,_editPointSize:$.graphViewEditPointSize,_editPointBorderColor:$.graphViewEditPointBorderColor,_editPointBackground:$.graphViewEditPointBackground,_scrollBarColor:jl,_scrollBarSize:bn,_autoHideScrollBar:ul,_autoMakeVisible:ks,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(H){this._dataModel.setLayers(H)},setEditable:function(F){var J=this,s=J.__interactorMap__;if(!s){var k=Uc.XEditInteractor;s=J.__interactorMap__={scrollBar:new Af(J),select:new Bn(J),edit:k?new k(J):new Tf(J),move:new $f(J),"default":new Tr(J),touch:new Uj(J,{editable:!1})}}F?(J._uieditable=!0,J.setInteractors([s.scrollBar,s.select,s.edit,s.move,s.default,s.touch])):(J._uieditable=!1,J.setInteractors([s.scrollBar,s.select,s.move,s.default,s.touch]))},getCanvas:function(){return this._canvas},_33I:function(s){var q=s.getUIClass();return q?new q(this,s):E},getDataUI:function(d){var D=this,A=D._25I[d._id];return A===n&&(A=D._33I(d),D._25I[d._id]=A),A},getNodeRect:function(Y){return $.getNodeRect(this,Y)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(O){var h=this.getDataUI(O);return h?(h._79o(),h._78o):null},getEdgeSourcePosition:function(d){var G=this,g=G.getDataUI(d),b=g.s,E=g._data._40I;return Kg(G,E,b("edge.source.position"),b("edge.source.offset.x"),b("edge.source.offset.y"),b("edge.source.anchor.x"),b("edge.source.anchor.y"))},getEdgeTargetPosition:function(B){var P=this,e=P.getDataUI(B),z=e.s,J=e._data._41I;return Kg(P,J,z("edge.target.position"),z("edge.target.offset.x"),z("edge.target.offset.y"),z("edge.target.anchor.x"),z("edge.target.anchor.y"))},invalidateAll:function(C){var W=this;if(C){for(var Z in W._25I){var y=W._25I[Z];y&&y.dispose()}W._25I={},W._56I={},W._24I={},W._34I.clear(),W.redraw()}else W.dm().each(function(A){W.invalidateData(A)})},invalidateSelection:function(){var v=this;v.sm().each(function(C){v.invalidateData(C)})},invalidateData:function(H){var x=this;x._24I[H._id]=H,x._21Q(H),x.iv()},_21Q:function(H){var B=this,v=B._24I;if(Ll(H)&&vk[H.s(Qr)]){var m=H.getSourceAgent();m&&m.getAgentEdges().each(function(g){v[g._id]=g}),m=H.getTargetAgent(),m&&m.getAgentEdges().each(function(m){v[m._id]=m}),B.iv()}},redraw:function(T){var C=this;C._32I||(T?C._34I.add(T):(C._32I=1,C._34I.clear()),C.iv())},each:function(R,h){var x,m,s,w=0,U=this.getLayers(),p=this._dataModel,T=p._datas._as,d=T.length;if(U){for(var O=U.length;O>w;w++)if(s=U[w],Kq(s)&&(s=s.name),p.isHierarchicalRendering()){var u=function(i){return i._layer===s?h?R.call(h,i):R(i):void 0};if(this._dataModel.eachByHierarchical(u)===!1)return}else for(var L=0;d>L;L++)if(x=T[L],x._layer===s&&(m=h?R.call(h,x):R(x),m===!1))return}else if(p.isHierarchicalRendering())this._dataModel.eachByHierarchical(R,null,h);else for(;d>w;w++)if(x=T[w],m=h?R.call(h,x):R(x),m===!1)return},reverseEach:function(T,B){var s,K,x,R,u=this._dataModel,N=u._layers,_=u._datas._as,M=_.length;if(N){for(s=N.length-1;s>=0;s--)if(R=N[s],Kq(R)&&(R=R.name),u.isHierarchicalRendering()){var l=function(F){return F._layer===R?B?T.call(B,F):T(F):void 0};if(u.reverseEachByHierarchical(l)===!1)return}else for(var P=M-1;P>=0;P--)if(K=_[P],K._layer===R&&(x=B?T.call(B,K):T(K),x===!1))return}else if(u.isHierarchicalRendering())u.reverseEachByHierarchical(T,null,B);else for(s=M-1;s>=0;s--)if(K=_[s],x=B?T.call(B,K):T(K),x===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var O=this,P=O._84I;if(!P){var b=this.dm().a("width"),G=this.dm().a("height");b>0&&G>0?O._84I={x:0,y:0,width:b,height:G}:(O.each(function(l){O.isVisible(l)&&(P=tf(P,O.getDataUIBounds(l)))}),O._84I=P?P:sm)}return O._84I},getScrollRect:function(){return tf(this.getContentRect(),this._29I)},makeCenter:function(L,n,s){var h=this;if(!h.getWidth()||!h.getHeight())return s||Sm(h.centerData,h,[L,n,!0],500),void 0;h.makeVisible(L),h.validate();var g=h.getDataUIBounds(L);if(g){var $=h.getWidth(),F=h.getHeight(),K=g.x+g.width/2,W=g.y+g.height/2,C=-K*h._zoom+$/2,l=-W*h._zoom+F/2;h.setTranslate(C,l,n)}},fitData:function(F,P,B,C,Z){var l=this;if(!l.getWidth()||!l.getHeight())return Z||Sm(l.fitData,l,[F,P,B,C,!0],500),void 0;var W=function(){l.makeVisible(F),l.validate();var z=l.getDataUIBounds(F);z&&(z=Rn(z),ip(z,B==E?20:B),l.fitRect(z,P,C))};P?$.callWhenLoaded(W):W()},fitContent:function(m,D,V,M){var g=this;if(!g.getWidth()||!g.getHeight())return M||Sm(g.fitContent,g,[m,D,V,!0],500),void 0;var T=function(){g.validate();var T=Rn(g.getContentRect());ip(T,D==E?20:D),g.fitRect(T,m,V)};m?$.callWhenLoaded(T):T()},fitRect:function(Z,B,c){var t=this,d=t.getWidth(),j=t.getHeight(),z=Z.x+Z.width/2,x=Z.y+Z.height/2,q=s(d/Z.width,j/Z.height),f=t._zoom,n=-z*f+d/2,r=-x*f+j/2;0===q||isNaN(q)||(c&&(q=s(1,q)),B?(t._65I&&(delete t._65I.finishFunc,t._65I.stop(!0)),t._14o&&t._14o.stop(!0),t.setTranslate(n,r,{finishFunc:function(){t.setZoom(q,B)}})):(t.setTranslate(n,r),t.setZoom(q)))},toCanvas:function(Y,O){O=O||this._zoom,this.validateImpl();var H=this,h=H.getContentRect();h.width||(h.width=10),h.height||(h.height=10);var M=Fj(),g=h.x*O,I=h.y*O,e=h.width*O,u=h.height*O;nf(M,e,u,1);var r=Qc(M);return Y=Y||this._dataModel.getBackground(),Y&&Fp(r,0,0,e,u,Y),Gg(r,-g,-I),r.scale(O,O),H._42(r),r.restore(),M},toDataURL:function(h,t,P){return this.toCanvas(h,P).toDataURL(t||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(r,o){var h=this,z=this.__htmlOrderList,_=[];if(h._93db(r,o),h.each(function(j){var d=h.getDataUI(j);if(d){var A=h._56I[j._id],m=d._htmlView;if(A){var g=d._79o();if(m=d._htmlView,B.HtmlNode&&j instanceof B.HtmlNode)d._42(r);else{var U=h.getViewRect(),T=m&&m.layoutHTML;!o||vn(o,g)?(T&&(m.layoutHTML(),d.__outerLayout&&delete d.__outerLayout),d._42(r)):vn(U,g)||!T||d.__outerLayout||(m.layoutHTML(),d.__outerLayout=!0)}}m&&(_.push(m),m.getView&&(m=m.getView()),m.style.display=A?"block":Uo)}}),z&&_.length>0){var f=!1;if(z.length!==_.length)f=!0;else for(var X=0;X<_.length;X++)if(_[X]!==z[X]){f=!0;break}f&&(_.forEach(function(I){h.appendHTML(I,!0)}),this.__htmlOrderList=_)}else this.__htmlOrderList=_;h._92db(r,o)},validateImpl:function(){this.tryUpdateRootData();var l,h,u,G,r,C=this,Q=C.tx(),t=C.ty(),J=C._zoom,S=C._canvas,P=this.getWidth(),F=this.getHeight(),$=C._29I,b={x:-Q/J,y:-t/J,width:P/J,height:F/J},T={},w=C._34I,L=C._24I,V=C._32I,U=C._23I;C._24I={},(P!==S.clientWidth||F!==S.clientHeight)&&(nf(S,P,F),V=1),V||zr(b,$)||(V=1),C._29I=b,C.each(function(e){h=e._id;var Y=T[h]=C.isVisible(e);Y!==C._56I[h]&&(L[h]=e,u=C.getDataUI(L[h]),u&&u._84o(Y),C._84o(e,Y))},C);for(h in L)u=C.getDataUI(L[h]),u&&(!V&&C._56I[h]&&(r=u._79o(),r&&w.add(r)),u.invalidate()),C._83I=1;if(C._56I=T,!V)for(h in L)T[h]&&(u=C.getDataUI(L[h]),u&&(r=u._79o(),r&&w.add(r)));if(V?G=b:(w.each(function(m){vn(b,m)&&(G=tf(G,m))}),G&&(ip(G,N(1,1/J)),G.x=A(G.x*J)/J,G.y=A(G.y*J)/J,G.width=d(G.width*J)/J,G.height=d(G.height*J)/J,G=$r(b,G))),C._74O=G,G){l=Qc(S);var M=G.x,p=G.y,E=G.width,j=G.height;M=Math.floor((M*J+Q)*ll),p=Math.floor((p*J+t)*ll),E=Math.ceil(E*J*ll)+1,j=Math.ceil(j*J*ll)+1,l.beginPath(),l.rect(M,p,E,j),l.clip(),l.clearRect(M,p,E,j),of(l,Q,t,J),C._42(l,G),l.restore(),delete C._74O}if(w.clear(),delete C._32I,U&&P>0&&F>0){var u=C.getDataUI(U);if(u){var r=u._79o(),I=C._29I,c=I.x,H=I.y,m=I.width,e=I.height,J=C._zoom;r&&!vn(r,I)&&(r.x+r.width<c&&C.tx(-r.x*J),r.x>c+m&&C.tx(-(r.x+r.width-m)*J),r.y+r.height<H&&C.ty(-r.y*J),r.y>H+e&&C.ty(-(r.y+r.height-e)*J))}delete C._23I}C._83I&&(delete C._83I,delete C._84I),C._98O(),C.countFrame(),si(C._24I)||Sm(C.iv,C)},tryUpdateRootData:function(){var B,e=this.getFullscreenDatas();for(var k in e)B=e[k],this.scaleRootData(B)},scaleRootData:function(u){var c=u.s("fullscreen");if("uniform"===c||"fill"===c){u.setRotation(0);var $,k=u.s("fullscreen.gap")||0,s=this.getWidth()-2*k,L=this.getHeight()-2*k,U=u.getAnchor(),t=u.getScaledSize(),Y=t.width,x=t.height,J=u.s("fullscreen.lock");if(J)return"uniform"===c?s/L>Y/x?($=L/x,Y=x*s/L):($=s/Y,x=Y*L/s):"v"===J?($=L/x,Y=s/$,u.setWidth(Y)):($=s/Y,x=L/$,u.setHeight(x)),this.setZoom($),this.tx(k-(u.getX()-U.x*Y)*$),this.ty(k-(u.getY()-U.y*x)*$),void 0;var e=this.tx(),F=this.ty();$=this._zoom;var S={x:(-e+k)/$,y:(-F+k)/$,width:s/$,height:L/$};if("uniform"===c){var p=Y/x,C=Math.min(S.width,S.height*p),A=C/p;S.x+=.5*(S.width-C),S.y+=.5*(S.height-A),S.width=C,S.height=A}u.setSize(S.width/u.getScaleX(),S.height/u.getScaleY()),u.setPosition(S.x+U.x*S.width,S.y+U.y*S.height)}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(y){var U=this;y!==U.isScrollBarVisible()&&(y?(Hi(U._view,U._79O=Rd()),Hi(U._79O,U._27I=Rd()),Hi(U._79O,U._28I=Rd())):(ii(U._79O),delete U._79O,delete U._27I,delete U._28I),U.fp("scrollBarVisible",!y,y))},getDebugTip:function(){return""},showScrollBar:function(){var X=this;X._79O&&(X._85I||(x(function(){X._86I()},kb),X.iv()),X._85I=new Date)},_86I:function(){var Q=this;if(Q._85I){var E=new Date,o=E.getTime();o-Q._85I.getTime()>=kb?(delete Q._85I,Q.iv()):x(function(){Q._86I()},kb)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var $=this,R=this._27I,f=this._28I;if($._79O){if($._autoHideScrollBar&&!$._85I)return R.style.visibility=ko,f.style.visibility=ko,void 0;var U=$.getScrollBarColor(),g=$._zoom,K=$.getScrollBarSize(),z=$.getViewRect(),I=$.getScrollRect(),T=z.height*g,Z=I.height*g,s=z.width*g-K-2,B=T*((z.y-I.y)*g/Z),S=T*(T/Z),W=R.style;Z-.5>T?(mr>S&&(B=B+S/2-mr/2,0>B&&(B=0),B+mr>T&&(B=T-mr),S=mr),ib(R,s,B,K,S),W.visibility=vh,W.background=U,W.borderRadius=K/2+sb):W.visibility=ko;var F=z.width*g,E=I.width*g,B=z.height*g-K-2,s=F*((z.x-I.x)*g/E),r=F*(F/E),W=f.style;E-.5>F?(mr>r&&(s=s+r/2-mr/2,0>s&&(s=0),s+mr>F&&(s=F-mr),r=mr),ib(f,s,B,r,K),W.visibility=vh,W.background=U,W.borderRadius=K/2+sb):W.visibility=ko}},setDataModel:function(Q){var f=this,x=f._dataModel,J=f._selectionModel;x!==Q&&(x&&(x.ump(f.handleDataModelPropertyChange,f),x.umm(f.handleDataModelChange,f),x.umd(f.handleDataPropertyChange,f),x.removeIndexChangeListener(f._75O,f),x.removeHierarchyChangeListener(f.handleHierarchyChange,f),J||x.sm().ums(f.handleSelectionChange,f)),f._dataModel=Q,Q.mp(f.handleDataModelPropertyChange,f),Q.mm(f.handleDataModelChange,f),Q.md(f.handleDataPropertyChange,f),Q.addIndexChangeListener(f._75O,f),Q.addHierarchyChangeListener(f.handleHierarchyChange,f),J?J._21I(Q):Q.sm().ms(f.handleSelectionChange,f),f.invalidateAll(!0),f.fp(Td,x,Q),f._canvas.style.background=Q.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===n){var W=this.getLayers();W?(this._layersInfo={},W.forEach(function(B){var v=Kq(B)?B.name:B;this._layersInfo[v]=B},this)):this._layersInfo=null}return this._layersInfo},calculateAttachPoint:function(){var X=new Jl,e=new Jl,L=new Jl;return function(b,n){var $=this.getAttachPoints(b);if(!$||!$.length)return null;L.set(n.x,n.y);for(var J,g,O,F,U=1/0,I=0,W=$.length;W>I;I++)O=$[I],e.x=O.x,e.y=O.y,X.x=O.offsetX||0,X.y=O.offsetY||0,F=Kg(this,b,0,X.x,X.y,e.x,e.y),g=L.distanceToSquared(F),U>g&&(J=I,U=g);U=Math.sqrt(U);var h=this.getAttachStyle(b);if("close"===h){var C=b.s("attach.close.threshold")/this._zoom;if(U>C)return null}return{index:J,distance:U,info:$[J]}}}(),getAttachPoints:function(d){var F=d.s("attach.points");if(F)return F;var q=wc(d._image);return q?aq(q.attachPoints,d,this)||null:void 0},getAttachStyle:function(o){var R=o.s("attach.style");if(R)return R;var l=wc(o._image);return l?aq(l.attachStyle,o,this)||"close":void 0},updateLayers:function(){this._layersInfo=n,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(b){if("background"===b.property){var B=this._canvas.style.background,j=b.newValue||"";this._canvas.style.background=j,this.fp("canvasBackground",B,j)}else"a:width"===b.property||"a:height"===b.property?(this._83I=1,this.redraw()):"layers"===b.property?this.updateLayers():"hierarchicalRendering"===b.property&&this.redraw()},handleDataPropertyChange:function(D){this.dm().isHierarchicalRendering()&&"parent"===D.property&&D.data.hasChildren()&&this.redraw(),this.invalidateData(D.data)},onPropertyChanged:function(K){var x=this,d=K.property;if(x.redraw(),"zoom"===d){var R=x.sm().getSelection();R.size()&&R.each(function($){$.invalidate()})}Nk[d]?x.showScrollBar():d===$i&&x.onCurrentSubGraphChanged(K)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(k){var e=this,Z=k.kind,C=k.data;if(e._83I=1,"add"===Z)e.invalidateData(C),Ll(C)&&C.getEdgeGroup()&&C.getEdgeGroup().eachSiblingEdge(e.invalidateData,e);else if(Z===ab){e._21Q(C);var V=C._id,$=e._25I[V];if($){if(e._56I[V]){var i=$._79o();i&&e.redraw(i)}$.dispose(),delete e._25I[V],delete e._24I[V],delete e._56I[V]}C===e._currentSubGraph&&e.setCurrentSubGraph(E)}else Z===Wb&&(e.invalidateAll(!0),e.setCurrentSubGraph(E))},_75O:function(p){this.invalidateData(p.data)},handleHierarchyChange:function(E){this.dm().isHierarchicalRendering()&&E.data.hasChildren()&&this.redraw(),this.invalidateData(E.data)},adjustIndex:function(e){var d=this;if(d.isVisible(e)){d.dm().beginTransaction();for(var J=e;J._parent&&d.isVisible(J._parent);)J=J._parent;J&&J!==e&&d._dataModel.adjustIndex(J),d._dataModel.adjustIndex(e),d.dm().endTransaction()}},getImage:function(N){return N.getImage?N.getImage():n},getSelectWidth:function(C){var M=wc(this.getImage(C));return M&&aq(M.disableSelectedBorder,C,this)?0:C.s("select.width")},getSelectColor:function(f){return f.s("select.color")},isSelectable:function(Y,g){if(this.isSelected(Y))return!0;if(!g&&Y.getParent()instanceof Go&&this.isSelectable(Y.getParent(),!0)&&Y.getParent().isSyncSize())return!1;var F=this.getLayersInfo();if(F){var P=F[Y._layer];if(P&&P.selectable===!1)return!1}return Y.s("2d.selectable")&&this.sm().isSelectable(Y)},isMovable:function(b){var o=this;if(Ll(b)&&b.getStyle(Qr)!==mc)return!1;var F=this.getLayersInfo();if(F){var x=F[b._layer];if(x&&x.movable===!1)return!1}return b.s("2d.movable")?o._movableFunc?o._movableFunc(b):!0:!1},isEditable:function(X){var U=this;if(B._uiSerializing)return U._uieditable;if(!U._editInteractor||!U.isSelected(X))return!1;if(Xi(X)){var P=U.getDataUI(X);if(!P||P._88I)return!1}if(Ll(X)&&X.getStyle(Qr)!==mc)return!1;var p=this.getLayersInfo();if(p){var i=p[X._layer];if(i&&i.editable===!1)return!1}return X.s("2d.editable")?U._editableFunc?U._editableFunc(X):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(M){return fk(M)&&0!==M.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(M):!0},isRectEditable:function(Q){return this._rectEditableFunc?this._rectEditableFunc(Q):!0},isAnchorEditable:function(A){return this._anchorEditableFunc?this._anchorEditableFunc(A):!0},isRotationEditable:function(W){return W.setRotation&&W.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(W):!0:!1},getRotationPoint:function(H){var N=H.getAnchor(),D=H.getScale(),O=this._zoom,_=Aj(H.getRotation(),0,-H.getHeight()*D.y*N.y-(D.y<0?-1:1)*(im?32:16)/O),F=H.p();return _.x+=F.x,_.y+=F.y,_},getLogicalPoint:function(x){var N=this;return He(x,N._canvas,N.tx(),N.ty(),N._zoom,N._zoom)},getScreenPoint:function(b,N){var x,t=this;return"object"==typeof b?b.x!==n?(x=b.x,N=b.y):(x=b[0],N=b[1]):x=b,hl(x,N,t._canvas,t.tx(),t.ty(),t._zoom,t._zoom)},getSelectedDataAt:function(h){var n=this;return this.getDataAt(h,function(j){return n.isSelected(j)})},getDataInfoAt:function(N,A,f){var x,l=this.lp(N),P=this.getDataAt(l,A,f);if(P){var J=this.getDataUI(P);x={data:P,ui:J,point:l};var R=J._38o;if(R){var K=R.icons;for(var Y in K){var F=K[Y],k=R.rects[Y];if(k)for(var B=aq(F.names,P,this),q=B?B.length:0,T=k.rotation,L=q-1;L>=0;L--){var H=B[L],z=k[L];if(Yr(z,l,T))return x.part="icons",x.name=Y,x.icon=H,x.rect=z,x.index=L,x.rotation=T,x}}}if(this.isNoteVisible(P)){if(J.note2Info&&Yr(J.note2Info.clickRect,l,E,J.note2Info.scale))return x.part="note2",x;if(J.noteInfo&&Yr(J.noteInfo.clickRect,l,E,J.noteInfo.scale))return x.part="note",x}if(this.isLabelVisible(P)){if(J.label2Info&&Yr(J.label2Info.rect,l,J.label2Info.rotation,J.label2Info.scale))return x.part="label2",x;if(J.labelInfo&&Yr(J.labelInfo.rect,l,J.labelInfo.rotation,J.labelInfo.scale))return x.part="label",x}if(P.isInRect&&P.isInRect(l))return x.part="body",x}return x},getDataAt:function(p,O,V){p.target&&(p=this.lp(p));var o,I=this._zoom;return this.reverseEach(function(k){return(O?O(k):this.isSelectable(k))&&this.rectIntersects(k,ti(p.x,p.y,V,I))?(o=k,!1):void 0},this),o},getIconInfoAt:function(Z,l){var Y=this;if(Z.target&&(Z=Y.lp(Z)),l||(l=Y.getDataAt(Z)),l){var P=Y.getDataUI(l);if(P&&P._38o){var K,$=P._38o,_=new yb;for(K in $.icons)_.add(K);for(var u=_.size()-1;u>=0;u--){K=_.get(u);for(var k=$.rects[K],c=k.rotation,d=k.length-1;d>=0;d--){var T=k[d],t=T.width,F=T.height,y={x:Z.x-T.x-t/2,y:Z.y-T.y-F/2};c!=E&&(y=Aj(-c,y.x,y.y));var T={x:-t/2,y:-F/2,width:t,height:F};if(Yr(T,y))return{key:K,index:d,name:$.icons[K].names[d],rect:k[d],point:Z,rotation:c,relativeRect:T,relativePoint:y,data:l}}}}}return E},getDatasInRect:function(W,s,y){y===n&&(y=1);var G=this,J=new yb;return G.reverseEach(function(g){y&&!G.isSelectable(g)||(s?G.rectIntersects(g,W):G.rectContains(g,W))&&J.add(g)}),J},moveSelection:function(i,h){var o=this;o.dm().beginTransaction(),sr(o.sm().toSelection(o.isMovable,o),i,h),o.dm().endTransaction()},moveDatas:function(B,N,Z){var Y=this;Y.dm().beginTransaction(),B instanceof yb||(B=new yb(B)),sr(B,N,Z),Y.dm().endTransaction()},getDataUIBounds:function(e){var V=this.getDataUI(e);return V?V._79o():E},drawData:function(P,c,Z){var n=this.getDataUI(c);if(n){var D=n._79o();(!Z||vn(Z,D))&&(n._42(P),c instanceof B.Block&&c.eachChild(function(y){this.drawData(P,y,Z)},this))}},getBoundsForGroup:function(i){return i.s(Am)?this.getDataUIBounds(i):E},isPixelPerfect:function(p){return p.s("pixelPerfect")},rectIntersects:function(r,o){this.validate();var V=E;if(this._56I[r._id]){var y=this._25I[r._id];if(y){var u=y._79o();if(rr(o,u))V=!0;else if((o=$r(o,u))&&(y.rectIntersects&&(V=y.rectIntersects(o)),V==E)){if(!this.isPixelPerfect(r))return!0;var s=o.x,K=o.y,e=o.width,z=o.height,k=this._zoom,c=$.hitMaxArea,p=e*z*k*k;if(p>c){var w=Math.sqrt(c/p);k*=w}e*=k,z*=k,2>e&&(e=2),2>z&&(z=2),s*=k,K*=k;var i=yl(e,z);Gg(i,-s,-K),i.scale(k,k),this._drawForChecking=!0,this.drawData(i,r,o),this._drawForChecking=!1;try{for(var Z=0,S=i.getImageData(0,0,e,z).data;Z<S.length;Z+=4)if(0!==S[Z+3]){V=!0;break}i.restore()}catch(X){_n=E,V=!1}}}}return V?!0:!1},rectContains:function(e,L){if(this._56I[e._id]){var l=this._25I[e._id];if(l)return rr(L,l._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(U){if(!$.isInput(U.target)){var O=this,k=O._focusData,m=k&&O._25I[k._id],F=0,E=O._dataModel._datas;if(!(k&&k._enabled&&k._editable&&m&&m.onKeyDown&&m.onKeyDown(U)===!0))if(9===U.keyCode&&(k&&(F=E.indexOf(k),Cj(U)?-1===--F&&(F=0):++F===E.size()&&(F=0)),O._focusData=k=E.get(F),O.sm().setSelection(k)),kj(U)?O.selectAll():dg(U)&&O.isResettable()&&O.reset(),O.sm().isEmpty()){if(O._editing)return;var D=O.tx(),q=O.ty(),c=!1,w=Cj()?100:10;Hf(U)&&(D-=w,c=!0),uh(U)&&(q-=w,c=!0),eg(U)&&(D+=w,c=!0),ps(U)&&(q+=w,c=!0),c&&O.setTranslate(D,q)}else{Bb(U)&&O.handleDelete(U);var t=Cj()?10:1;Hf(U)&&(O.moveSelection(-t,0),O.fi({kind:"moveLeft"})),uh(U)&&(O.moveSelection(0,-t),O.fi({kind:"moveUp"})),eg(U)&&(O.moveSelection(t,0),O.fi({kind:"moveRight"})),ps(U)&&(O.moveSelection(0,t),O.fi({kind:"moveDown"}))}}},handleScroll:function(F,h){if(ki(F),!this.getEditInteractor()){var k=this.getDataAt(F);if(k){var B=wc(this.getImage(k));if(B&&aq(B.scrollable,k,this))return}}var b=this.lp(F);h>0?this.scrollZoomIn(b):0>h&&this.scrollZoomOut(b)},handlePinch:function(m,y,f){this._68I||(y>f?this.pinchZoomIn(m):this.pinchZoomOut(m))},checkDoubleClickOnNote:function(S,p){var Q=this,F=Q.lp(S),r=Q.getDataUI(p),k=r.note2Info;return k&&p.s("note2.toggleable")&&Yr(k.clickRect,F)?(p.s(Oe,!p.s(Oe)),Q.fi({kind:"toggleNote2",event:S,data:p}),!0):(k=r.noteInfo,k&&p.s("note.toggleable")&&Yr(k.clickRect,F)?(p.s(Gf,!p.s(Gf)),Q.fi({kind:"toggleNote",event:S,data:p}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(n,w){var J=this,y=J.getAutoScrollZone(),I=y/J.getZoom(),e=y/4,m=J._29I,G=J.lp(n),k={x:J.tx(),y:J.ty()};return G&&y>0&&m&&(G.x-m.x<I?J.translate(e,0):m.x+m.width-G.x<I&&J.translate(-e,0),G.y-m.y<I?J.translate(0,e):m.y+m.height-G.y<I&&J.translate(0,-e)),k.x=J.tx()-k.x,k.y=J.ty()-k.y,w&&(w.x+=k.x,w.y+=k.y),k},getMoveMode:function(A,V){var Q=V.s("2d.move.mode");return Q?Q:tq["88"]?"x":tq["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(V,f,d){var E=this;return"currentSubGraph"===f?{__i:V.getId()}:d.serializeProperty(V,f,E)},deserializeProperty:function(U,v,S){var P=this;if("currentSubGraph"===v){var k=P.dm(),o=k.__idMap;return o[U.__i]}return S.deserializeProperty(U,v,P)},setDefaultCursor:function(A,T){this._defaultCursor=A,T!==!1&&this.setCursor(A)},setCursor:function(W){"default"===W&&(W=this._defaultCursor||W);var x=this.getView().style;x.cursor=W,x.cursor="-webkit-"+W,x.cursor="-moz-"+W},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(u){return u===E||$.getConnectAction(null,u)?(this._currentActionType=u,this.redraw(),!0):!1},isConnectActionVisible:function(E){var z=$.getConnectAction(this);if(!z)return!1;var B=z.visible;return hp(B)&&(B=B(this,E)),B},isInteractive:function(P){var _=wc(this.getImage(P));return _&&aq(_.interactive,P,this)?!0:P.s("interactive")},appendHTML:function(O,J){var u=this.getView();if(!(J||O&&O.parentNode!==u))return!1;var L=O.getView&&O.getView();if(!J&&L&&L.parentNode===u)return!1;if(O.isSelfViewEvent)return O.addToDOM(u),!0;O.getView&&(O=O.getView());var z=this.getEditInteractor();return z&&z._canvas?u.insertBefore(O,z._canvas):this.isScrollBarVisible()?u.insertBefore(O,this.getView().lastChild):Hi(u,O),!0},_layoutHTMLImpl:function(N,Y,p){if(arguments.length>1){var i,$=this,F=$._zoom;if(Y.getView&&(i=Y,Y=Y.getView()),Y.style.position="absolute",p){var V=N.getRect();ib(i||Y,$.tx()+V.x*F,$.ty()+V.y*F,V.width*F,V.height*F)}else{var G=new Xb,V=N.getAnchorRect(),r=N.getPosition(),a=N.getScale(),O=Y.style;ib(i||Y,V),G.appendTranslate($.tx(),$.ty()),G.appendScale(F,F),G.append(new Xb(N.getRotation(),r.x,r.y,a.x,a.y)),Sd(O,"transform","matrix("+G.a.toFixed(5)+", "+G.b.toFixed(5)+", "+G.c.toFixed(5)+",\n    "+G.d.toFixed(5)+", "+G.tx.toFixed(5)+", "+G.ty.toFixed(5)+")"),Sd(O,"transformOrigin",(-V.x).toFixed(5)+"px "+(-V.y).toFixed(5)+"px"),Y.maxtrixAppend=G.invert().translate(-V.x,-V.y)}}else this._layoutHTML&&this._layoutHTML()}}),O.defineProperties(Uc.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(r){this._layoutHTML=r}}});var ni=function(t,T){var C=this;C.gv=t,C.s=function(l){return T.getStyle(l)},C._data=T,C._87I=new yb};yr(ni,O,{_6I:E,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var Z=this,D=Z.gv.isSelected(Z._data);return!D||Z.isShadowed()?0:Z.gv.getSelectWidth(Z._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(K){var P=this._data,Y=this.gv.getBodyColor(P);return Y?Y:K?P.getStyle(K):E},_2Q:function(y){return this.s(y)},_1Q:function(R,k,h,Y){var p=this.s,N=p("2d.gray"),T=p(k+".dash.color");if(N&&(T=$.toGrayColor(T)),R.strokeStyle=T,R.lineWidth=h,R.stroke(),p(k+".dash.3d")){var g=p(k+".dash.3d.color");is(R,T,N?$.toGrayColor(g):g,h,this.gv._zoom,p(k+".dash.3d.accuracy"))}bl(R,Y)},invalidate:function(){this._6I=E},_79o:function(){var t=this;if(!t._6I){var R=t._data,Y=t.gv;t.labelInfo=t.label2Info=t.noteInfo=t.note2Info=t._38o=E,t._87I.clear(),t.interactiveInfo=Y.isInteractive(R)?{}:E,t._3O(),t._55O=Y.isEditable(R)?{_42O:Y.isRectEditable(R),_43O:Y.isPointEditable(R),_56O:Y.isRotationEditable(R)}:E,t._6I=t._81o()}return t._6I},_3O:function(){},getPosition:function(){return sm},_68o:function(e,D){e&&this._87I.add(cl(e,D))},_81o:function(){var a=this,l=a.s;a._24O(Eo,"getLabel"),a._24O(re,"getLabel2"),a._26O(No,"getNote"),a._26O(ss,"getNote2"),a._15O(),a._55O&&a._48O();var g;if(a._87I.each(function(y){g=tf(g,y)}),g&&a.isShadowed()){var U=Rn(g);U.x+=l("shadow.offset.x"),U.y+=l("shadow.offset.y"),ip(U,l("shadow.blur")),g=tf(g,U)}return a._87I.clear(),g},_42:function(U){var u=this,k=u._data,N=u.gv,r=u.s,p=r("opacity"),t=this.isShadowed();if(t){var J=U.shadowOffsetX,d=U.shadowOffsetY,T=U.shadowBlur,F=U.shadowColor,D=N.getZoom();U.shadowOffsetX=r("shadow.offset.x")*D,U.shadowOffsetY=r("shadow.offset.y")*D,U.shadowBlur=r("shadow.blur")*D,U.shadowColor=u.getSelectColor()}if(p!=E){var H=U.globalAlpha;U.globalAlpha=p}u._80o(U),N.isLabelVisible(k)&&((!N._drawForChecking||r("label.selectable"))&&Dm(U,u.labelInfo),(!N._drawForChecking||r("label2.selectable"))&&Dm(U,u.label2Info)),N.isNoteVisible(k)&&($c(U,u.noteInfo),$c(U,u.note2Info)),u._99O(U),p!=E&&(U.globalAlpha=H),t&&(U.shadowOffsetX=J,U.shadowOffsetY=d,U.shadowBlur=T,U.shadowColor=F)},_80o:function(){},_47O:function(){},_24O:function(q,M){var G=this,n=G._data,L=G.gv,b=G.s,t=L[M](n);if(t!=E){var $=b(q+".scale"),x=b(q+".max"),w=b(q+".position"),a=G[q+"Info"]={label:t,scale:$,color:L[M+"Color"](n),font:b(q+".font"),opacity:b(q+".opacity"),align:b(q+".align"),rotation:G.getRotation(b(q+".rotation"),!1,w),background:L[M+"Background"](n)},K=Qi(a,t);x>0&&x<K.width&&(a.labelWidth=K.width,K.width=x),1!==$&&(K.width*=$,K.height*=$);var d=G.getPosition(w,b(q+".offset.x"),b(q+".offset.y"),K,b(q+".position.fixed"));if(K.x=d.x-K.width/2,K.y=d.y-K.height/2,G._68o(a.rect=K,a.rotation),1!==$){var l=K.width/$,s=K.height/$;a.rect={x:d.x-l/2,y:d.y-s/2,width:l,height:s}}}},_26O:function(N,k){var e=this,b=e.gv,m=e._data,R=e.s,L=b[k](m);if(L!=E){var s,B,w=R(N+".scale"),Q=e[N+"Info"]={note:L,scale:w,data:m,view:b,expanded:R(N+".expanded"),font:R(N+".font"),color:R(N+".color"),opacity:R(N+".opacity"),align:R(N+".align"),icon:R(N+".icon"),backgroundImage:R(N+".backgroundImage"),borderWidth:R(N+".border.width"),borderColor:R(N+".border.color"),background:b[k+"Background"](m)},p=e.getPosition(R(N+".position"),R(N+".offset.x"),R(N+".offset.y")),O=p.x,H=p.y;if(Q.expanded){var g,n=R(N+".max"),S=R(N+".backgroundImage");S?(S=wc(S),g={width:Ap(S,m),height:pi(S,m)}):g=Qi(Q,L),g.width+=6,g.height+=2,n>0&&n<g.width&&(Q.labelWidth=g.width,g.width=n),s=g.width,B=g.height+8,Q.clickRect={x:O-s*w/2,y:H-B*w,width:s*w,height:B*w*g.height/B}}else{var u=R(N+".icon");u?(u=wc(u),s=Ap(u,m),B=pi(u,m)):(s=12,B=18),Q.clickRect={x:O-s*w/2,y:H-B*w,width:s*w,height:B*w}}Q.rect={x:O-s/2,y:H-B*w/2-B/2,width:s,height:B};var i=d(Q.borderWidth/2)*w;e._68o({x:O-s*w/2-i,y:H-B*w-i,width:s*w+2*i,height:B*w+2*i})
}},_48O:function(){},_99O:function(m){var X=this,W=X._38o;if(W){var v=X.gv,u=X._data,i=W.icons,l=X.interactiveInfo;l&&(l._38o={});for(var t in i){var J=i[t],R=W.rects[t];if(R){l&&(l._38o[t]=[]);var c=aq(J.opacity,u,v),Y=aq(J.names,u,v),H=Y?Y.length:0,N=R.rotation;if(c!=E){var U=m.globalAlpha;m.globalAlpha*=c}for(var M=0;H>M;M++){var e=Y[M],C=wc(e),F=R[M];if(N){var D=F.x+F.width/2,f=F.y+F.height/2;m.save(),Gg(m,D,f),Ke(m,N),Gg(m,-D,-f)}l&&l._38o[t].push(m.interactiveInfo={compInfos:[],matrix:N?new Xb(N,D,f).appendTranslate(-D,-f):new Xb}),zm(m,C,aq(J.stretch,u,v),F.x,F.y,F.width,F.height,X._data,X.gv),m.interactiveInfo=E,N&&m.restore()}c!=E&&(m.globalAlpha=U)}}}}});var wf=function(h,j){bs(wf,this,[h,j])};yr(wf,ni,{_checkEmptyRect:!0,_40O:function(b,B){var z=this,s=z.s,G=b.rect;(b.borderColor=z.gv.getBorderColor(z._data))&&(b.borderType=s("border.type"),b.borderWidth=s("border.width"),b.borderPadding=s("border.padding"),B=N(B,b.borderPadding+b.borderWidth/2));var u=z._data.getScale(),r=N(1,N(F(u.x),F(u.y)));if(b.selectWidth=z.getSelectWidth()){var p=z.gv._zoom;b.selectType=s("select.type"),b._97o=z.getSelectColor(),b.selectPadding=s("select.padding"),B=N(B,(b.selectPadding+b.selectWidth/2/p)/r)}B>0&&(B*=r,G=Rn(G),ip(G,B)),z._68o(G)},_39O:function(M,F){var N,U=this,P=F.rect;if(F.borderWidth>0&&(N=F.borderPadding,M.strokeStyle=F.borderColor,M.lineWidth=F.borderWidth,ap(M,F.borderType,{x:P.x-N,y:P.y-N,width:P.width+2*N,height:P.height+2*N}),M.stroke()),F.selectWidth>0){var $=U.gv._zoom;if(N=F.selectPadding,M.strokeStyle=F._97o,M.lineWidth=F.selectWidth/$,F.rotation!=E){M.save(),M.translate(F.position.x,F.position.y),M.rotate(F.rotation);var v=U._data,V=v.getWidth(),B=v.getHeight(),S=F.scale,L=F.anchor;P={x:S.x*-V*L.x,y:S.y*-B*L.y,width:S.x*V,height:S.y*B}}ap(M,F.selectType,{x:P.x-N,y:P.y-N,width:P.width+2*N,height:P.height+2*N}),F.rotation!=E&&M.restore(),M.stroke()}},dispose:function(){var l=this,D=l._htmlView;wf.superClass._3O.call(l),D&&(D.onHTMLRemoved&&D.onHTMLRemoved(),ii(D))},_3O:function(){var V=this,c=V.s,P=V._data,l=V.gv,W=P.getStyle(xc),j=V.getBodyColor(),D=V._83o=W?{shape:W,_53o:V.getBodyColor("shape.background"),_27Q:wc(c("shape.repeat.image"),j),shapeGradientPack:c("shape.gradient.pack"),_54o:c("shape.border.width"),_55o:c("shape.border.color"),_56o:c("shape.border.3d"),_57o:c("shape.border.3d.color"),_58o:c("shape.border.3d.accuracy"),shapeGradient:c("shape.gradient"),_59o:c("shape.gradient.color"),_60o:c("shape.border.pattern"),_61o:c("shape.border.cap"),_62o:c("shape.border.join"),shapeForeground:c("shape.foreground"),bodyColor:j,gray:c("2d.gray")}:{img:wc(l.getImage(P),j),bodyColor:j,gray:c("2d.gray"),stretch:c("image.stretch")};if(w&&!q);else{var r,s=D.img;s&&s.renderHTML?(V._htmlInfo&&V._htmlInfo.img!==s&&(V._htmlInfo=E),V._htmlInfo||(V._htmlInfo={img:s,cache:{}}),r=s.renderHTML(P,l,V._htmlInfo.cache)):V._htmlInfo=E,V._htmlView&&V._htmlView!==r&&(V._htmlView.onHTMLRemoved&&V._htmlView.onHTMLRemoved(),ii(V._htmlView.getView?V._htmlView.getView():V._htmlView)),(V._htmlView=r)&&l.appendHTML(r)&&r.onHTMLAdded&&r.onHTMLAdded(),D.rect=P.getRect(),D.position=P.p(),D.scale=P.getScale(),D.anchor=P.getAnchor(),D.rotation=P.getRotation(),W===Fe&&(D._63o=c("shape.depth"));var A=0;if(W)A=De(E,D._54o/2,D._62o),V.s("shape.dash")&&(A=N(A,(V.s("shape.dash.width")||D._54o)/2));else if(s&&s.boundExtend)if(A=aq(s.boundExtend,P,l),s.boundExtendAbsolute){var a=P.getScale();A/=l._zoom*N(1,N(F(a.x),F(a.y)))}else if(!aq(s.fitSize,P,l)){var I=aq(s.width,P,l),y=aq(s.height,P,l);A*=N(P.getWidth()/I,P.getHeight()/y)}V._40O(D,A);var x=c("clip.percentage");if(1>x&&(0>x&&(x=0),D.clipRect=op(P.getAnchorRect(),c("clip.direction"),x)),W){var e=c("shape.fill.clip.percentage");1>e&&(0>e&&(e=0),D.shapeClipRect=op(P.getAnchorRect(),c("shape.fill.clip.direction"),e));var O=c("shape.foreground.clip.percentage");1>O&&(0>O&&(O=0),D.shapeForegroundClipRect=op(P.getAnchorRect(),c("shape.foreground.clip.direction"),O))}}},getPosition:function(M,d,Y,q){var t=Vq(M,this._83o.rect,q);return t.x+=d,t.y+=Y,t},_80o:function(M){var R=this,r=R.s,K=R.gv,w=R._data,u=R._83o,P=u.rect,G=u.position,c=u.rotation,V=u.anchor,U=u.scale,I=u.shape,H=u.clipRect;if(!R._checkEmptyRect||P.width>0&&P.height>0){var N=w.getSize();if(N.x=-N.width*V.x,N.y=-N.height*V.y,M.save(),Gg(M,G.x,G.y),Ke(M,c),Sl(M,U.x,U.y),H&&(M.beginPath(),M.rect(H.x,H.y,H.width,H.height),M.clip()),K._drawForChecking&&u.img&&aq(u.img.pixelPerfect,w,K)===!1)Fp(M,N.x,N.y,N.width,N.height,"#888888");else if(R.freeDraw)R.freeDraw(M,N,u);else if(I){var x,n,S,q,J=u._60o,b=Be(M,J),o=u._27Q,D=u._54o,a=u.shapeGradientPack,T=u.gray,p=M.lineJoin,_=M.lineCap,A=function(g){return T?$.toGrayColor(g):g};"roundRect"===I?x=r("shape.corner.radius"):"polygon"===I?x=r("shape.polygon.side"):"arc"===I&&(x=r("shape.arc.from"),n=r("shape.arc.to"),S=r("shape.arc.close"),q=r("shape.arc.oval")),M.lineJoin=u._62o,M.lineCap=u._61o;var z=A(u._53o);if(z||o||a){var L=u.shapeClipRect;L&&(M.save(),M.beginPath(),M.rect(L.x,L.y,L.width,L.height),M.clip()),ap(M,I,N,x,n,S,q),a?Nf(M,a):o?dj(M,o,A(u.bodyColor),null,w,K):Rr(M,z,u.shapeGradient,A(u._59o),N),M.fill(),L&&M.restore(),a&&M.restore(),M!==b&&ap(b,I,N,x,n,S,q)}else ap(b,I,N,x,n,S,q);var s=u.shapeForeground;if(s){M.save();var B=u.shapeForegroundClipRect;B&&(M.beginPath(),M.rect(B.x,B.y,B.width,B.height),M.clip()),ap(M,I,N,x,n,S,q),Rr(M,s,r("shape.foreground.gradient"),A(r("shape.foreground.gradient.color")),N),M.fill(),M.restore()}if(D>0){var m=r("shape.border.width.absolute");m&&(M.save(),M.setTransform(1,0,0,1,0,0)),M.lineWidth=D;var h=A(u._55o);M.strokeStyle=h,M.stroke(),m&&M.restore(),u._56o&&is(M,h,A(u._57o),D,K._zoom,u._58o)}if(bl(M,J),r("shape.dash")){var F=r("shape.dash.width")||D;if(F>0){J=r("shape.dash.pattern");var b=Be(M,J,R._2Q("shape.dash.offset"));b!==M&&ap(b,I,N,x,n,S,q),R._1Q(M,"shape",F,J)}}gh(M,z,u._63o,N),M.lineJoin=p,M.lineCap=_}else{var f=R.interactiveInfo;f&&(M.interactiveInfo=f.bodyInfo={compInfos:[],matrix:new Xb(c,G.x,G.y,U.x,U.y)}),u.gray&&(M.compGray=!0);var l=u.img;l&&l.cacheRule!=E&&(l=es(M,l,u.stretch,N.width,N.height,w,K,u.bodyColor)),zm(M,l,u.stretch,N.x,N.y,N.width,N.height,w,K,u.bodyColor),M.compGray=!1,M.interactiveInfo=E}M.restore()}R._39O(M,u)},_48O:function(){},_47O:function(){}});var aj=function(c,$){bs(aj,this,[c,$])},al=function(M,J,d,z){var N=gn(M,J);return d=z?s(d,N):ag(d,N),N?d/=N:d=0,{x:M.x+(J.x-M.x)*d,y:M.y+(J.y-M.y)*d}};yr(aj,ni,{_3O:function(){var v,c=this,B=c._data,S=c.gv,P=c.s,L=P(Qr),e=B.isLooped(),H=P("edge.width"),T=P("edge.center"),w=P("edge.offset"),a=S.getBorderColor(B),b=a?P("border.width"):0,r=c.getSelectWidth(),_=B._40I,G=B._41I,Q=c._78o=_&&G?{looped:e,type:L,width:H,center:T,color:c.getBodyColor("edge.color"),borderColor:a,borderWidth:b,_97o:r?c.getSelectColor():E,selectWidth:r,pattern:P("edge.pattern"),cap:P("edge.cap"),join:P("edge.join"),is3d:P("edge.3d"),_67o:P("edge.3d.color"),_66o:P("edge.3d.accuracy"),gray:P("2d.gray")}:E;if(Q){var W=$.getEdgeType(L);if(W){var f=W(B,Hk(c,S,B,e,L),S,c._19Q);f.points&&f.points.size()>1?(Q.edgeTypeInfo=f,v=Vn(Q.edgeTypeInfo.points)):f[xf]&&f.rect&&(Q.edgeTypeInfo=f,v=f.rect)}else{var j=P("edge.source.anchor.x"),u=P("edge.source.anchor.y"),C=P("edge.target.anchor.x"),J=P("edge.target.anchor.y"),A=Kg(S,_,P("edge.source.position"),P("edge.source.offset.x"),P("edge.source.offset.y"),j,u),O=Kg(S,G,P("edge.target.position"),P("edge.target.offset.x"),P("edge.target.offset.y"),C,J);if(L===mc){var M=Q.points=P(Og)||Yo,V=M.size();Q.segments=P("edge.segments");var F=j!==n||u!==n,i=C!==n||J!==n;if(!T)if(w)F||(A=al(A,V?M.get(0):O,w,V)),i||(O=al(O,V?M.get(V-1):A,w,V));else{var y;F||(y=ae(A,V?M.get(0):O,Or(S,_)),y&&(A={x:y[0],y:y[1]})),i||(y=ae(V?M.get(V-1):A,O,Or(S,G)),y&&(O={x:y[0],y:y[1]}))}v=tf(Vn(Q.points),Vn(A,O))}else{var o=Hk(c,S,B,e,L);if(c._19Q||(o=-o),e)A=Rn(A),A.x=S.getNodeRect(_).x,Q.radius=o,v={x:A.x-o,y:A.y-o,width:2*o,height:2*o};else{var m=gn(A,O),g=ag(w,m),z={x:g,y:o},q={x:m-g,y:o},k=U(O.y-A.y,O.x-A.x),d=Q.mat=new Ng(k);if(Q.orienAngle=k,Q.angle=O.x<A.x?k+t:k,Q.rect={x:z.x,y:z.y,width:q.x-z.x,height:0},Q.origin=A,z=d.tf(z),z.x+=A.x,z.y+=A.y,q=d.tf(q),q.x+=A.x,q.y+=A.y,T){var l={x:m,y:0};l=d.tf(l),l.x+=A.x,l.y+=A.y,v=Vn([A,z,q,l]),Q.c1=A,Q.c2=l}else v=Vn(z,q);A=z,O=q}}Q.sourcePoint=A,Q.targetPoint=O,B._lastSourcePoint=A,B._lastTargetPoint=O}var K=0;P("edge.dash")&&(K=P("edge.dash.width")||H);var p="square"===Q.cap?.71:.5;De(v,N(K*p,H*p+b+r),Q.join),c._68o(v)}},getRotation:function(H,P,l){H=H||0;var U=this._78o;if(U){var O,F=U.angle,d=U.points,x=U.edgeTypeInfo;if(F!=E)return P?U.orienAngle+H:F+H;if(x&&x[xf])return x.getRotation?x.getRotation(this,H,P,l):0;if(x&&x.points){var b=x.points;return O=b.size(),Yb[l]?O&&0===O%2?ls(b.get(O/2-1),b.get(O/2),P,H):H:no[l]?ls(b.get(0),b.get(1),P,H):ls(b.get(O-2),b.get(O-1),P,H)}if(d)return O=d.size(),Yb[l]?O&&0===O%2?ls(d.get(O/2-1),d.get(O/2),P,H):H:no[l]?ls(U.sourcePoint,O?d.get(0):U.targetPoint,P,H):ls(O?d.get(O-1):U.sourcePoint,U.targetPoint,P,H)}return H},getPosition:function(w,t,y,e,d){var h=this._78o;if(h){var $,P=h.type,D=h.points,A=h.edgeTypeInfo,k=h.sourcePoint,m=h.targetPoint;if(!P)return h.looped?{x:k.x-h.radius+t,y:k.y+y}:(d&&k&&m&&(k.x>m.x||k.x===m.x&&k.y>m.y)&&(w=Jh[w],y=-y),$=Vq(w,h.rect,e),$.x+=t,$.y+=y,$=h.mat.tf($),$.x+=h.origin.x,$.y+=h.origin.y,$);if(A&&A[xf])return A.getPosition?A.getPosition(this,w,t,y,e,d):{x:(k.x+m.x)/2,y:(k.y+m.y)/2};if(D){var $,Q=D.size();if(Yb[w]){if(Q){var l=Q%2;if(0===l)return fr(D.get(Q/2-1),D.get(Q/2),w,t,y,e,d);$=D.get((Q-l)/2)}else $={x:(k.x+m.x)/2,y:(k.y+m.y)/2};return $=Vq(w,{x:$.x,y:$.y,width:0,height:0},e),$.x+=t,$.y+=y,$}return no[w]?fr(k,Q?D.get(0):m,w,t,y,e,d):fr(Q?D.get(Q-1):k,m,w,t,y,e,d)}if(A){var a=A.points,Q=a.size();if(Yb[w]){var l=Q%2;return 0===l?fr(a.get(Q/2-1),a.get(Q/2),w,t,y,e,d):($=a.get((Q-l)/2),$=Vq(w,{x:$.x,y:$.y,width:0,height:0},e),$.x+=t,$.y+=y,$)}return no[w]?fr(a.get(0),a.get(1),w,t,y,e,d):fr(a.get(Q-2),a.get(Q-1),w,t,y,e,d)}}return sm},_42:function($){this._78o&&aj.superClass._42.call(this,$)},drawPath:function(i,$){i.beginPath();var B=$.type,h=$.points,p=$.segments,E=$.edgeTypeInfo;if(!B||h){var Y=$.sourcePoint,u=Y.x,q=Y.y,Q=$.targetPoint,P=Q.x,v=Q.y;if(B)if(p){var b=new yb({x:u,y:q});b.addAll(h),b.add({x:P,y:v}),Sb(i,b,p)}else i.moveTo(u,q),h.each(function(I){i.lineTo(I.x,I.y)}),i.lineTo(P,v);else $.looped?i.arc(u,q,$.radius,0,f,!0):$.center?(i.moveTo($.c1.x,$.c1.y),i.lineTo(u,q),i.lineTo(P,v),i.lineTo($.c2.x,$.c2.y)):(i.moveTo(u,q),i.lineTo(P,v))}else E&&(E.points?Sb(i,E.points,E.segments):E[xf]&&E[xf](i,E))},_80o:function(G){var Y=this,R=Y.s,X=Y._78o,p=X.width,U=X.selectWidth,H=X.borderWidth,F=G.lineJoin,S=G.lineCap,k=X.gray,y=X.pattern;G.lineJoin=X.join,G.lineCap=X.cap,Y.drawPath(Be(G,y),X);var J=R("edge.width.absolute");J&&(G.save(),G.setTransform(1,0,0,1,0,0)),U&&(G.strokeStyle=X._97o,G.lineWidth=p+2*(H+U),G.stroke()),H&&(G.strokeStyle=k?$.toGrayColor(X.borderColor):X.borderColor,G.lineWidth=p+2*H,G.stroke());var f=k?$.toGrayColor(X.color):X.color,V=k?$.toGrayColor(X._67o):X._67o;if(G.strokeStyle=f,G.lineWidth=p,G.stroke(),X.is3d&&is(G,f,V,p,Y.gv._zoom,X._66o),J&&G.restore(),bl(G,y),R("edge.dash")){y=R("edge.dash.pattern");var n=Be(G,y,Y._2Q("edge.dash.offset"));n!==G&&Y.drawPath(n,X),Y._1Q(G,"edge",R("edge.dash.width")||p,y)}G.lineJoin=F,G.lineCap=S},_48O:function(){},_47O:function(){},_71o:function(k,d){var W=this,m=W._data;if(W._19Q=!0,!m.getEdgeGroup())return k?m.s("edge.gap"):0;var g,R=0,p=0,E=0;if(m.getEdgeGroup().getSiblings().each(function(P){P.each(function(O){if(W.gv.isVisible(O)&&O.s(Qr)==d){var t=O.s("edge.gap");g?(p+=E/2+t/2,E=t):(g=O,E=t),O===m&&(R=p)}})}),k)return p-R+E;var J=R-p/2;return g&&m._40I!==g._40I&&(W._19Q=!1),J}});var ac=function(u,i){bs(ac,this,[u,i])};yr(ac,wf,{_3O:function(){var j,b,n=this,C=n.s,T=n._data,_=n.gv;if(n._88I=E,T.isExpanded()&&T.eachChild(function(X){if(fk(X)){var v=_.getBoundsForGroup(X);v&&(b||(b=[]),b.push(v),j=tf(j,v))}}),j){var Y=_.getLabel(T),u=C("group.type");j=ok(u,b,j),Ic(j,T,"group.padding",1);var H=n._88I={type:u,rect:j,_64o:j};if(!u&&Y!=E){var m,A=n.labelInfo={label:Y,color:C("group.title.color"),font:C("group.title.font"),align:C("group.title.align")},t=Qi(A,Y),o=t.width,d=t.height,e=C("group.title.align"),x=C("group.title.orientation");if((x===Ui||x===Ki)&&o>j.width?j.width=o:(x===Pi||x===tl)&&o>j.height&&(j.height=o),A.rect={y:j.y-d,width:t.width,height:d},m=e===Pi?j.x:e===tl?j.x+j.width-o:j.x+j.width/2-o/2,A.rect.x=m,x===Ki)H.titleRect={x:j.x,y:j.y+j.height,width:j.width,height:d},H.rect={x:j.x,y:j.y,width:j.width,height:j.height+d},A.rect={x:m,y:j.y+j.height,width:o,height:d};else if(x===Pi){var p=H.titleRect={x:j.x-d,y:j.y,width:d,height:j.height};H.rect={x:j.x-d,y:j.y,width:j.width+d,height:j.height},A.rect={x:p.x+d/2-j.height/2,y:p.y+j.height/2-d/2,width:j.height,height:d},A.rotation=-Math.PI/2}else if(x===tl){var p=H.titleRect={x:j.x+j.width,y:j.y,width:d,height:j.height};H.rect={x:j.x,y:j.y,width:j.width+d,height:j.height},A.rect={x:p.x+d/2-j.height/2,y:p.y+j.height/2-d/2,width:j.height,height:d},A.rotation=Math.PI/2}else H.titleRect={x:j.x,y:j.y-d,width:j.width,height:d+1},H.rect={x:j.x,y:j.y-d,width:j.width,height:j.height+d}}n._40O(H,C("group.border.width")/2)}else ac.superClass._3O.call(n)},getPosition:function(c,b,P,G){var F=this._88I;if(F){var y=Vq(c,F.rect,G);return y.x+=b,y.y+=P,y}return ac.superClass.getPosition.apply(this,arguments)},_24O:function(B,g){var X=this._88I;(!X||X.type||"label2"===B)&&ac.superClass._24O.call(this,B,g)},_80o:function(j){var R=this,D=R._88I;if(D){var S=R._data,H=R.s,Q=R.gv,Y=D.type,O=D.rect,C=D._64o,K=D.titleRect,X=R.getBodyColor(),z=wc(H("group.image"),X),o=H("group.image.stretch"),m=R.getBodyColor("group.background"),I=wc(H("group.repeat.image"),X),n=H("group.gradient.pack"),b=H("group.gradient"),s=H("group.gradient.color"),P=H("group.border.width"),G=H("group.border.color"),l=H("group.border.pattern"),T=H("group.title.orientation"),_=H("group.depth");if(Y){var g=j.lineJoin,h=j.lineCap;if(j.lineJoin=H("group.border.join"),j.lineCap=H("group.border.cap"),z){if(j.save(),ap(j,Y,O),j.clip(),zm(j,z,o,O.x,O.y,O.width,O.height,S,Q,X),j.restore(),P>0){var $=Be(j,l);ap($,Y,O),j.lineWidth=P,j.strokeStyle=G,j.stroke(),bl(j,l)}}else{var $=Be(j,l);m||I||n?(ap(j,Y,O),n?Nf(j,n):I?dj(j,I,X,null,S,Q):Rr(j,m,b,s,O),j.fill(),n&&j.restore(),j!==$&&ap($,Y,O)):ap($,Y,O),P>0&&(j.lineWidth=P,j.strokeStyle=H("group.border.color"),j.stroke()),bl(j,l),Y===Fe&&gh(j,m,_,O)}j.lineJoin=g,j.lineCap=h}else{var M=H("group.title.background"),W=H("group.border.radius");if(z)zm(j,z,o,C.x,C.y,C.width,C.height,S,Q,R.getBodyColor());else if(m||I)if(I?dj(j,I,X,null,S,Q):Rr(j,m,b,s,C),0===P)ap(j,Fe,C),j.fill(),gh(j,m,_,C);else{switch(j.beginPath(),T){case Ki:ze(j,C.x,C.y,C.width,C.height,W,W,0,0);break;case Pi:ze(j,C.x,C.y,C.width,C.height,0,W,0,W);break;case tl:ze(j,C.x,C.y,C.width,C.height,W,0,W,0);break;case Ui:ze(j,C.x,C.y,C.width,C.height,0,0,W,W)}j.fill()}if(K&&M)if(0===P)Fp(j,K.x,K.y,K.width,K.height,M),gh(j,M,_,K);else{switch(j.beginPath(),j.fillStyle=M,T){case Ki:ze(j,K.x,K.y,K.width,K.height,0,0,W,W);break;case Pi:ze(j,K.x,K.y,K.width,K.height,W,0,W,0);break;case tl:ze(j,K.x,K.y,K.width,K.height,0,W,0,W);break;case Ui:ze(j,K.x,K.y,K.width,K.height,W,W,0,0)}j.fill()}if(P>0){var $=Be(j,l);if(ap($,"roundRect",O,W),j.lineWidth=P,j.strokeStyle=G,K&&H("group.splitLine")){var x=K.x,w=K.y,e=K.width,E=K.height;T===Ki?(j.moveTo(x,w),j.lineTo(x+e,w)):T===Pi?(j.moveTo(x+e,w),j.lineTo(x+e,w+E)):T===tl?(j.moveTo(x,w),j.lineTo(x,w+E)):(j.moveTo(x,w+E),j.lineTo(x+e,w+E))}j.stroke(),bl(j,l)}}R._39O(j,D)}else ac.superClass._80o.call(R,j)}});var Yq=function(D,p){bs(Yq,this,[D,p])};yr(Yq,wf,{_80o:function(J){this._39O(J,this._83o)}});var Mp=function(g,t){bs(Mp,this,[g,t])};yr(Mp,wf,{_3O:function(){var m=this,o=m._data,G=m.s,u=m.gv,I=o.getPoints(),W=u.getBorderColor(o),v=W?G("border.width"):0,D=m.getSelectWidth(),B=G("shape.border.width"),h=o.getRect(),i=u.getBodyColor(o),f=m._99o=I.isEmpty()?E:{rect:h,rotation:o.getRotation(),fillRule:G("shape.fill.rule"),scale:o.getScale(),position:o.p(),points:I,segments:o.getSegments(),bodyColor:i,borderColor:W,borderWidth:v,_94o:G("shape.border.3d"),_95o:G("shape.border.3d.color"),_96o:G("shape.border.3d.accuracy"),_97o:D?m.getSelectColor():E,selectWidth:D,_53o:G("shape.background"),_27Q:wc(G("shape.repeat.image"),i),shapeGradientPack:G("shape.gradient.pack"),_54o:B,_55o:G("shape.border.color"),shapeGradient:G("shape.gradient"),_59o:G("shape.gradient.color"),_60o:G("shape.border.pattern"),_61o:G("shape.border.cap"),_62o:G("shape.border.join"),shapeForeground:G("shape.foreground"),gray:G("2d.gray")};if(f){var s=o.getScale(),Q=N(1,N(F(s.x),F(s.y)));G("shape.dash")&&G("shape.dash.width")>B&&(B=G("shape.dash.width"));var c=B*("square"===f._61o?.71:.5)+v+D/m.gv._zoom/Q;c&&(c*=Q,h=Rn(h),De(h,c,f._62o)),m._68o(h);var V=G("clip.percentage");1>V&&(0>V&&(V=0),f.clipRect=op(o.getAnchorRect(),G("clip.direction"),V));var M=G("shape.fill.clip.percentage");1>M&&(0>M&&(M=0),f.shapeClipRect=op(o.getAnchorRect(),G("shape.fill.clip.direction"),M));var x=G("shape.foreground.clip.percentage");1>x&&(0>x&&(x=0),f.shapeForegroundClipRect=op(o.getAnchorRect(),G("shape.foreground.clip.direction"),x))}},getPosition:function(C,V,t,z){var s=this._99o;if(s){var P=Vq(C,s.rect,z);return P.x+=V,P.y+=t,P}return sm},_42:function(n){this._99o&&Mp.superClass._42.call(this,n)},_80o:function(P){var f,B=this,l=B.s,s=B._99o,H=s.position,z=s.scale,G=s.rotation,r=s.borderWidth,S=s.selectWidth/B.gv._zoom,g=s._27Q,A=s.shapeGradientPack,V=s._54o,q=s.clipRect,T=s.shapeClipRect,d=s.points,L=s.segments,M=B._data.isClosePath(),h=s.fillRule,v=s.gray,o=function(z){return v?$.toGrayColor(z):z},X=o(s._53o),I=X||g||A;P.save(),Gg(P,H.x,H.y),Ke(P,G),Sl(P,z.x,z.y),q&&(P.beginPath(),P.rect(q.x,q.y,q.width,q.height),P.clip()),I&&T&&(P.save(),P.beginPath(),P.rect(T.x,T.y,T.width,T.height),P.clip()),Gg(P,-H.x,-H.y);var K=s._60o,J=Be(P,K),O=P.lineJoin,R=P.lineCap;P.lineJoin=s._62o,P.lineCap=s._61o;var N=o(s.bodyColor);I?(Sb(P,d,L,M),A?Nf(P,A):g?dj(P,g,N,null,B._data,B.gv):(f=N?N:X,Rr(P,f,s.shapeGradient,o(s._59o),s.rect)),P.fill(h),T&&(P.restore(),Gg(P,-H.x,-H.y)),A&&P.restore(),J!==P&&Sb(J,d,L,M)):Sb(J,d,L,M);var b=s.shapeForeground;if(b){P.save();var W=s.shapeForegroundClipRect;W&&(Gg(P,H.x,H.y),P.beginPath(),P.rect(W.x,W.y,W.width,W.height),P.clip(),Gg(P,-H.x,-H.y)),Sb(P,d,L,M),Rr(P,b,l("shape.foreground.gradient"),o(l("shape.foreground.gradient.color")),s.rect),P.fill(h),P.restore()}var i=l("shape.border.width.absolute");if(i&&(P.save(),P.setTransform(1,0,0,1,0,0)),S&&(P.strokeStyle=s._97o,P.lineWidth=V+2*(r+S),P.stroke()),r&&(P.strokeStyle=o(s.borderColor),P.lineWidth=V+2*r,P.stroke()),V&&(f=o(s._55o),!X&&N&&(f=N),P.strokeStyle=f,P.lineWidth=V,P.stroke(),s._94o&&is(P,f,o(s._95o),V,B.gv._zoom,s._96o)),i&&P.restore(),bl(P,K),l("shape.dash")){var Z=l("shape.dash.width")||V;if(Z>0){K=l("shape.dash.pattern");var J=Be(P,K,B._2Q("shape.dash.offset"));J!==P&&Sb(J,d,L,M),B._1Q(P,"shape",Z,K)}}P.lineJoin=O,P.lineCap=R,P.restore()},_48O:function(){},_47O:function(){}});var Yh=function(A,r){bs(Yh,this,[A,r])};yr(Yh,Mp,{getRotation:function(J,$,k){J=J||0;var h=this._data.getPoints(),X=h.size();return X>1?Yb[k]?X&&0===X%2?ls(h.get(X/2-1),h.get(X/2),$,J):J:no[k]?ls(h.get(0),h.get(1),$,J):ls(h.get(X-2),h.get(X-1),$,J):J},getPosition:function(S,g,f,B,L){var t=this._data.getPoints(),v=t.size();if(v>1){if(Yb[S]){var X=v%2;if(0===X)return fr(t.get(v/2-1),t.get(v/2),S,g,f,B,L);var d=t.get((v-X)/2),K={x:d.x,y:d.y,width:0,height:0};return d=Vq(S,K,B),d.x+=g,d.y+=f,d}return no[S]?fr(t.get(0),t.get(1),S,g,f,B,L):fr(t.get(v-2),t.get(v-1),S,g,f,B,L)}return sm}});var Zm=function(Z,R){bs(Zm,this,[Z,R])};yr(Zm,wf,{_3O:function(){var V=this;Zm.superClass._3O.call(V);var M=V.s,y=V._83o;V._82o=y.img||y.shape?E:{background:V.getBodyColor("grid.background"),depth:M("grid.depth"),rect:y.rect,_88o:M("grid.cell.depth"),cellBorderColor:M("grid.cell.border.color"),_89o:M("grid.row.count"),_90o:M("grid.column.count"),block:M("grid.block"),_91o:M("grid.block.color"),_92o:M("grid.block.padding"),_93o:M("grid.block.width")}},_80o:function(X){var g=this,t=g._82o;if(!t)return Zm.superClass._80o.call(g,X),void 0;var y,p,J=g._data,z=t.background,r=t.rect,i=t.block,n=t._91o,Z=t._92o,T=t._93o,N=t._88o,V=t.cellBorderColor,s=t._89o,f=t._90o;if(z)if(Fp(X,r.x,r.y,r.width,r.height,z),gh(X,z,t.depth,r),N)for(y=0;s>y;y++)for(p=0;f>p;p++)r=J.getCellRect(y,p),r&&gh(X,z,N,r);else if(V){for(X.beginPath(),y=0;s>y;y++)for(p=0;f>p;p++)r=J.getCellRect(y,p),r&&X.rect(r.x,r.y,r.width,r.height);X.strokeStyle=V,X.lineWidth=1,X.stroke()}if("h"===i)for(y=0;s>y;y++)r=tf(J.getCellRect(y,0),J.getCellRect(y,f-1)),ip(r,Z),gj(X,n,r.x,r.y,r.width,r.height,T);else if("v"===i)for(p=0;f>p;p++)r=tf(J.getCellRect(0,p),J.getCellRect(s-1,p)),ip(r,Z),gj(X,n,r.x,r.y,r.width,r.height,T);g._39O(X,g._83o)}});var Ji=function(l,g){bs(Ji,this,[l,g])};yr(Ji,wf,{_checkEmptyRect:!1,_81o:function(){var i=this._data,P=Ji.superClass._81o.call(this),k=i.s("text");if(k!=E){var O,d,J=i.s("text.font"),S=i.s("text.align"),m=i.s("text.vAlign"),U=er(J,k),L=U.width,h=U.height,X=i.getAnchor(),j=i.getWidth(),q=i.getHeight();"left"===S?O=-j*X.x:"center"===S?O=-j*X.x+(j-L)/2:"right"===S&&(O=j*(1-X.x)-U.width),"top"===m?d=-q*X.y:"middle"===m?d=-q*X.y+(q-h)/2:"bottom"===m&&(d=q*(1-X.y)-U.height);var p,u=i.getMatrix();if(p=Vn([u.tf(O,d),u.tf(O+L,d),u.tf(O+L,d+h),u.tf(O,d+h)]),P=tf(P,p),P&&i.s("text.shadow")){var C=Rn(P);C.x+=i.s("text.shadow.offset.x"),C.y+=i.s("text.shadow.offset.y"),ip(C,i.s("text.shadow.blur")),P=tf(P,C)}}return P}});var Dp=Uc.Interactor=function(t){this.gv=this._graphView=t};Ro("Interactor",O,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(Z){this.gv.fi(Z)},setCursor:function(I){im||this.gv.setCursor(I)},startDragging:function(R){var d=this;d._lastClientPoint=Rb(R),d._lastLogicalPoint=d.gv.lp(R),to(d,R)},clearDragging:function(){var A=this;A._lastClientPoint=A._lastLogicalPoint=A._logicalPoint=E},autoScroll:function(G){return this.gv.autoScroll(G,this._lastClientPoint)}});var Zk=E,mn=function(Z){Zk.handleWindowTouchMove(Z)},Qk=function(u){Zk.handleWindowTouchEnd(u),S.removeEventListener(lc,mn,k),S.removeEventListener(Mi,Qk,k),Zk=E},Np=function(C){Zk.handleWindowMouseMove(C)},zk=function(M){Zk.handleWindowMouseUp(M),S.removeEventListener(Lg,Np,k),S.removeEventListener(Gh,zk,k),Zk=E},Hb=function(m,F){m!==Zk&&(Zk?im?Zk.handleWindowTouchEnd(F):Zk.handleWindowMouseUp(F):im?(S.addEventListener(lc,mn,k),S.addEventListener(Mi,Qk,k)):(S.addEventListener(Lg,Np,k),S.addEventListener(Gh,zk,k)),Zk=m)},zj=function(q){var b=this;b.gv=q,b._is2d=q instanceof Uc.GraphView,b._is2d&&(b.filter=function(D){return q.isSelectable(D)&&q.isInteractive(D)}),q.getView(),["mousedown","mousemove","mouseleave","touchstart","touchmove",wn].forEach(function(T){b.addListener(T)}),b.initImageResource()};yr(zj,Dp,{enableVR:function(C){var V=this;if(!!V._vrEnable!==C)if(V._vrEnable=C,C)V.gv.vr.mp(V.onVRControllerChange,V);else if(V.gv.vr.ump(V.onVRControllerChange,V),V._vrRayPolyline){var j=V.gv.dm();j.remove(V._vrRayPolyline),j.remove(V._vrRayHitPoint),V._vrRayPolyline=n,V._vrRayHitPoint=n}},onVRControllerChange:function(r){var $=this,L=r.property,H=r.newValue,v=$.gv.vr.getController(H.id),y=v.getRay();y&&("gamepad.button.trigger"===L?"down"===H._62O?$.handle_mousedown(y):$.handleWindowMouseUp(y):"gamepad.pose"===L&&($.handle_mousemove(y),$.handleWindowMouseMove(y)))},drawVRRay:function(G,H,b){var P,M=this,l=M.gv,f=M._vrRayPolyline,C=!1;if(f)P=M._vrRayHitPoint;else{var o=l.dm();M._vrRayPolyline=f=new B.Polyline,M._vrRayHitPoint=P=new B.Node,P.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),P.setAnchor3d(.5,.5,.499);var W=.2/l.vr.measureOflength;P.s3(W,W,W),f.s("intersect",!1),P.s("intersect",!1),o.add(f),o.add(P),C=!0}if(H){var z=b.world,q=b.worldNormal,x=z.x,k=z.y,D=z.z;f.s("shape.border.color","red"),f.setPoints([{x:G.origin.x,y:G.origin.z,e:G.origin.y},{x:x,y:D,e:k}]),P.s("3d.visible",!0),P.p3(x,k,D),P.lookAtDirection([q.x,q.y,q.z],"front")}else{f.s("shape.border.color","blue");var K=new B.Math.Vector3;K.copy(G.direction).setLength(1e3/M.gv.vr.measureOflength).add(G.origin),f.setPoints([{x:G.origin.x,y:G.origin.z,e:G.origin.y},{x:K.x,y:K.z,e:K.y}]),P.s("3d.visible",!1)}l.fi({kind:"vrRayIntersect",ray:G,data:H,intersect:b,polyline:f,hitNode:P,begin:C})},addListener:function(j){var H=this;H.gv.getView().addEventListener(j,function(T){$.preventDefault(T),H.disabled||H["handle_"+j](T)},k)},handleWindowTouchMove:function(I){this.handleWindowMouseMove(I)},handleWindowMouseMove:function(h){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",h):(this.handleDownInfo("onBeginDrag",h),this.isDragging=!0))},handleWindowTouchEnd:function(x){this.handleWindowMouseUp(x)},handleWindowMouseUp:function(x){if(this.isDragging&&(this.handleDownInfo("onEndDrag",x),this.isDragging=!1),this.downInfo){var j=this.handle("onUp",x);j&&j.data===this.downInfo.data?this.handleMissingUp(x):this.handleDownInfo("onUp",x),this.downInfo=E}},handle_mouseleave:function(H){var N=this,b=N.gv,o=N.currentInfo?N.currentInfo.data:E;if(o){o.s("onLeave")&&o.s("onLeave")(H,o,b),N.fire("data","onLeave",H,o);var G=N.currentInfo?N.currentInfo.hits:E;if(G)for(var W in G)N.handleLeave(H,W);N.currentInfo=E}},handle_mousewheel:function(x){x.scrollDelta=x.wheelDelta/40,this.handle("onScroll",x)},handle_DOMMouseScroll:function(s){s.scrollDelta=2===s.axis?-s.detail:0,this.handle("onScroll",s)},handle_touchstart:function(h){this.handle_mousedown(h)},handle_touchmove:function(P){this.handle("onMove",P)},handle_mousedown:function(x){this.isDragging&&(this.handleDownInfo("onEndDrag",x),this.isDragging=!1),this.downInfo=this.handle("onDown",x),this.downInfo&&Hb(this,x)},handle_mousemove:function(k){var y=this,Q=y.gv;y._hoverTimer&&(P(y._hoverTimer),delete y._hoverTimer);var n,A,U,r=y.handle("onMove",k),L=this.currentInfo?this.currentInfo.data:E,I=this.currentInfo?this.currentInfo.hits:E;if(r&&(A=r.data,U=r.hits,y._hoverTimer=x(function(){P(y._hoverTimer),delete y._hoverTimer,y.handle("onHover",k,r)},Q.getHoverDelay()||$.hoverDelay)),A!==L){if(L&&(L.s("onLeave")&&L.s("onLeave")(k,L,Q),this.fire("data","onLeave",k,L)),A&&(A.s("onEnter")&&A.s("onEnter")(k,A,Q),this.fire("data","onEnter",k,A)),I)for(n in I)this.handleLeave(k,n);if(U)for(n in U){var S=U[n];S.target.onEnter&&S.target.onEnter(k,A,Q,S.point,S.width,S.height),this.fire(S.type,"onEnter",S.event,S.data,S.image,S.comp,S.point,S)}}else{if(I)for(n in I)U&&U[n]||this.handleLeave(k,n);if(U)for(n in U)if(!I||!I[n]){var S=U[n];S.target.onEnter&&S.target.onEnter(k,A,Q,S.point,S.width,S.height),this.fire(S.type,"onEnter",S.event,S.data,S.image,S.comp,S.point,S)}}this.currentInfo=r},handle:function(I,M,O){var s,H=this,V=H.gv;if(H._is2d){if(O=O||V.getDataInfoAt(M,this.filter),!O)return;if(s=O.ui.interactiveInfo){var i,g=O.data;if(g.s(I)&&g.s(I)(M,g,V),this.fire("data",I,M,g),"body"===O.part&&s.bodyInfo)i="body",O.hits=this.handleImage(i,V.getImage(g),I,M,g,O.point,s.bodyInfo);else if("icons"===O.part&&s._38o){var n=s._38o[O.name];n&&n[O.index]&&(i="icons|"+O.name+"|"+O.index,O.hits=this.handleImage(i,O.icon,I,M,g,O.point,n[O.index]))}}return O}var g,C;if(!O)if(M&&M instanceof B.Math.Ray){var c=V.vr.intersectWorld(M);if(g=c.data,C=c.intersect,H.drawVRRay(M,g,C),!g)return;var Q=V.getData3dUI(g);if(s=Q.interactiveInfo,!s)return;O={data:g,part:C.part,ui:Q}}else{if(O=V.getDataInfoAt(M),!O)return;O&&(O={data:O.data,part:O.part})}if(!C){g=O.data;var Q=V.getData3dUI(g);if(O.ui=Q,s=Q.interactiveInfo,!s)return O;if(C=V.intersectObject(M,g),!C)return}g.s(I)&&g.s(I)(M,g,V),this.fire("data",I,M,g);var o,T=C.part;return"body"!==T&&(o=g.s(T+".image")||g.s("shape3d."+T+".image")),o||(o=g.s("all.image")||g.s("shape3d.image")),s="object"==typeof o?s[o.uuid]:s[o],s&&s.bodyInfo?(O.part="body",O.interactiveInfo=s,O.point=C.uv.multiply({x:s.bodyInfo.rect.width,y:s.bodyInfo.rect.height}),O.image=o,O.hits=this.handleImage("body",o,I,M,g,O.point,s.bodyInfo),O):O},_handleLeaveOrMissing:function(v,A,j){var h="leave"===v?this.currentInfo:this.downInfo;if(h){var z=h.interactiveInfo||h.ui.interactiveInfo;if(z){var t,i,B=h.data;if(this._is2d){if(i=this.gv.lp(A),"body"===h.part&&z.bodyInfo)t="body","leave"===v?this.handleLeaveImage(j,t,this.gv.getImage(B),A,B,i,z.bodyInfo):this.handleMissingUpImage(t,this.gv.getImage(B),A,B,i,z.bodyInfo);else if("icons"===h.part&&z._38o){var D=z._38o[h.name];D&&D[h.index]&&(t="icons|"+h.name+"|"+h.index,"leave"===v?this.handleLeaveImage(j,t,h.icon,A,B,i,D[h.index]):this.handleMissingUpImage(t,h.icon,A,B,i,D[h.index]))}}else{if(!z.bodyInfo)return;var X=this.gv.intersectObject(A,B);i=X?X.uv.multiply({x:z.bodyInfo.rect.width,y:z.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===v?this.handleLeaveImage(j,"body",h.image,A,B,i,z.bodyInfo):this.handleMissingUpImage("body",h.image,A,B,i,z.bodyInfo)}}}},handleDownInfo:function(C,J){if(this.downInfo){var Z=this.downInfo,w=this.gv,x=Z.interactiveInfo||Z.ui.interactiveInfo;if(x){var W,R=Z.data;if(R.s(C)&&R.s(C)(J,R,w),this.fire("data",C,J,R),this._is2d){var P=w.lp(J);if("body"===Z.part&&x.bodyInfo)W="body",this.handleDownInfoImage(W,w.getImage(R),C,J,R,P,x.bodyInfo);else if("icons"===Z.part&&x._38o){var z=x._38o[Z.name];z&&z[Z.index]&&(W="icons|"+Z.name+"|"+Z.index,this.handleDownInfoImage(W,Z.icon,C,J,R,P,z[Z.index]))}}else{if(!x.bodyInfo)return;var l=w.intersectObject(J,R);if(!l)return;P=l.uv.multiply({x:x.bodyInfo.rect.width,y:x.bodyInfo.rect.height}),this.handleDownInfoImage("body",Z.image,C,J,R,P,x.bodyInfo)}}}},fire:function(V,g,_,w,G,K,Q,A){this.gv.fi({kind:g,type:V,event:_,data:w,image:G,comp:K,view:this.gv,point:Q,width:A?A.width:n,height:A?A.height:n})},handleImage:function(w,N,_,b,z,q,$){var t={};if(N&&(N=wc(N))){var k=this.gv,K=$.rect,W=this.convertPoint(q,$);W.inRect&&(N[_]&&N[_](b,z,k,W,K.width,K.height),this.fire("image",_,b,z,N,n,W,K),t[w+"|image"]={target:N,type:"image",image:N,data:z,event:b,point:W,width:K.width,height:K.height});for(var X=$.compInfos,A=N,s=X.length-1;s>=0;s--){var j=X[s],h=j.comp;W=this.convertPoint(q,j,A,h,k,z),W.inRect&&(K=j.rect,h[_]&&h[_](b,z,k,W,K.width,K.height),this.fire("comp",_,b,z,N,h,W,K),(N=K.image)&&(N[_]&&N[_](b,z,k,W,K.width,K.height),this.fire("image",_,b,z,N,n,W,K)),t[w+"|"+s]={target:h,type:"comp",comp:h,image:N,data:z,event:b,point:W,width:K.width,height:K.height},N&&(t[w+"|"+s+"|image"]={target:N,type:"image",image:N,data:z,event:b,point:W,width:K.width,height:K.height}))}}return t},handleLeave:function(f,m){return this._handleLeaveOrMissing("leave",f,m)},handleMissingUp:function(L){return this._handleLeaveOrMissing("missing",L)},handleLeaveImage:function(p,z,w,s,q,y,o){if(w&&(w=wc(w))){var v=this.gv,I=o.rect,c=this.convertPoint(y,o);p===z+"|image"&&(w.onLeave&&w.onLeave(s,q,v,c,I.width,I.height),this.fire("image","onLeave",s,q,w,n,c,I));for(var r=o.compInfos,G=w,N=r.length-1;N>=0;N--){var i=r[N],j=i.comp;c=this.convertPoint(y,i,G,j,v,q),I=i.rect,p===z+"|"+N&&(j.onLeave&&j.onLeave(s,q,v,c,I.width,I.height),this.fire("comp","onLeave",s,q,w,j,c,I)),(w=I.image)&&p===z+"|"+N+"|image"&&(w.onLeave&&w.onLeave(s,q,v,c,I.width,I.height),this.fire("image","onLeave",s,q,w,n,c,I))}}},handleMissingUpImage:function(M,k,i,D,S,P){var A="onUp",G=this.downInfo.hits;if(G&&k&&(k=wc(k))){var J=this.gv,B=P.rect,I=this.convertPoint(S,P);!I.inRect&&G[M+"|image"]&&(k[A]&&k[A](i,D,J,I,B.width,B.height),this.fire("image",A,i,D,k,n,I,B));for(var r=P.compInfos,q=k,h=r.length-1;h>=0;h--){var o=r[h],U=o.comp;I=this.convertPoint(S,o,q,U,J,D),I.inRect||(B=o.rect,G[M+"|"+h]&&(U[A]&&U[A](i,D,J,I,B.width,B.height),this.fire("comp",A,i,D,k,U,I,B)),(k=B.image)&&G[M+"|"+h+"|image"]&&(k[A]&&k[A](i,D,J,I,B.width,B.height),this.fire("image",A,i,D,k,n,I,B)))}}},handleDownInfoImage:function(G,s,B,X,c,M,g){var k=this.downInfo.hits;
if(k&&s&&(s=wc(s))){var E=this.gv,j=g.rect,z=this.convertPoint(M,g);k[G+"|image"]&&(s[B]&&s[B](X,c,E,z,j.width,j.height),this.fire("image",B,X,c,s,n,z,j));for(var v=g.compInfos,D=s,y=v.length-1;y>=0;y--){var R=v[y],b=R.comp;z=this.convertPoint(M,R,D,b,E,c),j=R.rect,k[G+"|"+y]&&(b[B]&&b[B](X,c,E,z,j.width,j.height),this.fire("comp",B,X,c,s,b,z,j)),(s=j.image)&&k[G+"|"+y+"|image"]&&(s[B]&&s[B](X,c,E,z,j.width,j.height),this.fire("image",B,X,c,s,n,z,j))}}},initImageResource:function(){$.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(u,Q,Y,h,R,A){var q=Q.rect,g=Q.matrix.applyInverse(u).sub(q),J=g.x>=0&&g.y>=0&&g.x<=q.width&&g.y<=q.height;if(!J)return g;if(h&&aq(h.pixelPerfect,A,R)){var q,D=1;this._is2d?(D=R.getZoom(),q=ti(u.x,u.y,n,D)):q=ti(u.x,u.y);var d=!1,r=q.x,c=q.y,F=q.width,f=q.height,V=$.hitMaxArea,l=F*f*D*D;if(l>V){var Z=Math.sqrt(V/l);D*=Z}F*=D,f*=D,2>F&&(F=2),2>f&&(f=2),r*=D,c*=D;var K=yl(F,f),H=new Xb(0,-r,-c,D,D);H.append(Q.matrix),R._drawForChecking=!0,h.transform=H;var t=Y.comps;Y.comps=[h],uq(K,Y,0,0,F,f,A,self),Y.comps=t,delete h.transform,R._drawForChecking=!1;try{for(var y=0,s=K.getImageData(0,0,F,f).data;y<s.length;y+=4)if(0!==s[y+3]){d=!0;break}K.restore()}catch(e){_n=E,d=!1}g.inRect=d}else g.inRect=!0;return g}});var Tr=Uc.DefaultInteractor=function(G){bs(Tr,this,[G])};Ro("DefaultInteractor",Dp,{handle_mousedown:function(G){ki(G);var B=this,k=B.gv,m=k.getDataAt(G);!k.setFocus(G)||k._editing||k._scrolling||(nd(G)?k.handleDoubleClick(G,m):k.handleClick(G,m),!dg()&&m&&(k.isMovable(m)||k.isInteractive(m))||!k.isPannable()||!rq(G)||In(G)||(B._tx=k.tx(),B._ty=k.ty(),B.startDragging(G)))},handleWindowMouseUp:function(V){var S=this,n=S.gv;n._panning&&(delete n._panning,n.onPanEnded(),S.fi({kind:"endPan",event:V})),delete S._tx,delete S._ty,S.clearDragging()},handle_mousemove:function(e){var _=this,u=_.gv;_._hoverTimer&&(P(_._hoverTimer),delete _._hoverTimer),_._hoverTimer=x(function(){_.fi({kind:"hover",event:e}),P(_._hoverTimer),delete _._hoverTimer},u.getHoverDelay()||$.hoverDelay)},handle_touchmove:function(C){this.handle_mousemove(C)},handleWindowMouseMove:function(v){var U=this,C=U.gv,z=U._lastClientPoint;U.fi({kind:C._panning?"betweenPan":"beginPan",event:v}),C._panning=1,C.setTranslate(U._tx+v.clientX-z.x,U._ty+v.clientY-z.y)},handle_mousewheel:function(H){this.gv.handleScroll(H,H.wheelDelta)},handle_DOMMouseScroll:function(C){2===C.axis&&this.gv.handleScroll(C,-C.detail)},handle_keydown:function(z){this.gv.handleKeyDown(z)}});var Bn=Uc.SelectInteractor=function(S){bs(Bn,this,[S])};Ro("SelectInteractor",Dp,{_42:function(){var _=this,f=_.gv,B=f.getZoom(),Q=_.mark,I=_.div;I||(I=_.div=Rd(),Hi(_.getView(),I));var A={};A.x=Q.x*B+f.tx(),A.y=Q.y*B+f.ty(),A.width=Q.width*B,A.height=Q.height*B,ib(I,A),this.intersects()?(I.style.border="",I.style.background=f.getRectSelectBackground()):(I.style.background="",I.style.border="1px solid "+f.getRectSelectBorderColor())},handle_mousedown:function(m){var p=this,M=p.gv;if(p._57I=E,p.pendingClickThrough=E,!(M._editing||M._scrolling||dg())){var z=M.getDataAt(m),D=M.sm();z?In(m)?D.co(z)?D.rs(z):D.as(z):D.co(z)?z instanceof Go&&z.isClickThroughEnabled()&&rq(m)&&(p.pendingClickThrough=Rb(m)):D.ss(z):In(m)||!M.isPannable()?rq(m)&&(In(m)||D.cs(),M.isRectSelectable()&&(p.startDragging(m),M._77O=1)):rq(m)&&(p._57I=Rb(m))}},handle_mouseup:function(T){var N=this,G=N.gv,B=N._57I;if(B&&(gn(B,Rb(T))<=1&&G.sm().cs(),N._57I=E),N.pendingClickThrough){if(gn(N.pendingClickThrough,Rb(T))<=1){var o=G.getDataAt(T);if(o instanceof Go&&o.isClickThroughEnabled()){var F=G.getDataAt(T,function($){var h=$.getParent()===o&&G.isSelectable($,!0);return h});F&&(T.clickThrough=!0,G.sm().ss(F))}}N.pendingClickThrough=E}},handleWindowMouseUp:function(J){this.clear(J)},handleWindowMouseMove:function(G){var B=this,O=B.gv;B._logicalPoint=O.lp(G),B.mark?(B.fi({kind:"betweenRectSelect",event:G}),O.isPannable()&&B.autoScroll(G),B.redraw()):B.fi({kind:"beginRectSelect",event:G}),B.mark=Vn(B._lastLogicalPoint,B._logicalPoint),B.redraw()},intersects:function(){var j=this,l=j._lastLogicalPoint,U=j._logicalPoint;return l.x>U.x||l.y>U.y},clear:function(G){var I=this,A=I.gv,j=I.mark;if(I._57I=E,I.pendingClickThrough=E,I._lastLogicalPoint){if(j){if(0!==j.width&&0!==j.height){var U=A.getDatasInRect(j,I.intersects());if(!U.isEmpty()){var k=A.sm(),L=k.toSelection();U.each(function(W){k.co(W)?L.remove(W):L.add(W)}),k.ss(L)}}ii(I.div),delete I.div,delete I.mark,I.redraw(),I.fi({kind:"endRectSelect",event:G}),A.onRectSelectEnded()}I.clearDragging(),delete A._77O}},redraw:function(){var Q=this;Q._draw||(Q._draw=1,x(function(){Q.mark&&Q._42(),delete Q._draw},16))}});var $f=Uc.MoveInteractor=function(f){bs($f,this,[f])};Ro("MoveInteractor",Dp,{handle_mousedown:function(V){var S=this,L=S.gv;if(rq(V)&&!L._editing&&!L._scrolling&&!dg()){var f=L.getSelectedDataAt(V);!f||L.isInteractive(f)&&!L.isMovable(f)?L._focusData=E:(S._data=f,L.handleMouseDown&&L.handleMouseDown(V,f),S.startDragging(V),L.isMovable(f)&&(L._moving=1))}},handleWindowMouseUp:function(i){var U=this,s=U.gv;s.handleMouseUp&&s.handleMouseUp(i,U._data),U.clear(i)},handleWindowMouseMove:function(x){var g=this,r=g._data,C=g.gv;if((!C._93O||!C._93O(x,r))&&C._moving){g._logicalPoint||g.fi({kind:"prepareMove",event:x});var y=g._logicalPoint?"betweenMove":"beginMove",Z={kind:y,event:x},N=g._logicalPoint=C.lp(x);"beginMove"!==y||g._alreadyBeginTransaction||(g._alreadyBeginTransaction=!0,C.getDataModel().beginTransaction());var e=g._calcShift(y,x),U=e.x,l=e.y,m=g.gv.getMoveMode(x,r);m&&("x"===m?l=0:"y"===m?U=0:"xy"!==m&&(U=l=0)),C.moveSelection(U,l),g._lastLogicalPoint=N,g.autoScroll(x),g.fi(Z)}},_calcShift:function(){var C=this,B=C._logicalPoint,O=C._lastLogicalPoint,d=B.x-O.x,L=B.y-O.y;return{x:d,y:L}},clear:function(Z){var Y=this,C=Y.gv;Y._lastLogicalPoint&&(Y._lastLogicalPoint=Y._data=C._moving=E,Y._logicalPoint&&(Y.fi({kind:"endMove",event:Z}),C.onMoveEnded()),Y.clearDragging()),Y._alreadyBeginTransaction&&(Y._alreadyBeginTransaction=!1,C.getDataModel().endTransaction())}});var Af=Uc.ScrollBarInteractor=function(H){bs(Af,this,[H])};Ro("ScrollBarInteractor",Dp,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(N){var e=this.gv.getViewRect();return this._41o()&&(e.x+e.width-this.gv.lp(N).x)*this.gv.getZoom()<kp},isH:function(N){var j=this.gv.getViewRect();return this._40o()&&(j.y+j.height-this.gv.lp(N).y)*this.gv.getZoom()<kp},handle_mousemove:function(g){this.handle_touchmove(g)},handle_touchmove:function(n){if(!df&&rq(n)&&this.gv.isScrollBarVisible()){var N=this,C=N.isV(n),W=N.isH(n);(C||W)&&N.gv.showScrollBar(),N.gv._scrolling=C||W}},handleWindowMouseUp:function(T){this.handleWindowTouchEnd(T)},handleWindowTouchEnd:function(d){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=E,this.fi({kind:"endScroll",event:d})},handle_mousedown:function(Z){this.handle_touchstart(Z)},handle_touchstart:function(g){var E=this;if(E.gv.setFocus(g),ki(g),E.handle_touchmove(g),!(Bf(g)>1)&&E.gv._scrolling&&E.gv.isScrollBarVisible()){E._cp=Rb(g),E._tx=E.gv.tx(),E._ty=E.gv.ty();var Y=E.isV(g);E._state=Y?"vScroll":"hScroll",to(E,g),E.fi({kind:"beginScroll",event:g})}},handleWindowMouseMove:function(E){this.handleWindowTouchMove(E)},handleWindowTouchMove:function(A){var $=Rb(A),h=this.gv.getViewRect(),a=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-$.y)*a.height/h.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-$.x)*a.width/h.width),this.fi({kind:"betweenScroll",event:A})}});var Uj=Uc.TouchInteractor=function(Z,k){k=k||{},k.selectable===n&&(k.selectable=!0),k.movable===n&&(k.movable=!0),k.pannable===n&&(k.pannable=!0),k.pinchable===n&&(k.pinchable=!0),k.editable===n&&(k.editable=!0),this.params=k,bs(Uj,this,[Z])};Ro("TouchInteractor",Dp,{ms_edit:1,setUp:function(){var E=this;Uj.superClass.setUp.call(E),im&&E.params.editable&&E.gv.setEditInteractor(E)},tearDown:function(){var q=this;Uj.superClass.tearDown.call(q),im&&q.params.editable&&q.gv.setEditInteractor(E)},clear:function(T){var j=this,w=j.gv;w._moving&&(j.fi({kind:"endMove",event:T}),delete w._moving,w.onMoveEnded(),w.dm().endTransaction()),w._panning&&(j.fi({kind:"endPan",event:T}),delete w._panning,w.onPanEnded()),w._pinching&&(j.fi({kind:"endPinch",event:T}),delete w._pinching,w.onPinchEnded()),w._editing&&(j._46O(T),j._77I=j._node=j._edge=j._shape=j._rect=j._89I=j._index=w._editing=E),j._moving=j._panning=j._pinching=j._editing=j._57I=j._data=j._beginHistory=E,j.clearDragging()},handle_touchstart:function(g){var U=this;if(!U.gv._editing){ki(g),U._57I=E;var f=U.params,L=U.gv,K=L.sm(),V=L.getDataAt(g),s=Bf(g);if(1===s){if(nd(g))return L.handleDoubleClick(g,V),void 0;L.handleClick(g,V),V&&(L.handleMouseDown&&L.handleMouseDown(g,V),U._data=V),f.selectable||(V=E),V?(K.co(V)||K.ss(V),f.editable&&L.isEditable(V)&&U._79I(g,V,!0)?(U._editing=1,U.startDragging(g)):f.movable&&L.isMovable(V)&&(U._moving=1,U.startDragging(g))):(U._57I=Rb(g),f.pannable&&L.isPannable()&&(U._panning=1,U.startDragging(g),U._translate={x:L.tx(),y:L.ty()}))}else if(f.pinchable&&2===s){U._pinching=1,U.startDragging(g);var o=L.getView(),p=L.getZoom(),q=o.getBoundingClientRect(),S=g.touches[0],y=g.touches[1],u={x:(S.clientX+y.clientX)/2-q.left,y:(S.clientY+y.clientY)/2-q.top};u.x-=L.tx(),u.y-=L.ty(),u.x/=p,u.y/=p,U._p=u,U._d=jr(g)}}},handle_touchend:function(C){var Q=this,P=Q.gv,g=Q._57I,L=Q._data;g&&(gn(g,Rb(C))<=1&&P.sm().cs(),Q._57I=E),L&&P.handleMouseUp&&P.handleMouseUp(C,L)},handleWindowTouchEnd:function(S){this.clear(S)},handleWindowTouchMove:function(F){var D=this,O=D.gv,q=Bf(F);if(1===q){if(D._editing&&(D._beginHistory||(D._beginHistory=1,O.dm().beginTransaction()),O._editing=1,D._78I(F)),D._moving)D._beginHistory||(D._beginHistory=1,O.dm().beginTransaction()),D.handleMove(F);else if(D._panning){var M=Rb(F);O.setTranslate(D._translate.x+M.x-D._lastClientPoint.x,D._translate.y+M.y-D._lastClientPoint.y),D.fi({kind:O._panning?"betweenPan":"beginPan",event:F}),O._panning=1}}else if(2===q&&D._pinching){var e=jr(F);O.handlePinch(D._p,e,D._d),D._d=e,D.fi({kind:O._pinching?"betweenPinch":"beginPinch",event:F}),O._pinching=1}},handleMove:function(g){var w=this,v=w.gv,o=v.lp(g);v._93O&&v._93O(g,w._data)||(v.moveSelection(o.x-w._lastLogicalPoint.x,o.y-w._lastLogicalPoint.y),w._lastLogicalPoint=o,w.autoScroll(g),w.fi({kind:v._moving?"betweenMove":"beginMove",event:g}),v._moving=1)}});var B=S.ht,pn=B.graph._editor={Math:B.Math,Guide:{}};pn.getStyle=function(N){var E,r=pn.StyleMap;return r&&(E=r[N],E!==n)?E:pn.DefaultStyleMap[N]},pn.setStyle=function(A,d){var I=pn.StyleMap;I||(I=pn.StyleMap={}),I[A]=d},pn.inEdit=function(L){return L._inXEdit===!0},pn.startEdit=function(D){D._inXEdit=!0,pn.Inject.doInject(D)},pn._46O=function(M){M._inXEdit=!1,pn.Inject.undoInject(M)},pn.toScreenPosition=function(e,S){var E=e.tx(),Y=e.ty(),u=e._zoom;return new pn.Math.Vector2(S.x*u+E,S.y*u+Y)},pn.checkHit=function(c,d,T){return c.distanceTo(d)<T?!0:!1},pn.toWorldPosition=function(O,S){var v=O.tx(),s=O.ty(),g=O._zoom;return{x:(S.x-v)/g,y:(S.y-s)/g}},pn.setAntialias=function(m,J){for(var R,W=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],t=0,p=W.length;p>t&&(R=W[t],!(R in m));t++);m[R],m[R]=J},pn.getTargetCornersOnScreen=function(F,d){if(!d)return null;var P,C=[];if(Bh(d,F)){var A=Or(F,d);P=[{x:A.x,y:A.y},{x:A.x+A.width,y:A.y},{x:A.x+A.width,y:A.y+A.height},{x:A.x,y:A.y+A.height}]}else{if(!d.getCorners)return null;P=d.getCorners()}return P.forEach(function(E){var Z=pn.toScreenPosition(F,E);C.push(Z.x,Z.y)}),C},pn.log=function(){};var Nl=pn.Inject={_modules:[]};Nl.registAsModule=function(Q,T){var y={},P={};for(var H in Q){var U=T.prototype[H];y[H]=U}Q.getBackup=function(b){return y[b]},Q.getBackups=function(){return y},P.doInject=function(){for(var B in Q)"getBackup"!==B&&(T.prototype[B]=Q[B])},P.undoInject=function(){for(var H in Q)"getBackup"!==H&&(T.prototype[H]=y[H])},Nl._modules.push(P)},Nl.doInject=function(Y){for(var j,h=Nl._modules,k=0,L=h.length;L>k;k++)j=h[k],j.doInject(Y)},Nl.undoInject=function(f){for(var M,Z=Nl._modules,b=0,e=Z.length;e>b;b++)M=Z[b],M.undoInject(f)};var Dp=B.graph.EditInteractor=function(C){var N=this,y=W.createElement("canvas");y.className="editCanvas",y.style.position="absolute",N._styleMap={},N._canvas=y,N._context=y.getContext("2d"),Dp.superClass.constructor.call(N,C),pn.setAntialias(N._context,!1),N._subModules=[new pn.Anchor(N),new pn.RotateX(N),new pn.Rect(N),new pn.Curve(N),new pn.MoveHelper(N)],N._gridGuide=new pn.Guide.Grid(N),N._rectGuide=new pn.Guide.Rect(N)},Tf=Dp;B.Default.def(Dp,B.graph.Interactor,{ms_edit:1,ms_fire:1}),O.defineProperties(Dp.prototype,{editDetail:{get:function(){var z=!!this._editDetail;return z},set:function(n){var z=this,L=z._editDetail;L!==n&&(z._editDetail=n,z.gv._editing=n,z.fp("editDetail",L,n),z.fp("pointsEditingMode",L,n),z.fi({kind:n?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(W){(!this._editDetail||W)&&(this.gv._editing=W,W||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(P){this._editing=P,this.gvEditing=P}},pointsEditingMode:{get:function(){return this.editDetail},set:function(Q){var w=this;w.editDetail!==Q&&(Q?w._tryEnterEditDetailMode():w._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var D=this._gridEnabled;if(!D)return!1;var Y=this.gv;return Y?!0:!0},set:function(r){r!==this._gridEnabled&&(this._gridEnabled=r,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(I){I!==this._agEnabled&&(this._agEnabled=I,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),Dp.prototype.getSubModule=function(H){var z,c,l,i=this._subModules;for(c=0,l=i.length;l>c;c++)if(z=i[c],z.catalog===H)return z},Dp.prototype.invokeSubModule=function(D,P){var g=this,B=g._subModules;if(B)for(var M,K,l,u=Array.prototype.slice.call(arguments,2),q=0,T=B.length;T>q;q++)if(M=B[q],K=M[D],K&&(l=K.apply(M,u),l!=n&&P))return M},Dp.prototype.invokeSubModuleInverse=function(c,S){var e=this,h=e._subModules;if(h)for(var B,G,p,v=Array.prototype.slice.call(arguments,2),N=h.length-1;N>=0;N--)if(B=h[N],G=B[c],G&&(p=G.apply(B,v),p!=n&&S))return B},Dp.prototype.setUp=function(){pn.log("setUp");var b=this,J=b.gv,$=J.getView(),w=b._canvas;Dp.superClass.setUp.call(b),J.setEditInteractor(b),J._79O?$.insertBefore(w,J._79O):$.appendChild(w),pn.startEdit(J),b.invokeSubModule("setUp"),J.dm().mm(b._onDataModelChanged,b),J.dm().md(b._onDataPropertyChanged,b)},Dp.prototype.tearDown=function(){pn.log("tearDown");var F=this,H=F.gv,V=H.getView();F._resetCustomCursorStyle(),Dp.superClass.tearDown.call(F),H.dm().umm(F._onDataModelChanged,F),H.dm().umd(F._onDataPropertyChanged,F),H.setEditInteractor(null),V.removeChild(F._canvas),F._drawTimer&&(P(F._drawTimer),F._drawTimer=null),pn._46O(H),F.invokeSubModule("tearDown")},Dp.prototype._onDataModelChanged=function(o){var k=this;("clear"===o.kind||"remove"===o.kind&&k.editDetail&&o.data===k.getSubModule("Curve").target)&&(k.editDetail=!1,k._42())},Dp.prototype._onDataPropertyChanged=function(I){var Y=this;if(Y.editDetail){var E=Y.getSubModule("Curve"),o=I.data;o===E.target&&(o._writing||E._handleDataChanged())}},Dp.prototype.clear=function(){pn.log("clear")},Dp.prototype.redraw=function(){this._42()},Dp.prototype._42=function(){var T=this;T._drawTimer||(T._drawTimer=x(function(){T._drawTimer=null,T.drawImpl()},0))},Dp.prototype.drawImpl=function(){var z;for(z in{_42:!0})break;return function(){var $=this,y=$._canvas,o=$.gv,U=o.getWidth(),r=o.getHeight(),S=$._context,w=B.Default.getInternal();(y.width!==U||y.height!==r)&&w.setCanvas(y,U,r),S.clearRect(0,0,y.width,y.height);var N=$._getValidSelection();S.save();var R=B.Default.devicePixelRatio;S.scale(R,R),$._gridGuide._42(),$.invokeSubModuleInverse(z,!1,S,o,N),$._rectGuide._42(),S.restore()}}(),Dp.prototype._getValidSelection=function(){var I=this,s=I.gv,h=s.sm().getSelection(),a=[];return h.each(function(P){s.isVisible(P)&&s.isEditable(P)&&a.push(P)}),a},Dp.prototype.handle_touchmove=function(g){return this.handle_mousemove(g)},Dp.prototype.handle_mousemove=function(U){if(!B.Default.isDragging()){var I=this;(I.editDetail||!dg())&&(I.gvEditing=!1,I._checkEdit(U)&&(I.gvEditing=!0))}},Dp.prototype.handle_touchstart=function(D){return this.handle_mousedown(D)},Dp.prototype.handle_mousedown=function(F){ki(F);var J=this;if(J.editDetail||!dg()){if(nd(F)&&!F.clickThrough){if(J.editDetail){if(J._tryQuitEditDetailMode(F))return}else if(J._tryEnterEditDetailMode())return;J.gv.dm().beginTransaction();var s=J.invokeSubModule("handleDoubleClick",!0,F);if(J.gv.dm().endTransaction(),s)return}var z=J._checkEdit(F);z&&(J._downPosition=J._getLogicalPoint(F),J.gv.dm().beginTransaction(),z.startEdit(J,F),J.editing=!0)}},Dp.prototype._checkEdit=function(Q){var W=this,e=W.gv,w=W._getLogicalPoint(Q),i=W.invokeSubModule("check",!0,e,Q,w)||null;return W._editMod=i,i},Dp.prototype.handleWindowTouchMove=function(k){return this.handleWindowMouseMove(k)},Dp.prototype.handleWindowMouseMove=function(D){var u=this,c=u._downPosition;if(c){var I=u._getLogicalPoint(D);if(I.distanceTo(c)<u.getStyle("moveSensitivity"))return;delete u._downPosition}var K=u._editMod;K&&K.handleEdit(u.gv,D)},Dp.prototype._getLogicalPoint=function(F){var d=this,Y=B.Default.getLogicalPoint(F,d._canvas);return new pn.Math.Vector2(Y)},Dp.prototype.handleWindowTouchEnd=function(u){return this.handleWindowMouseUp(u)},Dp.prototype.handleWindowMouseUp=function(){var $;for($ in{_46O:!0})break;return function(y){var k=this;k.editing=!1,k.setCursor("default"),k.invokeSubModule($,!1,y),k._42(),k.gv.dm().endTransaction()}}(),Dp.prototype.handle_mousewheel=function(k){var r=this;ki(k),r.invokeSubModule("preHandleScroll",!0)||r.gv.handleScroll(k,k.wheelDelta)},Dp.prototype.handleDelete=function(){var F=this;if(!F.editDetail){F.gv.dm().beginTransaction();var Q=F.invokeSubModule("handleNormalStateDelete",!0);return F.gv.dm().endTransaction(),Q||F.gv.removeSelection(),void 0}F.gv.dm().beginTransaction(),F.invokeSubModule("handleDelete",!0),F.gv.dm().endTransaction(),F._42()},Dp.prototype.handle_keydown=function(F){var D=this;if((F.metaKey||F.ctrlKey)&&D._42(),dg(F)&&!D.editing)return D.gvEditing=!1,D.setCursor("default"),D._42(),void 0;var N=Qd(F);return D.editDetail?((N||$j(F))&&(D.editDetail=!1,D._42()),D.gv.dm().beginTransaction(),D.invokeSubModule("handle_keydown",!0,F),D.gv.dm().endTransaction(),void 0):(D.gv.dm().beginTransaction(),D.invokeSubModule("handleNormalStateKeyDown",!0,F),D.gv.dm().endTransaction(),N&&D._tryEnterEditDetailMode(),void 0)},Dp.prototype.handle_keyup=function(x){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,x),this.gv.dm().endTransaction()},Dp.prototype._tryEnterEditDetailMode=function(){var S=this;return!S.editDetail&&S.invokeSubModule("canEnterEditDetailMode",!0)&&1===S._getValidSelection().length?(S.editDetail=!0,S._42(),!0):void 0},Dp.prototype._tryQuitEditDetailMode=function(o){var d=this;return d.editDetail?!o||d.invokeSubModule("canQuitEditDetailMode",!0,o)?(d.editDetail=!1,d._42(),!0):!1:!1},Dp.prototype.setStyle=function(J,I,m){var L=this;m?pn.setStyle(J,I):L._styleMap[J]=I,L.fp("styleChanged",null,{key:J,value:I,base:m}),L._42()},Dp.prototype.getStyle=function(t){var z=this,$=z._styleMap[t];return $!==n?$:pn.getStyle(t)},Dp.prototype.setCursor=function(Z){this._resetCustomCursorStyle(),B.graph.EditInteractor.superClass.setCursor.call(this,Z)},Dp.prototype._resetCustomCursorStyle=function(){var T=this;if(T._customStyle){var e=this.gv.getView();e.classList&&e.classList.remove&&e.classList.remove(T._customStyle),T._customStyle=null}},Dp.prototype._setRotateCursor=function(e){var W=this,u=W._cursorFactory;u||(u=W._cursorFactory=new pn.CursorFactory(W));var w=u.getRotateCursor(e),V=W.gv.getView();W._resetCustomCursorStyle(),W._customStyle=w,V.classList&&V.classList.add&&V.classList.add(w)};var cf=pn.Group=function(H){var s=this;s._entities=H,s._64O=0,s._position={x:0,y:0},s._scale={x:1,y:1},s._anchor={x:.5,y:.5},s._anchor2={x:.5,y:.5}};cf.prototype={},cf.prototype.constructor=cf;var Mo=null;cf.findOrCreateGroup=function(j){if(Mo&&Mo.checkIsMe(j))return Mo;var M=new pn.Group(j);return M.getKeyOb()?(Mo=M,M):void 0},cf.prototype.checkIsMe=function(X){var p=this._entities;if(p.length!==X.length)return!1;var Z,e={},G=X.length;for(Z=0;G>Z;Z++)e[X[Z]._id]=!0;for(Z=0;G>Z;Z++)if(!e[p[Z]._id])return!1;return!0},cf.prototype.getRotation=function(){return this._64O},cf.prototype.getPosition=function(){return this._position},cf.prototype.getAnchor=function(){return this._anchor},cf.prototype.getWidth=function(){return this._width},cf.prototype.getScale=function(){return this._scale},cf.prototype.getSize=function(){return{width:this._width,height:this._height}},cf.prototype.getHeight=function(){return this._height},cf.prototype.getKeyOb=function(){for(var t=this._entities,x=t.length-1;x>=0;x--){var I=t[x];if(this.isNode(I))return I}},cf.prototype.getAnchor2=function(){var p=this,P=p.rotateCenter;if(P)return P;var X=p.getKeyOb();if(!X)return p._anchor;var b=p._anchor2,k=X.getMatrix();return k.tf({x:X.getWidth()*(b.x-X.getAnchor().x),y:X.getHeight()*(b.y-X.getAnchor().y)})},cf.prototype.setAnchor2=function(q,G){var v=this,b=v.getKeyOb();if(b){var f,r=b.getMatrix();f="number"==typeof q?{x:q,y:G}:q;var $=r.tfi(f);v._anchor2={x:b.getAnchor().x+$.x/b.getWidth(),y:b.getAnchor().y+$.y/b.getHeight()}}},cf.prototype.setRotation=function(){},cf.prototype.beginRotate=function(Q){this.rotateCenter=Q.pos,this.rotateMode=Q.groupRotateMode},cf.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},cf.prototype.addRotation=function(q,F){return"batch"===F?this._addRotationInBatchMode(q):"block"===F?this._addRotationInBlockMode(q):void 0},cf.prototype._addRotationInBlockMode=function(t){var C=this,R=C.rotateCenter||C.getPosition();C._entities.forEach(function(L){if(C.isNode(L)){var A=L.getMatrix();A.translate(-R.x,-R.y),A.rotate(t),A.translate(R.x,R.y);var I=Math.sign(L.getScale().x);L.setRotation(U(A.b*I,A.a*I)),L.setPosition(A.tx,A.ty)}})},cf.prototype._addRotationInBatchMode=function(d){var B=this,Q=B._anchor2;B._entities.forEach(function(O){if(B.isNode(O)){var q=O.getAnchor(),K=O.getMatrix(),z=K.tf({x:O.getWidth()*(Q.x-q.x),y:O.getHeight()*(Q.y-q.y)}),V=new pn.Math.Matrix2d;V.set(K.a,K.b,K.c,K.d,K.tx,K.ty),V.translate(-z.x,-z.y),V.rotate(d),V.translate(z.x,z.y);var s=Math.sign(O.getScale().x);O.setRotation(U(V.b*s,V.a*s)),O.setPosition(V.tx,V.ty)}})},cf.prototype.setPosition=function(K){var j,Y,y,M,s=this,w=s._position,X=K.x-w.x,m=K.y-w.y,$=s._entities;for(Y=0,y=$.length;y>Y;Y++)j=$[Y],fk(j)&&(M=j.getPosition(),j.setPosition(M.x+X,M.y+m));s._position=K},cf.prototype.setScale=function(X,d){var B=this,m=X/B._scale.x,q=d/B._scale.y;B._adjustChildScaleOrSize(m,q,"size"),B._scale={x:X,y:d}},cf.prototype.getRect=function(){var l=this,c=l._position,i=l._width,_=l._height;return{x:c.x-i/2,y:c.y-_/2,width:i,height:_}},cf.prototype.setSize=function(T,o){var k=this,T=Math.max(1,T),o=Math.max(1,o),V=T/k._width,J=o/k._height;k._adjustChildScaleOrSize(V,J,"size"),k._width=T,k._height=o},cf.prototype._adjustChildScaleOrSize=function(G,V,I){var H,t,i,n,e,g,s,o,C,w,N,T,W,L,r=this,O=r._position,Q=r._entities,d=new pn.Math.Matrix2d;for(t=0,i=Q.length;i>t;t++)if(H=Q[t],r.isNode(H)){if(n=H.getPosition(),e=H.getRotation(),g=H.getWidth(),s=H.getHeight(),o=H.getScale(),N=o.x*g,T=o.y*s,d.identity().scale(N,T).rotate(e).translate(n.x,n.y).translate(-O.x,-O.y).rotate(-r._64O),e=U(d.b*Math.sign(N),d.a*Math.sign(N)),d.scale(G,V),C=Math.cos(e),w=Math.sin(e),Math.abs(C)<.001?(W=d.b/w,L=-d.c/w):(W=d.a/C,L=d.d/C),"scale"===I)H.setScale(W/g,L/s);else if("size"===I){var E=W/o.x,x=L/o.y;H.setScale(or(W)*Math.abs(o.x),or(L)*Math.abs(o.y)),H.setSize(Math.max(.1,Math.abs(E)),Math.max(.1,Math.abs(x)))}d.rotate(r._64O).translate(O.x,O.y),H.setPosition(d.tx,d.ty)}},cf.prototype.getMatrix=function(){var u=this,y=u._position,H=B.Default.getInternal(),c=u._scale;return new H.Mat(u._64O,y.x,y.y,c.x,c.y)},cf.prototype.toGlobal=function($){return this.getMatrix().tf($)},cf.prototype.getCorners=function(){var c=this,S=c._width,k=c._height,g=c._anchor,P=-S*g.x,l=-k*g.y,y=c.getMatrix();return[y.tf(P,l),y.tf(P,l+k),y.tf(P+S,l+k),y.tf(P+S,l)]},cf.prototype.calcInfo=function(){var C,n,l,H,g,t,v=this,f=[],i=v._entities,m=v._64O;for(H=0,g=i.length;g>H;H++)t=i[H],v.isNode(t)&&t.getCorners&&f.push.apply(f,t.getCorners());if(f.length){var c=Math.cos(-m),o=Math.sin(-m),z=1/0,U=-1/0,S=1/0,L=-1/0;for(H=0,g=f.length;g>H;H++)l=f[H],C=l.x,n=l.y,l.x=c*C-o*n,l.y=o*C+c*n,z=Math.min(z,l.x),U=Math.max(U,l.x),S=Math.min(S,l.y),L=Math.max(L,l.y);v._width=(U-z)/v._scale.x,v._height=(L-S)/v._scale.y,c=Math.cos(m),o=Math.sin(m);var T=v._anchor;C=z+(U-z)*T.x,n=S+(L-S)*T.y,v._position={x:c*C-o*n,y:o*C+c*n}}},cf.prototype.isNode=function(v){return fk(v)?Bh(v)?!1:!0:!1},cf.prototype._42=function(v,q,V){var o,J,U,G,l,d,g,R,L=this,C=L._entities,e=L.rotateMode;for("batch"===e&&(R=L.getKeyOb()),o=0,J=C.length;J>o;o++)U=C[o],L.isNode(U)&&(d=U.getRect(),G=pn.toScreenPosition(V,{x:d.x,y:d.y}),l=pn.toScreenPosition(V,{x:d.x+d.width,y:d.y+d.height}),g={min:G,max:l},U===R&&(g.isKeyOb=!0),pn.Icons.DrawIcon(v,q,pn.Icons.GroupSubEntityRect,g))};var gd=pn.CurveActiving=function(P,v){this._curve=P,this._interactor=P._interactor;for(var e in v)this[e]=v[e]};gd.prototype={},gd.prototype.constructor=gd,O.defineProperties(gd.prototype,{point:{get:function(){return this._point},set:function(T){var k=this;k._point=T,k.editingCtrl||k._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(k){var w=this;w._pairs=k,w.editingCtrl&&w._firePointChange()}}}),gd.prototype._firePointChange=function(){var c=this,s=c.getCurrentEditingPoint();if(!s)return r.fi({kind:"selectPoint"}),void 0;var r=c._interactor,e=this._curve.target;if(e){var P=pn.getDataMatrix(e).invert(),D=s.e;s=P.apply(pn.toWorldPosition(r.gv,s)),s.e=D;var Z=c._lastFirePoint;Z&&Math.abs(s.x-Z.x)<1e-5&&Math.abs(s.y-Z.y)<1e-5&&(s.e==n&&Z.e==n||Math.abs(s.e-Z.e)<1e-5)||(c._lastFirePoint=s,r.fi({kind:"selectPoint",x:s.x,y:s.y,e:s.e}))}},gd.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},gd.prototype.getCurrentEditingPoint=function(){var D=this,c=D.editingCtrl;if(c){var o=D.pairs;if(o){var I=o[c.pairId],B=I[c.type];if(B)return B}}return D._point};var lo=pn.CursorFactory=function(r){var F=this;F._interactor=r,F._rotateCursorStyles={}};lo.prototype={},lo.prototype.constructor=lo,lo.prototype.getRotateCursor=function(s){var T=this;0>s&&(s+=2*Math.PI);var K=T._interactor,X=K.getStyle("rotateCursorSize"),F=K.getStyle("rotateCursorRound"),z=Math.round(180*(s/Math.PI)/F);z*F>=360&&(z=0);var j=T._rotateCursorStyles,E="htCustomRotateStyle_"+X+"_"+F+"_"+z;return j[E]||(T._produceRotateCursor(E,X,F,z),j[E]=!0),E},lo.prototype._produceRotateCursor=function(t,O,P,u){var U=this;U._interactor;var S=U._canvas;S||(S=U._canvas=W.createElement("canvas")),S.width=S.height=O*devicePixelRatio,S.style.width=S.style.height=O+" px";var H=S.getContext("2d");pn.setAntialias(H,!1),H.scale(devicePixelRatio,devicePixelRatio);var y,M,d,n,j,J=Math.round(O/2),L=""+J+" "+J+",auto !important;";y=Math.PI/180*u*P,H.clearRect(0,0,O,O),H.save(),H.scale(O/32,O/32),H.translate(16,16),H.rotate(y+Math.PI/2),H.beginPath(),H.moveTo(-8,0),H.lineTo(-8,3),H.lineTo(-5,3),H.moveTo(8,0),H.lineTo(8,3),H.lineTo(5,3),H.moveTo(-8,3),H.quadraticCurveTo(0,-6,8,3),H.restore(),H.strokeStyle="white",H.lineWidth=4,H.stroke(),H.strokeStyle="black",H.lineWidth=2,H.stroke(),M=JSON.stringify(S.toDataURL()),n="cursor:url("+M+")"+L,1!==devicePixelRatio&&(d='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+O+'px" height="'+O+'px"><image xlink:href='+M+' width="'+O+'" height="'+O+'"/></svg>',n+="cursor:url(data:image/svg+xml;base64,"+btoa(d)+")"+L,n+="cursor:-webkit-image-set(url("+M+")"+devicePixelRatio+"x,url("+M+")1x)"+L),j=W.createElement("style"),j.textContent="body."+t+" *, ."+t+"{"+n+"}",W.head.appendChild(j)};var oc=pn.Guide.Grid=function(u){var h=this;h._interactor=u,h._alignmentGuideId=0,h._xAlignmentGuide=[],h._yAlignmentGuide=[]};oc.prototype={},oc.prototype.constructor=oc,O.defineProperties(oc.prototype,{gridBlockSize:{get:function(){var a=this;return a._gridBlockSize||a._interactor.getStyle("gridBlockSize")},set:function(b){this._gridBlockSize=b,this._interactor._42()}},gridThickLinesEvery:{get:function(){var B=this;return B._gridThickLinesEvery||B._interactor.getStyle("gridThickLinesEvery")},set:function(P){this._gridThickLinesEvery=P,this._interactor._42()}},gridEnabled:{get:function(){var M=this,n=M._interactor;return n.gridEnabled&&M.isValidGrid()}}}),oc.prototype._42=function(){var a=this,E=a._interactor;a.gridEnabled&&a.drawGrid(),E.alignmentGuideEnabled&&a.drawAlignmentGuide()},oc.prototype.makeMatrix=function(){var a=this,Q=a._interactor.getStyle("gridAngle"),f=a._interactor.getStyle("gridRotation"),J=new pn.Math.Matrix2d,h=Math.sin(Q),t=Math.cos(Q);return J.set(1,0,t,h,0,0),J.rotate(f),J},oc.prototype.isValidGrid=function(){var R=this,z=Math.PI,k=R._interactor,t=k.gv;if(t._zoom<k.getStyle("gridZoomThreshold"))return!1;var i=k.getStyle("gridAngle"),M=Math.abs(180*(i%z/z)),N=1-1e-8;return N>M||M>180-N?!1:!0},oc.prototype.drawAlignmentGuide=function(){var l=this,D=l._interactor,T=D.gv,d=D._canvas,G=D._context,j=d.width,z=d.height,W=T.tx(),m=T.ty(),K=T._zoom;G.beginPath(),G.strokeStyle=D.getStyle("gridAlignmentGuideColor"),G.lineWidth=1,l._xAlignmentGuide.forEach(function(A){var o=A.p*K+W;G.moveTo(o,0),G.lineTo(o,z)}),l._yAlignmentGuide.forEach(function(f){var N=f.p*K+m;G.moveTo(0,N),G.lineTo(j,N)}),G.stroke()},oc.prototype.drawGrid=function(){function m(y,p,e,w){var q=pn.toScreenPosition(R,I.apply({x:y,y:p})),G=pn.toScreenPosition(R,I.apply({x:e,y:w}));h.moveTo(q.x,q.y),h.lineTo(G.x,G.y)}var q=this,K=q._interactor,L=q.gridBlockSize,g=q.gridThickLinesEvery,d=K.getStyle("gridThickColor"),G=K.getStyle("gridLightColor"),R=K.gv,F=K._canvas,h=K._context,z=F.width,U=F.height,I=q.makeMatrix(),b=I.applyInverse(pn.toWorldPosition(R,{x:0,y:0})),A=I.applyInverse(pn.toWorldPosition(R,{x:z,y:0})),l=I.applyInverse(pn.toWorldPosition(R,{x:0,y:U})),u=I.applyInverse(pn.toWorldPosition(R,{x:z,y:U})),X=Math.min(b.x,A.x,l.x,u.x),_=Math.max(b.x,A.x,l.x,u.x),P=Math.min(b.y,A.y,l.y,u.y),Q=Math.max(b.y,A.y,l.y,u.y);z=_-X,U=Q-P;var p=Math.ceil(X/L),M=Math.floor(_/L),w=Math.ceil(P/L),S=Math.floor(Q/L);R.tx(),R.ty(),R._zoom;var x,k,o;for(h.save(),h.lineWidth=1,h.beginPath(),h.strokeStyle=d,o=Math.ceil(p/g)*g;M>=o;o+=g)x=o*L,m(x,P,x,Q);for(o=Math.ceil(w/g)*g;S>=o;o+=g)k=o*L,m(X,k,_,k);for(h.stroke(),h.beginPath(),h.strokeStyle=G,o=p;M>=o;o++)0!==o%g&&(x=o*L,m(x,P,x,Q));for(o=w;S>=o;o++)0!==o%g&&(k=o*L,m(X,k,_,k));h.stroke(),h.restore()},oc.prototype.getAlignmentGuides=function(){var r=this;return{x:r._xAlignmentGuide,y:r._yAlignmentGuide}},oc.prototype.addAlignmentGuide=function(S,s,X){var T=this,J="x"===S?T._xAlignmentGuide:T._yAlignmentGuide,X=X?X:++T._alignmentGuideId,B={p:s,id:X};if(J.length){var o=T._findClosestAlignmentGuide(B.p,J);o.dis<0?J.splice(o.index+1,0,B):J.splice(o.index,0,B)}else J.push(B);return T._interactor._42(),X},oc.prototype.findClosest=function(q,A,_){var I=this,Z=I._interactor,M=Z.gv;_&&(q=pn.toWorldPosition(M,q));var N,f,b,W=1/0,B=1/0,R=q.x,r=q.y;if(I.gridEnabled){var G=I.gridBlockSize,U=I.makeMatrix(),p=U.applyInverse(q);
p=U.apply({x:Math.round(p.x/G)*G,y:Math.round(p.y/G)*G}),W=p.x-R,B=p.y-r,b=!0}if(Z.alignmentGuideEnabled&&(N=I._findClosestAlignmentGuide(R,I._xAlignmentGuide).dis,f=I._findClosestAlignmentGuide(r,I._yAlignmentGuide).dis,Math.abs(N)<Math.abs(W)&&(W=N,b=!0),Math.abs(f)<Math.abs(B)&&(B=f,b=!0)),b){b=!1;var s=M._zoom,C=Z.getStyle("smartGuideSensitivity")/s,F={};if(Math.abs(W)<C&&"y"!==A&&(F.x=_?W*s:W,b=!0),Math.abs(B)<C&&"x"!==A&&(F.y=_?B*s:B,b=!0),b)return F}},oc.prototype._findClosestAlignmentGuide=function(j,B){if(!B.length)return{dis:1/0};for(var e,S=0,R=B.length-1;R-S>1;)e=Math.floor((S+R)/2),B[e].p<j?S=e:R=e;var L=B[S].p-j,V=B[R].p-j;return Math.abs(L)<=Math.abs(V)?{line:B[S],dis:L,index:S}:{line:B[R],dis:V,index:R}},oc.prototype.removeAllAlignmentGuide=function(T){var x=this;"y"!==T&&(x._xAlignmentGuide=[]),"x"!==T&&(x._yAlignmentGuide=[]),x._interactor._42()},oc.prototype.removeAlignmentGuide=function(W){for(var F,i,k,e=this,C=e._xAlignmentGuide,_=0;2>_;_++)for(C=0===_?e._xAlignmentGuide:e._yAlignmentGuide,F=0,i=C.length;i>F;F++)if(k=C[F],k.id===W)return C.splice(F,1),e._interactor._42(),{axis:0===_?"x":"y",position:k.p};return!1},oc.prototype.adjustAlignmentGuide=function(O,p){var Q=this,T=Q.removeAlignmentGuide(O);return T?(Q.addAlignmentGuide(T.axis,p,O),!0):!1};var fe=pn.Guide.Rect=function(R){var N=this;N._interactor=R};fe.prototype={},fe.prototype.constructor=fe,fe.prototype.gatherRects=function(){var N,B,c,k,j=this,n=j._interactor.gv,M=[],S=[],H={x:M,y:S},L={},D=n.getDataModel(),u=D.a("width"),y=D.a("height");u&&y&&(N=0,B=0,c=u,k=y,M.push({node:D,type:0,p:N},{node:D,type:1,p:N+c/2},{node:D,type:2,p:N+c}),S.push({node:D,type:0,p:B},{node:D,type:1,p:B+k/2},{node:D,type:2,p:B+k}),L[D._id||0]={x:N,y:B,width:c,height:k}),D.each(function(m){if(fk(m)&&!n.isSelected(m)&&n.isVisible(m)){var b=!1;if(n.sm().getSelection().each(function(S){b||(m.isHostOn(S)?b=!0:m.isDescendantOf(S)&&(b=!0))}),!b){var J=m.getRect();N=J.x,B=J.y,c=J.width,k=J.height,M.push({node:m,type:0,p:N},{node:m,type:1,p:N+c/2},{node:m,type:2,p:N+c}),S.push({node:m,type:0,p:B},{node:m,type:1,p:B+k/2},{node:m,type:2,p:B+k}),L[m._id]=J}}}),M.sort(function(R,A){return R.p-A.p}),S.sort(function(F,d){return F.p-d.p}),j._grid=H,j._87I=L},fe.prototype.gatherLines=function(F,D,C){var z,J,l,I,k,n,c,U,f,i,b,d,_=this,X=[_.findClosest({x:F.x,y:F.y},D),_.findClosest({x:F.x+F.w/2,y:F.y+F.h/2},D),_.findClosest({x:F.x+F.w,y:F.y+F.h},D)],s={},A=_._87I;C=C||255;var O,W;for(_._guideLine=[],z=0;2>z;z++)for(s={},0===z?(I="y",U=F.x,f=U+F.w):(I="x",U=F.y,f=U+F.h),J=0;3>J;J++)k=X[J],k&&isFinite(k[I])&&(O=1<<3*z+J,C&O&&(n=k[I+"Line"],c=n.node,W=c._id||0,s[W]||(s[W]=!0,d=A[W],"y"===I?(i=d.x,b=d.x+d.width):(i=d.y,b=d.y+d.height),l=n.p,_._guideLine.push({type:I,a:U,b:f,c:i,d:b,p:l,center:1===n.type}))))},fe.prototype._binarySearchClosest=function(d,$){if(!$.length)return{dis:1/0};for(var P,s=0,H=$.length-1;H-s>1;)P=Math.floor((s+H)/2),$[P].p<d?s=P:H=P;var i=$[s].p-d,C=$[H].p-d;return Math.abs(i)<=Math.abs(C)?{line:$[s],dis:i}:{line:$[H],dis:C}},fe.prototype.findClosest=function(E,X,R){var G=this,C=G._interactor,c=C.gv,P=G._grid;R&&(E=pn.toWorldPosition(c,E));var W,S=G._binarySearchClosest(E.x,P.x),o=G._binarySearchClosest(E.y,P.y),u=S.dis,D=o.dis,p=c._zoom,L=C.getStyle("smartGuideSensitivity")/p,J={};return Math.abs(u)<L&&"y"!==X&&(J.x=R?u*p:u,J.xLine=S.line,W=!0),Math.abs(D)<L&&"x"!==X&&(J.y=R?D*p:D,J.yLine=o.line,W=!0),W?J:void 0},fe.prototype._42=function(){var L=this,O=L._guideLine;if(O&&!B.Default.isCtrlDown()){var v,V,X,D,E,Q,K,M,p,I,t,l,y,P,i,b,k,G=L._interactor,$=G.gv,_=G._context,s=$.tx(),U=$.ty(),m=$._zoom,x=G.getStyle("guideLineTextSpacing");for(v=0,V=O.length;V>v;v++)X=O[v],M=X.type,p=X.p,I=X.a,t=X.b,l=X.c,y=X.d,P=Math.min(I,l),i=Math.max(t,y),"x"===M?(D=p*m+s,E=P*m+U,Q=D,K=i*m+U):(D=P*m+s,E=p*m+U,Q=i*m+s,K=E),pn.Icons.DrawIcon(G,_,pn.Icons.MoveLineGuide,{rect:[D,E,Q,K],center:X.center}),y>=I&&t>=l||(P=I>y?y:t,i=I>y?I:l,k=i-P,"x"===M?(X.center2center||(D-=x,Q=D),E=P*m+U,K=i*m+U,b=pn.Icons.MoveLineGuideDistanceV):"y"===M&&(X.center2center||(E-=x,K=E),D=P*m+s,Q=i*m+s,b=pn.Icons.MoveLineGuideDistanceH),pn.Icons.DrawIcon(G,_,b,{x0:D,y0:E,x1:Q,y1:K,dis:k}))}},fe.prototype.clear=function(){this._guideLine=null},pn.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:0,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Sr=pn.Icons={},Bi=1e4,Id=null,Ri="rgb(51,153,255)",Ok="rgb(183,232,135)",ui="rgb(255,204,153)",hk=6;B.Default.setImage("Icons.RectPoint",{width:hk,height:hk,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:Ri,rect:[0,0,hk,hk]}]});var tg="#e000e0";Sr.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var X=Sr.GroupSubEntityRect.data;if(!X)return[];var j=X.min,l=X.max;return[j.x,j.y,j.x,l.y,l.x,l.y,l.x,j.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Sr.GroupSubEntityRect.data.isKeyOb?tg:"#666666"}}}]},Sr.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Sr.Line.data.P1.x,Sr.Line.data.P1.y],hk,hk]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Sr.Line.data.P2.x,Sr.Line.data.P2.y],hk,hk]}}}]},Sr.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Sr.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Sr.Rect={comps:[{type:"shape",points:{func:function(){var p=Sr.Rect.data;if(!p)return[];var x=p.LT,d=p.LB,P=p.RB,w=p.RT;return[x.x,x.y,d.x,d.y,P.x,P.y,w.x,w.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:Ri},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Sr.Rect.data.rotation}},rect:{func:function(){return[[Sr.Rect.data.LT.x,Sr.Rect.data.LT.y],hk,hk]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Sr.Rect.data.rotation}},rect:{func:function(){return[[Sr.Rect.data.LB.x,Sr.Rect.data.LB.y],hk,hk]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Sr.Rect.data.rotation}},rect:{func:function(){return[[Sr.Rect.data.RB.x,Sr.Rect.data.RB.y],hk,hk]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Sr.Rect.data.rotation}},rect:{func:function(){return[[Sr.Rect.data.RT.x,Sr.Rect.data.RT.y],hk,hk]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Sr.Rect.data.rotation}},visible:{func:function(){return Sr.Rect.data.L?!0:!1}},rect:{func:function(){return[[Sr.Rect.data.L.x,Sr.Rect.data.L.y],hk,hk]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Sr.Rect.data.rotation}},visible:{func:function(){return Sr.Rect.data.R?!0:!1}},rect:{func:function(){return[[Sr.Rect.data.R.x,Sr.Rect.data.R.y],hk,hk]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Sr.Rect.data.rotation}},visible:{func:function(){return Sr.Rect.data.T?!0:!1}},rect:{func:function(){return[[Sr.Rect.data.T.x,Sr.Rect.data.T.y],hk,hk]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Sr.Rect.data.rotation}},visible:{func:function(){return Sr.Rect.data.B?!0:!1}},rect:{func:function(){return[[Sr.Rect.data.B.x,Sr.Rect.data.B.y],hk,hk]}}}]};var Yd=16;B.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:Ri,borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:Ri,shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Sr.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Sr.Anchor.data.POS.x,Sr.Anchor.data.POS.y],Yd,Yd]}}}]},Sr.TipShiftX=12,Sr.TipShiftY=12;var Ak=[8,28];Sr.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Sr.TipHelper.data.helperPos.x,Sr.TipHelper.data.helperPos.y,Ak[0]*Sr.TipHelper.data.size,Ak[1]]}},background:{func:function(){return Id.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Sr.TipHelper.data.text}},rect:{func:function(){return[Sr.TipHelper.data.helperPos.x,Sr.TipHelper.data.helperPos.y,Ak[0]*Sr.TipHelper.data.size,Ak[1]]}},color:{func:function(){return Id.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var vg=7;Sr.ShapePoint={comps:[{type:"circle",rect:{func:function(){var M=Sr.ShapePoint.data.point;return[M,vg,vg]}},background:{func:function(){var z=Sr.ShapePoint.data.isEnd;return z?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:Ri}]},Sr.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return Sr.ShapeBgCurve.data.P}},segments:{func:function(){return Sr.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:Ri}]};var Dj=8;Sr.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var v=Sr.ShapeHighlighPoint.data;return[[v.x,v.y],Dj,Dj]}},background:{func:function(){return Id.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var mo=10;Sr.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var j=Sr.ShapeHighlighRealPoint.data;return[[j.x,j.y],mo,mo]}},background:"#ffffff",borderWidth:2,borderColor:Ri}]};var Tp=8;Sr.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var T=Sr.ShapeHighlighCtrlPoint.data,P=T.x,d=T.y,_=Tp/2;return[P-_,d-_,P-_,d+_,P+_,d+_,P+_,d-_]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Id.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Id.getStyle("shapeCtrlPointBorderColor")||Ri}}}]};var Tl=3;Sr.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Sr.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Tl,borderColor:{func:function(){return Id.getStyle("curveHighlightColor")}}}]},Sr.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Sr.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Sr.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Sr.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Sr.MoveLineGuide.data.center?Ok:ui}}}]};var nq=5;Sr.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var L=Sr.MoveLineGuideDistanceH.data,c=L.x0,e=L.y0;return[c,e-nq,c,e+nq]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:ui},{type:"shape",points:{func:function(){var j=Sr.MoveLineGuideDistanceH.data,b=j.x1,F=j.y1;return[b,F-nq,b,F+nq]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:ui},{type:"text",text:{func:function(){return Math.round(Sr.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var F=Sr.MoveLineGuideDistanceH.data;return[[(F.x0+F.x1)/2,F.y0-10],20,20]}},color:ui,font:"12px Arial",align:"center"}]},Sr.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var u=Sr.MoveLineGuideDistanceV.data,W=u.x0,p=u.y0;return[W-nq,p,W+nq,p]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:ui},{type:"shape",points:{func:function(){var K=Sr.MoveLineGuideDistanceV.data,x=K.x1,g=K.y1;return[x-nq,g,x+nq,g]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:ui},{type:"text",text:{func:function(){return Math.round(Sr.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var S=Sr.MoveLineGuideDistanceV.data;return[[S.x0-10,(S.y0+S.y1)/2],20,20]}},color:ui,font:"12px Arial",align:"center"}]},B.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Sr.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var k=Sr.EdgeElevationGuide.data,J=k.x,U=k.y,X=Id.getStyle("curveElevationIntersectSize"),z=Id.getStyle("curveElevationGuideShift");return J+=z[0],U+=z[1],[J-X,U-X,2*X,2*X]}}}]},B.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),B.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Sr.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Sr.ConnectGuide.data.rotation}},rect:{func:function(){var n=Sr.ConnectGuide.data.connect;n.x,n.y;var g=Id.getStyle("connectGuideIntersectSize");return[[n.x,n.y],2*g,2*g]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var $=Sr.ConnectGuide.data.cursorPos||Sr.ConnectGuide.data.connect,i=Id.getStyle("connectGuideIntersectSize");return[[$.x,$.y],2*i-2,2*i-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var z=Sr.ConnectGuide.data.connect,r=Sr.ConnectGuide.data.cursorPos||z;return[z.x,z.y,z.x+.5*(r.x-z.x),z.y,r.x+.5*(z.x-r.x),r.y,r.x,r.y]}}}]},B.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),B.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Sr.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var $=Sr.ConnectGuideGarbage.data.hover;return $?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var X=Sr.ConnectGuideGarbage.data,l=Id.getStyle("connectGuideGarbageIntersectsize");return X.hover&&(l+=5),[[X.x,X.y],2*l,2*l]}}}]};var rc=6;Sr.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Sr.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var o=Sr.ShapeActivingCtrl.data;return[o.point.x,o.point.y,o.c1.x,o.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:Ri},{type:"shape",visible:{func:function(){return Sr.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var R=Sr.ShapeActivingCtrl.data;return[R.point.x,R.point.y,R.c2.x,R.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:Ri},{type:"shape",visible:{func:function(){return Sr.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var E=Sr.ShapeActivingCtrl.data.c1,Y=E.x,O=E.y,L=rc/2;return"c1"===Sr.ShapeActivingCtrl.data.hl&&(L+=.5),[Y-L,O-L,Y-L,O+L,Y+L,O+L,Y+L,O-L]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Id.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Sr.ShapeActivingCtrl.data.hl?Id.getStyle("shapeCtrlPointHighlightBorder")||Ri:Id.getStyle("shapeCtrlPointBorderColor")||Ri}}},{type:"shape",visible:{func:function(){return Sr.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var p=Sr.ShapeActivingCtrl.data.c2,r=p.x,_=p.y,L=rc/2;return"c2"===Sr.ShapeActivingCtrl.data.hl&&(L+=.5),[r-L,_-L,r-L,_+L,r+L,_+L,r+L,_-L]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Id.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Sr.ShapeActivingCtrl.data.hl?Id.getStyle("shapeCtrlPointHighlightBorder")||Ri:Id.getStyle("shapeCtrlPointBorderColor")||Ri}}}]},Sr.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:Ri,rect:{func:function(){return[[Sr.RoundPoint.data.x,Sr.RoundPoint.data.y],hk,hk]}}}]},Sr.AttachPoint={comps:[{type:"rect",background:{func:function(){return Sr.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:Ri,rect:{func:function(){var h=Sr.AttachPoint.data.isAttach?hk+4:hk;return[[Sr.AttachPoint.data.x,Sr.AttachPoint.data.y],h,h]}}}]},pn.Icons.DrawIcon=function(I,L,c,O){c.width=c.height=Bi,c.data=O,Id=I,B.Default.drawImage(L,c,0,0,Bi,Bi)},pn.Icons.MapPoints=function(d,e){for(var Q=0,f=d.length;f>Q;Q++)d[Q]/=e},pn.roundTo=function(e,g,p){var S=Math.abs(e%g);return p>S||p>g-S?g*Math.round(e/g):e},pn.toFixed=function(P){return Math.round(100*P)/100},pn.getDataMatrix=function(v){if(v instanceof B.Shape){var r=new B.Math.Matrix2d,o=v.getPosition();return r.translate(-o.x,-o.y).scale(v.getScale().x,v.getScale().y).rotate(v.getRotation()).translate(o.x,o.y),r}return v.getMatrix?v.getMatrix():new B.Math.Matrix2d};var ei=pn.Math.Curve=function(){this._curves=[]};ei.prototype={},ei.prototype.constructor=ei,ei.prototype.createFromHtShape=function(W,e,Q){e instanceof B.List&&(e=e.toArray());var S,P,A,t,T,z,F,H=this,d=null,x=null,Z=0,G=pn.Math.Vector2,K=pn.Math.CubicBezier,U=function(O){return new G(W[O],W[O+1],Q?Q[O/2]:n)};for(P=0,A=e.length;A>P;P++){switch(t=e[P],T=null,t){case 1:x=U(Z),d=x,Z+=2;break;case 2:S=U(Z),Z+=2,T=new K(x,x.clone(),S.clone(),S),x=S;break;case 3:z=U(Z),S=U(Z+2),Z+=4,T=new K(x,z.clone().sub(x).multiplyScalar(2/3).add(x),z.clone().sub(S).multiplyScalar(2/3).add(S),S),x=S;break;case 4:z=U(Z),F=U(Z+2),S=U(Z+4),Z+=6,T=new K(x,z,F,S),x=S;break;case 5:if(!d)break;T=new K(x,x.clone(),d.clone(),d),x=null,d=null}T&&(T._index=H._curves.length,H._curves.push(T))}},ei.prototype.checkPoint=function(a,R){var X,M,F,z,b,E=this,Y=E._curves;for(X=0,M=Y.length;M>X;X++)if(z=Y[X],b=z.intersectRect(a,R,R),b.length)return F=0,b.forEach(function(X){F+=X.t}),F/=b.length,a=z.getPointAt(F),a.t=F,{bezier:z,intersection:a}},ei.prototype.insertKnot=function(Y,T){var U=Y.insertKnot(T),y=this,n=y._curves;n.splice(Y._index,1,U[0],U[1])},ei.prototype._isCloseEnough=function(Y,$){return Math.abs(Y.x-$.x)<1e-6&&Math.abs(Y.y-$.y)<1e-6},ei.prototype._isSamePoint=function(H,o){return H===o},ei.prototype.moveRealPoint=function(I,H){var Z=this,g=Z._curves,k=H.clone().sub(I);g.forEach(function(o){var U=o._p1;o._p2,o._p3;var l=o._p4;Z._isSamePoint(U,I)&&(o._p2.add(k),o._p1=H),Z._isSamePoint(l,I)&&(o._p3.add(k),o._p4=H)})},ei.prototype.moveCtrlDueToRealPointMovement=function(d,X){var S=this,z=S._curves,O=function(J){J.add(X),J.e&&X.e&&(J.e+=X.e)};z.forEach(function(C){var $=C._p1;C._p2,C._p3;var t=C._p4;S._isSamePoint($,d)&&O(C._p2),S._isSamePoint(t,d)&&O(C._p3)})},ei.prototype.moveCtrlPoint=function(b,T,I){var J=b[I];if(J){J.e!==n&&(T.e=J.e);var X=this,t=X._curves;T.clone().sub(J),t.forEach(function(Y){var P;"c2"===I?P="_p2":"c1"===I&&(P="_p3"),X._isSamePoint(Y[P],J)&&(Y[P]=T)}),b[I]=T}},ei.prototype.deleteRealPoint=function(Z,q){var C,S,K,z,i,w,j,M=this,H=M._curves,b={},Q=[],Y=pn.Math.CubicBezier;for(S=0,K=H.length;K>S;S++)C=H[S],z=C._p1,i=C._p2,w=C._p3,j=C._p4,(b[S]||!M._isSamePoint(z,Z))&&(M._isSamePoint(j,Z)?K>S+1&&M._isSamePoint(H[S+1]._p1,Z)&&(q||Q.push(new Y(z,i,H[S+1]._p3,H[S+1]._p4))):Q.push(C));M._curves=Q},ei.prototype.findPairs=function(P,s){var Q,L,G,w,l,O,S,R,k=this,n=k._curves,h={},W=[];for(L=0,G=n.length;G>L;L++)Q=n[L],w=Q._p1,l=Q._p2,O=Q._p3,S=Q._p4,!h[L]&&k._isSamePoint(w,P)&&(s?W.push({point:w,r2:S}):W.push({point:w,c2:l})),k._isSamePoint(S,P)&&(R=s?{point:S,r1:w}:{point:S,c1:O},G>L+1&&k._isSamePoint(n[L+1]._p1,P)&&(s?R.r2=n[L+1]._p4:R.c2=n[L+1]._p2,h[L+1]=!0),W.push(R));return W},ei.prototype.toHtShape=function(){var B=this,a=B._curves,n=[],L=[],S={x:1/0,y:1/0};return a.forEach(function(v){var A=v._p1,c=v._p2,q=v._p3,g=v._p4;return B._isCloseEnough(A,S)||(n.push(1),L.push(A.clone())),S=g,B._isCloseEnough(A,c)&&B._isCloseEnough(q,g)?(n.push(2),L.push(g.clone()),void 0):(n.push(4),L.push(c.clone(),q.clone(),g.clone()),void 0)}),{segments:n,points:L}};var bm=pn.Math.CubicBezier=function(A,c,o,D){var Q=this;Q._id=pn.Math.CubicBezier._globalId++,Q._p1=A,Q._p2=c,Q._p3=o,Q._p4=D};bm._globalId=1,bm.prototype={},bm.prototype.constructor=bm,bm.prototype.toString=function(){return this._id},bm.prototype.intersectRect=function(v,X,M){var V=X/2,S=M/2,n=v.x,G=v.y,Q=pn.Math.Vector2,T=new Q(-V+n,-S+G),J=new Q(V+n,S+G),l=new Q(J.x,T.y),q=new Q(T.x,J.y),R=this,g=R.intersectLine(T,l),m=R.intersectLine(l,J),j=R.intersectLine(J,q),d=R.intersectLine(q,T),Y=g.concat(m).concat(j).concat(d);return Y},bm.prototype.intersectLine=function($,P){var d,l,y,m,f,j,D,S,I,_,U,Y,M,w=this,z=$.clone().min(P),x=$.clone().max(P);m=w._p1,f=w._p2,j=w._p3,D=w._p4,d=m.clone().multiplyScalar(-1),l=f.clone().multiplyScalar(3),y=j.clone().multiplyScalar(-3),U=d.add(l).add(y).add(D),d=m.clone().multiplyScalar(3),l=f.clone().multiplyScalar(-6),y=j.clone().multiplyScalar(3),_=d.add(l).add(y),d=m.clone().multiplyScalar(-3),l=f.clone().multiplyScalar(3),I=d.add(l),S=m.clone(),M=new pn.Math.Vector2($.y-P.y,P.x-$.x),Y=$.x*P.y-P.x*$.y;for(var L=w.getRoots(M.dot(U),M.dot(_),M.dot(I),M.dot(S)+Y),T=new Array,e=0,G=L.length;G>e;e++){var O=L[e];if(!(0>O||O>1)){var W=m.clone().lerp(f,O),F=f.clone().lerp(j,O),a=j.clone().lerp(D,O),q=W.lerp(F,O),H=F.lerp(a,O),v=q.lerp(H,O);v.t=O,$.x==P.x?z.y<=v.y&&v.y<=x.y&&T.push(v):$.y==P.y?z.x<=v.x&&v.x<=x.x&&T.push(v):v.x>=z.x&&v.y>=z.y&&v.x<=x.x&&v.y<=x.y&&T.push(v)}}return T},bm.prototype.solveTForPoint=function(o){var r,S,J,v,K=this;r=K._p1.x-o.x,S=K._p2.x-o.x,J=K._p3.x-o.x,v=K._p4.x-o.x;for(var t=K.getRoots(v-3*J+3*S-r,3*J-6*S+3*r,3*S-3*r,r),Z=n,p=1/0,R=0,u=t.length;u>R;R++){var m=t[R];if(!(0>m||m>1)){var s=K._p1.clone().lerp(K._p2,m),j=K._p2.clone().lerp(K._p3,m),H=K._p3.clone().lerp(K._p4,m),b=s.lerp(j,m),Y=j.lerp(H,m),$=b.lerp(Y,m);$.t=m;var Q=Math.abs($.y-o.y);p>Q&&(p=Q,Z=$)}}return Z},bm.prototype.getPointAt=function(E){var K=this,r=K._p1,i=K._p2,B=K._p3,e=K._p4,u=r.clone().lerp(i,E),p=i.clone().lerp(B,E),v=B.clone().lerp(e,E),C=u.lerp(p,E),$=p.lerp(v,E);return C.lerp($,E)},bm.prototype.getRoots=function(K,l,Y,f){var r,m,V,b,h,A=new Array;if(Math.abs(K)<1e-6){var r=l,m=Y/r,V=f/r,b=m*m-4*V;if(b>0){var h=Math.sqrt(b);A.push(.5*(-m+h)),A.push(.5*(-m-h))}else 0==b&&A.push(.5*-m)}l/=K,Y/=K,f/=K,r=(3*Y-l*l)/3,m=(2*l*l*l-9*Y*l+27*f)/27;var $=l/3,P=m*m/4+r*r*r/27,v=m/2;if(Math.abs(P)<=1e-6&&(P=0),P>0){var s,G,h=Math.sqrt(P);s=-v+h,G=s>=0?Math.pow(s,1/3):-Math.pow(-s,1/3),s=-v-h,s>=0?G+=Math.pow(s,1/3):G-=Math.pow(-s,1/3),A.push(G-$)}else if(0>P){var B=Math.sqrt(-r/3),M=Math.atan2(Math.sqrt(-P),-v)/3,Q=Math.cos(M),x=Math.sin(M),p=Math.sqrt(3);A.push(2*B*Q-$),A.push(-B*(Q+p*x)-$),A.push(-B*(Q-p*x)-$)}else{var s;s=v>=0?-Math.pow(v,1/3):Math.pow(-v,1/3),A.push(2*s-$),A.push(-s-$)}return A},bm.prototype._70I=function(){var Y=this;return Y._p1.distanceToSquared(Y._p2)<1e-10&&Y._p3.distanceToSquared(Y._p4)<1e-10},bm.prototype.insertKnot=function(c){var E=this,W=E._p1,X=E._p2,u=E._p3,q=E._p4,D=W.clone().lerp(X,c),b=X.clone().lerp(u,c),g=u.clone().lerp(q,c),k=D.clone().lerp(b,c),I=b.clone().lerp(g,c),B=k.clone().lerp(I,c);return E._70I()?(W.clone().lerp(q,c),[new pn.Math.CubicBezier(W,W.clone(),B.clone(),B),new pn.Math.CubicBezier(B,B.clone(),q.clone(),q)]):[new pn.Math.CubicBezier(W,D,k,B),new pn.Math.CubicBezier(B,I,g,q)]};var aj=B.Default.getInternal().ui().EdgeUI,pb={_47O:function(m){var J=this,C=pb.getBackups()._47O;pn.inEdit(J.gv)||C.call(J,m)}};pn.Inject.registAsModule(pb,aj);var wf=B.Default.getInternal().ui().NodeUI,sf={_47O:function(P){var j=this,E=sf.getBackups()._47O;pn.inEdit(j.gv)||E.call(j,P)},getSelectWidth:function(){var O=this,M=O.gv,l=O._data;if(M.isEditable(l)&&pn.inEdit(M))return 0;var $=sf.getBackup("getSelectWidth");return $.call(O)}};pn.Inject.registAsModule(sf,wf);var vr=B.graph.GraphView,Nd={_editPointSize:function(){var $=B.Default.isTouchable,c=pn.getStyle("pointSize");return c[$?0:1]}(),isPointEditable:function(A){var I=this;if(pn.inEdit(I))return I._pointEditableFunc?I._pointEditableFunc(A):!0;var H=Nd.getBackup("isPointEditable");H.call(I,A)},isEditable:function(R){var x,C=this,h=Nd.getBackup("isEditable");if(x=R instanceof pn.Group?!0:h.call(C,R),!pn.inEdit(C))return x;if(!(R instanceof B.Edge))return x;if(!R.s("2d.editable"))return!1;var o=C.getEditableFunc();return o?o(R):!0},_42:function(C,p){var B=this,l=Nd.getBackups()._42;if(l.call(B,C,p),pn.inEdit(B)){var j=B.getEditInteractor();j.drawImpl()}}};pn.Inject.registAsModule(Nd,vr);var Mp=B.Default.getInternal().ui().ShapeUI,Fn={_47O:function(B){var o=this,j=Fn.getBackups()._47O;pn.inEdit(o.gv)||j.call(o,B)}};pn.Inject.registAsModule(Fn,Mp);var Tr=B.graph.DefaultInteractor,ub={handle_mousewheel:function(K){var Z=this,f=ub.getBackup("handle_mousewheel");pn.inEdit(Z.gv)||f.call(Z,K)}};pn.Inject.registAsModule(ub,Tr);var $f=B.graph.MoveInteractor,Aq={_calcShift:function(q,B){var p=this,K=Aq.getBackup("_calcShift"),D=p.gv;if(!pn.inEdit(D))return K.call(p,q,B);var k=D.getEditInteractor(),U=k.getSubModule("Move").calcShift(q,B,p);return U||K.call(p,q,B)},clear:function(r){var _=this,L=Aq.getBackup("clear");L.call(_,r);var O=_.gv;if(pn.inEdit(O)){var o=O.getEditInteractor();o.getSubModule("Move").clear(r)}}};pn.Inject.registAsModule(Aq,$f);var fe=pn.Rect=function(i){this.catalog="Rect",this._interactor=i};fe.prototype={},fe.prototype.constructor=fe,fe.prototype.gatherInfo=function(V,q){var g=this;if(1===q.length){var A=q[0];return A instanceof B.Shape&&A._70I()?g.gatherLine(V,A):Bh(A,V)?!1:g.gatherSingleTarget(V,A)}return q.length>1?g.gatherMultiTargets(V,q):!1},fe.prototype.gatherSingleTarget=function(z,j){if(j.getCorners){var G,m=this,Y=m.info;m.target=j,G=m.screenInfo={};var L=j.getCorners();Y.LT=new pn.Math.Vector2(L[0]),Y.LB=new pn.Math.Vector2(L[1]),Y.RB=new pn.Math.Vector2(L[2]),Y.RT=new pn.Math.Vector2(L[3]),Y.T=Y.LT.clone().add(Y.RT).divideScalar(2),Y.B=Y.LB.clone().add(Y.RB).divideScalar(2),Y.L=Y.LT.clone().add(Y.LB).divideScalar(2),Y.R=Y.RT.clone().add(Y.RB).divideScalar(2);for(var E in Y)G[E]=pn.toScreenPosition(z,Y[E]);var Z=m._interactor,J=Z.getStyle("checkSize"),X=function(t,T,n){var m=T.clone().sub(t).setLength(-J),_=n.clone().sub(t).setLength(-J),h=m.add(_).add(t);return h};return G.rotLT=X(G.LT,G.RT,G.LB),G.rotLB=X(G.LB,G.LT,G.RB),G.rotRB=X(G.RB,G.LB,G.RT),G.rotRT=X(G.RT,G.LT,G.RB),G.rotT=G.rotLT.clone().add(G.rotRT).divideScalar(2),G.rotB=G.rotLB.clone().add(G.rotRB).divideScalar(2),G.rotL=G.rotLT.clone().add(G.rotLB).divideScalar(2),G.rotR=G.rotRT.clone().add(G.rotRB).divideScalar(2),G.rotation=j.getRotation(),m.gatherConnectInfo(),!0}},fe.prototype.gatherConnectInfo=function(){var K=this,f=K.target,h=K._interactor,g=K.screenInfo,M=h.gv;if(M.isConnectActionVisible(f)&&h.getStyle("connectGuideVisible")){var z;f.s&&(z=f.s("connectGuideShift")),z||(z=h.getStyle("connectGuideShift"));var I=f.getAnchor(),P=f.getSize(),H=f.toGlobal({x:P.width*(z[0]-I.x),y:P.height*(z[1]-I.y)});H=pn.toScreenPosition(M,H),g.P1?H.add(g.P2.clone().sub(g.P1).setLength(z[2])):(H.add(g.RT.clone().sub(g.LT).setLength(z[2])),H.add(g.LB.clone().sub(g.LT).setLength(z[3]))),g.connect=H}},fe.prototype.gatherMultiTargets=function(m,x){var Q=pn.Group.findOrCreateGroup(x);if(!Q)return!1;var j=this;return j.editing&&"rotate"!==j.editing.mode||Q.calcInfo(),j.gatherSingleTarget(m,Q)},fe.prototype.gatherLine=function(U,V){this.target=V;var y=this.screenInfo={},t=V.getPoints(),A=pn.getDataMatrix(V);return y.P1=pn.toScreenPosition(U,A.apply(t.get(0))),y.P2=pn.toScreenPosition(U,A.apply(t.get(1))),this.gatherConnectInfo(),!0},fe.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],fe.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],fe.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],fe.prototype.check=function(k,o,l){if(B.Default.isLeftButton(o)){var C=this;if(C.editing=null,C.tipInfo=null,C.screenInfo){var i=C.target,q=k.isEditable(i),J=C.screenInfo;if(q&&J.connect){var d=C._checkConnect(l);if(d)return d}if(J.P1)return C._checkLine(l);var A,a,H,D=null,G=C._interactor,f=G.getStyle("checkSize");if(q&&k.isRectEditable(i))for(a=0;a<pn.Rect.ResizeKeys.length;a++)if(H=pn.Rect.ResizeKeys[a],pn.checkHit(l,J[H],f)){D=H,A="resize";break}if(!D&&q&&k.isRotationEditable(i)&&!G.getStyle("rotateAsClock")){var j=G.getStyle("rotateCheckSize");for(a=0;a<pn.Rect.RotateKeys.length;a++)if(H=pn.Rect.RotateKeys[a],pn.checkHit(l,J[H],j)){D=H,A="rotate";break}}if(!D)return G.setCursor("default"),void 0;if("rotate"===A){var $,F=k.lp(o);if(i instanceof pn.Group){var r=G.getStyle("groupRotateModeKey");"string"==typeof r&&(r=[r]);for(var R=!1,w=0,t=r.length;t>w;w++)if(o[r[w]]){R=!0;break}var s=G.getStyle("groupRotateModeDefault");$=R?"batch"===s?"block":"batch":s}var T="batch"===$?i.getAnchor2():i.getPosition(),Y=Math.atan2(F.y-T.y,F.x-T.x);G._setRotateCursor(Y),C.editing={mode:A,key:D,pos:T,flipY:i.getScale().y<0,rotation:i.getRotation(),hitRot:Y},$&&(C.editing.groupRotateMode=$)}else{var n=pn.Rect.ResizeKeys.indexOf(D),V=pn.Rect.ResizeDirection[n],W=Math.cos(i.getRotation()),X=Math.sin(i.getRotation()),N=V.x*Math.sign(i.getScale().x),Z=V.y*Math.sign(i.getScale().y),I=Math.atan2(-X*N-W*Z,W*N-X*Z),c=(Math.round(I/(Math.PI/4))+8)%8,e=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][c];
this._interactor.setCursor(e);var x=i.getWidth(),g=i.getHeight(),O=i.getAnchor();C.editing={mode:A,key:D,rect:{x:-x*O.x,y:-g*O.y,width:x,height:g},anchor:O,matrix:i.getMatrix()}}return D}}},fe.prototype._checkLine=function(v){var p=this;p.screenInfo;var i,f=p._interactor.getStyle("checkSize");if(pn.checkHit(v,p.screenInfo.P1,f))i="P1";else{if(!pn.checkHit(v,p.screenInfo.P2,f))return this._interactor.setCursor("default"),void 0;i="P2"}return p.editing={mode:"line",key:i},i},fe.prototype._checkConnect=function(x){var R=this,I=R.screenInfo,m=R._interactor,G=m.getStyle("connectGuideIntersectSize"),Y=I.connect,U=x.x,X=Y.x;if(X>U&&G>X-U&&Math.abs(Y.y-x.y)<G||U>=X&&pn.checkHit(x,Y,G)){var n="connect",_=$.getConnectAction(m.gv);if(R.editing={mode:n},_&&_.delete)if(R.target instanceof pn.Group){var P=!0;m.gv.sm().getSelection().each(function(f){_.delete.visible.call(null,m.gv,f)||(P=!1)}),R.editing.hasDeleteAction=P}else _.delete.visible.call(null,m.gv,R.target)&&(R.editing.hasDeleteAction=!0);return m.setCursor("default"),n}},fe.prototype._fireEditEvent=function(v,M){var a=this._interactor,B=this.editing;if(B){var S=B.mode;S="rotate"===S?"Rotation":"connect"===S?"Connection":S[0].toUpperCase()+S.slice(1),a.fi({kind:v+"Edit"+S,event:M})}},fe.prototype.startEdit=function(b,Z){b.startDragging(Z);var H=this;H._interactor.fi({kind:"prepareEdit",event:Z});var x=H.editing,o=H.target;if(x){if(H._fireEditEvent("begin",Z),"rotate"===x.mode)return x.groupRotateMode&&o.beginRotate(x),void 0;if("connect"!==x.mode)("line"===x.mode||o&&0===o.getRotation())&&(H._inSmartGuide=!0,H._interactor.rectGuide.gatherRects());else if(x.hasDeleteAction){var P=b.gv,c=H._interactor.getStyle("connectGuideGarbageShift");x.garbageInfo={x:P.getWidth()*c[0]+c[2],y:P.getHeight()*c[1]+c[3],size:H._interactor.getStyle("connectGuideGarbageIntersectsize")},b._42()}}},fe.prototype._46O=function(d){var v,H,b=this,o=b.editing,f=b.target;if(o){if("connect"===o.mode&&!o.canceled&&!o.deleted)try{o.garbageInfo&&o.garbageInfo.hover?$.doDeleteConnectionAction(b._interactor.gv,f):$.doConnectAction(b._interactor.gv,f,o.target)}catch(G){console.error(G)}H=o.freezeFlag,v=b.editing.groupRotateMode,b._fireEditEvent("end",d),b.editing=null}b.tipInfo=null,b._inSmartGuide&&(b._interactor.rectGuide.clear(),b._inSmartGuide=!1),v&&f&&f.endRotate(),f instanceof B.Block&&(H===n?delete f._freezeSyncFromChildren:f._freezeSyncFromChildren=H,f.updateFromChildren())},fe.prototype.handleNormalStateDelete=function(){var O=this,f=O.editing;if(f&&"connect"===f.mode&&!f.canceled&&!f.deleted){if(f.garbageInfo){try{$.doDeleteConnectionAction(O._interactor.gv,O.target)}catch(J){console.error(J)}f.garbageInfo=null}return f.cursorPos=null,f.targetCorners=null,f.deleted=!0,O._interactor._42(),!0}},fe.prototype.handleNormalStateKeyDown=function(q){var y=this,F=y.editing;return!F||"connect"!==F.mode||F.canceled||F.deleted?void 0:B.Default.isEsc(q)?(F.cursorPos=null,F.targetCorners=null,F.canceled=!0,y._interactor._42(),!0):void 0},fe.prototype.handleEdit=function(j,K){var n=this,U=n.editing;if(U){var Q,t,a,m,r,O=n.target,X=U.key,d=U.mode,u=j.lp(K),I=n._interactor;if("connect"===d){if(U.canceled)return;if(U.deleted)return;U.cursorPos=I._getLogicalPoint(K);var s=U.garbageInfo;return s&&pn.checkHit(U.cursorPos,s,s.size)?(s.hover=!0,U.target=null,U.targetCorners=null):(s&&(s.hover=!1),U.target=j.getDataAt(u,function(p){return j.isSelectable(p)?fk(p)?!0:!1:!1})||null,U.targetCorners=pn.getTargetCornersOnScreen(j,U.target)),I._42(),void 0}if("rotate"===d){var o,f,p=U.pos,_=Math.atan2(u.y-p.y,u.x-p.x);if(U.groupRotateMode?f=_-U.hitRot:(o=_-U.hitRot,f=U.rotation+o),f%=2*Math.PI,0>f&&(f+=2*Math.PI),!B.Default.isCtrlDown(K)){var N,v;Cj(K)?(N=I.getStyle("shiftRotateRound"),v=N/2):(N=I.getStyle("rotateRound"),v=I.getStyle("rotateSensitivity")),f=pn.roundTo(f,N,v)}U.groupRotateMode?(o=f-(U.lastRotation||0),0!==o&&(O.addRotation(o,U.groupRotateMode),U.lastRotation=f)):O.setRotation(f),I._setRotateCursor(_),f>Math.PI&&(f-=2*Math.PI);var k=180*(f/Math.PI);k=k.toFixed(2),Q=""+k+""}else if("resize"===d){var V=U.rect;a=V.x,m=V.y;var z,J=V.width,L=V.height,Z=U.anchor,$=U.matrix,G=O.s&&O.s("keepAspectRatio")||I.getStyle("keepAspectRatio");Cj(K)&&(G=!G);var q=n._unionPointMode1,w=n._unionPointMode2;if(n._inSmartGuide&&!B.Default.isCtrlDown(K)&&!G){var i;"L"===X||"R"===X?i="x":("T"===X||"B"===X)&&(i="y"),n._adsorbedToClosest(u,i),r=!0}z=$.tfi(u);var M;"LT"===X?(V=q(z,{x:a+J,y:m+L},J,L,G),M=9):"T"===X?(V=w({x:a,y:z.y},{x:a+J,y:m+L},J,L,G,"v"),M=1):"RT"===X?(V=q(z,{x:a,y:m+L},J,L,G),M=33):"L"===X?(V=w({x:z.x,y:m},{x:a+J,y:m+L},J,L,G,"h"),M=8):"R"===X?(V=w({x:a,y:m},{x:z.x,y:m+L},J,L,G,"h"),M=32):"LB"===X?(V=q(z,{x:a+J,y:m},J,L,G),M=12):"B"===X?(V=w({x:a,y:m},{x:a+J,y:z.y},J,L,G,"v"),M=4):"RB"===X&&(V=q(z,{x:a,y:m},J,L,G),M=36);var l=$.tf(V.x+V.width*Z.x,V.y+V.height*Z.y);O instanceof B.Block&&(U.hasOwnProperty("freezeFlag")||(U.freezeFlag=O._freezeSyncFromChildren,O._freezeSyncFromChildren=!0)),O.setPosition(l),O.setSize(V.width,V.height),r&&(t=O.getRect(),I.rectGuide.gatherLines({node:O,x:t.x,y:t.y,w:t.width,h:t.height},i,M)),Q=""+Math.round(V.width)+" * "+Math.round(V.height)}else if("line"===d){if(Cj(K)){var e=O.getPoints(),F="P1"===X?e.get(1):e.get(0),h={x:u.x-F.x,y:u.y-F.y},x=I.getStyle("shiftLineRotateRound"),b=n._shiftDirList;if(!b||n._shiftRotateRound!==x){n._shiftRotateRound=x,n._shiftDirList=b=[];for(var g=0;g<Math.PI;g+=x)b.push({x:y(g),y:T(g)})}for(var S,R=0,Y=0,A=b.length;A>Y;Y++){var D=b[Y],H=D.x*h.x+D.y*h.y;Math.abs(H)>Math.abs(R)&&(R=H,S=D)}u={x:F.x+S.x*R,y:F.y+S.y*R},I.rectGuide.clear()}else n._inSmartGuide&&!B.Default.isCtrlDown(K)&&(n._adsorbedToClosest(u),r=!0);var P=pn.getDataMatrix(O).applyInverse(u);O.setPoint("P1"===X?0:1,P,!0);var W=O.getPoints(),E=W.get(0),C=W.get(1);a=E.x-C.x,m=E.y-C.y,Q=" "+Math.round(Math.sqrt(a*a+m*m))+" ",r&&(t=O.getRect(),I.rectGuide.gatherLines({node:O,x:t.x,y:t.y,w:t.width,h:t.height}))}if(Q){var c=B.Default.getLogicalPoint(K,I._canvas);c.x+=pn.Icons.TipShiftX,c.y+=pn.Icons.TipShiftY,n.tipInfo={helperPos:c,text:Q,size:Q.length}}n._fireEditEvent("between",K)}},fe.prototype._unionPointMode1=function(d,y,j,S,X){if(X&&j&&S){var c=d.x-y.x,F=d.y-y.y;Math.abs(c*S)<Math.abs(F*j)?(F=Math.sign(F)*Math.abs(c*S/j),d.y=y.y+F):(c=Math.sign(c)*Math.abs(F*j/S),d.x=y.x+c)}return B.Default.unionPoint(d,y)},fe.prototype._unionPointMode2=function(t,p,o,L,u,z){var Y=B.Default.unionPoint(t,p);if(u&&o&&L){var V;"v"===z?(V=Y.x+Y.width/2,Y.width=o*Y.height/L,Y.x=V-Y.width/2):(V=Y.y+Y.height/2,Y.height=L*Y.width/o,Y.y=V-Y.height/2)}return Y},fe.prototype._adsorbedToClosest=function(j,X){var m=this,L=m._interactor,R=L.rectGuide.findClosest(j,X),n=L.gridGuide.findClosest(j,X),K=1/0,C=1/0;R&&(isFinite(R.x)&&(K=R.x),isFinite(R.y)&&(C=R.y)),n&&(isFinite(n.x)&&Math.abs(n.x)<Math.abs(K)&&(K=n.x),isFinite(n.y)&&Math.abs(n.y)<Math.abs(C)&&(C=n.y)),isFinite(K)&&(j.x+=K),isFinite(C)&&(j.y+=C)},fe.prototype._42=function(t,e,b){var s=this;s.info={},s.screenInfo=null;var H=s._interactor;if(!H.editDetail&&s.gatherInfo(e,b)){var M=s.editing,E=M?M.groupRotateMode:null,V=s.screenInfo;"block"!==E&&(V.P1?pn.Icons.DrawIcon(H,t,pn.Icons.Line,V):pn.Icons.DrawIcon(H,t,pn.Icons.Rect,V),V.connect&&(pn.Icons.DrawIcon(H,t,pn.Icons.ConnectGuide,{rotation:V.rotation,connect:V.connect,cursorPos:M?M.cursorPos:null}),M&&(M.targetCorners&&pn.Icons.DrawIcon(H,t,pn.Icons.NodeHoverGuide,M.targetCorners),M.garbageInfo&&pn.Icons.DrawIcon(H,t,pn.Icons.ConnectGuideGarbage,M.garbageInfo))),s.tipInfo&&pn.Icons.DrawIcon(H,t,pn.Icons.TipHelper,s.tipInfo)),s.target instanceof pn.Group&&s.target._42(H,t,e)}};var Ir=pn.Anchor=function(I){this.catalog="Anchor",this._interactor=I};Ir.prototype={},Ir.prototype.constructor=Ir,Ir.prototype.gatherInfo=function(u,c){var p=this;if(1===c.length){var G=c[0];if(!G.getAnchor)return;if(G instanceof B.Shape&&G._70I())return;if(Bh(G,u))return;return p.gatherSingleTarget(u,c[0])}return c.length>1?p.gatherMultiTargets(u,c):!1},Ir.prototype.gatherSingleTarget=function(X,_){var A=this;return A.info.POS=_.getPosition(),A.screenInfo.POS=pn.toScreenPosition(X,A.info.POS),A.target=_,!0},Ir.prototype.gatherMultiTargets=function(X,G){var M=this,W=pn.Group.findOrCreateGroup(G);return W?(M.screenInfo.POS=pn.toScreenPosition(X,W.getAnchor2()),M.target=W,!0):!1},Ir.prototype.isVisible=function(){var U=this,a=U._interactor;if(a.getStyle("anchorVisible")===!1)return!1;var J=U.target;if(J){if(this.editing)return!0;var g=J.getAnchor(),D=a.getStyle("anchorOutsideVisibleThreshold");if(g.x<-D||g.x>1+D||g.y<-D||g.y>1+D)return!0;var L=J.getSize(),H=J.getScale(),d=Math.min(Math.abs(L.width*H.x),Math.abs(L.height*H.y));if(d*a.gv._zoom<a.getStyle("anchorHideThreshold"))return!1}return!0},Ir.prototype.check=function(g,Z,h){if(B.Default.isLeftButton(Z)){var $=this,V=$._interactor;if($.isVisible()&&V.getStyle("anchorMovable")!==!1){$.editing=null,$.tipInfo=null;var l=$.target;if(l&&g.isAnchorEditable(l)&&g.isEditable(l)){var J;if($.screenInfo&&(J=$.screenInfo.POS)&&pn.checkHit(h,new pn.Math.Vector2(J),V.getStyle("checkSize"))){if(l instanceof pn.Group)return $.editing={},!0;var I=l.getWidth(),y=l.getHeight(),k=l.getAnchor();return $.editing={rect:{x:-I*k.x,y:-y*k.y,width:I,height:y},anchor:k,matrix:l.getMatrix()},!0}}}}},Ir.prototype.startEdit=function(M,d){M.startDragging(d),M.fi({kind:"beginEditAnchor",event:d})},Ir.prototype._46O=function($){var u=this;u.editing&&(u.editing=null,u._interactor.fi({kind:"endEditAnchor",event:$})),u.tipInfo=null},Ir.prototype.handleEdit=function(X,W){var H=this,y=H.target;if(y){var K=H.editing;if(K){var q=X.lp(W),t=H._interactor;if(y instanceof pn.Group)return y.setAnchor2(q),t._42(),void 0;var i=K.matrix,L=i.tfi(q),S=K.rect,m=(L.x-S.x)/S.width,A=(L.y-S.y)/S.height;if(!B.Default.isCtrlDown(W)){var u=t.getStyle("anchorRound"),P=t.getStyle("anchorSensitivity");m=pn.roundTo(m,u,P),A=pn.roundTo(A,u,P)}y.setAnchor(m,A,!0);var n=B.Default.getLogicalPoint(W,t._canvas);n.x+=pn.Icons.TipShiftX,n.y+=pn.Icons.TipShiftY;var j=""+m.toFixed(2)+", "+A.toFixed(2);H.tipInfo={helperPos:n,text:j,size:j.length},t.fi({kind:"betweenEditAnchor",event:W})}}},Ir.prototype._42=function(S,M,O){var n=this;n.info={},n.screenInfo={};var k=n._interactor;k.editDetail||n.gatherInfo(M,O)&&n.isVisible()&&(pn.Icons.DrawIcon(k,S,pn.Icons.Anchor,n.screenInfo),n.tipInfo&&pn.Icons.DrawIcon(k,S,pn.Icons.TipHelper,n.tipInfo))};var qs=pn.RotateX=function(Y){this.catalog="RotateX",this._interactor=Y};qs.prototype={},qs.prototype.constructor=qs,qs.prototype.gatherInfo=function(w,C){var i=this;if(1===C.length){var g=C[0];return g instanceof B.Shape&&g._70I()||Bh(g,w)?!1:i.gatherSingleTarget(w,g)}return C.length>1?i.gatherMultiTargets(w,C):!1},qs.prototype.gatherSingleTarget=function(){var Z=new B.Math.Vector2,d=new B.Math.Vector2,u=new B.Math.Vector2,J=new B.Math.Vector2,x=function(a,R){var B=a.x-R.x,x=a.y-R.y;return B*B+x*x};return function(m,F){if(F.getCorners){var D=this,H=F.getCorners(),X=15,V=F.getPosition();Z.copy(H[0]),u.copy(H[1]),J.copy(H[3]),d.copy(Z).add(J).divideScalar(2).add(Z.sub(u).setLength(X/m.getZoom()));var C=Math.max(x(V,H[0]),x(V,H[1]),x(V,H[2]),x(V,H[3]));return D.info.POS=d.clone(),D.screenInfo.POS=pn.toScreenPosition(m,D.info.POS),D.screenInfo.LEN=Math.sqrt(C)*m.getZoom()+X,D.screenInfo.CENTER=pn.toScreenPosition(m,V),D.target=F,!0}}}(),qs.prototype.gatherMultiTargets=function(M,l){var h=this,P=pn.Group.findOrCreateGroup(l);if(!P)return!1;var h=this;return h.gatherSingleTarget(M,P)},qs.prototype.isVisible=function(){var y=this._interactor;if(!y.getStyle("rotateAsClock"))return!1;var e=this.target;if(!e)return!0;var _=y.gv;return _.isEditable(e)&&_.isRotationEditable(e)?!0:!1},qs.prototype.check=function(_,s,u){var o=this,h=o._checkImpl(_,s,u);return(h||o._clockPainted)&&o._interactor._42(),h},qs.prototype._checkImpl=function(H,z,t){if(B.Default.isLeftButton(z)){var P=this;P.editing=null,P.tipInfo=null;var $;if(P.screenInfo&&($=P.screenInfo.POS)&&P.isVisible()){var K=P._interactor;if(pn.checkHit(t,$,K.getStyle("checkSize"))){var R=P.target,D=H.lp(z),n=R.getPosition(),I=Math.atan2(D.y-n.y,D.x-n.x);return K._setRotateCursor(I),P.editing={pos:n,rotation:R.getRotation(),hitRot:I,groupRotateMode:"block",screenInfo:{CENTER:P.screenInfo.CENTER,LEN:P.screenInfo.LEN}},!0}}}},qs.prototype.startEdit=function(F,X){F.startDragging(X),F.fi({kind:"beginEditRotation",event:X}),this.target instanceof pn.Group&&this.target.beginRotate(this.editing)},qs.prototype._46O=function(m){var k=this;k.editing&&(k.editing=null,k._interactor.fi({kind:"endEditRotation",event:m})),k.target instanceof pn.Group&&k.target.endRotate(),k.tipInfo=null},qs.prototype.handleEdit=function(Z,r){var I=this,m=I.editing;if(m){var P,C,c=I.target,G=Z.lp(r),Y=I._interactor,k=m.pos,t=Math.atan2(G.y-k.y,G.x-k.x),a=c instanceof pn.Group;if(a?C=t-m.hitRot:(P=t-m.hitRot,C=m.rotation+P),C%=2*Math.PI,0>C&&(C+=2*Math.PI),!B.Default.isCtrlDown(r)){var l,h;Cj(r)?(l=Y.getStyle("shiftRotateRound"),h=l/2):(l=Y.getStyle("rotateRound"),h=Y.getStyle("rotateSensitivity")),C=pn.roundTo(C,l,h)}a?(P=C-(m.lastRotation||0),0!==P&&(c.addRotation(P,m.groupRotateMode),m.lastRotation=C)):c.setRotation(C),Y._setRotateCursor(t),C>Math.PI&&(C-=2*Math.PI);var O=180*(C/Math.PI),d=""+O.toFixed(2)+"",Q=B.Default.getLogicalPoint(r,Y._canvas);Q.x+=pn.Icons.TipShiftX,Q.y+=pn.Icons.TipShiftY,I.tipInfo={helperPos:Q,text:d,size:d.length},Y.fi({kind:"betweenEditRotation",event:r})}},qs.prototype._42=function(y,L,s){var v=this;v._clockPainted=!1,v.info={},v.screenInfo={};var V=v._interactor;V.editDetail||v.gatherInfo(L,s)&&v.isVisible()&&(pn.Icons.DrawIcon(V,y,pn.Icons.RoundPoint,v.screenInfo.POS),v.tipInfo&&pn.Icons.DrawIcon(V,y,pn.Icons.TipHelper,v.tipInfo),v.editing&&v.drawClock(y))},qs.prototype.drawClock=function(w){w.save();var f=this;f._clockPainted=!0;var A=f.editing||{},D=A.screenInfo||f.screenInfo,L=D.LEN,q=L+8,Q=L+18;w.save(),w.translate(D.CENTER.x,D.CENTER.y),w.beginPath(),w.strokeStyle="rgb(150, 150, 150)";for(var d,C,e,j,m,$=0;360>$;$++)d=$*Math.PI/180,0===$%5&&(C=T(d)*L,e=y(d)*L,j=T(d)*q,m=y(d)*q,w.moveTo(C,e),w.lineTo(j,m)),0===$%45&&(C=T(d)*L,e=y(d)*L,j=T(d)*Q,m=y(d)*Q,w.moveTo(C,e),w.lineTo(j,m));w.stroke(),w.rotate(-H);var F=A.lastRotation||f.target.getRotation();w.beginPath(),w.fillStyle="rgba(255, 0, 0, 0.1)",w.strokeStyle="rgb(157, 157, 157)",w.moveTo(0,0),w.arc(0,0,Q,0,F,!1),w.fill(),w.beginPath(),w.moveTo(0+Q,0),w.arc(0,0,Q,0,F,!1),w.stroke(),w.restore()};var ei=pn.Curve=function(H){this.catalog="Curve",this._interactor=H};ei.prototype={},ei.prototype.constructor=ei,O.defineProperties(ei.prototype,{activing:{get:function(){return this._activing},set:function(g){var o=this;if(g)o._activing=new pn.CurveActiving(this,g);else{var $=o._activing;$&&$.dispose(),o._activing=null}}}}),ei.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},ei.prototype.setUp=function(){var D=this,S=D._interactor;S&&S.gv.mp(D._onGraphviewPropertyChanged,D)},ei.prototype._onGraphviewPropertyChanged=function(M){("zoom"===M.property||"translateX"===M.property||"translateY"===M.property)&&this._handleDataChanged()},ei.prototype.tearDown=function(){var k=this,D=k._interactor;D&&D.gv.ump(k._onGraphviewPropertyChanged,k)},ei.prototype.canEnterEditDetailMode=function(){var F=this,i=F._interactor,J=i._getValidSelection();if(1===J.length){var s=J[0],P=s instanceof B.Edge;if(s instanceof B.Shape||P){if(P){var M=s.s("edge.type");if(M&&"points"!==M)return}var t=i.gv;if(t.isPointEditable(s)&&t.isEditable(s))return F.target=s,!0}}},ei.prototype.canQuitEditDetailMode=function(U){var q=this,J=q._interactor._getLogicalPoint(U);return q._checkEditRealPoint(J)?void 0:q._interactor.gv.getDataAt(U)!==q.target?!0:void 0},ei.prototype.preHandleScroll=function(){var C=this.editing;return C&&C.inEdit?!0:void 0},ei.prototype.getCurrentSelectintStatus=function(){var B=this;if(B.activing&&!B.activing.selections){if(B.activing.status!=n)return B.activing.status;var Q=function(o){var t=B.activing.status;B.activing.status=o,B._interactor.fp("shapePointStatus",t,o)},p=pn.Curve.PointType,D=B.activing.point,e=B.activing.pairs;if(!e||1!==e.length)return Q(p.Mirrored);var W=e[0],G=W.c1&&W.c1.isNearEnough(D),k=W.c2&&W.c2.isNearEnough(D);if(!W.c1||!W.c2)return G||k?Q(p.Straight):Q(p.Disconnected);if(G&&k)return Q(p.Straight);if(G||k)return Q(p.Asymmetric);var F=W.c1.clone().sub(D),C=W.c2.clone().sub(D);return Math.abs(F.x*C.y-F.y*C.x)>1e-5||F.x*C.x>0?Q(p.Disconnected):Math.abs(F.length()-C.length())>1e-5?Q(p.Asymmetric):Q(p.Mirrored)}},ei.prototype.handle_keydown=function(Y){var l=this;if(l._interactor.editDetail){var p=pn.Curve.PointType;"1"===Y.key?l._setCurrentSelectionStatus(p.Straight):"2"===Y.key?l._setCurrentSelectionStatus(p.Mirrored):"3"===Y.key?l._setCurrentSelectionStatus(p.Disconnected):"4"===Y.key&&l._setCurrentSelectionStatus(p.Asymmetric)}},ei.prototype.setCurrentSelectionStatus=function(n){var S=this,R=S._interactor;if(R){var u=R.gv;u.dm().beginTransaction(),this._setCurrentSelectionStatus(n),u.dm().endTransaction()}},ei.prototype._setCurrentSelectionStatus=function(d){var s=this,j=s.activing;if(j){var n=s.getCurrentSelectintStatus();if(null!==n&&n!==d){j.status=d;var R=s.activing.point,I=s.activing.pairs;if(I&&1===I.length){var Z=I[0],z=s.screenInfo.curve,W=pn.Curve.PointType,y=function(){s._writeToHt(),s._interactor.fp("shapePointStatus",n,d)};if(d===W.Straight)return z.moveCtrlPoint(Z,R,"c1"),z.moveCtrlPoint(Z,R,"c2"),y(),void 0;if(n===W.Straight){var t=z.findPairs(R,!0),u=t[0],N=u.r1||R,f=u.r2||R,M=f.clone().sub(N).multiplyScalar(.25);return z.moveCtrlPoint(Z,R.clone().sub(M),"c1"),z.moveCtrlPoint(Z,R.clone().add(M),"c2"),y(),void 0}var J=Z.c1,c=Z.c2;if(J&&c){if(d===W.Mirrored)return z.moveCtrlPoint(Z,R.clone().multiplyScalar(2).sub(c),"c1"),y(),void 0;if(d===W.Asymmetric&&n===W.Disconnected){var b=J.clone().sub(R).length(),M=R.clone().sub(c).setLength(b).add(R);return z.moveCtrlPoint(Z,M,"c1"),y(),void 0}}j._firePointChange(),s._interactor.fp("shapePointStatus",n,d)}}}},ei.prototype._handleDataChanged=function(X){var n=this;if(n.screenInfo&&n.target){var I=n._interactor;n.gatherSingleTarget(I.gv,n.target,!0),n.check(I.gv,null,X?I._getLogicalPoint(X):new pn.Math.Vector2(I._lastClientPoint)),I._42()}},ei.prototype.gatherSingleTarget=function(Y,J,x){var T,H,L=this;L.screenInfo&&L.screenInfo.curve&&(H=L.screenInfo.curve._curves);var D=L.editing;T=D?L.screenInfo:L.screenInfo={};var e,m,d=J instanceof B.Edge;d?(e=J.s("edge.segments"),m=J.s("edge.points")||new B.List):(e=J._58O,m=J._59O),T.S=e;var N,W=T.P=[],S=pn.getDataMatrix(J);if(J instanceof B.Polyline&&(N=J.getElevation()||0,T.E=[]),m.each(function(e){T.E&&T.E.push(e.e||N),e=S.apply(e);var U=pn.toScreenPosition(Y,e);W.push(U.x,U.y)}),d){var w=pn.toScreenPosition(Y,J._lastSourcePoint),n=pn.toScreenPosition(Y,J._lastTargetPoint);W.splice(0,0,w.x,w.y),W.push(n.x,n.y)}if(!T.S||!T.S.size()){T.S=new B.List,T.S.add(1);for(var t=0;t<W.length/2-1;t++)T.S.add(2)}if((!D||x)&&L.convertToCubicBezier(H),L.activing&&(x||!L.editing||"realPoint"===L.editing.type)){var M=T.curve.findPairs(L.activing.point);L.activing.pairs=M}d&&"points"!==J.s("edge.type")&&L._writeToHt()},ei.prototype._convertToNewPoint=function(w,m,A){var z,M,v;for(z=0,M=m.length;M>z;z++){if(v=m[z],v._p1.isNearEnough(w))return v._p1;if(v._p4.isNearEnough(w))return v._p4}if(A)for(z=0,M=Math.min(A.length,M);M>z;z++){if(v=A[z],v._p1===w)return m[z]._p1;if(v._p4===w)return m[z]._p4}},ei.prototype.convertToCubicBezier=function(e){var A,E,n=this,m=new pn.Math.Curve,D=n.screenInfo;if(m.createFromHtShape(D.P,D.S,D.E),D.curve=m,n.activing){var C=m._curves;if(A=n.activing.point,E=n._convertToNewPoint(A,C,e),E&&(n.activing.point=E),n.activing.selections){var h=-1,L=n.activing.selections;L.forEach(function(A){h++,E=n._convertToNewPoint(A,C,e),E&&(L[h]=E)})}}},ei.prototype.check=function(F,w,_){if(!w||B.Default.isLeftButton(w)){var T=this;if(T._interactor.setCursor("default"),T.editing=null,T.highlight=null,T.tipInfo=null,T.screenInfo){if(dg())return T._interactor._42(),!0;if(T._checkEditCtrlPoint(_))return T._interactor._42(),!0;if(T._checkEditRealPoint(_))return T._interactor._42(),!0;if(T._checkEditElevation(_))return T._interactor._42(),!0;var J=T.screenInfo.curve,o=J.checkPoint(_,T._interactor.getStyle("curveIntersectSize"));if(o){var v=T.highlight={};v.type="insertKnot",v.bezier=o.bezier,v.point=o.intersection}return T._interactor._42(),!0}}},ei.prototype._checkEditRealPoint=function(W){var i,r,M,q,c,U,p=this,k=p.screenInfo.curve._curves,R=p._interactor.getStyle("curvePointIntersectSize"),$=1/0;for(R*=R,M=0,q=k.length;q>M;M++)i=k[M],c=i._p1,U=W.distanceToSquared(c),$>U&&($=U,r=c),c=i._p4,U=W.distanceToSquared(c),$>U&&($=U,r=c);if($>R)return!1;var S=p.highlight={};return S.type="changeRealPoint",S.point=r,p.editing={type:"realPoint",point:r,shiftGuide:{point:r.clone(),dir:"x",limit:0}},p._interactor.setCursor("crosshair"),!0},ei.prototype._checkEditElevation=function(K){var y=this;if(!y._interactor.getStyle("curveElevationVisible"))return!1;var E=y.activing;if(!E)return!1;var v=E.getCurrentEditingPoint();if(!v)return!1;var M=y._interactor,T=M.getStyle("curveElevationGuideShift"),w=M.getStyle("curveElevationIntersectSize"),N=K.distanceToSquared({x:v.x+T[0],y:v.y+T[1]});if(!(N>w*w)){var s=y.highlight={};s.type="elevation";var b=new pn.Math.Vector2(K.x,K.y,v.e);return y.editing={type:"elevation",startPoint:b},y._interactor.setCursor("crosshair"),!0}},ei.prototype._checkEditCtrlPoint=function(r){var i=this;if(i.activing&&!i.activing.selections){var d=i.getCurrentSelectintStatus();if(d!==pn.Curve.PointType.Straight){var W=i.activing.pairs;if(W){var $=i._interactor.getStyle("curvePointIntersectSize");$*=$;var z,E,q,A,H,w,f,Y,F,h=1/0;for(f=0,F=W.length;F>f;f++)for(A=W[f],Y=0;2>Y;Y++)H=0===Y?"c1":"c2",A[H]&&(w=r.distanceToSquared(A[H]),h>w&&(h=w,z=A,E=f,q=H));if(h>$)return!1;i.activing.hlpair=z,i.activing.hltype=q;var T=i.highlight={};return T.type="changeCtrlPoint",T.point=z[q],i.editing={type:"ctrlPoint",pair:z,pairId:E,ctrlType:q,direction:z[q].clone().sub(i.activing.point).normalize()},i._interactor.setCursor("crosshair"),!0}}}},ei.prototype.startEdit=function(N,v){N.startDragging(v);var x=this;x.highlight&&"insertKnot"===x.highlight.type&&(x.insertKnot(),x.gatherSingleTarget(x._interactor.gv,x.target),x.activing=null,x._checkEditRealPoint(x._interactor._getLogicalPoint(v)));var R=x._activing;if(R){var F=x.editing?x.editing.type:null;"ctrlPoint"===F?R.editingCtrl={pairId:x.editing.pairId,type:R.hltype}:"realPoint"===F&&(R.editingCtrl=!1)}var Z=x.highlight,W=B.Default.isCtrlDown(v);if(!Z||dg()){var L=x._interactor.gv;if(!L.setFocus(v)||L._scrolling)return;return L.isPannable()&&rq(v)&&!W&&(x._pan={tx:L.tx(),ty:L.ty()},N.fi({kind:"beginPan",event:v})),void 0}if("changeRealPoint"===Z.type){var r,e=x.activing?x.activing.point:null,q=x.activing?x.activing.selections:null;if(W&&x.activing)e===Z.point?(q?(x.activing={point:q[0]},q.length>1&&(q.splice(0,1),x.activing.selections=q)):x.activing=null,x.editing=null):q&&(r=q.indexOf(Z.point))>=0?(q.length>1?q.splice(r,1):delete x.activing.selections,x.editing=null):q?(q.push(e),x.activing={point:Z.point,selections:q}):x.activing={point:Z.point,selections:[e]};else if(q)e===Z.point||((r=q.indexOf(Z.point))>=0?(q.splice(r,1,e),x.activing={point:Z.point,selections:q}):x.activing={point:Z.point});else{var o;e===Z.point&&(o=x.activing.status),x.activing={point:Z.point},o&&(x.activing.status=o)}N.fi({kind:"beginEditPoint",event:v})}},ei.prototype.insertKnot=function(){var Z=this,J=Z.highlight,b=Z.screenInfo.curve;b.insertKnot(J.bezier,J.point.t),Z._writeToHt()},ei.prototype._writeToHt=function(){var U,H,O,b,w=this,F=w.screenInfo.curve,E=F.toHtShape(),v=E.points,Q=[],z=E.segments,t=w._interactor.gv,l=w.target,I=l instanceof B.Edge,C=pn.getDataMatrix(l).invert();b=l instanceof B.Polyline,b&&(O=l.getElevation());for(var T=0,A=v.length;A>T;T++)U=v[T],H=pn.toWorldPosition(t,U),H=C.apply(H),U.e!=n&&U.e!==O&&(H.e=U.e),Q.push(H);if(l._writing=!0,I){l.s("edge.type","points"),l.setStyle("edge.segments",z),l.setStyle("edge.points",Q.slice(1,Q.length-1)),l.setStyle("edge.source.offset.x",0),l.setStyle("edge.source.offset.y",0),l.setStyle("edge.target.offset.x",0),l.setStyle("edge.target.offset.y",0);var x=w._nextChangeEdgeHost;delete w._nextChangeEdgeHost,x&&("source"===x.type?l.setSource(x.host):l.setTarget(x.host)),w._writeEdgeHostAnchor("source",Q[0]),w._writeEdgeHostAnchor("target",Q[Q.length-1])}else Q.length?(l.setSegments(z),l.setPoints(Q,!0)):l.removeFromDataModel();delete l._writing},ei.prototype._writeEdgeHostAnchor=function(R,m){var Z=this,v=Z.target,$=Z._calcHostAnchor(v,R,m);v.s("edge."+R+".anchor.x",$.x),v.s("edge."+R+".anchor.y",$.y),$.offsetX||$.offsetY?(v.s("edge."+R+".offset.x",$.offsetX),v.s("edge."+R+".offset.y",$.offsetY)):(v.s("edge."+R+".offset.x",0),v.s("edge."+R+".offset.y",0))},ei.prototype._calcHostAnchor=function(q,w,f,N){N||(N="source"===w?q.getSource():q.getTarget());var u=this._interactor.gv,i=u.calculateAttachPoint(N,f);if(i)return i.info;var U=N.getRotation(),v=N.getAnchor();if(Bh(N,u)&&(U=0),U){var B=N.getMatrix(),P=B.tfi(f),D=N.getSize();return{x:P.x/D.width+v.x,y:P.y/D.height+v.y}}var R=Or(u,N),O={x:(f.x-R.x)/R.width,y:(f.y-R.y)/R.height};return O},ei.prototype._handlePanning=function(T){var G=this,y=G._pan;if(y){y.started=!0;var F=G._interactor,n=F.gv,x=F._lastClientPoint,a=Rb(T);n.setTranslate(y.tx+a.x-x.x,y.ty+a.y-x.y),G.gatherSingleTarget(F.gv,G.target),F._42(),F.fi({kind:"betweenPan",event:T})}},ei.prototype.handleEdit=function(Z,z){var R=this,W=R.editing;if(R._pan)return R._handlePanning(z),void 0;if(W){W.inEdit=!0;var x,f,X,u=R._interactor._getLogicalPoint(z),i=B.Default.isCtrlDown(z),s=B.Default.isShiftDown(z),E=W.type,I=R.activing;if(R._guideInfo=null,"ctrlPoint"===E&&s){var g=R.editing.direction.clone();x=I.point;var A=g.dot(u.clone().sub(x));u=g.setLength(A).add(x)}else if("ctrlPoint"===E||"realPoint"===E){var g;if("realPoint"===E&&s){var o=R.editing.shiftGuide;f=o.point;var d=Math.abs(u.x-f.x),L=Math.abs(u.y-f.y);d>L&&d>o.limit&&"y"===o.dir&&(o.dir="x"),L>d&&L>o.limit&&"x"===o.dir&&(o.dir="y"),g=o.dir,"x"===g?(u.y=f.y,o.limit=Math.max(o.limit,d)):"y"===g&&(u.x=f.x,o.limit=Math.max(o.limit,L))}var b=R._isEditEdgeSourceTarget();if(b){var T=R._editEdgeSourceTarget(b,u,i);T&&(X=T.tipText)}else if(!i){var c=R._guidingToEdit(u,g),P="realPoint"===E?R._interactor.gridGuide.findClosest(u,g,!0):null,C=1/0,O=1/0;P&&(P.x&&(C=P.x),P.y&&(O=P.y));var N=!1;c&&(c.xList&&(Math.abs(c.x)<=Math.abs(C)?(N=!0,C=c.x):delete c.xList),c.yList&&(Math.abs(c.y)<=Math.abs(O)?(N=!0,O=c.y):delete c.yList),N&&(R._guideInfo=c)),isFinite(C)&&(u.x+=C),isFinite(O)&&(u.y+=O),N&&(c.v=u)}}var h=R.screenInfo.curve;if("realPoint"===W.type){x=W.point,x.e!==n&&(u.e=x.e),h.moveRealPoint(x,u),W.point=u,R.highlight.point=u;var Q=I.status,S=I.selections;if(R.activing={point:u,status:Q},S){var V=u.clone().sub(x),D=0;S.forEach(function(Z){var L=Z.clone().add(V);h.moveRealPoint(Z,L),S[D++]=L}),R.activing.selections=S}}else if("ctrlPoint"===W.type){var _=I.pairs,j=_[W.pairId];h.moveCtrlPoint(j,u,W.ctrlType);var U=I.status,q=pn.Curve.PointType;if((U===q.Mirrored||U===q.Asymmetric)&&j.c1&&j.c2){var x=new pn.Math.Vector2(I.point),v="c1"===W.ctrlType?"c2":"c1";if(U===pn.Curve.PointType.Mirrored)h.moveCtrlPoint(j,x.clone().multiplyScalar(2).sub(u),v);else if(U===q.Asymmetric){var A=j[v].clone().sub(x).length(),Y=x.clone().sub(j[W.ctrlType]).setLength(A).add(x);isNaN(Y.x)||h.moveCtrlPoint(j,Y,v)}}I._firePointChange()}else if("elevation"===W.type){f=W.startPoint;var J=f.e+(f.y-u.y)/Z._zoom;R._setCurrentPointImpl("e",J),I._firePointChange(),X="E: "+pn.toFixed(J)}var M=B.Default.getLogicalPoint(z,R._interactor._canvas);if(M.x+=pn.Icons.TipShiftX,M.y+=pn.Icons.TipShiftY,!X){var K=pn.toWorldPosition(Z,u);X=""+pn.toFixed(K.x)+", "+pn.toFixed(K.y)}R.tipInfo={helperPos:M,text:X,size:X.length},R._writeToHt(),R._interactor.fi({kind:"betweenEditPoint",event:z})}},ei.prototype._setCurrentPointImpl=function(D,r){var T=this,$=T._activing;if(!$)return!1;var N=T.target;if(!N)return!1;var l=$.getCurrentEditingPoint();if(!l)return!1;var J=$.editingCtrl;if(!J)var a=l.clone();if("e"===D)l.e=r;else{var S;if("x"===D||"y"===D){var d=$._lastFirePoint;S="x"===D?{x:r,y:d?d.y:0}:{x:d?d.x:0,y:r}}else"object"==typeof D?(S=D,D.e!==n&&(l.e=D.e)):(S={x:arguments[0],y:arguments[1]},arguments[2]!==n&&(l.e=arguments[2]));var y=pn.getDataMatrix(N);S=pn.toScreenPosition(T._interactor.gv,y.apply(S)),l.x=S.x,l.y=S.y}if(!J){var b=a.multiplyScalar(-1).add(l);l.e&&a.e&&(b.e=l.e-a.e),T.screenInfo.curve.moveCtrlDueToRealPointMovement(l,b)}return!0},ei.prototype.setCurrentPoint=function(Q,O){return this._setCurrentPointImpl(Q,O)?(this._writeToHt(),!0):!1},ei.prototype._isEditEdgeSourceTarget=function(){var i=this,U=i.target;if(!(U instanceof B.Edge))return!1;var W=i.editing.point,d=i.screenInfo.curve._curves;return W===d[0]._p1?"source":W===d[d.length-1]._p4?"target":!1},ei.prototype._editEdgeSourceTarget=function(n,u,V){var e,K=this,r=K.target;if(e="source"===n?r.getSource():r.getTarget()){var N=K._interactor.gv,p=pn.toWorldPosition(N,u),U=K._calcHostAnchor(r,n,p,e);if(K._interactor.getStyle("edgeHostDetectPerFrame")||U.x<0||U.x>1||U.y<0||U.y>1){var s=N.getDataAt(p,function(i){return N.isSelectable(i)?fk(i)?!0:!1:!1});if(s){var q=K._calcHostAnchor(r,n,p,s);e=s,K._nextChangeEdgeHost={type:n,host:s},U=q}}var W;if(!V){var M=K._interactor.getStyle("anchorRound"),w=K._interactor.getStyle("anchorSensitivity");W=N.calculateAttachPoint(e,p),W?U=W.info:(U.x=pn.roundTo(U.x,M,w),U.y=pn.roundTo(U.y,M,w))}if(!V){var I=e.getAttachPosition(U.x,U.y,U.offsetX,U.offsetY),f=pn.toScreenPosition(N,I);u.x=f.x,u.y=f.y}K._edgeHostGuideInfo={corners:pn.getTargetCornersOnScreen(N,e),attach:W?W.index:-1,host:e};var J=""+U.x.toFixed(2)+", "+U.y.toFixed(2);return(U.offsetX||U.offsetY)&&(J+=" offset: "+U.offsetX.toFixed(2)+", "+U.offsetY.toFixed(2)),{host:e,anchor:U,tipText:J}}},ei.prototype._guidingToEdit=function(P,C){var z,u,h=this;if(z=h.screenInfo.curve){u=z._curves;var s,Y,R,e,F,K,O,A,L=1/0,o=1/0,E=[];for(h.editing&&"realPoint"===h.editing.type&&(A=h.editing.point),F=0,K=2*u.length;K>F;F++)O=u[Math.floor(F/2)][F%2?"_p4":"_p1"],E.indexOf(O)>=0||(E.push(O),A&&A===O||(R=O.x-P.x,e=O.y-P.y,Math.abs(R)<Math.abs(L)?(L=R,s=[O]):R===L&&s.push(O),Math.abs(e)<Math.abs(o)?(o=e,Y=[O]):e===o&&Y.push(O)));var f=h._interactor.getStyle("smartGuideSensitivity");if((Math.abs(L)>f||"y"===C)&&(s=null),(Math.abs(o)>f||"x"===C)&&(Y=null),s||Y){var X=!1,x={};if(s&&(X=!0,x.xList=s,x.x=L),Y&&(X=!0,x.yList=Y,x.y=o),X)return x}}},ei.prototype._46O=function(i){var p=this;p.editing&&(p.editing=null,p._interactor.fi({kind:"endEditPoint",event:i})),p._guideInfo=null,p._edgeHostGuideInfo=null,p._pan&&(p._pan=null,p._interactor.fi({kind:"endPan",event:i})),p.tipInfo=null},ei.prototype._canDeletePoint=function(g,V){var K=this.target;if(!(K instanceof B.Edge))return!0;var J=g._curves[0],l=g._curves[g._curves.length-1];return J._p1===V||l._p4===V?!1:!0},ei.prototype.handleDelete=function(){var k=this;if(k.activing&&k.screenInfo){var V=B.Default.isShiftDown(),M=k.screenInfo.curve;k._canDeletePoint(M,k.activing.point)&&M.deleteRealPoint(k.activing.point,V),k.activing.selections&&k.activing.selections.forEach(function($){k._canDeletePoint(M,$)&&M.deleteRealPoint($,V)}),k.activing=null,delete k.editing,delete k.tipInfo,delete k._pan,k._writeToHt(),k._interactor.fp("deleteShapePoint",!1,!0)}},ei.prototype.handleDoubleClick=function(n){var i=this,B=i._interactor._getLogicalPoint(n);if(i.screenInfo&&i._checkEditRealPoint(B)){var E=i.getCurrentSelectintStatus(),Y=pn.Curve.PointType;return E=E===Y.Mirrored?Y.Straight:Y.Mirrored,i._setCurrentSelectionStatus(E),i._interactor._42(),!0}},ei.prototype._drawHighlight=function(k){var B=this,p=B.highlight;if(p){var i=p.bezier,r=B._interactor;i&&pn.Icons.DrawIcon(r,k,pn.Icons.ShapeHighlightCurve,[i._p1.x,i._p1.y,i._p2.x,i._p2.y,i._p3.x,i._p3.y,i._p4.x,i._p4.y]);var I=p.point;
I&&"insertKnot"===p.type&&pn.Icons.DrawIcon(r,k,pn.Icons.ShapeHighlighPoint,I)}},ei.prototype._drawGuide=function(f){var b=this,k=b._guideInfo;if(k){var n,e,N,C,Q=k.v;for(n=0;2>n;n++)if(C=0===n?k.xList:k.yList)for(e=0,N=C.length;N>e;e++)pn.Icons.DrawIcon(b._interactor,f,pn.Icons.ShapeGuideLine,[Q.x,Q.y,C[e].x,C[e].y])}},ei.prototype._drawCurrentPoint=function(M){var L=this;if(L.activing){var s=L.activing,j=L.getCurrentSelectintStatus(),$=L._interactor;if(j!==pn.Curve.PointType.Straight){var v=s.pairs;s.hlpair,s.hltype;var F=s.selections,W=s.editingCtrl;if(v&&!F){var Z,I,r;for(I=0,r=v.length;r>I;I++)Z=v[I],W&&I===W.pairId&&Z[W.type]?pn.Icons.DrawIcon($,M,pn.Icons.ShapeActivingCtrl,{point:Z.point,c1:Z.c1,c2:Z.c2,hl:W.type}):pn.Icons.DrawIcon($,M,pn.Icons.ShapeActivingCtrl,Z)}}pn.Icons.DrawIcon($,M,pn.Icons.ShapeHighlighRealPoint,L.activing.point),F&&F.forEach(function(l){pn.Icons.DrawIcon($,M,pn.Icons.ShapeHighlighRealPoint,l)})}},ei.prototype.clear=function(){var j=this;j.editing=null,j._guideInfo=null,j.activing=null,j.highlight=null},ei.prototype._42=function(A){var b=this;b.info={},b.editing||(b.screenInfo=null);var _=b._interactor;if(!_.editDetail)return b.clear(),void 0;var g=_.gv;if(!b.target||!g.isSelected(b.target)||!g.isVisible(b.target))return _.editDetail=!1,b.clear(),void 0;if(b.gatherSingleTarget(g,b.target),pn.Icons.DrawIcon(_,A,pn.Icons.ShapeBgCurve,b.screenInfo),b._drawHighlight(A),b._drawCurrentPoint(A),b._getRealPoint().forEach(function(X){pn.Icons.DrawIcon(_,A,pn.Icons.ShapePoint,X)}),b._drawGuide(A),b.tipInfo&&pn.Icons.DrawIcon(_,A,pn.Icons.TipHelper,b.tipInfo),b._edgeHostGuideInfo){pn.Icons.DrawIcon(_,A,pn.Icons.NodeHoverGuide,b._edgeHostGuideInfo.corners);var o=b._edgeHostGuideInfo.host;if(o){var e=g.getAttachPoints(o);if(e&&e.length)for(var W=0,f=e.length;f>W;W++){var z=e[W],y=o.getAttachPosition(z.x,z.y,z.offsetX,z.offsetY);y=pn.toScreenPosition(g,y),y.isAttach=b._edgeHostGuideInfo.attach===W,pn.Icons.DrawIcon(_,A,pn.Icons.AttachPoint,y)}}}if(b._interactor.getStyle("curveElevationVisible")&&b.target instanceof B.Polyline&&b.activing){var E=b.activing.getCurrentEditingPoint();E&&pn.Icons.DrawIcon(_,A,pn.Icons.EdgeElevationGuide,E)}},ei.prototype._getRealPoint=function(){var p,R=this.screenInfo,T=R.P,o=R.S,Y=-1,s=[],$=-1,z=o.length;return o.each(function(v){$++;var M=1;if(3===v)M=2;else if(4===v)M=3;else if(5===v)return;Y+=M,p=$+1>=z?!0:1===o.get($+1)?!0:!1,s.push({point:{x:T[2*Y],y:T[2*Y+1]},segmentIndex:$,pointIndex:Y,isEnd:p})}),s},ei.prototype.getEditingPointsInfo=function(P){var k=this,Q=k.activing;if(!Q)return!1;var i=Q.point;if(!i)return!1;var G=this._getRealPoint(),L=[{screen:i}];Q.selections&&Q.selections.forEach(function($){L.push({screen:$})});var r,h,C=G.length;return L.forEach(function(V){for(r=0;C>r;r++)if(h=G[r],V.screen.isNearEnough(h.point)){V.segmentIndex=h.segmentIndex,V.pointIndex=h.pointIndex,V.point=k.target.getPoints().get(h.pointIndex);break}}),P&&L.sort(function(K,B){return K.segmentIndex-B.segmentIndex}),L};var Pe=pn.MoveHelper=function(N){var I=this;I.catalog="Move",I._interactor=N};Pe.prototype={},Pe.prototype.constructor=Pe,Pe.prototype.calcShift=function(v,D,S){var d,C,e=this,I=e._interactor.gv,y=I.lp(D);if("beginMove"===v&&e._gatherGridInfo(S._lastLogicalPoint||y),d=e._target){var c=d.downPosition;if(c){var V=e._interactor.getStyle("moveSensitivity")/I._zoom;if(c.distanceTo(y)<V)return{x:0,y:0};delete d.downPosition}var H;C=B.Default.isShiftDown(D),C&&(y=e._dealShiftDown(y),H=d.shiftGuide.dir);var j,g=d.rawPos={x:d.pos.x+y.x-d.lp.x,y:d.pos.y+y.y-d.lp.y};if(B.Default.isCtrlDown(D)){if(j=e._calcShiftByAddon(),e._target.node instanceof pn.Group){var f=e._target.node;f._position.x+=j.x,f._position.y+=j.y}return j}for(var r,T=d.x+g.x,z=d.y+g.y,F={x:T,y:z},Y={x:T+d.w/2,y:z+d.h/2},E={x:T+d.w,y:z+d.h},G=e._interactor.rectGuide,m=e._interactor.gridGuide,q=[G.findClosest(F,H),G.findClosest(Y,H),G.findClosest(E,H),m.findClosest(F,H),m.findClosest(Y,H),m.findClosest(E,H)],$=1/0,W=1/0,s=0,Z=q.length;Z>s;s++)r=q[s],r&&(T=r.x,z=r.y,isFinite(T)&&Math.abs(T)<Math.abs($)&&($=T),isFinite(z)&&Math.abs(z)<Math.abs(W)&&(W=z));if(isFinite($)||($=0),isFinite(W)||(W=0),j=e._calcShiftByAddon($,W),e._target.node instanceof pn.Group){var f=e._target.node;f._position.x+=j.x,f._position.y+=j.y}var x=d.node;if(!Bh(x,I)){var O=g.x+$,p=g.y+W;e._interactor.rectGuide.gatherLines({node:x,x:d.x+O,y:d.y+p,w:d.w,h:d.h},H)}return j}},Pe.prototype._calcShiftByAddon=function(q,D){var X=this._target,y=X.rawPos,w=X.node.getPosition();return q=q||0,D=D||0,{x:y.x-w.x+q,y:y.y-w.y+D}},Pe.prototype._dealShiftDown=function(t){var y=this,i=y._target.shiftGuide,f=y._target.lp,D=Math.abs(t.x-f.x),x=Math.abs(t.y-f.y);D>x&&D>i.limit&&"y"===i.dir&&(i.dir="x"),x>D&&x>i.limit&&"x"===i.dir&&(i.dir="y");var F=i.dir;return"x"===F?(t.y=f.y,i.limit=Math.max(i.limit,D)):"y"===F&&(t.x=f.x,i.limit=Math.max(i.limit,x)),t},Pe.prototype._gatherGridInfo=function(E){var O,Y=this,F=Y._interactor,W=F._getValidSelection();if(W.length){if(1===W.length){if(O=W[0],!O.getRect)return Y._target=null,void 0}else if(O=pn.Group.findOrCreateGroup(W),!O)return Y._target=null,void 0}else{var W=F.gv.sm().getSelection();if(W.length&&(O=W.get(0),!O.getRect))return Y._target=null,void 0}var g=O.getPosition(),K=O.getRect();Y._target={node:O,x:K.x-g.x,y:K.y-g.y,w:K.width,h:K.height,lp:{x:E.x,y:E.y},pos:{x:g.x,y:g.y},shiftGuide:{dir:"x",limit:0},downPosition:new pn.Math.Vector2(E)},F.rectGuide.gatherRects()},Pe.prototype.clear=function(){var w=this;w._interactor.rectGuide.clear(),w._interactor._42()};var ys="directional",Eh="point",Qm="spot",am="light.color",cm=function(Y,h){Qo(h)&&$n.test(h)?pj(Y,h):Kq(h)&&h.modelType?ye(Y,h):Ee[Y]=h},xe=function(I){if(Kq(I))return I.modelType?I.uuid?Ee[I.uuid]:(I.uuid=B.Math.generateUUID(),ye(I.uuid,I),n):I;var V=Ee[I];return I&&V===n&&$n.test(I)&&(pg&&pg[I]||pj(I,I)),V};yp($,{graph3dViewAttributes:E,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:t/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:uf,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:t/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:cm,getShape3dModel:xe,createMatrix:function(e,t){Km(e)||(e=[e]);for(var Y=e.length-1;Y>=0;Y--){var V=e[Y];t=gb(V.mat,V.s3,V.r3,V.rotationMode,V.t3,t)}return t},transformVec:function(A,K){return _b(A,K)},createBoxModel:function(){return{vs:_o,ns:Ec,uv:Wq,is:xp}},createRoundRectModel:function(J,l){return io.roundRect(J,l)},createStarModel:function(K,b){return io.star(K,b)},createRectModel:function(M,g){return io.rect(M,g)},createTriangleModel:function(i,W){return io.triangle(i,W)},createRightTriangleModel:function(s,j){return io.rightTriangle(s,j)},createParallelogramModel:function(u,R){return io.parallelogram(u,R)},createTrapezoidModel:function(m,I){return io.trapezoid(m,I)},createSmoothSphereModel:function(d,M,r,t,c,I,T){return jd(new ce(d,M,r,t,c,I,T))},createSphereModel:function(b,y,N,K,J,W){return b?nm(b,y,N,K,J,W):$.createSmoothSphereModel()},createSmoothConeModel:function(Z,W,f,E,F){return ol(Z,W,f,E,F)},createConeModel:function(A,X,V,H,K,a){return A?Fc(A,X,V,H,K,a):ol(a)},createSmoothCylinderModel:function(L,D,S,u,t,p,U,E){return jd(new pq(L,D,S,u,t,p,U,E))},createCylinderModel:function(u,h,S,t,K,v,F){return u?_f(u,h,S,t,K,v,F):Tj(v,F)},createSmoothTorusModel:function(V,B,T,N,n,a){return jd(new nb(V,B,T,N,n,a))},createTorusModel:function(Q,W,k,s,e,l,N){return Q?qc(Q,W,k,s,e,l,N):Ii(l,N)},createExtrusionModel:function(k,O,u,C,X,R,N,B){return $l(k,O,u,C,X,R,N,B)},createSmoothRingModel:function(Y,i,s,l,a,F){for(var z=[],v=0;v<Y.length-1;v+=2)z.push({x:Y[v],y:Y[v+1]});for(Y=vm(z,i,s)[0],z=[],v=0;v<Y.length;v++){var P=Y[v];z.push(new rb(P.x,0,P.y))}return jd(new Ln(z,F,l,a))},createTextGeometry:function(Q,T){return jd(new zb(Q,T))},loadFontFace:function(H,t){$.xhrLoad(H,function(A){if(!A)return t();var N;try{N=JSON.parse(A)}catch(Z){N=JSON.parse(A.substring(65,A.length-2))}hc.loadFace(N),t&&t(N.familyName.toLowerCase())},t?null:{sync:!0})},createRingModel:function(H,r,Y,v,z,b,t,C,N,K){for(var g=[],i=0;i<H.length-1;i+=2)g.push({x:H[i],y:H[i+1]});b=b||$.shapeSide,t=t||0,C=C||b;var U,D,m,L,S,h,W,J,V,w,i,l,k,u,p,R,n,Q,F=[],X=[],B=N?[]:E,s=N?[]:E,_=K?[]:E,O=K?[]:E,M=v?[]:E,d=v?[]:E,Z=z?[]:E,e=z?[]:E,H=vm(g,r,Y),f=kf(H),A=0,c=2*Math.PI/b;return H.forEach(function(H){if(m=H.length,m>1){if(L=H[0],v)for(h=L.x,J=L.y,i=t;C>i;i++)l=i+1,k=i*c,u=l*c,p=T(k),R=y(k),n=T(u),Q=y(u),M.push(p*h,J,-R*h,n*h,J,-Q*h,0,J,0),d.push(.5-.5*p,.5-.5*R,.5-.5*n,.5-.5*Q,.5,.5);for(w=0;m>w;w++){for(S=H[w],h=L.x,W=S.x,J=L.y,V=S.y,U=A/f,A+=gn(L,S),D=A/f,i=t;C>i;i++)l=i+1,k=i*c,u=l*c,p=T(k),R=y(k),n=T(u),Q=y(u),F.push(p*W,V,-R*W,n*W,V,-Q*W,p*h,J,-R*h,n*W,V,-Q*W,n*h,J,-Q*h,p*h,J,-R*h),X.push(i/b,D,l/b,D,i/b,U,l/b,D,l/b,U,i/b,U),N&&i===t&&(B.push(0,J,0,0,V,0,p*W,V,-R*W,p*W,V,-R*W,p*h,J,-R*h,0,J,0),s.push(0,.5-J,0,.5-V,2*W,.5-V,2*W,.5-V,2*h,.5-J,0,.5-J)),K&&l===C&&(_.push(0,J,0,n*W,V,-Q*W,0,V,0,n*W,V,-Q*W,0,J,0,n*h,J,-Q*h),O.push(1,.5-J,1-2*W,.5-V,1,.5-V,1-2*W,.5-V,1,.5-J,1-2*h,.5-J));L=S}if(z)for(h=L.x,J=L.y,i=t;C>i;i++)l=i+1,k=i*c,u=l*c,p=T(k),R=y(k),n=T(u),Q=y(u),Z.push(n*h,J,-Q*h,p*h,J,-R*h,0,J,0),e.push(.5-.5*n,.5+.5*Q,.5-.5*p,.5+.5*R,.5,.5)}}),{vs:F,uv:X,bottom_vs:Z,bottom_uv:e,top_vs:M,top_uv:d,from_vs:B,from_uv:s,to_vs:_,to_uv:O}}},!0),yp(r,{"3d.move.mode":n,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":n,"edge.gradient.color":n,"edge.source.t3":n,"edge.target.t3":n,"light.type":Eh,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":t/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":dq,"wf.short":!1,"wf.mat":n,"wf.geometry":!1,batch:n,"transparent.mask":!1,brightness:n,"select.brightness":.7,"repeat.uv.length":n,alphaTest:.4,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"shape3d.vector.dynamic.maxsize":2048,"label.face":Gr,"label.t3":n,"label.r3":n,"label.texture.scale":2,"label.rotationMode":Lo,"label.light":!1,"label.blend":n,"label.reverse.flip":!1,"label.reverse.color":cb,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Gr,"label2.t3":n,"label2.r3":n,"label2.texture.scale":2,"label2.rotationMode":Lo,"label2.light":!1,"label2.blend":n,"label2.reverse.flip":!1,"label2.reverse.color":cb,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Gr,"note.t3":n,"note.r3":n,"note.texture.scale":2,"note.rotationMode":Lo,"note.light":!1,"note.blend":n,"note.reverse.flip":!1,"note.reverse.color":cb,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Gr,"note2.t3":n,"note2.r3":n,"note2.texture.scale":2,"note2.rotationMode":Lo,"note2.light":!1,"note2.blend":n,"note2.reverse.flip":!1,"note2.reverse.color":cb,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:n,"shape3d.color":Gl,"shape3d.top.color":n,"shape3d.bottom.color":n,"shape3d.from.color":n,"shape3d.to.color":n,"shape3d.image":n,"shape3d.top.image":n,"shape3d.bottom.image":n,"shape3d.from.image":n,"shape3d.to.image":n,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":n,"shape3d.side.to":n,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":n,"shape3d.opacity":n,"shape3d.reverse.flip":!1,"shape3d.reverse.color":cb,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":n,"shape3d.uv.scale":n,"shape3d.top.uv.offset":n,"shape3d.top.uv.scale":n,"shape3d.bottom.uv.offset":n,"shape3d.bottom.uv.scale":n,"shape3d.from.uv.offset":n,"shape3d.from.uv.scale":n,"shape3d.to.uv.offset":n,"shape3d.to.uv.scale":n,"shape3d.top.cap":n,"shape3d.bottom.cap":n,"shape3d.start.angle":0,"shape3d.sweep.angle":f,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":n,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":Gl,"all.image":n,"all.blend":n,"all.opacity":n,"all.reverse.flip":!1,"all.reverse.color":cb,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":n,"all.uv.offset":n,"all.uv.scale":n,"all.discard.selectable":!0,mat:n,"left.mat":n,"right.mat":n,"top.mat":n,"bottom.mat":n,"front.mat":n,"back.mat":n},!0);var ih,gp=!1,$e=[0,0,0,0],Lc={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Pi,2:tl,3:Ui,4:Ki,5:Gr,6:hq}},Jp=function(Q,C,_,I){if(C.getFaceVisible(Q,_)){Yl(C,fl(Q,C.getFaceMat(Q,_)||C.getMat(Q)));var U=C._26I;C.getFaceReverseCull(Q,_)?U.enable(U.CULL_FACE):U.disable(U.CULL_FACE),dn(U,C._prg.uFixPickReverseColor,Lc[_]),$h(U),Cb(U,I,6),Nj(U),Wp(C)}},Pl=function(A){return A instanceof ff},hb=function(V){return[V.x,V.e||0,V.y]},li=function(y,i,O){for(var i=oo(i),v=i[0],V=i[1],h=i[2];O--;)y.push(v,V,h)},bh=function(h,e,n){for(var e=oo(e),l=e[0],R=e[1],E=e[2],j=e[3];n--;)h.push(l,R,E,j)},Th=function(b,X,G){if(X)for(var T,I,K,g=X[0],O=X[1],z=X[2],k=X[4],H=X[5],L=X[6],V=X[8],m=X[9],Y=X[10],P=X[12],u=X[13],Q=X[14],c=G.length,j=0,j=0;c>j;j+=3)T=G[j],I=G[j+1],K=G[j+2],b.push(g*T+k*I+V*K+P,O*T+H*I+m*K+u,z*T+L*I+Y*K+Q);else mb(b,G)},Ud=function(X,c){var K=c.s("light.intensity"),d=oo(c.s(am)),h=d[0],T=d[1],q=d[2];1!==K&&(h*=K,T*=K,q*=K),X.push(h,T,q,c.s("light.disabled")?1:0)},On=function(Q,A,q){dn(A,q.uHeadlightRange,Q._headlightRange);var d=Q._headlightIntensity,o=oo(Q._headlightColor);1!==d&&(o=[o[0]*d,o[1]*d,o[2]*d]),dn(A,q.uHeadlightColor,[o[0],o[1],o[2],Q._headlightDisabled?1:0]);var x=Q._59O,p=Q._spots,P=Q._dirs;if(x.length){var t=[],u=[],B=[];x.forEach(function(p){Ud(t,p),mb(u,Q._transformPointToViewSpace(p.p3())),B.push(p.s("light.range"))}),A.uniform4fv(q.uPointColor,t),A.uniform1fv(q.uPointRange,B),A.uniform3fv(q.uPointPosition,u)}if(p.length){var l=[],Y=[],U=[],J=[],D=[],_=[];p.forEach(function(N){Ud(l,N),mb(Y,Q._transformPointToViewSpace(N.p3())),mb(D,Q._transformDirectionToViewSpace(N.p3(),N.s("light.center"))),U.push(N.s("light.range")),J.push(T(N.s("light.angle")/2)),_.push(N.s("light.exponent"))}),A.uniform4fv(q.uSpotColor,l),A.uniform1fv(q.uSpotRange,U),A.uniform1fv(q.uSpotAngle,J),A.uniform1fv(q.uSpotExponent,_),A.uniform3fv(q.uSpotPosition,Y),A.uniform3fv(q.uSpotDirection,D)}if(P.length){var W=[],j=[];P.forEach(function(v){Ud(W,v),mb(j,Q._transformDirectionToViewSpace(v.p3()))}),A.uniform4fv(q.uDirColor,W),A.uniform3fv(q.uDirDirection,j)}},Vj=function(M){return M>0&&0===(M-1&M)},$q=function(F){return F=N(0,s(t,F)),F=N(Yk,s(t-Yk,F))},ci=function(){return.05+I()/2},Rm=function(y,f,E,U){var w,H=y.getEye();return y.isOrtho()?(w=qi(y.getCenter(),H),w[0]+=U[0],w[1]+=U[1],w[2]+=U[2]):w=H,mg(f,E,U,w)},mg=function(W,I,V,s){var p=il(W,I),e=qi(s,V,!0),G=il(e,I);if(F(G)<Yk)return E;var u=(p-il(V,I))/G;return[V[0]+e[0]*u,V[1]+e[1]*u,V[2]+e[2]*u]},Te=function(x,V){return{x:2*x.x-V.x,y:2*x.y-V.y}},Ze=function(o,b,h,u){var F,$;if(!o)return F=U(b.y-h.y,h.x-b.x),{x:b.x+u*y(F),y:b.y+u*T(F)};if(!h)return F=U(o.y-b.y,b.x-o.x),{x:b.x+u*y(F),y:b.y+u*T(F)};var e=qi([o.x,o.y,0],[b.x,b.y,0],!0),w=qi([h.x,h.y,0],[b.x,b.y,0],!0),R=-(e[0]+w[0])/2,p=-(e[1]+w[1])/2,j=i(R*R+p*p);if(Yk>j)return F=U(o.y-b.y,b.x-o.x),{x:b.x+u*y(F),y:b.y+u*T(F)};var J=o.x-b.x,l=o.y-b.y,G=h.x-b.x,v=h.y-b.y,Q=i(J*J+l*l),z=i(G*G+v*v);F=g(il(e,w))/2,$=e[1]*w[0]-e[0]*w[1]>0?-1:1,R/=j,p/=j;var m=u/y(F),k=N(Q,z)/T(F);j=Math.min(m,k);var H={x:b.x+$*j*R,y:b.y+$*j*p};return h.b&&m>z/T(F)&&(H.adjust=!0),H},kq=function(r){var k=r[1],T=r[2],B=r[3],n=r[6],O=r[7],f=r[11];r[1]=r[4],r[2]=r[8],r[3]=r[12],r[4]=k,r[6]=r[9],r[7]=r[13],r[8]=T,r[9]=n,r[11]=r[14],r[12]=B,r[13]=O,r[14]=f},ch=function(F){var J=F[0],p=F[1],n=F[2],i=F[3],o=F[4],m=F[5],M=F[6],z=F[7],r=F[8],W=F[9],G=F[10],t=F[11],x=F[12],j=F[13],S=F[14],Z=F[15],q=J*m-p*o,u=J*M-n*o,Y=J*z-i*o,f=p*M-n*m,y=p*z-i*m,R=n*z-i*M,L=r*j-W*x,h=r*S-G*x,C=r*Z-t*x,l=W*S-G*j,$=W*Z-t*j,e=G*Z-t*S,O=q*e-u*$+Y*l+f*C-y*h+R*L;return O?(O=1/O,F[0]=(m*e-M*$+z*l)*O,F[1]=(n*$-p*e-i*l)*O,F[2]=(j*R-S*y+Z*f)*O,F[3]=(G*y-W*R-t*f)*O,F[4]=(M*C-o*e-z*h)*O,F[5]=(J*e-n*C+i*h)*O,F[6]=(S*Y-x*R-Z*u)*O,F[7]=(r*R-G*Y+t*u)*O,F[8]=(o*$-m*C+z*L)*O,F[9]=(p*C-J*$-i*L)*O,F[10]=(x*y-j*Y+Z*q)*O,F[11]=(W*Y-r*y-t*q)*O,F[12]=(m*h-o*l-M*L)*O,F[13]=(J*l-p*h+n*L)*O,F[14]=(j*u-x*f-S*q)*O,F[15]=(r*f-W*u+G*q)*O,void 0):E},Qf=function(J,Y){if(Y){var f=Y[0],p=Y[1],R=Y[2];J[12]=J[0]*f+J[4]*p+J[8]*R+J[12],J[13]=J[1]*f+J[5]*p+J[9]*R+J[13],J[14]=J[2]*f+J[6]*p+J[10]*R+J[14],J[15]=J[3]*f+J[7]*p+J[11]*R+J[15]}},Kc=function(j,C){if(C){var o=C[0],u=C[1],z=C[2];j[0]=j[0]*o,j[1]=j[1]*o,j[2]=j[2]*o,j[3]=j[3]*o,j[4]=j[4]*u,j[5]=j[5]*u,j[6]=j[6]*u,j[7]=j[7]*u,j[8]=j[8]*z,j[9]=j[9]*z,j[10]=j[10]*z,j[11]=j[11]*z}},so=function(k,W,G){var f=W[0],l=W[1],Y=W[2],n=W[3],p=W[4],q=W[5],O=W[6],U=W[7],x=W[8],g=W[9],S=W[10],B=W[11],o=W[12],D=W[13],H=W[14],I=W[15],a=G[0],j=G[1],E=G[2],w=G[3];return k[0]=a*f+j*p+E*x+w*o,k[1]=a*l+j*q+E*g+w*D,k[2]=a*Y+j*O+E*S+w*H,k[3]=a*n+j*U+E*B+w*I,a=G[4],j=G[5],E=G[6],w=G[7],k[4]=a*f+j*p+E*x+w*o,k[5]=a*l+j*q+E*g+w*D,k[6]=a*Y+j*O+E*S+w*H,k[7]=a*n+j*U+E*B+w*I,a=G[8],j=G[9],E=G[10],w=G[11],k[8]=a*f+j*p+E*x+w*o,k[9]=a*l+j*q+E*g+w*D,k[10]=a*Y+j*O+E*S+w*H,k[11]=a*n+j*U+E*B+w*I,a=G[12],j=G[13],E=G[14],w=G[15],k[12]=a*f+j*p+E*x+w*o,k[13]=a*l+j*q+E*g+w*D,k[14]=a*Y+j*O+E*S+w*H,k[15]=a*n+j*U+E*B+w*I,k},Fm=function(Z,x,G,l){var D,A,I,_,s,v,k,e,X,H,p=x[0],V=x[1],h=x[2],r=l[0],S=l[1],j=l[2],a=G[0],t=G[1],U=G[2];return F(p-a)<Yk&&F(V-t)<Yk&&F(h-U)<Yk?wo(Z):(k=p-a,e=V-t,X=h-U,H=1/i(k*k+e*e+X*X),k*=H,e*=H,X*=H,D=S*X-j*e,A=j*k-r*X,I=r*e-S*k,H=i(D*D+A*A+I*I),H?(H=1/H,D*=H,A*=H,I*=H):(D=0,A=0,I=0),_=e*I-X*A,s=X*D-k*I,v=k*A-e*D,H=i(_*_+s*s+v*v),H?(H=1/H,_*=H,s*=H,v*=H):(_=0,s=0,v=0),Z[0]=D,Z[1]=_,Z[2]=k,Z[3]=0,Z[4]=A,Z[5]=s,Z[6]=e,Z[7]=0,Z[8]=I,Z[9]=v,Z[10]=X,Z[11]=0,Z[12]=-(D*p+A*V+I*h),Z[13]=-(_*p+s*V+v*h),Z[14]=-(k*p+e*V+X*h),Z[15]=1,Z)},go=function(s,C,n,o,D){var m=1/L(C/2),A=1/(o-D);return s[0]=m/n,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=m,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=(D+o)*A,s[11]=-1,s[12]=0,s[13]=0,s[14]=2*D*o*A,s[15]=0,s},lh=function(g,N,a,d,D,X,o){var R=1/(N-a),B=1/(d-D),Z=1/(X-o);return g[0]=-2*R,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=-2*B,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=2*Z,g[11]=0,g[12]=(N+a)*R,g[13]=(D+d)*B,g[14]=(o+X)*Z,g[15]=1,g},hh=function(m,d){var N=d[0],k=d[1],A=d[2],X=d[3],w=N*N+k*k+A*A+X*X,F=w?1/w:0;return m[0]=-N*F,m[1]=-k*F,m[2]=-A*F,m[3]=X*F,m},Um=function(C,y){var d=y[0]+y[5]+y[10],r=0;return d>0?(r=2*Math.sqrt(d+1),C[3]=.25*r,C[0]=(y[6]-y[9])/r,C[1]=(y[8]-y[2])/r,C[2]=(y[1]-y[4])/r):y[0]>y[5]&y[0]>y[10]?(r=2*Math.sqrt(1+y[0]-y[5]-y[10]),C[3]=(y[6]-y[9])/r,C[0]=.25*r,C[1]=(y[1]+y[4])/r,C[2]=(y[8]+y[2])/r):y[5]>y[10]?(r=2*Math.sqrt(1+y[5]-y[0]-y[10]),C[3]=(y[8]-y[2])/r,C[0]=(y[1]+y[4])/r,C[1]=.25*r,C[2]=(y[6]+y[9])/r):(r=2*Math.sqrt(1+y[10]-y[0]-y[5]),C[3]=(y[1]-y[4])/r,C[0]=(y[8]+y[2])/r,C[1]=(y[6]+y[9])/r,C[2]=.25*r),C},Zl=function(A,z,t){var J=z[0],_=z[1],U=z[2],e=z[3],x=J+J,I=_+_,i=U+U,q=J*x,s=J*I,W=J*i,h=_*I,Z=_*i,p=U*i,k=e*x,C=e*I,d=e*i;return A[0]=1-(h+p),A[1]=s+d,A[2]=W-C,A[3]=0,A[4]=s-d,A[5]=1-(q+p),A[6]=Z+k,A[7]=0,A[8]=W+C,A[9]=Z-k,A[10]=1-(q+h),A[11]=0,A[12]=t[0],A[13]=t[1],A[14]=t[2],A[15]=1,A},Xp=function(){var b=[0,0,0],t=[0,0,0],c=[0,0,0],f=function(r,U,t){r[0]=U[1]*t[2]-U[2]*t[1],r[1]=U[2]*t[0]-U[0]*t[2],r[2]=U[0]*t[1]-U[1]*t[0]},U=function(w){return w[0]*w[0]+w[1]*w[1]+w[2]*w[2]},K=function(M){var o=Math.sqrt(U(M));M[0]/=o,M[1]/=o,M[2]/=o},h=function(L,l,x){L[0]=l[0]-x[0],L[1]=l[1]-x[1],L[2]=l[2]-x[2]};return function(s,g,T){var e=ig();return h(c,s,g),0===U(c)&&(c[2]=1),K(c),f(b,T,c),0===U(b)&&(1===Math.abs(T[2])?c[0]+=1e-4:c[2]+=1e-4,K(c),f(b,T,c)),K(b),f(t,c,b),e[0]=b[0],e[4]=t[0],e[8]=c[0],e[1]=b[1],e[5]=t[1],e[9]=c[1],e[2]=b[2],e[6]=t[2],e[10]=c[2],e}}(),Fq=function($,g){if($.vr.enable){var i=$.vr.getViewMatrix(g);if(i)return i}return Fm(g?g:ig(),$._eye,$._center,$._up)},Il=function(U){if(U.vr.enable){var c=U.vr.getProjectMatrix();if(c)return c}var d=U.getAspect(),w=U._near,$=U._far,G=ig();if(U._ortho){var M=U._orthoWidth/2,n=M/d;lh(G,-M,M,-n,n,w,$)}else go(G,U._fovy,d,w,$);return G},jp=function(T,m){if(!T)return E;var O=0,L=1,W=2,h=[],j=0,$=T.length,y=$/3;if(m){for(;$>j;j++)h[j]=0;for(j=0;j<m.length;j+=3){var Q=[],F=[],H=[];Q[O]=T[3*m[j+1]+O]-T[3*m[j]+O],Q[L]=T[3*m[j+1]+L]-T[3*m[j]+L],Q[W]=T[3*m[j+1]+W]-T[3*m[j]+W],F[O]=T[3*m[j+2]+O]-T[3*m[j+1]+O],F[L]=T[3*m[j+2]+L]-T[3*m[j+1]+L],F[W]=T[3*m[j+2]+W]-T[3*m[j+1]+W],H[O]=Q[L]*F[W]-Q[W]*F[L],H[L]=Q[W]*F[O]-Q[O]*F[W],H[W]=Q[O]*F[L]-Q[L]*F[O];for(var d=0;3>d;d++)h[3*m[j+d]+O]+=H[O],h[3*m[j+d]+L]+=H[L],h[3*m[j+d]+W]+=H[W]}}else for(j=0;y>j;j+=3){var Q=[],F=[],H=[];Q[O]=T[3*(j+1)+O]-T[3*j+O],Q[L]=T[3*(j+1)+L]-T[3*j+L],Q[W]=T[3*(j+1)+W]-T[3*j+W],F[O]=T[3*(j+2)+O]-T[3*(j+1)+O],F[L]=T[3*(j+2)+L]-T[3*(j+1)+L],F[W]=T[3*(j+2)+W]-T[3*(j+1)+W],H[O]=Q[L]*F[W]-Q[W]*F[L],H[L]=Q[W]*F[O]-Q[O]*F[W],H[W]=Q[O]*F[L]-Q[L]*F[O];for(var d=0;3>d;d++)h[3*(j+d)+O]=H[O],h[3*(j+d)+L]=H[L],h[3*(j+d)+W]=H[W]}for(j=0;$>j;j+=3){var u=[];u[O]=h[j+O],u[L]=h[j+L],u[W]=h[j+W];var I=i(u[O]*u[O]+u[L]*u[L]+u[W]*u[W]);0===I&&(I=Yk),u[O]=u[O]/I,u[L]=u[L]/I,u[W]=u[W]/I,h[j+O]=u[O],h[j+L]=u[L],h[j+W]=u[W]}return new Vi(h)},fb=function(H,A,a,D){if(a||(a=H.createTexture()),A){var K=H.TEXTURE_2D,R=H.REPEAT,h=H.CLAMP_TO_EDGE,k=H.TEXTURE_MIN_FILTER;D!==H.NEAREST&&(D=H.LINEAR),Yn(H,a),H.texImage2D(K,0,H.RGBA,H.RGBA,H.UNSIGNED_BYTE,A),Ek(H,H.TEXTURE_MAG_FILTER,D);var C=A.naturalWidth||A.width,L=A.naturalHeight||A.height;Vj(C)&&Vj(L)&&!A.clampToEdge?(Ek(H,H.TEXTURE_WRAP_S,R),Ek(H,H.TEXTURE_WRAP_T,R),Ek(H,k,H.LINEAR_MIPMAP_LINEAR),H.generateMipmap(K)):(Ek(H,H.TEXTURE_WRAP_S,h),Ek(H,H.TEXTURE_WRAP_T,h),Ek(H,k,D)),Yn(H,E)}return a},Ge=function(l,N){var V=new Uint8Array(4);return N=N||l.createTexture(),Yn(l,N),Ek(l,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,V),N},sd=function(r){r._26I&&r._prg&&(r._26I.deleteProgram(r._prg),r._prg=E)},Jn=function(K,I,j,i){var A=K.createShader(j);return K.shaderSource(A,i),K.compileShader(A),K.attachShader(I,A),A},us=function(D){return D.createBuffer()},Yn=function(C,z){C.bindTexture(C.TEXTURE_2D,z)},Up=function(k,R){k.frameStack?k.frameStack.push(R):k.frameStack=[R],k.bindFramebuffer(k.FRAMEBUFFER,R)},Hc=function(R){var s=R.frameStack;if(s){if(s.pop(),s.length)return R.bindFramebuffer(R.FRAMEBUFFER,s[s.length-1]),void 0;R.frameStack=null}R.bindFramebuffer(R.FRAMEBUFFER,null)},Ek=function(J,X,T){J.texParameteri(J.TEXTURE_2D,X,T)},wj=function(L,T){L.enable(L.POLYGON_OFFSET_FILL),L.polygonOffset(T[0],T[1])},Vo=function(e){e.disable(e.POLYGON_OFFSET_FILL)},ar=function(I,N){if(N){var N=oo(N);I.clearColor(N[0],N[1],N[2],N[3])}},bj=function(R,h){dn(R,h.uFix,!0),Zb(R,h.aNormal)},Od=function(r,N){dn(r,N.uFix,!1),Bg(r,N.aNormal)},Si=function(J,y,p,G,T,X,D,M){J._picking||(p?(dn(J,y.uBlend,!0),dn(J,y.uBlendColor,p)):dn(J,y.uBlend,!1),dn(J,y.uLight,G==E?!0:G),Ib(T)&&1!==T&&dn(J,y.uPartOpacity,T),dn(J,y.uReverseFlip,X==E?!1:X),dn(J,y.uFixPickReverseColor,D||cb)),M?J.enable(J.CULL_FACE):J.disable(J.CULL_FACE)},kc=function(I,h){I._picking||dn(I,h.uPartOpacity,1)},$h=function(){var G=[0,0,1,1];return function(o,X,u,z,N,H,I,M,O){return u?(dn(o,X.uTexture,!0),dn(o,X.uDiscardSelectable,Uf(z)?z:!0),Bg(o,X.aUv),Nr(o,N,H,X.aUv,2),O?(dn(o,X.uBlendTexture,!0),o.activeTexture(o.TEXTURE1),Yn(o,O),o.uniform1i(X.uBlendSampler,1)):(dn(o,X.uBlendTexture,!1),o.activeTexture(o.TEXTURE1),Yn(o,o._emptyBlendTexture)),o.activeTexture(o.TEXTURE0),Yn(o,u),o.uniform1i(X.uSampler,0),I?(G[0]=I[0],G[1]=I[1]):(G[0]=0,G[1]=0),M?(G[2]=M[0],G[3]=M[1]):(G[2]=1,G[3]=1),dn(o,X.uOffsetScale,G),void 0):(o.activeTexture(o.TEXTURE0),Yn(o,o._emptyTexture),o.activeTexture(o.TEXTURE1),Yn(o,o._emptyBlendTexture),void 0)}}(),Nj=function(M,Z,c){M.activeTexture(M.TEXTURE0),Yn(M,E),M.activeTexture(M.TEXTURE1),Yn(M,E),c&&(Zb(M,Z.aUv),dn(M,Z.uTexture,!1),dn(M,Z.uBlendTexture,!1))},Uk=function(w,V,J,B,E,s){!J||b||gf||w.lineWidth(J),B&&!w._picking&&dn(w,V.uFixPickReverseColor,B),E&&Nr(w,E,s,V.aPosition)},cn=function(P,i,m,$){ih&&($=P[ih]),P.drawArrays($==E?P.TRIANGLES:$,i,m);var H=P._renderInfo;H&&(H.calls++,H.vertices+=m,($==E||$===P.TRIANGLES)&&(H.faces+=m/3),$===P.LINES&&(H.lines+=m/2))},Cb=function(L,H,h,z){ih&&(z=L[ih]),L.drawElements(z==E?L.TRIANGLES:z,h,L.UNSIGNED_SHORT,H==E?0:2*H);var l=L._renderInfo;l&&(l.calls++,l.vertices+=h,(z==E||z===L.TRIANGLES)&&(l.faces+=h/3),z===L.LINES&&(l.lines+=h/2))},os=function(G,I,F,t,j){var H=G.ARRAY_BUFFER;G.bindBuffer(H,I),F&&G.bufferData(H,F,G.STATIC_DRAW),t!=E&&G.vertexAttribPointer(t,j?j:3,G.FLOAT,!1,0,0)},Nr=function(C,T,U,Z,s){return U?(yj(C,C.ARRAY_BUFFER,T,U),Z!=E&&C.vertexAttribPointer(Z,s?s:3,C.FLOAT,!1,0,0),void 0):os(C,T,U,Z,s)},kd=function(G,_,o){var l=G.ELEMENT_ARRAY_BUFFER;G.bindBuffer(l,_),o&&G.bufferData(l,o,G.STATIC_DRAW)},Op=function(i,w,G){yj(i,i.ELEMENT_ARRAY_BUFFER,w,G)},yj=function(y,Z,A,D){var k=D._bufId;k||(k=D._bufId=B.Math.generateIncreasingID());var A,N=y._bufPool;(A=N[k])&&A._buf?y.bindBuffer(Z,A._buf):(A=N[k]={_buf:us(y)},y.bindBuffer(Z,A._buf),y.bufferData(Z,D,y.STATIC_DRAW)),A._fid=y._renderInfo.frame},dn=function(H,d,S){if(S!=E&&d!=E){S=oo(S);var R=S.length;3===R?H.uniform3fv(d,S):4===R?H.uniform4fv(d,S):16===R?H.uniformMatrix4fv(d,!1,S):Uf(S)?H.uniform1i(d,S?1:0):2===R?H.uniform2fv(d,S):H.uniform1f(d,S)}},Bg=function(F,j){j!=E&&j>=0&&F.enableVertexAttribArray(j)},Zb=function(T,g){g!=E&&g>=0&&T.disableVertexAttribArray(g)},Wp=function($,L){var v=$.getGL(),O=$._prg;$._7O=$._8O.pop(),L&&(dn(v,O.uMVMatrix,$._7O),$._6O=L,dn(v,O.uNMatrix,L))},Ub=function(_,r){return r||(r=ig()),Ld(r,_),ch(r),kq(r),r},Yl=function(N,m){var P=N.getGL(),t=N._prg,c=N._7O;m&&(N._8O.push(bk(c)),dn(P,t.uMMatrix,m),so(c,c,m),N._7O=c),dn(P,t.uMVMatrix,c),dn(P,t.uNMatrix,Ub(c,N._6O))},Db=function(e,Y,g,A,n,h){if(g){if(A){var V=g.value++,$=2147483648|V,f=[(255&$>>16)/255,(255&$>>8)/255,(255&$)/255,(255&$>>24)/255];g[V]={data:n,part:h}}else f=$e;return dn(e,Y.uFixPickReverseColor,f),f}},wp=function(){var b={center:function(D,p,y,I,a){var S=-p[1]/2,O={x:-p[0]/2,y:S,width:p[0],height:p[1]},P=Vq(D,O,y);return[P.x+I,-P.y-a,ci()]},front:function(g,t,Q,o,S){var n=-t[1]/2,D={x:-t[0]/2,y:n,width:t[0],height:t[1]},r=Vq(g,D,Q);return[r.x+o,-r.y-S,t[2]/2+ci()]},back:function(u,x,s,Z,B){var Q=-x[0]/2,K=-x[1]/2,U={x:Q,y:K,width:x[0],height:x[1]},r=Vq(u,U,s);return[-r.x-Z,-r.y-B,-x[2]/2-ci()]},left:function(S,d,Q,R,k){var r=-d[1]/2,D={x:-d[2]/2,y:r,width:d[2],height:d[1]},K=Vq(S,D,Q);return[-d[0]/2-ci(),-K.y-k,K.x+R]},right:function(m,L,y,A,I){var e=-L[2]/2,s=-L[1]/2,n={x:e,y:s,width:L[2],height:L[1]},U=Vq(m,n,y);return[L[0]/2+ci(),-U.y-I,-U.x-A]},top:function(s,r,J,j,i){var k={x:-r[0]/2,y:-r[2]/2,width:r[0],height:r[2]},d=Vq(s,k,J);return[d.x+j,r[1]/2+ci(),d.y+i]},bottom:function(p,t,F,Y,A){var H=-t[2]/2,X={x:-t[0]/2,y:H,width:t[0],height:t[2]},V=Vq(p,X,F);return[V.x+Y,-t[1]/2-ci(),-V.y-A]}};return function(F,D,A,P,X,U){return b[P](F,D,A,X||0,U||0)}}(),tj=function(j,M,r,K,m,S,z,s,x,D){if(m&&(M[0]+=m[0],M[1]+=m[1],M[2]+=m[2]),Qf(j,r),s){var W=ig();if(ao(W,x,D),_b(M,W),Qf(j,M),j.auto=s,j.pos=_b([0,0,0],j),S){var b=j.mat2=ig();ao(b,S,z)}}else ao(j,x,D),Qf(j,M),K===Pi?qm(j,-H):K===tl?qm(j,H):K===Ui?Oq(j,-H):K===Ki?Oq(j,H):K===hq&&qm(j,t),ao(j,S,z);return j},Ck=function(n,Z){var F=Z.auto,g=Z.mat2,b=n.gv;if(F){var r,q=ig(),N=[0,0,0,0];r="string"==typeof F?[F.indexOf("x")<0?b._eye[0]:b._center[0],F.indexOf("y")<0?b._eye[1]:b._center[1],F.indexOf("z")<0?b._eye[2]:b._center[2]]:b._eye,Um(N,Fm(ig(),r,b._center,b._up)),Zl(q,hh(N,N),Z.pos),g&&so(q,q,g),Yl(b,q)}else Yl(b,Z)},zp=function(f,I,A,s,B){var g=f.s,$=f.gv,k=$.getGL(),w=$._prg,t=$._buffer,z=$._1O;fb(k,_n,z),Ck(f,A),Si(k,w,g(I+".blend"),g(I+".light"),g(I+".opacity"),g(I+".reverse.flip"),g(I+".reverse.color"),g(I+".reverse.cull")),$h(k,w,z,B,t.uv,Zj),Nr(k,t.vs,s,w.aPosition),Nr(k,t.ns,sg,w.aNormal),Op(k,t.is,tm),Cb(k,0,tm.length),Nj(k,w,z),kc(k,w),Wp($)},tn=function(i,f,B){var w=i.gv,G=i.data,N=i[f]={blend:w.getBodyColor(G)||w.getFaceBlend(G,f),light:w.getFaceLight(G,f),color:w.getFaceColor(G,f),opacity:w.getFaceOpacity(G,f),transparent:w.getFaceTransparent(G,f),reverseFlip:w.getFaceReverseFlip(G,f),reverseColor:w.getFaceReverseColor(G,f),reverseCull:w.getFaceReverseCull(G,f),texture:w.getFaceImage(G,f),blendTexture:w.getFaceBlendImage(G,f),discardSelectable:w.getFaceDiscardSelectable(G,f)};if("csg"!==f){N.uv=w.getFaceUv(G,f)||B&&B[f+"Uv"],N.uvScale=w.getFaceUvScale(G,f)||B&&B[f+"UvScale"],N.uvOffset=w.getFaceUvOffset(G,f)||B&&B[f+"UvOffset"];var Y=w.getFaceMat(G,f);Y&&(N.mat=fl(G,Y))}return N},qk=function(v,U,h,P,Z){if(P){if(!Z(P.transparent))return;var V=v.data,y=v.gv,H=y._buffer,C=y.getTexture(P.texture,V),B=y.getTexture(P.blendTexture,V);$h(U,h,C,P.discardSelectable,H.uv,P.tuv,P.uvOffset,P.uvScale,B),Si(U,h,P.blend,P.light,P.opacity,P.reverseFlip,P.reverseColor,P.reverseCull),dn(U,h.uDiffuse,P.color||r["color.empty"]),Nr(U,H.vs,P.vs,h.aPosition),Nr(U,H.ns,P.ns,h.aNormal),cn(U,0,P.vs.length/3),kc(U,h),Nj(U,h,C)}},qq=function(p,j,R,C,T,V){var Q,X,i,Z,w,n,N,$,S,H,Y,g=[C-j,T-R],L=p?p.length:0;for(i=0;L>i;i++){for(Z=2,Q=p[i],w=Q[0],n=Q[1];Z+1<Q.length;){if(N=Q[Z],$=Q[Z+1],X=oh(j,R,C,T,w,n,N,$,!0)){S=[N-w,$-n],H=gn(S),S[0]/=H,S[1]/=H,H=il(g,S),H=H>0?V:-V,Y=[S[0]*H,S[1]*H];break}w=N,n=$,Z+=2}if(Y)break}if(Y)for(C=j+Y[0],T=R+Y[1],i=0;L>i;i++)for(Z=2,Q=p[i],w=Q[0],n=Q[1];Z+1<Q.length;){if(N=Q[Z],$=Q[Z+1],X=oh(j,R,C,T,w,n,N,$,!0))return[0,0];w=N,n=$,Z+=2}return Y?Y:[C-j,T-R]},Ip=B.graph3d={},Bp=function(p,k,I){yr(J+".graph3d."+p,k,I)},Kd="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",_r="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
yp($,{setBatchInfo:function(x,v){he[x]=v},getBatchInfo:function(S){return he[S]}},!0);var Yc=[1,1,1],Hp=[1,0,0,0,0,1,0,1,1,1,1,0],Nb=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],jc=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],nr=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Mh=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],pm=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],rp=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Ne=function(X,U){Ik(X,U,"_batchModelMap","_batchIndexMap"),ck(X,U,"_wireframeModelMap","_wireframeIndexMap"),ck(X,U,"_polylineModelMap","_polylineIndexMap"),ck(X,U,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),ck(X,U,"_polylineModelMapSwap","_polylineIndexMapSwap")},Ik=function(A,O,u,m){if(!O)return A[u]={},A[m]={},void 0;var c=O._id,M=A[m],R=M[c];if(R){var H=A[u],Z=R.batch,f=H[Z],B=f.ds,b=R.index;if(f.invalidate=!0,delete M[c],B.splice(b,1),wk(B))return delete H[Z],void 0;for(var K=R.begin,W=R.size,$=3*K,p=3*W,z=4*K,k=4*W,L=f.vs,j=f.ps,l=f.uv,v=f.cs,o=f.bs,h=f.rs,i=f.ns,D=f.ls;b<B.length;b++)R=M[B[b]._id],R.index--,R.begin-=W;L.splice($,p),j.splice(z,k),l&&l.splice(2*K,2*W),v&&v.splice(z,k),o&&o.splice($,p),h&&h.splice(K,W),i&&i.splice($,p),D&&D.splice(K,W)}},ck=Ik,_m=function(I,P,_,t){if(!t)return E;var o=P[t];if(!o){var c=he[t]||mf,u=c.image?[]:E;o=P[t]={vs:[],ns:[],uv:u,cs:u?E:c.color?E:[],bs:c.blend?[]:E,ps:[],rs:c.brightness?[]:E,ds:[]}}return o.invalidate=!0,I[_._id]={index:o.ds.length,begin:o.vs.length/3,batch:t},o.ds.push(_),o},cg=function(P,y){return y!=E&&1!==y?[P[0]*y,P[1]*y,P[2]*y,P[3]]:P},Ti=function(y,C,E){var u=y.getBrightness(C),M=oo(E.color||"white"),G=M[3]<1,x=Math.ceil(E.width)||1,L=(G?"T":"O")+x,l=y._wireframeIndexMap,I=y._wireframeModelMap,J=I[L];J||(J=I[L]={vs:[],cs:[],ps:[],ds:[],T:G,W:x});var h,r=y.getData3dUI(C),Y=Mb(r);if(E.geometry){if(!Y)return;if(h=ns(Y),!h)return}else h=E.short?dh:Tk;J.invalidate=!0;var R=J.vs,d=J.cs,V=J.ds,Q=l[C._id]={index:V.length,begin:R.length/3,batch:L};V.push(C);var X=fl(C,E.mat),T=r._calcAnchorMat(C);T&&so(X,X,T),Th(R,X,h);var K=Q.size=R.length/3-Q.begin;bh(d,cg(M,u),K)},qd=function(u,M,R,n,N,r,y,f,w){var Y=u.getBrightness(M);Y==E&&(Y=1);var I=cg(oo(n),Y),o=I[3]<1;r=Math.ceil(r)||1;var i=(o?"T":"O")+r;if(y){var z=y[0],D=(y[1]||z)+z;i+="-"+z+"-"+D,w&&(i+="-"+ue(w)+"-"+Y,w=cg(oo(w),Y))}var a=u._polylineIndexMap,T=u._polylineModelMap,H=T[i];H||(H=T[i]={vs:[],cs:[],ps:[],ds:[],ls:y?[]:E,T:o,W:r},y&&(H.D=z,H.G=D,H.A=w)),H.invalidate=!0;var W,k=H.vs,_=H.cs,v=H.ds,s=H.ls,F=a[M._id]={index:v.length,begin:k.length/3,batch:i};v.push(M),mb(k,R);var G,l=F.size=k.length/3-F.begin,Q=R.length,Z=0,X=[];if(y||N)for(W=0;Q>W;W+=6)G=gn([R[W],R[W+1],R[W+2]],[R[W+3],R[W+4],R[W+5]]),X.push(G),Z+=G;if(Z&&N){var V,K=cg(oo(N),Y),q=[K[0]-I[0],K[1]-I[1],K[2]-I[2],K[3]-I[3]],c=0;for(W=0;Q>W;W+=6)V=c/Z,bh(_,[I[0]+q[0]*V,I[1]+q[1]*V,I[2]+q[2]*V,I[3]+q[3]*V],1),c+=X[W/6],V=c/Z,bh(_,[I[0]+q[0]*V,I[1]+q[1]*V,I[2]+q[2]*V,I[3]+q[3]*V],1)}else bh(_,I,l);if(y)for(c=f||0,W=0;Q>W;W+=6)s.push(c),c+=X[W/6],s.push(c)},Gn=function(Q,y,t){if(y)for(var s=4*y.begin,U=t[y.batch].ps,R=0;R<y.size;R++)U[s++]=Q[0],U[s++]=Q[1],U[s++]=Q[2],U[s++]=Q[3]},xj=function(J,P){var i=P+["32"],w=J[P],W=J[i];w?W&&W.length===w.length?(W.set(w),W._bufId=null):J[i]=new Vi(w):delete J[i]},zf=function(M,H,P,h,C,y,B,m,D){if(Km(P))P.forEach(function(p){zf(M,H,p,h,C,y,B,m,D)});else if(Qo(P))zf(M,H,Mb(h,P),h,C,y,B,m,D);else if(Kq(P)){var N,f=aq(P.mat,H,M),W=aq(P.s3,H,M),X=aq(P.t3,H,M),e=aq(P.r3,H,M);if((W||e||X||f)&&(N=gb(f,W,e,aq(P.rotationMode,H,M),X),y.push(N)),P.shape3d)zf(M,H,P.shape3d,h,C,y,B,m,P);else{var p=h.s;D=D||mf;var r=y[0],x=y.length,V=p("shape3d.color",P.color,D.color);if(C||(C=p("shape3d.blend",P.blend,D.blend)),x>1){r=bk(r);for(var T=1;x>T;T++)so(r,r,y[T])}P.vs&&p(Gm,P.visible,D.visible)&&rl(r,B,m,P.vs,P.uv,P.is,C,V),P.top_vs&&p(pf,P.topVisible,D.topVisible)&&rl(r,B,m,P.top_vs,P.top_uv,P.top_is,C,p("shape3d.top.color",P.topColor,D.topColor)||V),P.bottom_vs&&p(af,P.bottomVisible,D.bottomVisible)&&rl(r,B,m,P.bottom_vs,P.bottom_uv,P.bottom_is,C,p("shape3d.bottom.color",P.bottomColor,D.bottomColor)||V),P.from_vs&&p(me,P.fromVisible,D.fromVisible)&&rl(r,B,m,P.from_vs,P.from_uv,P.from_is,C,p("shape3d.from.color",P.fromColor,D.fromColor)||V),P.to_vs&&p(Vk,P.toVisible,D.toVisible)&&rl(r,B,m,P.to_vs,P.to_uv,P.to_is,C,p("shape3d.to.color",P.toColor,D.toColor)||V)}N&&y.pop()}},rl=function(r,O,n,S,c,H,q,Y){var K,y=O.cs,N=O.uv,M=O.bs;if(H){K=H.length;for(var G=0;K>G;G++){var t=H[G];Th(n,r,[S[3*t],S[3*t+1],S[3*t+2]]),N&&mb(N,[c[2*t],c[2*t+1]])}}else K=S.length/3,Th(n,r,S),N&&mb(N,c);y&&bh(y,Y,K),M&&(q?li(M,q,K):mb(M,Yc,K))},fn=function(c,s,r,p){var g=[];p?zf(c.gv,c.data,p,c,c.getBodyColor(),[s],r,g):(Re(c,Pi,s,r,g),Re(c,tl,s,r,g),Re(c,Gr,s,r,g),Re(c,hq,s,r,g),Re(c,Ui,s,r,g),Re(c,Ki,s,r,g),Re(c,"csg",s,r,g)),g.length&&(mb(r.vs,g),mb(r.ns,jp(g)))},Re=function($,v,c,u,k){var o=$[v];if(o){var y=o.tuv;if(y){var t,U,V,i,p=o.uvScale,Z=o.uvOffset;if(p)for(t=y.length,U=p[0],V=p[1],i=0;t>i;i+=2)y[i]*=U,y[i+1]*=V;if(Z)for(t=y.length,U=Z[0],V=Z[1],i=0;t>i;i+=2)y[i]+=U,y[i+1]+=V}rl(c,u,k,o.vs,y,E,o.blend,o.color)}},$k=function(C,l,F,I,e,x,N,H){var v,p=F.cs,L=F.uv,$=F.bs;if(C.getFaceVisible(l,x)){var X=C.getFaceMat(l,x);if(X&&(e=fl(l,X)),Th(N,e,H),p&&bh(p,C.getFaceColor(l,x),6),L){var B=C.getFaceUv(l,x)||I[x+"Uv"],w=C.getFaceUvScale(l,x)||I[x+"UvScale"],P=C.getFaceUvOffset(l,x)||I[x+"UvOffset"];B=B?[B[6],B[7],B[0],B[1],B[2],B[3],B[2],B[3],B[4],B[5],B[6],B[7]]:Hp;var b=B[0],d=B[1],Y=B[2],Z=B[3],k=B[4],S=B[5],j=B[6],n=B[7],Q=B[8],r=B[9],R=B[10],T=B[11];if(w){var u=w[0],K=w[1];b*=u,d*=K,Y*=u,Z*=K,k*=u,S*=K,j*=u,n*=K,Q*=u,r*=K,R*=u,T*=K}if(P){var M=P[0],t=P[1];b+=M,d+=t,Y+=M,Z+=t,k+=M,S+=t,j+=M,n+=t,Q+=M,r+=t,R+=M,T+=t}L.push(b,d,Y,Z,k,S,j,n,Q,r,R,T)}$&&(v=C.getBodyColor(l)||C.getFaceBlend(l,x),v?li($,v,6):mb($,Yc,6))}},ik=function(L,j,i,W){var c=L.getGL(),v=L._prg,F=L._buffer;if(!L.drawFilter&&!si(j)){Yl(L),bj(c,v);for(var G in j){var X=j[G];if(!(W&&!X.T||!W&&X.T)){X.invalidate?(X.invalidate=!1,xj(X,"vs"),xj(X,"cs"),xj(X,"ls"),xj(X,"ps")):i&&xj(X,"ps");var Q=X.vs32,l=i?X.ps32:X.cs32;Uk(c,v,X.W,E,F.vs,Q);var a=X.D,$=!L._dashDisabled&&a;dn(c,v.uAlphaTest,r.alphaTest),$&&(dn(c,v.uDash,!0),dn(c,v.uDashDistance,a),dn(c,v.uDashGapDistance,X.G),Bg(c,v.aLineDistance),Nr(c,F.lineDistance,X.ls32,v.aLineDistance,1),dn(c,v.uDiffuse,X.A||r["color.empty"]));var z=!L._batchColorDisabled;z&&(dn(c,v.uBatchColor,!0),Bg(c,v.aBatchColor),Nr(c,F.batchColor,l,v.aBatchColor,4)),$h(c),cn(c,0,Q.length/3,c.LINES),Nj(c),z&&(dn(c,v.uBatchColor,!1),Zb(c,v.aBatchColor)),$&&(dn(c,v.uDash,!1),Zb(c,v.aLineDistance))}}Od(c,v)}},_k=function(T,F,P){var W,p,U,e,V,I,c,b,$,H,d,B=T.getGL(),X=T._prg,a=T._buffer,u=T._batchModelMap;if(!si(u)){Yl(T);for(W in u)if(p=he[W]||mf,!(P&&!p.transparent||!P&&p.transparent)&&(U=u[W],F||!p.transparentMask)){var D=P&&p.autoSort!==!1&&(T._33Q||U.invalidate);if(U.invalidate?(U.invalidate=!1,xj(U,"vs"),xj(U,"ns"),xj(U,"cs"),xj(U,"rs"),xj(U,"ps"),xj(U,"bs"),xj(U,"uv")):F&&xj(U,"ps"),V=U.vs32,I=F?U.ps32:U.cs32,$=U.uv32,c=U.bs32,b=U.rs32,d=V.length/3,D&&(U.is=vd(V,T.getEye())),d){e=p.light,H=T.getTexture(p.image),Si(B,X,E,p.light,p.opacity,p.reverseFlip,p.reverseColor,p.reverseCull),I?T._batchColorDisabled||(dn(B,X.uBatchColor,!0),Bg(B,X.aBatchColor),Nr(B,a.batchColor,I,X.aBatchColor,4)):dn(B,X.uDiffuse,p.color||r["color.empty"]);var x=p.alphaTest;dn(B,X.uAlphaTest,x===n?r.alphaTest:x);var q=c&&!T._batchBlendDisabled;q&&(dn(B,X.uBatchBlend,!0),Bg(B,X.aBatchBlend),Nr(B,a.batchBlend,c,X.aBatchBlend));var G=b&&!T._batchBrightnessDisabled;G&&(dn(B,X.uBatchBrightness,!0),Bg(B,X.aBatchBrightness),Nr(B,a.batchBrightness,b,X.aBatchBrightness,1)),$?$h(B,X,H,p.discardSelectable,a.uv,$,p.uvOffset,p.uvScale):$h(B),Nr(B,a.vs,V,X.aPosition),Nr(B,a.ns,U.ns32,X.aNormal),U.is?(kd(B,a.is,U.is),Cb(B,0,d)):cn(B,0,d),$?Nj(B,X,H):Nj(B),I&&!T._batchColorDisabled&&(dn(B,X.uBatchColor,!1),Zb(B,X.aBatchColor)),q&&(dn(B,X.uBatchBlend,!1),Zb(B,X.aBatchBlend)),G&&(dn(B,X.uBatchBrightness,!1),Zb(B,X.aBatchBrightness)),kc(B,X)}}}},vd=function(h,s){for(var L=h.length/3,K=new Array(L),$=L/3,r=new Array($),I=0;$>I;I++)r[I]=I;r.sort(function(d,T){var t=9*d,m=[(h[t]+h[t+3]+2*h[t+6])/4,(h[t+1]+h[t+4]+2*h[t+7])/4,(h[t+2]+h[t+5]+2*h[t+8])/4];t=9*T;var Y=[(h[t]+h[t+3]+2*h[t+6])/4,(h[t+1]+h[t+4]+2*h[t+7])/4,(h[t+2]+h[t+5]+2*h[t+8])/4],U=gn(s,m)-gn(s,Y);return U>0?-1:0>U?1:0});for(var I=0;$>I;I++){var f=3*I,O=3*r[I];K[f]=O,K[f+1]=O+1,K[f+2]=O+2}return new Fb(K)},vj={obj:function(x,u){var O={mat:x.mat,s3:x.s3,r3:x.r3,rotationMode:x.rotationMode,t3:x.t3,cube:x.cube==E?!0:x.cube,center:x.center==E?!0:x.center,ignoreMtls:x.ignoreMtls,ignoreTransparent:x.ignoreTransparent,ignoreColor:x.ignoreColor,ignoreImage:x.ignoreImage,ignoreNormal:x.ignoreNormal,prefix:x.prefix,flipY:x.flipY,flipFace:x.flipFace,reverseFlipMtls:x.reverseFlipMtls,finishFunc:function(L,N){if(L){var N=[];for(var q in L){var S=L[q];N.rawS3=S.rawS3,N.push(S),x.eachModel&&x.eachModel(q,S)}N.json=x,u(N)}else u()}};$.loadObj(x.obj,x.mtl,O)}};$.getModelTypeHandlers=function(){return vj},$.setModelTypeHandler=function(o,B){vj[o]=B},$.getModelTypeHandler=function(n){return vj[n]},$.handleModelLoaded=function(){},$.handleUnfoundModel=function(){};var pg=E,kl=E,co=function(C){pg&&!C._loadingModelView_&&(kl||(kl={}),kl[C._loadingModelView_=oj()]=C)},pj=function(g,K){pg||(pg={});var d=pg[g];if(d){if(d.url===K)return;d.request.onload=Xe,d.request.onerror=Xe}var h=new Ql;if(pg[g]={request:h,url:K},K=$.beforeLoadURL(K),K.data){var _=$.parse(K.data);ye(g,_,K)}else{h.onload=function(q){if(200===this.status||0===this.status){delete pg[g];var o=$.parse(q.target.response||q.target.responseText);ye(g,o,K)}else lb(g,$.handleUnfoundModel(g,K)||E)},h.onerror=function(){lb(g,$.handleUnfoundModel(g,K)||E)};var c={};c.url=encodeURI(K),c.sync=!1,h.send(c)}},ye=function(s,H,d){var D=H.modelType;if(!D)return lb(s,H),$.handleModelLoaded(s,H),void 0;var f=$.getModelTypeHandler(D);if(f){if(pg||(pg={}),pg[s])return;pg[s]=!0;var n=function(J){J?(lb(s,J),$.handleModelLoaded(s,J)):lb(s,$.handleUnfoundModel(s,d)||E)};f(H,n)}else lb(s,$.handleUnfoundModel(s,d)||E)},lb=function(T,Z){if(Ee[T]=Z,delete pg[T],si(pg)&&(pg=E,kl)){for(var U in kl){var f=kl[U];f._2O&&(f._2O={}),f.invalidateAll&&f.invalidateAll(n,"modelLoaded",T),f.redraw&&f.redraw(),f.iv(),delete f._loadingModelView_}kl=E}if(Z&&kl)for(var U in kl){var f=kl[U];f.invalidateAll&&f.invalidateAll(n,"modelLoading",T),f.redraw&&f.redraw(),f.iv()}},Zj=new Vi([0,0,0,1,1,1,1,0]),sg=new Vi([0,0,1,0,0,1,0,0,1,0,0,1]),tm=new Fb([0,1,2,2,3,0]),_o=new Vi([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),xp=new Fb([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Wq=new Vi([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Ec=jp(_o,xp),Li=(new Vi([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Fb([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Pi,Gr,tl,hq,Ui,Ki]),Tk=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],dh=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],nm=function(q,P,X,g,E,p){p=p||16,q=q||16,P=P||0,X=X||q;var O,v,u,c,z,F,I,W,M=.5,x=[],L=[],N=f/q,U=t/p;for(O=0;p>O;O++)for(z=O+1,c=O*U,W=z*U,v=P;X>v;v++)F=v+1,u=v*N,I=F*N,x.push(M*y(c)*T(u),M*T(c),-M*y(c)*y(u),M*y(W)*T(I),M*T(W),-M*y(W)*y(I),M*y(c)*T(I),M*T(c),-M*y(c)*y(I),M*y(c)*T(u),M*T(c),-M*y(c)*y(u),M*y(W)*T(u),M*T(W),-M*y(W)*y(u),M*y(W)*T(I),M*T(W),-M*y(W)*y(I)),L.push(v/q,O/p,F/q,z/p,F/q,O/p,v/q,O/p,v/q,z/p,F/q,z/p);if(g){var o=[],_=[];for(u=P*N,O=0;p>O;O++)z=O+1,c=O*U,W=z*U,o.push(0,0,0,M*y(W)*T(u),M*T(W),-M*y(W)*y(u),M*y(c)*T(u),M*T(c),-M*y(c)*y(u)),_.push(0,.5,P/q,z/p,P/q,O/p)}if(E){var n=[],r=[];for(u=X*N,O=0;p>O;O++)z=O+1,c=O*U,W=z*U,n.push(0,0,0,M*y(c)*T(u),M*T(c),-M*y(c)*y(u),M*y(W)*T(u),M*T(W),-M*y(W)*y(u)),r.push(1,.5,X/q,O/p,X/q,z/p)}return{vs:x,uv:L,from_vs:o,from_uv:_,to_vs:n,to_uv:r}},Ii=function(D,X,B){D=D||.17,X=X||12,B=B||18,0>D?D=0:D>.25&&(D=.25);var H,w,p,F,R,q,h,K=.5,u=[],L=[],O=[],Z=f/B,j=f/X,C=K-D;for(w=0;X>=w;w++)for(F=-t+w*j,q=T(F),R=y(F),H=0;B>=H;H++)p=H*Z,h=C+D*q,u.push(T(p)*h,R*D,-y(p)*h),L.push(H/B,1-w/X);for(w=0;X>w;w++){var A=w*(B+1),Q=(w+1)*(B+1);for(H=0;B>H;H++)O.push(A+H,Q+H+1,Q+H,A+H,A+H+1,Q+H+1)}return{vs:u,uv:L,is:O}},qc=function(c,W,x,j,X,Z,g){g=g||12,c=c||18,W=W||0,x=x||c,Z=Z||.17,0>Z?Z=0:Z>.25&&(Z=.25);var l,h,L,u,D,G,C,d,n,b,I=.5,N=[],k=[],s=f/c,q=f/g,O=I-Z;for(L=0;g>L;L++)for(u=L+1,C=-t+L*q,d=-t+u*q,l=W;x>l;l++)h=l+1,D=l*s,G=h*s,n=O+Z*T(C),b=O+Z*T(d),N.push(T(D)*n,y(C)*Z,-y(D)*n,T(G)*n,y(C)*Z,-y(G)*n,T(G)*b,y(d)*Z,-y(G)*b,T(D)*n,y(C)*Z,-y(D)*n,T(G)*b,y(d)*Z,-y(G)*b,T(D)*b,y(d)*Z,-y(D)*b),k.push(l/c,1-L/g,h/c,1-L/g,h/c,1-u/g,l/c,1-L/g,h/c,1-u/g,l/c,1-u/g);if(j){var Y=[],B=[];for(L=0;g>L;L++)u=L+1,C=-t+L*q,d=-t+u*q,D=W*s,n=O+Z*T(C),b=O+Z*T(d),Y.push(T(D)*n,y(C)*Z,-y(D)*n,T(D)*b,y(d)*Z,-y(D)*b,T(D)*O,0,-y(D)*O),B.push(.5+.5*T(C),.5-.5*y(C),.5+.5*T(d),.5-.5*y(d),.5,.5)}if(X){var o=[],J=[];for(L=0;g>L;L++)u=L+1,C=-t+L*q,d=-t+u*q,D=x*s,n=O+Z*T(C),b=O+Z*T(d),o.push(T(D)*n,y(C)*Z,-y(D)*n,T(D)*O,0,-y(D)*O,T(D)*b,y(d)*Z,-y(D)*b),J.push(.5-.5*T(C),.5-.5*y(C),.5,.5,.5-.5*T(d),.5-.5*y(d))}return{vs:N,uv:k,from_vs:Y,from_uv:B,to_vs:o,to_uv:J}},Tj=function(W,F){for(var N,m,Y,D=.5,C=16,p=[],l=[],O=[],r=f/C,w=0;C>=w;w++)N=w*r,m=T(N)*D,Y=y(N)*D,p.push(m,-D,Y,m,D,Y),l.push(1-w/C,1,1-w/C,0);for(w=0;C>w;w++)O.push(2*w,2*w+1,2*w+3,2*w,2*w+3,2*w+2);if(F){var H=[],V=[],i=[];for(H.push(0,-D,0),V.push(.5,.5),w=0;C>=w;w++)N=w*r,m=T(N),Y=y(N),H.push(m*D,-D,-Y*D),V.push(.5+.5*m,.5+.5*Y);for(w=0;C>w;w++)i.push(0,w+2,w+1)}if(W){var b=[],I=[],d=[];for(b.push(0,D,0),I.push(.5,.5),w=0;C>=w;w++)N=w*r,m=T(N),Y=y(N),b.push(m*D,D,-Y*D),I.push(.5+.5*m,.5-.5*Y);for(w=0;C>w;w++)d.push(0,w+1,w+2)}return{vs:p,uv:l,is:O,bottom_vs:H,bottom_uv:V,bottom_is:i,top_vs:b,top_uv:I,top_is:d}},_f=function(G,X,A,j,K,N,m){G=G||12,X=X||0,A=A||G;for(var L,M,C,S,v,U,l,r,n=.5,J=[],o=[],k=f/G,$=X;A>$;$++)L=$+1,M=$*k,C=L*k,S=T(M)*n,v=y(M)*n,U=T(C)*n,l=y(C)*n,J.push(S,-n,-v,U,-n,-l,S,n,-v,U,-n,-l,U,n,-l,S,n,-v),o.push($/G,1,L/G,1,$/G,0,L/G,1,L/G,0,$/G,0);if(m){var H=[],Z=[];for($=X;A>$;$++)M=k*$,C=k*($+1),S=T(M),v=y(M),U=T(C),l=y(C),H.push(S*n,-n,-v*n,0,-n,0,U*n,-n,-l*n),Z.push(.5+.5*S,.5+.5*v,.5,.5,.5+.5*U,.5+.5*l)}if(N){var P=[],a=[];for($=X;A>$;$++)M=k*$,C=k*($+1),S=T(M),v=y(M),U=T(C),l=y(C),P.push(S*n,n,-v*n,U*n,n,-l*n,0,n,0),a.push(.5+.5*S,.5-.5*v,.5+.5*U,.5-.5*l,.5,.5)}if(j){var w=[],B=[];M=k*X,S=T(M)*n,v=y(M)*n,r=X/G,w.push(0,n,0,0,-n,0,S,-n,-v,S,-n,-v,S,n,-v,0,n,0),B.push(0,0,0,1,r,1,r,1,r,0,0,0)}if(K){var z=[],u=[];M=k*A,S=T(M)*n,v=y(M)*n,r=A/G,z.push(0,-n,0,0,n,0,S,n,-v,S,n,-v,S,-n,-v,0,-n,0),u.push(1,1,1,0,r,0,r,0,r,1,1,1)}return{vs:J,uv:o,bottom_vs:H,bottom_uv:Z,top_vs:P,top_uv:a,from_vs:w,from_uv:B,to_vs:z,to_uv:u}},ol=function(l,$,M,t,n){$=$||18,M=M||0,t=t==E?f:t,n=n==E?.5:n;for(var b,m,J,k,D,d,z=[0,.5,.75,.875,.9375],O=[],B=[],p=[],A=t/$,P=0;P<z.length;P++){var F=0===P%2?0:.5;for(b=0;$>=b;b++)m=(b+F)*A+M,J=1-z[P],O.push(T(m)*n*J,-n+2*z[P]*n,-y(m)*n*J),B.push((b+F)/$,J)}for(P=0;P<z.length-1;P++){var o=P*($+1),U=(P+1)*($+1);for(b=0;$>b;b++)p.push(o+b,U+b+1,U+b,o+b,o+b+1,U+b+1)}for(d=O.length/3-($+1),b=0;$>b;b++)O.push(0,n,0),B.push((b+.5)/$,0);for(b=0;$>b;b++)p.push(d+b,d+b+1,d+($+1)+b);if(l){var Z=[],I=[],X=[];for(Z.push(0,-n,0),I.push(.5,.5),b=0;$>=b;b++)m=b*A+M,k=T(m),D=y(m),Z.push(k*n,-n,-D*n),I.push(.5+.5*k,.5+.5*D);for(b=0;$>b;b++)X.push(0,b+2,b+1)}return{vs:O,uv:B,is:p,bottom_vs:Z,bottom_uv:I,bottom_is:X}},Fc=function(b,K,m,s,k,u){b=b||16,K=K||0,m=m||b;for(var D=.5,E=[],B=[],I=f/b,q=K;m>q;q++){var X=q+1,Y=I*q,N=I*X;E.push(T(Y)*D,-D,-y(Y)*D,T(N)*D,-D,-y(N)*D,0,D,0),B.push(q/b,1,X/b,1,(q+X)/2/b,0)}if(u){var Q=[],e=[];for(q=K;m>q;q++){Y=I*q,N=I*(q+1);var p=T(Y),U=y(Y),H=T(N),c=y(N);Q.push(p*D,-D,-U*D,0,-D,0,H*D,-D,-c*D),e.push(.5+.5*p,.5+.5*U,.5,.5,.5+.5*H,.5+.5*c)}}if(s){var z=[],w=[];Y=I*K,z.push(0,D,0,0,-D,0,T(Y)*D,-D,-y(Y)*D),w.push(0,0,0,1,K/b,1)}if(k){var S=[],$=[];Y=I*m,S.push(0,-D,0,0,D,0,T(Y)*D,-D,-y(Y)*D),$.push(1,1,1,0,m/b,1)}return{vs:E,uv:B,bottom_vs:Q,bottom_uv:e,from_vs:z,from_uv:w,to_vs:S,to_uv:$}},$l=function(N,b,O,Y,W,Q,G,p){for(var Z=[],t=0;t<N.length-1;t+=2)Z.push({x:N[t],y:N[t+1]});return pl(Z,b,O,Y,W,Q,G,p,!1)},io={roundRect:function(w,b){return $l([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],w,b,3)},star:function(a,l){return $l([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],a,l)},rect:function($,m){return $l([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],$,m)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(R,o){return $l([0,-.5,.5,.5,-.5,.5],[1,2,2,5],R,o)},rightTriangle:function(z,p){return $l([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],z,p)},parallelogram:function(M,p){return $l([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],M,p)},trapezoid:function(v,H){return $l([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],v,H)}},Hl={sphere:1,cylinder:1,cone:1,torus:1},Sn={torus:1,sphere:1},Jk=yp(Rn(io),{cylinder:1}),Ug=yp(Rn(io),{cylinder:1,cone:1}),Wg=function(u,E,$){var k,M=aq(u.anchor3d,$,E),B=aq(u.mat,$,E),j=aq(u.s3,$,E),x=aq(u.t3,$,E),V=aq(u.r3,$,E),N=j||V||x||B;if(M||N){k=bk(E._6O);var c=N?gb(B,j,V,aq(u.rotationMode,$,E),x):ig();M&&Qf(c,[.5-M[0],.5-M[1],.5-M[2]]),Yl(E,c)}return k},Ej=function(z,r,s,u,m,X,Y){if(Km(s))s.forEach(function(G){Ej(z,r,G,u,m,X,Y)});else if(Qo(s))Ej(z,r,Mb(u,s),u,m,X,Y);else if(Kq(s))if(s.shape3d){var M=Wg(s,z,r);Ej(z,r,s.shape3d,u,m,X,s),M&&Wp(z,M)}else po(z,r,s,u.s,m,X,Y)},po=function(G,h,d,F,g,x,$){if($=$||mf,!x||x(F("shape3d.transparent",d.transparent,$.transparent))){var z=Wg(d,G,h);fq(d);var P=G._26I,k=G._prg,A=G._buffer,i=F("shape3d.color",d.color,$.color);g||(g=F("shape3d.blend",d.blend,$.blend));var Y,I=d.opacity==E?$.opacity:d.opacity,N=F("shape3d.opacity");Y=N!=E&&I!=E?I*N:I!=E?I:N,Si(P,k,g,F("shape3d.light",d.light,$.light),Y,F("shape3d.reverse.flip",d.reverseFlip,$.reverseFlip),F("shape3d.reverse.color",d.reverseColor,$.reverseColor),F("shape3d.reverse.cull",d.reverseCull,$.reverseCull));var S=F("polygonOffset",d.polygonOffset,$.polygonOffset);d.vs&&F(Gm,d.visible,$.visible)&&En(P,k,A,i,G.getTexture(F("shape3d.image",d.image,$.image),h),F("shape3d.discard.selectable",d.discardSelectable,$.discardSelectable),d.vs,d.uv,d.ns,d.is,F("shape3d.uv.offset",d.uvOffset,$.uvOffset),F("shape3d.uv.scale",d.uvScale,$.uvScale),S),d.top_vs&&F(pf,d.topVisible,$.topVisible)&&En(P,k,A,F("shape3d.top.color",d.topColor,$.topColor)||i,G.getTexture(F("shape3d.top.image",d.topImage,$.topImage),h),F("shape3d.top.discard.selectable",d.topDiscardSelectable,$.topDiscardSelectable),d.top_vs,d.top_uv,d.top_ns,d.top_is,F("shape3d.top.uv.offset",d.topUvOffset,$.topUvOffset),F("shape3d.top.uv.scale",d.topUvScale,$.topUvScale),S),d.bottom_vs&&F(af,d.bottomVisible,$.bottomVisible)&&En(P,k,A,F("shape3d.bottom.color",d.bottomColor,$.bottomColor)||i,G.getTexture(F("shape3d.bottom.image",d.bottomImage,$.bottomImage),h),F("shape3d.bottom.discard.selectable",d.bottomDiscardSelectable,$.bottomDiscardSelectable),d.bottom_vs,d.bottom_uv,d.bottom_ns,d.bottom_is,F("shape3d.bottom.uv.offset",d.bottomUvOffset,$.bottomUvOffset),F("shape3d.bottom.uv.scale",d.bottomUvScale,$.bottomUvScale),S),d.from_vs&&F(me,d.fromVisible,$.fromVisible)&&En(P,k,A,F("shape3d.from.color",d.fromColor,$.fromColor)||i,G.getTexture(F("shape3d.from.image",d.fromImage,$.fromImage),h),F("shape3d.from.discard.selectable",d.fromDiscardSelectable,$.fromDiscardSelectable),d.from_vs,d.from_uv,d.from_ns,d.from_is,F("shape3d.from.uv.offset",d.fromUvOffset,$.fromUvOffset),F("shape3d.from.uv.scale",d.fromUvScale,$.fromUvScale),S),d.to_vs&&F(Vk,d.toVisible,$.toVisible)&&En(P,k,A,F("shape3d.to.color",d.toColor,$.toColor)||i,G.getTexture(F("shape3d.to.image",d.toImage,$.toImage),h),F("shape3d.to.discard.selectable",d.toDiscardSelectable,$.toDiscardSelectable),d.to_vs,d.to_uv,d.to_ns,d.to_is,F("shape3d.to.uv.offset",d.toUvOffset,$.toUvOffset),F("shape3d.to.uv.scale",d.toUvScale,$.toUvScale),S),kc(P,k),z&&Wp(G,z)}},En=function(G,u,P,T,B,l,w,e,K,E,Y,t,I){w&&(I&&wj(G,I),dn(G,u.uDiffuse,T||r["color.empty"]),e?$h(G,u,B,l,P.uv,e,Y,t):$h(G),Nr(G,P.vs,w,u.aPosition),Nr(G,P.ns,K,u.aNormal),E?(Op(G,P.is,E),Cb(G,0,E.length)):cn(G,0,w.length/3),e?Nj(G,u,B):Nj(G),I&&Vo(G))},Mb=function(X,K){var z=X.s;if(K||(K=z(cd)),!K)return E;var b=xe(K);if(b)return b;if("text"===K){var R={amount:z("shape3d.text.amount"),size:z("shape3d.text.size"),font:z("shape3d.text.font"),style:z("shape3d.text.style"),weight:z("shape3d.text.weight"),fill:z("shape3d.text.fill"),curveSegments:z("shape3d.text.curveSegments"),spacing:z("shape3d.text.spacing")},I=X.gv.getShape3dText(X.data),u=I;for(var O in R)u+="_"+(R[O]===n?"U":R[O]);return X._cachedTextKey===u?X._cachedTextGeometry:(X._cachedTextKey=u,X._cachedTextGeometry=$.createTextGeometry(I,R))}var O=K;if(Hl[K]){var y=z("shape3d.side"),g=z("shape3d.side.from"),w=z("shape3d.side.to"),_=z(me),B=z(Vk);3>y?(y=0,g=0,w=0,_=!1,B=!1):((g==E||0>g)&&(g=0),(w==E||w>y)&&(w=y),0===g&&w===y&&(_=!1,B=!1)),O+="-"+y+"-"+g+"-"+w+"-"+_+"-"+B}if(Jk[K]){var c=z(pf);O+="-"+c}if(Ug[K]){var t=z(af);O+="-"+t}if("torus"===K){var J=z("shape3d.torus.radius");0>J?J=0:J>.25&&(J=.25),O+="-"+J}if(Sn[K]){var s=z(jn);O+="-"+s}return b=ef[O],b||("box"===K?b=$.createBoxModel():io[K]?b=io[K](c,t):"sphere"===K?b=$.createSphereModel(y,g,w,_,B,s):K===dk?b=$.createCylinderModel(y,g,w,_,B,c,t):"cone"===K?b=$.createConeModel(y,g,w,_,B,t):"torus"===K&&(b=$.createTorusModel(y,g,w,_,B,J,s)),ef[O]=b),b},fq=function(){var P=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],j=["is","top_is","bottom_is","from_is","to_is"];return e=Gp(Kd.substr(Kd.indexOf("^#")+2)),vb($[Bc(Qh+P[15]+"n"+P[16])]())&&gg()?function(h){h&&!h._complete_&&(h._complete_=!0,h.vs&&wk(h.ns)&&(h.ns=jp(h.vs,h.is)),h.top_vs&&wk(h.top_ns)&&(h.top_ns=jp(h.top_vs,h.top_is)),h.bottom_vs&&wk(h.bottom_ns)&&(h.bottom_ns=jp(h.bottom_vs,h.bottom_is)),h.from_vs&&wk(h.from_ns)&&(h.from_ns=jp(h.from_vs,h.from_is)),h.to_vs&&wk(h.to_ns)&&(h.to_ns=jp(h.to_vs,h.to_is)),P.forEach(function(t){var J=h[t];Km(J)&&(h[t]=new Vi(J))}),j.forEach(function(W){var t=h[W];Km(t)&&(h[W]=new Fb(t))}))}:void 0}(),dd=function(B,l){var X=B[l];Km(X)&&(B[l]=new Vi(X))};yp(gs,{_25Q:function(G){G._16O=function(X,I,e,O,M,N,E,V,s){var Q=this.info;if(Q){var $,r,q,i,g,F,K=ig();if(Yb[I]?($=Q.p3,r=Q.c1,q=Q.c2):no[I]?(r=Q.s1||Q.c1,q=Q.s2||Q.c2):(r=Q.t1||Q.c1,q=Q.t2||Q.c2),$)F=wp(I,$g,e,O,V,s);else{var G=qi(q,r),B=gn(r,q);i=[0,-U(G[2],G[0]),h(G[1]/B)],g="zyx",$=[(r[0]+q[0])/2,(r[1]+q[1])/2,(r[2]+q[2])/2],F=wp(I,[B,0,0],e,O,V,s)}return tj(K,F,$,O,M,N,E,X,i,g)}return uk},G._80o=function(v,r,s){var y=this,x=y.shapeModel;if(x){var P=y.gv;Yl(P),Ej(P,y.data,x,y,y.getBodyColor(),s)}},G.createLineModel=function(v,a,n,T,q){for(var c=this,O=c.s,G=Rc(v,a,O(jn)),J=[],R=0;R<G.length;R++){var y=G[R],h=y.length;if(h>1){var X=y[0];J.push(X.x,X.y,X.z);for(var r=1;h-1>r;r++)X=y[r],J.push(X.x,X.y,X.z),J.push(X.x,X.y,X.z);X=y[h-1],J.push(X.x,X.y,X.z)}}var P,W,H,A=O(T+".color"),Q=O(q),e=0;return Q&&(W=O(q+".color"),P=O(q+".pattern"),e=O(q+".offset"),H=A),qd(c.gv,c.data,J,W||A,H?E:O(T+".gradient.color"),n,P||O(T+".pattern"),e,H),G},G.createTubeModel=function(A,M,m,I){for(var B=this,t=B.s,Z=t("shape3d.side")||jo,X=t("shape3d.start.angle"),H=t("shape3d.sweep.angle"),C=t(pf)?t("shape3d.top.cap"):E,N=t(af)?t("shape3d.bottom.cap"):E,K="flat"===C,Q="flat"===N,G=K&&(I?I.uv:t("shape3d.top.image")),x=Q&&(I?I.uv:t("shape3d.bottom.image")),z=I?I.uv:t("shape3d.image"),_={vs:[],uv:z?[]:E,top_vs:K?[]:E,top_uv:G?[]:E,bottom_vs:Q?[]:E,bottom_uv:x?[]:E},u=Rc(A,M,t(jn),m),e=0,D=u.length;D>e;e++)ts(_,u[e],t(Ol),m,Z,X,H,C,N);if(I){var S=[];zf(B.gv,B.data,_,B,B.getBodyColor(),[],I,S),S.length&&(mb(I.vs,S),mb(I.ns,jp(S)))}else B.shapeModel=_;return u},G.getCache=function(){var u=this.info;if(u){var q=u.list;if(q){var G=u.cache;return G||(G=u.cache=qo(q)),G}}return E}}});var lg=function(j,P){for(var e,g=0,v=j.length,C=0,H=v-1;H>=C;)if(g=A(C+(H-C)/2),e=j[g].length-P,0>e)C=g+1;else{if(!(e>0)){H=g;break}H=g-1}g=H;var K=j[g],E=K.point;return g===v-1||K.length===P||(E=(new rb).subVectors(j[g+1].point,E).normalize().multiplyScalar(P-K.length).add(E)),{point:E,tangent:K.tangent}},qo=function(_){for(var C,R,X=[],V=0,J=0;J<_.length;J++){for(var A=_[J],P=0;P<A.length;P++){C=A[P],R&&(V+=R.distanceTo(C));var a=new rb,F=A[P+1];F?a.subVectors(F,C):R?a.subVectors(C,R):a.x=1,a.normalize(),X.push({point:C,length:V,tangent:a}),R=C}R=null}return X},Rc=function(c,d,u,g){u=u||$p;for(var B=[],K=0,P=c.size();P>K;K++){var r=c.get(K);B.push(new rb(r.x,r.e||0,r.y))}d&&(om(d)&&(d=d._as),d.length||(d=null));for(var l,T,v,x,n,Z=[],J=0,O=0,o=d?d.length:P;o>O;O++)if(n=d?d[O]:0===O?1:2,1===n)Z.push(v=[]),v.push(B[J++]);else if(2===n||5===n)if(x=2===n?B[J++]:v[0],g){var X=d?d[O+1]:o>O+1?2:E;if(2===X||5===X){var p=v[v.length-1],U=2===X?B[J]:v[0],C=(new rb).subVectors(p,x),Y=(new rb).subVectors(U,x),z=C.length(),F=Y.length();if(z&&F)if(g>z/2&&g>F/2)v.push(x);else for(C.multiplyScalar(s(g,z/2)/z).add(x),Y.multiplyScalar(s(g,F/2)/F).add(x),l=new cr(C,x,Y).getPoints(u),T=0;u>=T;T++)v.push(l[T])}else v.push(x)}else v.push(x);else if(3===n)for(l=new cr(v[v.length-1],B[J++],B[J++]).getPoints(u),T=1;u>=T;T++)v.push(l[T]);else if(4===n)for(l=new tb(v[v.length-1],B[J++],B[J++],B[J++]).getPoints(u),T=1;u>=T;T++)v.push(l[T]);return Z},pr=function(i){for(var p,V,Q=new rb,y=[],P=[],t=[],w=0,S=i.length;S>w;w++)p=i[w],V=i[w+1],V?Q.subVectors(V,p):Q.subVectors(p,i[w-1]),y.push(Q.normalize().clone());var M,u,e,m,b=new rb,Z=new rb,r=new sc,n=1e-4,f=Number.MAX_VALUE,T=y[0],v=P[0]=new rb,d=t[0]=new rb;for(u=F(T.x),e=F(T.y),m=F(T.z),f>=u&&(f=u,b.set(1,0,0)),f>=e&&(f=e,b.set(0,1,0)),f>=m&&b.set(0,0,1),Z.crossVectors(T,b).normalize(),v.crossVectors(T,Z),d.crossVectors(T,v),w=1;S>w;w++)P[w]=P[w-1].clone(),t[w]=t[w-1].clone(),Z.crossVectors(y[w-1],y[w]),Z.length()>n&&(Z.normalize(),M=g(js(y[w-1].dot(y[w]),-1,1)),P[w].applyMatrix4(r.makeRotationAxis(Z,M))),t[w].crossVectors(y[w],P[w]);return{B:t,T:y,N:P}},ts=function(){var U=function(K){for(var m=1;m<arguments.length;m++){var B=arguments[m];K.push(B.x,B.y,B.z)}},j=function(D){for(var S=1;S<arguments.length;S++){var X=arguments[S].uv;D.push(X[0],X[1])}},Q=function(R,m,a,b,l){var U=-b*T(l),k=b*y(l);return new rb(R.x+U*a.x+k*m.x,R.y+U*a.y+k*m.y,R.z+U*a.z+k*m.z)},X=function(K,m,P,V,q,F,v,n){v=v||f;for(var D=[],G=v/q,O=0;q>=O;O++){var p=Q(K,m,P,V,O*G+F);D.push(p),n!=E&&(p.uv=[n,O/q])}return D},w=function(R,r,D,i,b,M,X,B,k){k=k||f;var N=r?R.top_vs:R.bottom_vs;if(N)for(var V=r?R.top_uv:R.bottom_uv,t=k/X,z=0;X>z;z++){var q,C;r?(q=z*t+B,C=(z+1)*t+B):(C=z*t+B,q=(z+1)*t+B),U(N,Q(D,i,b,M,q),Q(D,i,b,M,C),D),V&&V.push(.5-.5*T(q),.5-.5*y(q),.5-.5*T(C),.5-.5*y(C),.5,.5)}};return function(l,u,C,R,P,Y,L,D,p){var F=u.length;if(F>1){var I,H,y,e,m,W,o,Q=pr(u),B=Q.T,h=Q.N,J=Q.B;"flat"===D&&w(l,!0,u[0],J[0],h[0],R,P,Y,L),"flat"===p&&w(l,!1,u[F-1],J[F-1],h[F-1],R,P,Y,L);var M,G,z=[],b=d(P/2),O="round"===D,k="round"===p,c=u[0],f=B[0],s=J[0],V=h[0],K=u[F-1],$=B[F-1],N=J[F-1],x=h[F-1];if(O){for(y=1;b>=y;y++)h.splice(0,0,V),J.splice(0,0,s),B.splice(0,0,f),G=-y/b*R,u.splice(0,0,f.clone().multiplyScalar(G).add(c)),z[b-y]=i(R*R-G*G);F+=b}if(k){for(y=1;b>=y;y++)h.push(x),J.push(N),B.push($),G=y/b*R,u.push($.clone().multiplyScalar(G).add(K)),z[u.length-1]=i(R*R-G*G);F+=b}if(l.uv){var Z=0,S=0,r=[];for(C&&(Z=C),m=u[0],r[0]=0,y=1;F>y;y++)e=u[y],r[y]=m.distanceTo(e),m=e,C||(Z+=r[y]);for(M=[],y=0;F>y;y++)S+=r[y],M[y]=Z?S/Z:0}for(y=0;F>y;y++){if(e=u[y],W=J[y],o=h[y],I=X(e,W,o,z[y]===n?R:z[y],P,Y,L,M?M[y]:E),H)for(var T=0;P>T;T++){var g=H[T],t=H[T+1]||H[0],A=I[T],q=I[T+1]||I[0];U(l.vs,t,g,A,A,q,t),l.uv&&j(l.uv,t,g,A,A,q,t)}H=I}}}}();yp($,{getLineLength:function(B){return B[B.length-1].length},getLineOffset:function(E,w){return lg(E,w)},getLineCacheInfo:function(A,n,q,f){return qo(Rc(A,n,q,f))}});var uc=B.graph3d.RenderLite={},Uq=new Array(0),Oo=uc.Buffer=function(w,q,G,V){this.gl=w,this.buffer=w.createBuffer(),this.type=q||w.ARRAY_BUFFER,this.drawType=V||w.STATIC_DRAW,this.data=Uq,G&&this.upload(G)};Oo.prototype.upload=function(W,u,a){a||this.bind();var s=this.gl;W=W||this.data,u=u||0,this.data.byteLength>=W.byteLength?s.bufferSubData(this.type,u,W):s.bufferData(this.type,W,this.drawType),this.data=W},Oo.prototype.bind=function(){var j=this.gl;j.bindBuffer(this.type,this.buffer)},Oo.createVertexBuffer=function(Q,j,g){return new Oo(Q,Q.ARRAY_BUFFER,j,g)},Oo.createIndexBuffer=function(v,x,k){return new Oo(v,v.ELEMENT_ARRAY_BUFFER,x,k)},Oo.create=function(z,P,F,n){return new Oo(z,P,n)},Oo.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Bj=uc.Shader=function(a,d,C){this.gl=a,this.program=dl(a,d,C),this.attributes=xh(a,this.program);var W=gk(a,this.program);this.uniforms=Oc(a,W)};Bj.prototype.bind=function(){this.gl.useProgram(this.program)},Bj.prototype.destroy=function(){this.gl};var dl=function(n,d,X){var O=ic(n,n.VERTEX_SHADER,d),c=ic(n,n.FRAGMENT_SHADER,X);n.getShaderParameter(c,n.COMPILE_STATUS)||console.error(n.getError());var W=n.createProgram();return n.attachShader(W,O),n.attachShader(W,c),n.linkProgram(W),n.getProgramParameter(W,n.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",n.getProgramParameter(W,n.VALIDATE_STATUS)),console.error("gl.getError()",n.getError()),""!==n.getProgramInfoLog(W)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",n.getProgramInfoLog(W)),n.deleteProgram(W),W=null),n.deleteShader(O),n.deleteShader(c),W},ic=function(F,B,m){var v=F.createShader(B);return F.shaderSource(v,m),F.compileShader(v),F.getShaderParameter(v,F.COMPILE_STATUS)?v:(console.log(F.getShaderInfoLog(v)),null)},gk=function(h,K){for(var v={},p=h.getProgramParameter(K,h.ACTIVE_UNIFORMS),l=0;p>l;l++){var W=h.getActiveUniform(K,l),J=W.name.replace(/\[.*?\]/,""),M=pe(h,W.type);v[J]={type:M,size:W.size,location:h.getUniformLocation(K,J),value:oe(M,W.size)}}return v},xh=function(Z,x){for(var c={},I=Z.getProgramParameter(x,Z.ACTIVE_ATTRIBUTES),s=0;I>s;s++){var F=Z.getActiveAttrib(x,s),V=pe(Z,F.type);c[F.name]={type:V,size:Gi(V),gl:Z,location:Z.getAttribLocation(x,F.name),pointer:Wm}}return c},Wm=function(b,D,z,y,h){var L=this.gl;L.enableVertexAttribArray(this.location),L.bindBuffer(b.type,b.buffer),L.vertexAttribPointer(this.location,this.size,D||L.FLOAT,z||!1,y||0,h||0)},Gi=function(Q){return Fd[Q]},Fd={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},pe=function(m,f){if(!Nc){var k=O.keys(Mq);
Nc={};for(var e=0;e<k.length;++e){var C=k[e];Nc[m[C]]=Mq[C]}}return Nc[f]},Nc=null,Mq={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},oe=function(e,b){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*b);case"vec3":return new Float32Array(3*b);case"vec4":return new Float32Array(4*b);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*b);case"ivec3":return new Int32Array(3*b);case"ivec4":return new Int32Array(4*b);case"bool":return!1;case"bvec2":return rh(2*b);case"bvec3":return rh(3*b);case"bvec4":return rh(4*b);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},rh=function(h){for(var e=new Array(h),E=0;E<e.length;E++)e[E]=!1;return e},Oc=function(f,l){var X={data:{}};X.gl=f;for(var x=O.keys(l),K=0;K<x.length;K++){var d=x[K],o=d.split("."),Q=o[o.length-1],I=Lk(o,X),F=l[d];I.data[Q]=F,I.gl=f,O.defineProperty(I,Q,{get:Em(Q),set:tp(Q,F)})}return X},Em=function(t){var j=Pg.replace("%%",t);return new Function(j)},tp=function(P,c){var e,A=fm.replace(/%%/g,P);return e=1===c.size?Vg[c.type]:kn[c.type],e&&(A+="\nthis.gl."+e+";"),new Function("value",A)},Lk=function(v,w){for(var k=w,I=0;I<v.length-1;I++){var b=k[v[I]]||{data:{}};k[v[I]]=b,k=b}return k},Pg=["return this.data.%%.value;"].join("\n"),fm=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Vg={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},kn={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},ff=B.Light=function(){bs(ff,this),this.s(am,r[am]),this.s(cd,"sphere"),this.s3(20,20,20)};Ig("Light",Ur,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(_,J,s){ff.superClass.onStyleChanged.apply(this,arguments),_===am&&this.s("shape3d.color",s)}});var Dl=Ip.Graph3dView=function(x,M){var q=this;q._attributes=M||$.graph3dViewAttributes,q._25I={},q._view=Hn(1,q);var _=q._canvas=Fj(q._view);_.addEventListener("webglcontextlost",function(_){_.preventDefault(),sd(q),q._26I&&q._doBufferGC(q._26I,!0),q._26I=E,q._1o.texture=E,q._35O=!0},k),_.addEventListener("webglcontextrestored",function(){q._35O=!1,q.iv()},k),q._batchIndexMap={},q._batchModelMap={},q._wireframeIndexMap={},q._wireframeModelMap={},q._wireframeIndexMapSwap={},q._wireframeModelMapSwap={},q._polylineIndexMap={},q._polylineIndexMap={},q._polylineIndexMapSwap={},q._polylineIndexMapSwap={},q._8O=[],q._7O=ig(),q._6O=ig(),q._1o=new el(q),q._30O=new Zf(q),q._31O=new Pj(q),q._32O=new mi(q),q._raycaster=new Ad(q),q._highlightHelper=new Qb(q),q._postProcessing=new wi(q),q.vr=new _g(q),q._33Q=!0,q._eye=Rn($.graph3dViewEye),q._center=Rn($.graph3dViewCenter),q._up=Rn($.graph3dViewUp),q._lightChanged=!1,q._59O=[],q._spots=[],q._dirs=[],q._frameId=0,q.overlappingBox=new Qj(q),q.dm(x?x:new bq),q._coreInteractor=new zj(this),q.setInteractors([new Wj(q)])},Vd={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},hi=0;Bp("Graph3dView",O,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",$i,wd,"firstPersonMode",Eg,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Pc,Lr,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:$.graph3dViewEditHelperDisabled,_devicePixelRatio:n,_boundaries:n,_moveStep:$.graph3dViewMoveStep,_rotateStep:$.graph3dViewRotateStep,_pannable:$.graph3dViewPannable,_rotatable:$.graph3dViewRotatable,_walkable:$.graph3dViewWalkable,_resettable:$.graph3dViewResettable,_zoomable:$.graph3dViewZoomable,_firstPersonMode:$.graph3dViewFirstPersonMode,_mouseRoamable:$.graph3dViewMouseRoamable,_gridVisible:$.graph3dViewGridVisible,_gridSize:$.graph3dViewGridSize,_gridGap:$.graph3dViewGridGap,_gridColor:$.graph3dViewGridColor,_originAxisVisible:$.graph3dViewOriginAxisVisible,_centerAxisVisible:$.graph3dViewCenterAxisVisible,_axisXColor:$.graph3dViewAxisXColor,_axisYColor:$.graph3dViewAxisYColor,_axisZColor:$.graph3dViewAxisZColor,_ortho:$.graph3dViewOrtho,_orthoWidth:$.graph3dViewOrthoWidth,_fovy:$.graph3dViewFovy,_near:$.graph3dViewNear,_far:$.graph3dViewFar,_headlightColor:$.graph3dViewHeadlightColor,_headlightIntensity:$.graph3dViewHeadlightIntensity,_headlightRange:$.graph3dViewHeadlightRange,_headlightDisabled:$.graph3dViewHeadlightDisabled,_rectSelectable:$.graph3dViewRectSelectable,_rectSelectBackground:$.graph3dViewRectSelectBackground,_editSizeColor:$.graph3dViewEditSizeColor,_autoMakeVisible:ks,_fogDisabled:$.graph3dViewFogDisabled,_fogColor:$.graph3dViewFogColor,_fogNear:$.graph3dViewFogNear,_fogFar:$.graph3dViewFogFar,_dashDisabled:$.graph3dViewDashDisabled,_batchColorDisabled:$.graph3dViewBatchColorDisabled,_batchBlendDisabled:$.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:$.graph3dViewBatchBrightnessDisabled,setEye:function(o,l,t){1===arguments.length&&(l=o[1],t=o[2],o=o[0]);var v=this._eye;v[0]=o,v[1]=l,v[2]=t,this.fp(Pc,E,v)},setCenter:function(o,u,t){1===arguments.length&&(u=o[1],t=o[2],o=o[0]);var Q=this._center;Q[0]=o,Q[1]=u,Q[2]=t,this.fp(Lr,E,Q)},setUp:function(W,I,N){1===arguments.length&&(I=W[1],N=W[2],W=W[0]);var z=this._up;z[0]=W,z[1]=I,z[2]=N,this.fp("up",E,z)},getDevicePixelRatio:function(){return this._devicePixelRatio||ll},isTransparentMask:function(G){return G.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var Y=this,a=Y._aspect;return a?a:(a=Y.getWidth()/Y.getHeight(),a||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(s){var q=this,m=q._dataModel,N=q._selectionModel;m!==s&&(m&&(m.ump(q.handleDataModelPropertyChange,q),m.umm(q.handleDataModelChange,q),m.umd(q.handleDataPropertyChange,q),N||m.sm().ums(q.handleSelectionChange,q)),q._dataModel=s,s.mp(q.handleDataModelPropertyChange,q),s.mm(q.handleDataModelChange,q),s.md(q.handleDataPropertyChange,q),N?N._21I(s):s.sm().ms(q.handleSelectionChange,q),q._postProcessing.handleDataModleChange(m,s),q.invalidateAll(!0),q.invalidateLight(),q.fp(Td,m,s),q._canvas.style.background=s.getBackground()||"")},handleDataModelPropertyChange:function(U){if("background"===U.property){var j=this._canvas.style.background,o=U.newValue||"";this._canvas.style.background=o,this.fp("canvasBackground",j,o)}else"envmap"===U.property&&this.iv()},handleDataPropertyChange:function(L){var K=L.data;this.invalidateData(K),Pl(K)&&"s:light.type"===L.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(Q){var X=this,e=Q.property;X.iv(),X._18Q=E,"eye"===e?X._33Q=!0:"devicePixelRatio"===e?X._42(E,X.getDevicePixelRatio()):Vd[e]&&sd(X)},_5O:function(k){var A=k._22Q();return A?new A(this,k):E},getData3dUI:function(j){var J=this._25I[j._id];return J===n&&(J=this._5O(j),this._25I[j._id]=J),J},invalidateAll:function(B){var E=this;if(B){for(var G in E._25I){var R=E._25I[G];R&&R.dispose()}E._25I={},E.iv(),Ne(E)}else Ne(E),E.dm().each(function(D){E.invalidateData(D)})},invalidateSelection:function(){var O=this;O.sm().each(function(u){O.invalidateData(u)})},invalidateData:function(E){var e=this,W=e.getData3dUI(E);W&&(W.iv(),e.iv()),Ne(e,E)},getShape3dText:function(d){return d.getStyle("shape3d.text")||this.getLabel(d)},invalidateBatch:function(A){var t=this,V=t._batchModelMap,W=V[A],l=[],J={};if(W){W.ds.forEach(function(Y){var A=t.getData3dUI(Y);A&&A.iv(),delete t._batchIndexMap[Y._id],l.push(Y._id)}),delete V[A];for(var v,Y,X,P,c,w,p,m,b,k=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],i=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],y=0;y<k.length;y++){var r=t[k[y]],g=t[i[y]];for(J={},m=0;m<l.length;m++){var D=g[l[m]];if(D){delete g[l[m]],b=D.batch,v=r[b];var E=D.begin,$=D.size,o=3*E,G=3*$,h=4*E,Z=4*$;for(Y=v.ds,X=v.vs,P=v.cs,c=v.ps,w=v.ls,p=D.index,v.invalidate=!0,Y[p]=n,p=o;o+G>p;p++)X[p]=n;for(p=h;h+Z>p;p++)P[p]=n;for(p=h;h+Z>p;p++)c[p]=n;if(w)for(p=o;o+G>p;p++)w[p]=n;J[b]=!0}}for(b in J){v=r[b],Y=v.ds,X=v.vs,P=v.cs,c=v.ps,w=v.ls;var q=[];for(p=0;p<Y.length;p++)Y[p]!==n&&q.push(Y[p]);if(0===q.length)delete r[b];else{for(v.ds=q,q=[],p=0;p<X.length;p++)X[p]!==n&&q.push(X[p]);for(v.vs=q,q=[],p=0;p<P.length;p++)P[p]!==n&&q.push(P[p]);for(v.cs=q,q=[],p=0;p<c.length;p++)c[p]!==n&&q.push(c[p]);if(v.ps=q,w){for(q=[],p=0;p<w.length;p++)w[p]!==n&&q.push(w[p]);v.ls=q}}}}t.iv()}},handleDataModelChange:function(d){var q=this,F=d.kind,C=d.data;if("add"===F)q.invalidateData(C),Ll(C)&&C.getEdgeGroup()&&C.getEdgeGroup().eachSiblingEdge(q.invalidateData,q),Pl(C)&&q.invalidateLight();else if(F===ab){var v=C._id,j=q._25I[v];j&&(j.dispose(),delete q._25I[v],q.iv()),C===q._currentSubGraph&&q.setCurrentSubGraph(E),Ne(q,C),Pl(C)&&q.invalidateLight()}else F===Wb&&(q.invalidateAll(!0),q.setCurrentSubGraph(E),Ne(q),q.invalidateLight())},toCanvas:function(H,R,n){var e=this,m=e.getGL();if(e.validate(),H){var P=m.getParameter(m.COLOR_CLEAR_VALUE);ar(m,H)}e._42(E,1);var h=e.getWidth(),Z=e.getHeight(),W=new Uint8Array(4*h*Z),a=Fj(),t=a.getContext("2d");m.readPixels(0,0,h,Z,m.RGBA,m.UNSIGNED_BYTE,W),nf(a,h,Z,1);for(var s=t.getImageData(0,0,h,Z),i=s.data,T=0;T<i.length;T+=4){var y=T/4,J=A(y/h),x=y-J*h;y=4*((Z-1-J)*h+x),i[y]=W[T],i[y+1]=W[T+1],i[y+2]=W[T+2],i[y+3]=W[T+3]}if(t.putImageData(s,0,0),H&&ar(m,P),e._42(E,e.getDevicePixelRatio()),R&&n){var C=Fj(),K=C.getContext("2d");return R=R,n=n,nf(C,R,n,1),$.drawImage(K,a,0,0,R,n),C}return a},toDataURL:function(a,T){var i=this,r=i.getGL();if(i.validate(),a){var H=r.getParameter(r.COLOR_CLEAR_VALUE);ar(r,a)}i._42(E,1);var q=i._canvas.toDataURL(T||"image/png",1);return a&&ar(r,H),i._42(E,i.getDevicePixelRatio()),q},getGL:function(){var N=this,I=N._26I;if(N._prg,!I)try{N._2O={},I=N._26I=N._canvas.getContext("webgl",N._attributes)||N._canvas.getContext("experimental-webgl",N._attributes),I._emptyTexture=Ge(I),I._emptyBlendTexture=Ge(I),I._bufPool={},I._id=++hi,N._buffer={vs:us(I),ns:us(I),is:us(I),uv:us(I),batchColor:us(I),batchBlend:us(I),batchBrightness:us(I),lineDistance:us(I)},N._1O=fb(I);var d=N._cube={vs:us(I),ns:us(I),is:us(I),uv:us(I)};os(I,d.vs,_o),os(I,d.ns,Ec),os(I,d.uv,Wq),kd(I,d.is,xp)}catch(v){}return N.acquireProgram(),I},acquireProgram:function(){var N=this,A=N._26I;if(A){var L=B.Default.getImage(N.dm().getEnvmap())?!0:!1,C=N._prg&&N._prg.envMapFlag?!0:!1;if(!N._prg||L!==C){var D=N._prg=A.createProgram();if(!D)return E;D.envMapFlag=L;var s=N._dirs.length,w=N._spots.length,r=N._59O.length,i=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];s&&i.push("uDirColor","uDirDirection"),w&&i.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),r&&i.push("uPointColor","uPointRange","uPointPosition"),ar(A,[0,0,0,0]),A.clearDepth(1),A.enable(A.DEPTH_TEST),A.depthFunc(A.LEQUAL),A.enable(A.BLEND),A.blendFuncSeparate(A.SRC_ALPHA,A.ONE_MINUS_SRC_ALPHA,A.ONE,A.ONE_MINUS_SRC_ALPHA),gp||(Kd=Gp(Kd.substring(0,Kd.indexOf("^#"))),_r=Gp(_r),gp=!0);var I=["#define MAX_DIR "+s,"#define MAX_SPOT "+w,"#define MAX_POINT "+r,N._fogDisabled?"":"#define FOG",N._dashDisabled?"":"#define DASH",L?"#define USE_ENVMAP":"",N._batchColorDisabled?"":"#define BATCHCOLOR",N._batchBlendDisabled?"":"#define BATCHBLEND",N._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),e=Jn(A,D,A.VERTEX_SHADER,Kd.replace("PREFIX",I));A.getShaderParameter(e,A.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",A.getShaderInfoLog(e));var h=Jn(A,D,A.FRAGMENT_SHADER,_r.replace("PREFIX",I));A.getShaderParameter(h,A.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",A.getShaderInfoLog(h)),b?i.push("aPosition"):(D.aPosition=0,A.bindAttribLocation(D,0,"aPosition")),A.linkProgram(D),i.forEach(function(Z){D[Z]=/^u/.test(Z)?A.getUniformLocation(D,Z):A.getAttribLocation(D,Z)}),A.useProgram(D),A.deleteShader(e),A.deleteShader(h)}}},getBrightness:function(l){var b=l.s("brightness"),P=this.isSelected(l)?l.s("select.brightness"):E;return b==E?P:P==E?b:b*P},setHighlightMode:function(z){var r;r="selection"===z?Qb.Mode.Selection:"mouseover"===z?Qb.Mode.MouseOver:Qb.Mode.Disable,this._highlightHelper.mode=r},getHighlightMode:function(){var N=this._highlightHelper.mode;return N===Qb.Mode.Selection?"selection":N===Qb.Mode.MouseOver?"mouseover":"disable"},bindEnvMap:function(i){var l=this,m=l._prg,T=5,F=l.dm().getEnvmap(),v=B.Default.getImage(F);if(v){if(F!==l._lastEnvMap){l._envMapTexture&&i.deleteTexture(l._envMapTexture);var h=l._envMapTexture=i.createTexture();i.bindTexture(i.TEXTURE_CUBE_MAP,h),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,v),i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,v),i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,v),i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,v),i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,v),i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,v),i.bindTexture(i.TEXTURE_CUBE_MAP,null),l._lastEnvMap=F}i.activeTexture(i.TEXTURE0+T),i.bindTexture(i.TEXTURE_CUBE_MAP,l._envMapTexture),i.uniform1i(m.uEnvMap,T)}},getWireframe:function(j){var Y=j.s("wf.visible"),U=j.s("wf.width");return Y===!0||U>0&&"selected"===Y&&this.isSelected(j)?{color:j.s("wf.color"),width:U,"short":j.s("wf.short"),mat:j.s("wf.mat")}:void 0},_transformPointToViewSpace:function(w){var O=[w[0],w[1],w[2]];return _b(O,this._viewMatrix),O},_transformDirectionToViewSpace:function(Y,R){var D=[Y[0],Y[1],Y[2]];_b(D,this._viewMatrix);var f=R?[R[0],R[1],R[2]]:[0,0,0];_b(f,this._viewMatrix);var e=f[0]-D[0],X=f[1]-D[1],W=f[2]-D[2],J=Math.sqrt(e*e+X*X+W*W);return J?[e/J,X/J,W/J]:[e,X,W]},getWireframeGeometry:function(f){return f.s("wf.geometry")?{color:f.s("wf.color"),width:f.s("wf.width"),mat:f.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(S){return S.s("body.color")},getMat:function(v){return v.getMat?v.getMat():v.s("mat")},getFaceMat:function(z,g){return z.getFaceMat?z.getFaceMat(g):z.s(g+".mat")},getFaceBlend:function(a,O){return a.s(O+".blend")||a.s("all.blend")},getFaceColor:function(G,B){return G.s(B+".color")||G.s("all.color")},getFaceImage:function(S,c){return S.s(c+".image")||S.s("all.image")},getFaceBlendImage:function(q,t){return q.s(t+".blend.image")||q.s("all.blend.image")},getFaceDiscardSelectable:function(u,P){var $=u.s(P+".discard.selectable");return $==E?u.s("all.discard.selectable"):$},getFaceUv:function(u,g){return u.s(g+".uv")||u.s("all.uv")},getFaceUvOffset:function(T,I){return T.s(I+".uv.offset")||T.s("all.uv.offset")},getFaceUvScale:function(e,U){return e.s(U+".uv.scale")||e.s("all.uv.scale")},getFaceLight:function(z,J){var V=z.s(J+".light");return V==E?z.s("all.light"):V},getFaceVisible:function(j,c){var o=j.s(c+".visible");return o==E?j.s("all.visible"):o},getFaceOpacity:function(v,z){var b=v.s(z+".opacity");return b==E?v.s("all.opacity"):b},getFaceTransparent:function(e,T){var M=e.s(T+".transparent");return M==E?e.s("all.transparent"):M},getFaceReverseColor:function(J,m){return J.s(m+".reverse.color")||J.s("all.reverse.color")},getFaceReverseFlip:function(k,r){var N=k.s(r+".reverse.flip");return N==E?k.s("all.reverse.flip"):N},getFaceReverseCull:function(I,_){var P=I.s(_+".reverse.cull");return P==E?I.s("all.reverse.cull"):P},getTextureMap:function(){return this._2O},deleteTexture:function(G){var L=this,p=L._2O[G];p&&(delete L._2O[G],L.getGL().deleteTexture(p))},invalidateShape3dCachedImage:function(t){var O=this.getData3dUI(t);O.invalidateCachedTexture(this.getGL())},isInteractive:function(G){return G.s("interactive")},getTexture:function(M,F){if(!M)return E;var g=this,h=g.getGL(),A=g._2O[M];if(!A){var v=wc(M);if(!v)return h._emptyTexture;if(v.tagName){if(v.dynamic)return fb(h,v,g._1O);A=g._2O[M]=fb(h,v)}else{var Y,i=F&&F.s("shape3d.image.cache")&&!g.isInteractive(F),K=g.vr.isPresenting();K&&(F._textureUpdateFrame===h._renderInfo.frame?i=!0:F._textureUpdateFrame=h._renderInfo.frame),i&&(Y=g.getData3dUI(F),A=Y.getCachedTexture());var X;if(!A){var f=F&&F.s("shape3d.fixSizeOnScreen"),t=f?h.NEAREST:h.LINEAR;f||F&&F.s("shape3d.vector.dynamic")&&(Y||(Y=g.getData3dUI(F)),f=Y.getVectorDynamicSize(),f&&(X=g.getDevicePixelRatio(),f[0]*=X,f[1]*=X));var d,O,c=F&&F.s("shape3d.texture.scale")||1;if(f?(X||(X=g.getDevicePixelRatio()),d=f[0]>0?f[0]:c*Ap(v,F)*X,O=f[1]>0?f[1]:c*pi(v,F)*X):(d=c*Ap(v,F),O=c*pi(v,F)),d>=1&&O>=1){var e=yl(d,O);if(!Y&&F&&(Y=g.getData3dUI(F)),Y&&Y.interactiveInfo){var r=M;"object"==typeof r&&(r=r.uuid||(r.uuid=B.Math.generateUUID()));var S=Y.interactiveInfo[r]={};e.interactiveInfo=S.bodyInfo={compInfos:[],matrix:new Xb,rect:{x:0,y:0,width:d,height:O}}}uq(e,v,0,0,d,O,F,g),e.interactiveInfo&&(e.interactiveInfo=null),e.restore(),(i||K)&&fp(v,F)?(A=fb(h,_n,null,t),Y.setCachedTexture(A),_n=null):A=fb(h,_n,g._1O,t)}}}}return A},redraw:function(){this.iv()},validateImpl:function(){var D=this;if(D._lightChanged){D._lightChanged=!1;var i=[],P=[],X=[];D.dm().each(function(E){if(Pl(E)){var A=E.s("light.type");A===Eh?i.push(E):A===Qm?P.push(E):A===ys&&X.push(E)}}),(i.length!==D._59O.length||P.length!==D._spots.length||X.length!==D._dirs.length)&&sd(D),D._59O=i,D._spots=P,D._dirs=X}D._42(),D._1o.iv()},getRenderInfo:function(){var W=this.getGL();return W?W._renderInfo:void 0},getDebugTip:function(){var h=this,C=h.getRenderInfo();if(C){var d=h.getGL()._validBufCount||0,b="Draw Calls: "+C.calls+"<br/>"+"Vertices: "+C.vertices+"<br/>"+"Faces: "+C.faces+"<br/>"+"Lines: "+C.lines+"<br/>"+"Buffer Count: "+d;return h.vr.isPresenting()&&(b+="<br/>VR fps: "+h.vr.getFps()),b}},_42:function(D,q){var X=this;if(!X._35O&&(!Ei||zq(Ei))){var Q,N;D&&(D instanceof Ur?N=D:Q=D);var w=X._canvas,U=X.getGL(),T=X._prg;if(U){var k=X.getWidth(),o=X.getHeight();q?D||nf(w,k,o,q):(q=X.getDevicePixelRatio(),D||k===w.clientWidth&&o===w.clientHeight||nf(w,k,o,q)),U.clear(U.COLOR_BUFFER_BIT),X.drawFilter||(U._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:D?X._frameId:++X._frameId});var M=function(){if(X.overlappingBox.clear(),X._81O=E,U.clear(U.DEPTH_BUFFER_BIT),dn(U,T.uBrightness,1),dn(U,T.uOpacity,1),dn(U,T.uPartOpacity,1),U._picking=!!D,dn(U,T.uPick,!!D),dn(U,T.uTexture,!1),dn(U,T.uBlendTexture,!1),dn(U,T.uAlphaTest,r.alphaTest),dn(U,T.uTransparent,!1),dn(U,T.uFix,!1),dn(U,T.uBatchColor,!1),dn(U,T.uBatchBlend,!1),dn(U,T.uBatchBrightness,!1),dn(U,T.uReflectivity,X._envmapReflectivity||.5),dn(U,T.uCameraPosition,X.getEye()),dn(U,T.uPMatrix,X._projectMatrix=Il(X)),dn(U,T.uViewMatrix,Fq(X,X._7O)),X.bindEnvMap(U),X._viewMatrix=bk(X._7O),D||(On(X,U,T),X._fogDisabled||(dn(U,T.uFogColor,X._fogColor),dn(U,T.uFogNear,X._fogNear),dn(U,T.uFogFar,X._fogFar))),Bg(U,T.aPosition),Bg(U,T.aNormal),Zb(U,T.aUv),Zb(U,T.aBatchColor),Zb(U,T.aBatchBlend),Zb(U,T.aBatchBrightness),Zb(U,T.aLineDistance),N){var i=U.getParameter(U.COLOR_CLEAR_VALUE);U.clearColor(0,0,0,0),U.disable(U.BLEND),Zb(U,T.aNormal),os(U,X._cube.vs,E,T.aPosition),kd(U,X._cube.is),Jp(N,X,Pi,0),Jp(N,X,Gr,6),Jp(N,X,tl,12),Jp(N,X,hq,18),Jp(N,X,Ui,24),Jp(N,X,Ki,30),Bg(U,T.aNormal),ar(U,i)}else if(Q){Q.value=2;var i=U.getParameter(U.COLOR_CLEAR_VALUE);U.clearColor(0,0,0,0),U.disable(U.BLEND),X._95I(U,T,Q),_k(X,Q),ik(X,X._polylineModelMap,Q),ik(X,X._wireframeModelMap,Q),dn(U,T.uTransparent,!0),X._95I(U,T,Q,!0),_k(X,Q,!0),ik(X,X._polylineModelMap,Q,!0),ik(X,X._wireframeModelMap,Q,!0),dn(U,T.uTransparent,!1),U.clear(U.DEPTH_BUFFER_BIT),X._swapLineMap(),X._95I(U,T,Q,!1,!0),ik(X,X._polylineModelMap,Q),ik(X,X._wireframeModelMap,Q),X._swapLineMap(),X._swapLineMap(),X._95I(U,T,Q,!1,!0),ik(X,X._polylineModelMap,Q),ik(X,X._wireframeModelMap,Q),dn(U,T.uTransparent,!0),X._95I(U,T,Q,!0,!0),ik(X,X._polylineModelMap,Q,!0),ik(X,X._wireframeModelMap,Q,!0),dn(U,T.uTransparent,!1),X._swapLineMap(),U.disable(U.DEPTH_TEST),X.drawFilter||X._30O._42(U,T,Q),U.enable(U.DEPTH_TEST),ar(U,i)}else U.disable(U.BLEND),X.drawSky(U,T),X._31O._42(U,T),X._95I(U,T),_k(X),ik(X,X._polylineModelMap),ik(X,X._wireframeModelMap),U.enable(U.BLEND),dn(U,T.uTransparent,!0),U.depthMask(!1),X._95I(U,T,E,!0),_k(X,E,!0),ik(X,X._polylineModelMap,E,!0),ik(X,X._wireframeModelMap,E,!0),U.depthMask(!0),dn(U,T.uTransparent,!1),U.clear(U.DEPTH_BUFFER_BIT),X._swapLineMap(),U.disable(U.BLEND),X._95I(U,T,E,!1,!0),ik(X,X._polylineModelMap),ik(X,X._wireframeModelMap),U.enable(U.BLEND),dn(U,T.uTransparent,!0),U.depthMask(!1),X._95I(U,T,E,!0,!0),ik(X,X._polylineModelMap,E,!0),ik(X,X._wireframeModelMap,E,!0),U.depthMask(!0),dn(U,T.uTransparent,!1),X._swapLineMap(),U.disable(U.DEPTH_TEST),U.disable(U.BLEND),X._32O._42(U,T),X._30O._42(U,T),X._highlightHelper._42(U,T),U.enable(U.DEPTH_TEST);os(U,E),kd(U,E)},t=!1,l=k*q,H=o*q,C=X.vr;C.enable&&C._42(U,l,H,M)&&(t=!0);var F=X.envRenderer;F&&F.enable&&F._42(U,l,H,M)&&(t=!0);var m=X._postProcessing;m._42(U,l,H,M,D)&&(t=!0),t||(X.setViewport(U,0,0,k*q,o*q),M()),X._33Q=!1,X.drawFilter||X.countFrame(),X._doBufferGC(U)}}},enablePostProcessing:function(G,s){return this._postProcessing.enableModule(G,s)},getPostProcessingModule:function(I){return this._postProcessing.getModule(I)},setViewport:function(T,w,m,n,l){this._viewport=[w,m,n,l],T.viewport(w,m,n,l)},getViewport:function(){return this._viewport},setBufferGCInterval:function(M){this._bufferGCInterval=M},_doBufferGC:function(H,y){var R,C,Q=H._bufPool,A=0,B=0,m=H._renderInfo.frame,f=this._bufferGCInterval||10;for(R in Q)A++,C=Q[R],C&&(y||m-C._fid>f?(H.deleteBuffer(C._buf),C._buf=null,Q[R]=null):B++);if(A/2>B&&A>128){var D={};for(R in Q)Q[R]&&(D[R]=Q[R]);H._bufPool=D}H._validBufCount=B},_swapLineMap:function(){var W=this;z=W._polylineModelMap,W._polylineModelMap=W._polylineModelMapSwap,W._polylineModelMapSwap=z,z=W._wireframeModelMap,W._wireframeModelMap=W._wireframeModelMapSwap,W._wireframeModelMapSwap=z,z=W._polylineIndexMap,W._polylineIndexMap=W._polylineIndexMapSwap,W._polylineIndexMapSwap=z,z=W._wireframeIndexMap,W._wireframeIndexMap=W._wireframeIndexMapSwap,W._wireframeIndexMapSwap=z},_updateSkyBox:function(_){if(this._skyBox&&_){var k=_.property,u=!1,O=this._skyBox;if("eye"===k||"forceUpdate"===k){var h=this._eye;O.p3(h[0],h[1],h[2]),u=!0}if("near"===k||"far"===k||"forceUpdate"===k){var Q=this._near,K=this._far,j=O.getFinalScale3d();if(j[0]/=2,j[1]/=2,j[2]/=2,j[0]<=Q||j[0]>=K||j[1]<=Q||j[1]>=K||j[2]<=Q||j[2]>=K){var W=2*Q*K/(Q+K),A=Math.min(j[0],j[1],j[2]),$=W/A,e=O.getScale3d();O.setScale3d(e[0]*$,e[1]*$,e[2]*$),u=!0}}u&&this.invalidateData(O)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(U){var I=this._skyBox;I&&(this._skyBoxStyleMap&&I.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&I.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&I.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=U,this.ump(this._updateSkyBox,this),U&&(U.dm()&&U.dm().remove(U),this._skyBoxStyleMap=B.Default.clone(U.getStyleMap()),this._skyBoxAnchor3d=U.getAnchor3d(),U.setAnchor3d(.5,.5,.5),this._skyBoxP3=U.p3().slice(0),U.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",I,U)},drawSky:function(R,C,e){var K=this,Y=K._skyBox;if(Y){var V=K._headlightIntensity,H=oo(K._headlightColor),C=K._prg;1!==V&&(H=[H[0]*V,H[1]*V,H[2]*V]),dn(R,C.uHeadlightColor,[H[0],H[1],H[2],1]);var s=K.getData3dUI(Y);s&&s._42(R,C,e,function(){return!0}),R.clear(R.DEPTH_BUFFER_BIT),dn(R,C.uHeadlightColor,[H[0],H[1],H[2],K._headlightDisabled?1:0])}},_95I:function(H,S,Z,G,g){function h(v){if(!!v.s("shape3d.alwaysOnTop")==!!g&&$.isVisible(v)&&(!w||q)){if(!Z&&$.isTransparentMask(v))return;var N=$.getData3dUI(v);N&&N._42(H,S,Z,i)}}var $=this,i=function(v){return G?v:!v};$.sky&&H.clear(H.DEPTH_BUFFER_BIT);var l=$.drawFilter;l?$.dm().each(function(S){l(S)||h(S)}):$.dm().each(function(y){h(y)})},getLogicalPoint:function(X){return He(X,this._canvas)},isRectOverlapping:function(R){var c=this.getData3dUI(R);return c._rectOverlapping},getHitFaceInfo:function(G){G.target&&(G=this.lp(G));var y=this.getDataInfoAt(G);if(y){var F=this._1o.face(y.data,ti(G.x,G.y));if(F)return{data:y.data,face:F}}return E},unproject:function(q,C){var z=this,Z=z.getWidth(),o=z.getHeight(),L=q.target?z.lp(q):q,G=L.x-Z/2,s=L.y-o/2,J=2*(G/Z),O=2*(-1*s/o);C=C||0;var V=ig(),n=Il(z),I=Fq(z);so(V,n,I),ch(V);var E=ug([J,O,C,1],V);return[E[0]/E[3],E[1]/E[3],E[2]/E[3]]},getDataAt:function(B){var k=this.getDataInfoAt(B);return k?k.data:E},getDataInfoAt:function(M,r){return M.target&&(M=this.lp(M)),this._1o.get(ti(M.x,M.y,r),!0)},getDatasInRect:function(I){return this._1o.get(I)},setEditable:function(l){var c=this,N=c._editable;c._editable=l,this.fp(Zh,N,l)},isEditable:function(d){var B=this;return B._editable?fk(d)?d.s("3d.editable")?B._editableFunc?B._editableFunc(d):!0:!1:!1:!1},isSelectable:function(c){return c.s("3d.selectable")&&this.sm().isSelectable(c)},isMovable:function(G){var Y=this;return Ll(G)&&G.getStyle(Qr)!==mc?!1:G.s("3d.movable")?Y._movableFunc?Y._movableFunc(G):!0:!1},isSizeEditable:function(w){return fk(w)?this._sizeEditableFunc?this._sizeEditableFunc(w):!0:!1},isRotationEditable:function(N){return fk(N)&&N.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(N):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(z){this.setZoom(Yp,z)},zoomOut:function(j){this.setZoom(1/Yp,j)},setZoom:function(d,$){if(1!==d){var i=this;if(i._ortho)return i.setOrthoZoom(d,$),void 0;i._14o&&i._14o.stop(!0);var m=1/d,t=i._eye,o=i._center,l=o[0]+(t[0]-o[0])*m-t[0],c=o[1]+(t[1]-o[1])*m-t[1],U=o[2]+(t[2]-o[2])*m-t[2];if(!(gn(t,o)<i._moveStep&&1>m)){if($=_q($)){var Y=Rn(t);return $.action=function(m){i.fi({kind:i._zooming?"betweenZoom":"beginZoom"}),i._zooming=1,t[0]=Y[0]+l*m,t[1]=Y[1]+c*m,t[2]=Y[2]+U*m,i.fp(Pc,E,t)},$._37o=function(){delete i._14o,delete i._zooming,i.fi({kind:"endZoom"}),i.onZoomEnded()},i._14o=Dk($)}t[0]+=l,t[1]+=c,t[2]+=U,i.fp(Pc,E,t)}}},setOrthoZoom:function(g,u){if(1!==g){var p=this;p._14o&&p._14o.stop(!0);var z=p._orthoWidth,L=z/g-z;if(!(z<p._moveStep&&g>1))return(u=_q(u))?(u.action=function(d){p.fi({kind:p._zooming?"betweenZoom":"beginZoom"}),p._zooming=1,p.setOrthoWidth(z+L*d)},u._37o=function(){delete p._14o,delete p._zooming,p.fi({kind:"endZoom"}),p.onZoomEnded()},p._14o=Dk(u)):(p.setOrthoWidth(z/g),void 0)}},getPositionInfo:function(G){var e=this,M=e._eye,_=e._center,d=e.getAspect(),p=G?il(qi(_,M,!0),qi(G,M)):gn(M,_);if(e._ortho){var A=e._orthoWidth;return{length:p,height:A/d,width:A}}var y=2*L(e._fovy/2)*p;return{length:p,height:y,width:y*d}},getCenterInfo:function(){var e=this;return e._81O||(e._81O=e.getPositionInfo()),Rn(e._81O)},rotate:function(Q,C,g,v){var L=this;if(Q||C){v==E&&(v=L._firstPersonMode),L._88O&&L._88O.stop(!0);var r=L._center,m=L._eye,t=L.getCenterInfo().length,l=v?r:m,c=v?m:r,Y=qi(l,c),o=U(Y[0],Y[2]),z=U(i(Y[0]*Y[0]+Y[2]*Y[2]),Y[1]),D=v?Lr:Pc;return v&&(C=-C),(g=_q(g))?(g.action=function($){L.fi({kind:L._rotating?"betweenRotate":"beginRotate"}),L._rotating=1;var w=o+Q*$,K=z+C*$;K=$q(K),Y[0]=t*y(K)*y(w),Y[1]=t*T(K),Y[2]=t*y(K)*T(w),l[0]=c[0]+Y[0],l[1]=c[1]+Y[1],l[2]=c[2]+Y[2],L.fp(D,E,l)},g._37o=function(){delete L._88O,delete L._rotating,L.fi({kind:"endRotate"}),L.onRotateEnded()},L._88O=Dk(g)):(o+=Q,z+=C,z=$q(z),Y[0]=t*y(z)*y(o),Y[1]=t*T(z),Y[2]=t*y(z)*T(o),l[0]=c[0]+Y[0],l[1]=c[1]+Y[1],l[2]=c[2]+Y[2],L.fp(D,E,l),void 0)}},pan:function(I,d,g,G){if(I||d){var n=this;G==E&&(G=n._firstPersonMode),n._89O&&n._89O.stop(!0);var $=Fq(n),L=[$[0]*I,$[4]*I,$[8]*I],u=[$[1]*d,$[5]*d,$[9]*d],A=L[0]+u[0],q=L[1]+u[1],z=L[2]+u[2],r=n._center,S=n._eye;if(G){var Q=qq(n.getBoundaries(),S[0],S[2],S[0]+A,S[2]+z,i(A*A+z*z));A=Q[0],z=Q[1]}if(g=_q(g)){var m=Rn(S),s=Rn(r);return g.action=function(X){n.fi({kind:n._panning?"betweenPan":"beginPan"}),n._panning=1,r[0]=s[0]+A*X,r[1]=s[1]+q*X,r[2]=s[2]+z*X,S[0]=m[0]+A*X,S[1]=m[1]+q*X,S[2]=m[2]+z*X,n.fp(Pc,E,S),n.fp(Lr,E,r)},g._37o=function(){delete n._89O,delete n._panning,n.fi({kind:"endPan"}),n.onPanEnded()},n._89O=Dk(g)}r[0]+=A,r[1]+=q,r[2]+=z,S[0]+=A,S[1]+=q,S[2]+=z,n.fp(Pc,E,S),n.fp(Lr,E,r)}},walk:function(h,L,N){if(h){var j=this;N==E&&(N=j._firstPersonMode),j._90O&&j._90O.stop(!0);var R=j._center,q=j._eye,U=qi(R,q,!0);if(N){var y=qq(j.getBoundaries(),q[0],q[2],q[0]+U[0]*h,q[2]+U[2]*h,F(h));if(h=gn(y),!h)return;U=[y[0]/h,0,y[1]/h]}if(L=_q(L)){var f=Rn(q),u=Rn(R);return L.action=function(z){j.fi({kind:j._walking?"betweenWalk":"beginWalk"}),j._walking=1;var x=h*z;q[0]=f[0]+U[0]*x,q[1]=f[1]+U[1]*x,q[2]=f[2]+U[2]*x,R[0]=u[0]+U[0]*x,R[1]=u[1]+U[1]*x,R[2]=u[2]+U[2]*x,j.fp(Pc,E,q),j.fp(Lr,E,R)},L._37o=function(){delete j._90O,delete j._walking,j.fi({kind:"endWalk"}),j.onWalkEnded()},j._90O=Dk(L)}q[0]+=U[0]*h,q[1]+=U[1]*h,q[2]+=U[2]*h,R[0]+=U[0]*h,R[1]+=U[1]*h,R[2]+=U[2]*h,j.fp(Pc,E,q),j.fp(Lr,E,R)}},handleScroll:function(W,V){W.preventDefault();var M=this,x=M._moveStep,v=M.getDataInfoAt(W);
if(v){var e=v.data;if(e&&M.isInteractive(e)){var $=M.intersectObject(W,e);if($){var k=$.part,w=wc(e.s(k+".image")||e.s("shape3d."+k+".image")||e.s("all.image")||e.s("shape3d.image"));if(w&&aq(w.scrollable,e,M))return}}}M.isFirstPersonMode()?M.isPannable()&&M.pan(0,V>0?x:-x):M.isZoomable()&&M.setZoom(0>V?1/ql:ql)},handlePinch:function(n,Q){this.isZoomable()&&this.setZoom(Q>n?1/_e:_e)},reset:function(){this.setCenter($.graph3dViewCenter),this.setEye($.graph3dViewEye),this.setUp($.graph3dViewUp)},moveSelection:function(X,f,N){var C=this;C.dm().beginTransaction(),sr(this.sm().toSelection(this.isMovable,this),X,f,N),C.dm().endTransaction()},getMoveMode:function(I,c){var B=c.s("3d.move.mode");if(B)return B;var G="88",a="89",m="90";return Cj(I)||tq[G]&&tq[a]&&tq[m]?"xyz":tq[G]&&tq[a]?"xy":tq[G]&&tq[m]?"xz":tq[a]&&tq[m]?"yz":tq[G]?"x":tq[a]?"y":tq[m]?"z":"xz"},handleTick:function(){var S=this,Y=!1,O=S._moveStep,z=O,Q=!1,t=!0,E=S._rotateStep*(t?-1:1);if(S.isWalkable()||(z=0),S.isPannable()||(O=0),S.isRotatable()||(E=0),S._32Q){var K=(xq()-S._32Q)/50;z*=K,O*=K,E*=K}S._31Q&&(gl(S._31Q),delete S._31Q,delete S._32Q),Fk()&&(Y=!0,S.pan(-O,0,Q,t)),Vc()&&(Y=!0,S.pan(O,0,Q,t)),kh()&&(Y=!0,Cj()?S.pan(0,O,Q,t):S.walk(z,Q,t)),um()&&(Y=!0,Cj()?S.pan(0,-O,Q,t):S.walk(-z,Q,t)),Hf()&&(Y=!0,S.rotate(-E,0,Q,t)),eg()&&(Y=!0,S.rotate(E,0,Q,t)),uh()&&(Y=!0,S.rotate(0,-E/2,Q,t)),ps()&&(Y=!0,S.rotate(0,E/2,Q,t)),Y&&(S._32Q=xq(),S._31Q=Sm(S.handleTick,S))},handleKeyDown:function($){var Q=this;!In($)&&yk[$.keyCode]?Q.handleTick():kj($)?Q.selectAll():Bb($)?Q.handleDelete($):dg($)&&this.isResettable()&&Q.reset()},checkDoubleClickOnNote:function(D,z,n){var m=this;if(n===No){if(z.s("note.toggleable"))return z.s(Gf,!z.s(Gf)),m.fi({kind:"toggleNote",event:D,data:z,part:n}),!0}else if(n===ss&&z.s("note2.toggleable"))return z.s(Oe,!z.s(Oe)),m.fi({kind:"toggleNote2",event:D,data:z,part:n}),!0;return!1},checkDoubleClickOnRotation:function(a,y,p){return p===Oj?(y.setRotationX(0),!0):p===Lj?(y.setRotationY(0),!0):p===Dn?(y.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(N){var m=this;if(m.isOrtho())return m.getWidth()/m.getOrthoWidth();var X=m.getCenter(),t=m.getHeight(),J=m.getEye(),C=[X[0]-J[0],X[1]-J[1],X[2]-J[2]],B=[N[0]-J[0],N[1]-J[1],N[2]-J[2]],w=Math.sqrt(C[0]*C[0]+C[1]*C[1]+C[2]*C[2]),z=1/Math.tan(m.getFovy()/2);return t*w*z/(B[0]*C[0]+B[1]*C[1]+B[2]*C[2])},inViewSpace:function(l){var q,b=this,J=b._transformPointToViewSpace(l),c=b.getAspect(),K=b.getNear(),Q=b.getFar();return-J[2]<K||-J[2]>Q?!1:b.isOrtho()?(q=b.getOrthoWidth()/2,Math.abs(J[0])<=q&&Math.abs(J[1]*c)<=q):(q=Math.sqrt(J[0]*J[0]+J[1]*J[1]+J[2]*J[2])*Math.tan(b.getFovy()/2),Math.abs(J[1]<=q)&&Math.abs(J[0])<=q*c)},toViewPosition:function(D){var U=this,L=U.getWidth()/2,e=U.getHeight()/2,P=U._18Q;return P&&P._wh===L/e||(P=Il(U),U._18Q=so(P,P,Fq(U)),U._18Q._wh=L/e),D=ug([D[0],D[1],D[2],1],P),{x:L+L*D[0]/D[3],y:e-e*D[1]/D[3]}},getHitPosition:function(n,E,t){var d=this,e=d.getWidth(),M=d.getHeight(),s=n.target?d.lp(n):n,A=s.x-e/2,u=s.y-M/2,R=d.getCenterInfo(),o=Fq(d);E=E?E:[0,0,0],t=t?t:[0,1,0],A=A/e*R.width,u=-1*u/M*R.height;var r=[o[0]*A,o[4]*A,o[8]*A],C=[o[1]*u,o[5]*u,o[9]*u],B=[r[0]+C[0],r[1]+C[1],r[2]+C[2]],Y=d.getCenter(),l=Rm(d,E,t,[B[0]+Y[0],B[1]+Y[1],B[2]+Y[2]]);return l?l:[0,0,0]},intersectObject:function(D,i){return this._raycaster.intersectObject(D,i)},intersectObjects:function(x,d,e){return this._raycaster.intersectObjects(x,d,e)},getLineLength:function(T){this.validate();var n=this.getData3dUI(T);if(n&&n.getCache){var M=n.getCache();if(M)return M[M.length-1].length}return 0},getLineOffset:function(R,D){var u=this.getData3dUI(R);if(u&&u.getCache){var m=u.getCache();if(m)return lg(m,D)}return E},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(b,m,d){var i=this,$=i.getEye();$=[$[0],$[1],$[2]];var J=i.getCenter();if(J=[J[0],J[1],J[2]],b||(b=$),m||(m=J),i._flyAnim&&i._flyAnim.stop(!0),d=_q(d),!d)return i.setEye(b[0],b[1],b[2]),i.setCenter(m[0],m[1],m[2]),delete i._flyAnim,!0;var _=[b[0]-$[0],b[1]-$[1],b[2]-$[2]],N=[m[0]-J[0],m[1]-J[1],m[2]-J[2]];return d.action=function(Z){i.setCenter(J[0]+N[0]*Z,J[1]+N[1]*Z,J[2]+N[2]*Z),i.setEye($[0]+_[0]*Z,$[1]+_[1]*Z,$[2]+_[2]*Z)},d._37o=function(){delete i._flyAnim},i._flyAnim=Dk(d)},flyTo:function(){function i(i,N,L){if(L instanceof B.Node){$.fromArray(fl(L,N.getMat(L)));var t=L.getAnchor3d();i.push((new ud).set(0-t.x,0-t.y,0-t.z).applyMatrix4($)),i.push((new ud).set(0-t.x,0-t.y,1-t.z).applyMatrix4($)),i.push((new ud).set(0-t.x,1-t.y,0-t.z).applyMatrix4($)),i.push((new ud).set(0-t.x,1-t.y,1-t.z).applyMatrix4($)),i.push((new ud).set(1-t.x,0-t.y,0-t.z).applyMatrix4($)),i.push((new ud).set(1-t.x,0-t.y,1-t.z).applyMatrix4($)),i.push((new ud).set(1-t.x,1-t.y,0-t.z).applyMatrix4($)),i.push((new ud).set(1-t.x,1-t.y,1-t.z).applyMatrix4($))}}var o=new ud,u=new ud,f=new ud,L=new ud,$=new fg,q=new B.Math.Quaternion,C=new ln;return function(J,c,d){var p=this;if(d!==n)c={animation:c,ratio:d};else{var W=typeof c;("boolean"===W||"object"===W&&c.duration)&&(c={animation:c})}c=c||{},o.fromArray(p.getEye()),u.fromArray(p.getCenter());var j,v,$=[],K=c.center,G=c.distance===n;if(K&&f.fromArray(K),J instanceof B.Node)K||f.fromArray(J.p3()),G&&(i($,p,J),j=$.length);else{if(J||(J=p.dm().getDatas()),!J.length)return;if((G||!K)&&($=[],J.forEach(function(R){i($,p,R)}),j=$.length),!j)return;if(!K){for(f.set(0,0,0),v=0;j>v;v++)f.add($[v]);f.multiplyScalar(1/j)}}if(p.setCenter(f.x,f.y,f.z),L.subVectors(o,u),c.direction||c.worldDirection){!c.worldDirection&&J instanceof B.Node?q.setFromEuler(C.set(J.r3(),J.getRotationMode(),!0)):q.set(0,0,0,1);var b=L.length();L.fromArray(c.worldDirection||c.direction).applyQuaternion(q).setLength(b)}if(G){for(var F,Q,l,R,D,w=p.getNear(),N=10,d=c.ratio||.8;N--;){for(p._eye[0]=L.x+f.x,p._eye[1]=L.y+f.y,p._eye[2]=L.z+f.z,F=Il(p),so(F,F,Fq(p)),R=!0,D=-1/0,v=0;j>v;v++){if(l=$[v],Q=ug([l.x,l.y,l.z,1],F),Q[3]<w&&N){L.multiplyScalar(2),R=!1;break}D=Math.max(D,Math.max(Math.abs(Q[0]),Math.abs(Q[1]))/d-Q[3])}if(R)break}L.setLength(D+L.length()).add(f)}else L.setLength(c.distance).add(f);p._flyAnim&&p._flyAnim.stop(!0);var y=_q(c.animation);if(y){p.setEye(o.x,o.y,o.z),p.setCenter(u.x,u.y,u.z);var E=(new ud).subVectors(L,o),k=(new ud).subVectors(f,u),x=new ud,T=new ud;return y.action=function(S){x.copy(o).addScaledVector(E,S),T.copy(u).addScaledVector(k,S),p.setCenter(T.x,T.y,T.z),p.setEye(x.x,x.y,x.z)},y._37o=function(){delete p._flyAnim},{lastEye:o,lastCenter:u,eye:L,center:f,animation:p._flyAnim=Dk(y)}}return p.setEye(L.x,L.y,L.z),delete p._flyAnim,{lastEye:o,lastCenter:u,eye:L,center:f}}}(),getBoundingBox:function(){function L(a,M,O){t.fromArray(fl(O,M.getMat(O)));var E=O.getAnchor3d();a.push((new ud).set(0-E.x,0-E.y,0-E.z).applyMatrix4(t)),a.push((new ud).set(0-E.x,0-E.y,1-E.z).applyMatrix4(t)),a.push((new ud).set(0-E.x,1-E.y,0-E.z).applyMatrix4(t)),a.push((new ud).set(0-E.x,1-E.y,1-E.z).applyMatrix4(t)),a.push((new ud).set(1-E.x,0-E.y,0-E.z).applyMatrix4(t)),a.push((new ud).set(1-E.x,0-E.y,1-E.z).applyMatrix4(t)),a.push((new ud).set(1-E.x,1-E.y,0-E.z).applyMatrix4(t)),a.push((new ud).set(1-E.x,1-E.y,1-E.z).applyMatrix4(t))}var t=new fg;return function(J){if(J=J||this.sm().getSelection(),J instanceof B.Node&&(J=[J]),0===J.length)return E;var l=[];J.forEach(function(O){L(l,this,O)},this);var e=[1/0,1/0,1/0],P=[-1/0,-1/0,-1/0];return l.forEach(function(m){e[0]=Math.min(m.x,e[0]),e[1]=Math.min(m.y,e[1]),e[2]=Math.min(m.z,e[2]),P[0]=Math.max(m.x,P[0]),P[1]=Math.max(m.y,P[1]),P[2]=Math.max(m.z,P[2])}),{min:e,max:P}}}()}),Ip.RenderEnv=function(c){this.gv=c,this.enable=!1},O.defineProperties(Ip.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(C){this._debugOn=C,this.capture&&this.capture()}}}),O.assign(Ip.RenderEnv.prototype,{renderEnvToCube:function(E,z,c,P){var l=this,m=l.gv;if(!E||!z||!c)return l.enable=!1,l._42=null,void 0;l.enable=!0;var V=Math.floor(P/E*z),a=m.getGL(),t=l._renderTargets;t?t.length<c&&(t=l._renderTargets=t.concat(new Array(c-t.length))):t=l._renderTargets=new Array(c);for(var _=0;c>_;_++)t[_]?t[_].setSize(a,P,V):t[_]=new Ip.RenderTarget(m,a,P,V);var u=!1;l.capture=function(){u=!0,m._42(),u=!1};var B=new ud,x=new ud,H=new ud,G=new ud,R=(new ud).setY(0),q=2*Math.PI/c,v=E/2/Math.tan(Math.PI/c),Z=2*Math.atan2(z/2,v),i=E/z;l._42=function(S,J,j,r){var P=l._debugOn;if(!u&&!P)return!1;B.copy(m.getEye()),G.copy(m.getCenter()).sub(B);var M=Math.atan2(G.z,G.x),Q=m.getNear(),b=m.getFovy(),V=m.getAspect();x.copy(m.getCenter());for(var $,s=0;c>s;s++)if($=t[s],R.setZ(Math.cos(M)).setX(Math.sin(M)).multiplyScalar(v),M-=q,H.addVectors(B,R),m.setNear(v),m.setCenter([H.x,H.y,H.z]),m.setFovy(Z),m.setAspect(i),P){var g=Math.round(J/c);S.viewport(g*s,0,g,j),r()}else Up(S,$.frame),S.viewport(0,0,$.width,$.height),S.clear(S.COLOR_BUFFER_BIT),r(),Hc(S),$.assureTexture();return m.setNear(Q),m.setCenter([x.x,x.y,x.z]),m.setFovy(b),m.setAspect(V),!0},l.capture()},getTextureInfo:function(n){var o=this._renderTargets;if(!o)return null;var M=this._renderTargets[n];return M?{index:n,texture:M.texture,textureName:M.uuid}:null}}),O.assign(Ip.Graph3dView.prototype,{renderEnvToCube:function(x,H,I,k){var O=this;O.envRenderer||(O.envRenderer=new Ip.RenderEnv(O)),O.envRenderer.renderEnvToCube(x,H,I,k)}}),Ip.RenderTarget=function(Q,_,g,X,K){var W=this;K=K||{},W.uuid=B.Math.generateUUID(),W.gv=Q,W.init(Q,_,K),W.setSize(_,g,X)},O.assign(Ip.RenderTarget.prototype,{init:function(H,B,I){var V=this,y=V.texture=B.createTexture();B.activeTexture(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,y),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_WRAP_S,B.CLAMP_TO_EDGE),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_WRAP_T,B.CLAMP_TO_EDGE),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_MIN_FILTER,I.minFilter||B.LINEAR),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_MAG_FILTER,I.magFilter||B.LINEAR),B.bindTexture(B.TEXTURE_2D,null),V.render=B.createRenderbuffer(),V.frame=B.createFramebuffer(),H._2O[V.uuid]=y},assureTexture:function(){var l=this,m=l.uuid,V=l.gv._2O;V[m]||(V[m]=l.texture)},setSize:function(F,u,C){var q=this;if(q.width!==u||q.height!==C){var v=F.RGBA,V=F.TEXTURE_2D,T=F.RENDERBUFFER,O=F.FRAMEBUFFER;Yn(F,q.texture),F.texImage2D(V,0,v,u,C,0,v,F.UNSIGNED_BYTE,E),F.bindRenderbuffer(T,q.render),F.renderbufferStorage(T,F.DEPTH_COMPONENT16,u,C),Up(F,q.frame),F.framebufferTexture2D(O,F.COLOR_ATTACHMENT0,V,q.texture,0),F.framebufferRenderbuffer(O,F.DEPTH_ATTACHMENT,T,q.render),Yn(F,E),F.bindRenderbuffer(T,E),Hc(F),q.width=u,q.height=C}},toCanvas:function(){var K=this,u=K.gv.getGL();Up(u,K.frame);var J=K.width,G=K.height,X=new Uint8Array(4*J*G);u.readPixels(0,0,J,G,u.RGBA,u.UNSIGNED_BYTE,X),Hc(u);var s=W.createElement("canvas");s.width=J,s.height=G;var Q=s.getContext("2d"),E=Q.createImageData(J,G);return E.data.set(X),Q.putImageData(E,0,0),s}});var So=Ip.Interactor=function(r){this.gv=r};Bp("Interactor",O,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Wj=Ip.DefaultInteractor=function(H){bs(Wj,this,[H])};Bp("DefaultInteractor",So,{handle_contextmenu:function(i){ki(i)},handle_mousewheel:function(R){this.gv.handleScroll(R,R.wheelDelta/40)},handle_DOMMouseScroll:function(b){2===b.axis&&this.gv.handleScroll(b,-b.detail)},handle_keydown:function(o){this.gv.handleKeyDown(o)},handle_mousedown:function(H){this.handle_touchstart(H)},handle_touchstart:function(N){ki(N);var M=this,q=M.gv,O=rq(N),H=q.getDataInfoAt(N),G=H?H.data:E,_=H?H.part:E,A=q.sm(),j=lm(N),l=Bf(N);q.setFocus(N)&&(M._62O=E,M._57I=E,G?In(N)?A.co(G)?A.rs(G):A.as(G):A.co(G)||A.ss(G):O&&(In(N)?q.isRectSelectable()&&(M._62O=Qn):M._57I=Rb(N)),M._31Q&&(gl(M._31Q),delete M._31Q,delete M._32Q),M._62O||(q.isFirstPersonMode()&&(Cj(N)||l>2?M._62O="pan":q.isMouseRoamable()||im?(M._62O="roaming",M.foward=j&&rq(N),M._32Q=xq(),M._31Q=Sm(M.tick,M)):O||(M._62O="roaming")),M._62O||(O&&j&&Sf[_]?(M._62O=_,M.p3=G.p3()):O&&j&&fk(G)&&q.isSelected(G)?q.isMovable(G)?(M._62O="move",M.p3=G.p3(),M.movedata=G):q.isInteractive(G)&&(M._62O="none"):im&&(l>2?M._62O="pan":2===l&&(M.dist=jr(N),M._62O="pinch")))),M.point=q.lp(N),to(M,N),nd(N)?q.handleDoubleClick(N,G,_):q.handleClick(N,G,_))},tick:function(){var G=this,$=G.gv,X=$._moveStep;G.point&&$.isWalkable()&&(G._32Q&&(X*=(xq()-G._32Q)/50),$.walk(G.foward?X:-X),G._32Q=xq(),G._31Q=Sm(G.tick,G))},handle_mouseup:function(A){this.handle_touchend(A)},handle_touchend:function(v){var p=this._57I;p&&(gn(p,Rb(v))<=1&&this.gv.sm().cs(),this._57I=E)},handleWindowMouseMove:function(Y){this.handleWindowTouchMove(Y)},handleWindowTouchMove:function(Z){var s,K,$=this,l=$.gv,L=$._62O,R=$.point,v=l.dm(),i=l.lp(Z),C=i.x-R.x,q=i.y-R.y,a=l.getWidth(),b=l.getHeight();if(a&&b){var O=-f*C/a,Q=-f*q/b;if("roaming"===L)$.rotate(Z,O/2,Q/2);else if(L===Oj||L===Lj||L===Dn)l._86O||v.beginTransaction(),l.fi({kind:l._86O?"betweenEditRotation":"beginEditRotation",event:Z}),l._86O=1,l.sm().each(function(D){if(fk(D)&&l.isRotationEditable(D)){var _=F(O)>F(Q)?O:Q;L===Oj?D.setRotationX(D.getRotationX()+_):L===Lj?D.setRotationY(D.getRotationY()+_):L===Dn&&D.setRotationZ(D.getRotationZ()+_)}});else if("move"===L||Sf[L]){L===Mc||L===Pr||L===od?(l._87O||v.beginTransaction(),l.fi({kind:l._87O?"betweenEditScale":"beginEditScale",event:Z}),l._87O=1):(l._moving||v.beginTransaction(),l.fi({kind:l._moving?"betweenMove":"beginMove",event:Z}),l._moving=1);var p,x=$.p3,_=l.getPositionInfo(x),t=Fq(l);p=L===Tg?"x":L===xd?"y":L===Cs?"z":L===Mc?"sx":L===Pr?"sy":L===od?"sz":l.getMoveMode(Z,$.movedata),C=C/a*_.width,q=-1*q/b*_.height;var y,n,M=[t[0]*C,t[4]*C,t[8]*C],A=[t[1]*q,t[5]*q,t[9]*q],B=M[0]+A[0],W=M[1]+A[1],D=M[2]+A[2],r=[x[0]+B,x[1]+W,x[2]+D],T=qi(l.getEye(),r,!0);if("xyz"===p?(y=r,l.moveSelection(B,W,D)):"xz"===p?(y=Rm(l,x,[0,1,0],r),y&&l.moveSelection(y[0]-x[0],0,y[2]-x[2])):"xy"===p?(y=Rm(l,x,[0,0,1],r),y&&l.moveSelection(y[0]-x[0],y[1]-x[1],0)):"yz"===p?(y=Rm(l,x,[1,0,0],r),y&&l.moveSelection(0,y[1]-x[1],y[2]-x[2])):"x"===p||"sx"===p?(T[0]=0,y=Rm(l,x,T,r),y&&(n=y[0]-x[0],"x"===p?l.moveSelection(n,0,0):l.sm().each(function(j){fk(j)&&l.isSizeEditable(j)&&(s=j.getScaleX()+n/100,K=s/j.getScaleX(),j.setScaleX(s),Cj(Z)&&(j.setScaleY(j.getScaleY()*K),j.setScaleTall(j.getScaleTall()*K)))}))):"y"===p||"sy"===p?(T[1]=0,y=Rm(l,x,T,r),y&&(n=y[1]-x[1],"y"===p?l.moveSelection(0,n,0):l.sm().each(function(F){fk(F)&&l.isSizeEditable(F)&&(s=F.getScaleTall()+n/100,K=s/F.getScaleTall(),F.setScaleTall(s),Cj(Z)&&(F.setScaleY(F.getScaleY()*K),F.setScaleX(F.getScaleX()*K)))}))):("z"===p||"sz"===p)&&(T[2]=0,y=Rm(l,x,T,r),y&&(n=y[2]-x[2],"z"===p?l.moveSelection(0,0,n):l.sm().each(function(y){fk(y)&&l.isSizeEditable(y)&&(s=y.getScaleY()+n/100,K=s/y.getScaleY(),y.setScaleY(s),Cj(Z)&&(y.setScaleX(y.getScaleX()*K),y.setScaleTall(y.getScaleTall()*K)))}))),!y)return;$.p3=y}else if(L===Qn){var g=$.div;g||(g=$.div=Rd(),Hi($.getView(),g),g.op=R,g.style.background=l.getRectSelectBackground()),l.fi({kind:l._rectSelecting?"betweenRectSelect":"beginRectSelect",event:Z}),l._rectSelecting=1,g.rect=Vn(g.op,i),ib(g,g.rect)}else if("pinch"===L&&2===Bf(Z)){l.fi({kind:l._pinching?"betweenPinch":"beginPinch",event:Z}),l._pinching=1;var n=jr(Z);l.handlePinch(n,$.dist),$.dist=n}else"pan"===L||Cj(Z)?$.pan(Z,C,q):"none"===L||l.isFirstPersonMode()||(rq(Z)?$.rotate(Z,O,Q):($.pan(Z,C,0),l.isWalkable()&&(l.fi({kind:l._walking?"betweenWalk":"beginWalk",event:Z}),l._walking=1,l.walk(q/l.getHeight()*l.getCenterInfo().height))));$.point=i}},pan:function(m,O,E){var Q=this.gv;if(Q.isPannable()){var s=Q.getWidth(),h=Q.getHeight();if(!s||!h)return;var t=Q.getCenterInfo(),o=O/s*t.width,P=-1*E/h*t.height;Q.fi({kind:Q._panning?"betweenPan":"beginPan",event:m}),Q._panning=1,Q.pan(-o,-P)}},rotate:function(B,A,v){var C=this.gv;C.isRotatable()&&(C.fi({kind:C._rotating?"betweenRotate":"beginRotate",event:B}),C._rotating=1,C.rotate(A,v))},handleWindowMouseUp:function(K){this.handleWindowTouchEnd(K)},handleWindowTouchEnd:function(D){var U=this,L=U.gv,p=L.dm(),q=U.div;if(q){var K=L.getDatasInRect(q.rect);if(!K.isEmpty()){var B=L.sm(),Z=B.toSelection();K.each(function(v){B.co(v)?Z.remove(v):Z.add(v)}),B.ss(Z)}ii(q)}L._moving&&(delete L._moving,L.fi({kind:"endMove",event:D}),L.onMoveEnded(),p.endTransaction()),L._panning&&(delete L._panning,L.fi({kind:"endPan",event:D}),L.onPanEnded()),L._rotating&&(delete L._rotating,L.fi({kind:"endRotate",event:D}),L.onRotateEnded()),L._86O&&(delete L._86O,L.fi({kind:"endEditRotation",event:D}),p.endTransaction()),L._87O&&(delete L._87O,L.fi({kind:"endEditScale",event:D}),p.endTransaction()),L._pinching&&(delete L._pinching,L.fi({kind:"endPinch",event:D}),L.onPinchEnded()),L._rectSelecting&&(delete L._rectSelecting,L.fi({kind:"endRectSelect",event:D}),L.onRectSelectEnded()),L._walking&&(delete L._walking,L.fi({kind:"endWalk",event:D}),L.onWalkEnded()),U.dist=U.point=U._62O=U.p3=U.movedata=U.div=U._57I=U._32Q=U._31Q=U.foward=E}});var Im=Ip.MapInteractor=function(X){bs(Im,this,[X]),this._minPhi=0,this._maxPhi=5*t/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right"};Bp("MapInteractor",So,{handle_contextmenu:function(Y){ki(Y)},handle_mousewheel:function(M){this.gv.handleScroll(M,M.wheelDelta/40)},handle_DOMMouseScroll:function(b){2===b.axis&&this.gv.handleScroll(b,-b.detail)},handle_keydown:function(J){this.gv.handleKeyDown(J)},handle_mousedown:function(N){this.handle_touchstart(N)},handle_touchstart:function(d){ki(d);var m=this,f=m.gv;if(f.setFocus(d)){f.lp(d);var k=f.getDataInfoAt(d),B=k?k.data:E,R=k?k.part:E;if(!B||!f.isInteractive(B)){var Y=m.editing={point:f.lp(d)};im?Y.touch=!0:(Y.touch=!1,Y.pan="left"===this.panButton===rq(d)),to(m,d)}nd(d)?f.handleDoubleClick(d,B,R):f.handleClick(d,B,R)}},handle_mouseup:function(f){this.handle_touchend(f)},handle_touchend:function(){},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowTouchMove:function(C){var h=this,M=h.gv,Q=h.editing;if(Q){var n=M.lp(C),I=Q.point,r=n.x-I.x,F=n.y-I.y;if(!Q.moved){if(Math.abs(r)<h.threshold&&Math.abs(F)<h.threshold&&!(C.touches&&C.touches.length>1))return;Q.moved=!0}if(Q.point=n,Q.touch){var N=C.touches.length;if(2!==N)h.pan(C,r,F);else{if(1>=N)return;var j=C.touches,G={x:j[0].clientX,y:j[0].clientY},K={x:j[1].clientX,y:j[1].clientY},l={x:K.x-G.x,y:K.y-G.y},a=Q.lastCenter,V=Math.atan2(l.y,l.x),e=Q.theta,D=0;e==E?e=Q.theta=V:(D=V-e,Q.thetaStarted||Math.abs(D)>h.touchRotateThreshold?(Q.thetaStarted=!0,Q.theta=V):D=0);var q=t*(G.y+K.y)/2/M.getHeight(),i=Q.phi,b=0;i==E?i=Q.phi=q:(b=q-i,Q.phiStarted||Math.abs(b)>h.touchRotateThreshold?(Q.phiStarted=!0,Q.phi=q):b=0);var d,U=Math.sqrt(l.x*l.x+l.y*l.y),H=Q.vlen;if(H){var W=G.x-a.x,O=G.y-a.y,y=K.x-a.x,L=K.y-a.y,g=Math.sqrt(W*W+O*O),k=Math.sqrt(y*y+L*L),Y=H/2,s=h._sign2(g-Y),m=h._sign2(k-Y);0>s*m||0===s&&0===m?(d=1,Q.vlen=U):(d||(d=U/H),Q.scaleStarted||Math.abs(d-1)>h.touchScaleThreshold?(Q.vlen=U,Q.scaleStarted=!0):d=1)}else H=Q.vlen=U,d=1;1!==d&&M.setZoom(d),(b||D)&&h.rotate(C,D,-b),Q.lastCenter={x:(K.x+G.x)/2,y:(K.y+G.y)/2}}}else if(Q.pan)h.pan(C,r,F);else{var X=M.getWidth(),A=M.getHeight();if(!X||!A)return;var v=-f*r/X,S=-f*F/A;h.rotate(C,v,S)}}},_sign2:function(o){return Math.abs(o)<this._touchScaleCheckAccuracy?0:o>0?1:-1},handleWindowMouseUp:function(v){this.handleWindowTouchEnd(v)},handleWindowTouchEnd:function(r){var g=this,l=g.editing;if(g.editing=null,l){var D=g.gv;if(!l.moved&&l.pan){var L=D.getDataAt(r);L?D.sm().setSelection([L]):D.sm().clearSelection()}else D._panning=null,D._rotating=null,D.fi({kind:l.pan?"endPan":"endRotate",event:r})}},pan:function(U,S,b){var X=this,q=X.gv;if(q.isPannable()){var k=q.getWidth(),e=q.getHeight();if(k&&e){var n=q.getCenterInfo(),r=-S/k*n.width,$=1*b/e*n.height;q.fi({kind:q._panning?"betweenPan":"beginPan",event:U}),q._panning=1;var i=X.keepHorizon,c=X.editing.touch;if((c&&U.touches&&U.touches.length>1||!c&&Cj(U))&&(i=!i),!i)return q.pan(r,$);if(r||$){var f=Fq(q),N=[f[0]*r,f[4]*r,f[8]*r],t=[f[1],0,f[9]],A=Math.sqrt(t[0]*t[0]+t[2]*t[2]);A&&(t=[t[0]/A*$,0,t[2]/A*$]);var H=N[0]+t[0],L=N[1]+t[1],h=N[2]+t[2],F=q._center,J=q._eye;F[0]+=H,F[1]+=L,F[2]+=h,J[0]+=H,J[1]+=L,J[2]+=h,q.fp(Pc,E,J),q.fp(Lr,E,F)}}}},rotate:function(I,A,O){var t=this,k=t.gv;if(k.isRotatable()){var h=k._center,j=k._eye,N=qi(j,h),V=U(i(N[0]*N[0]+N[2]*N[2]),N[1]),u=V+O;u=Math.max(t.minPhi,Math.min(t.maxPhi,u)),O=u-V,k.fi({kind:k._rotating?"betweenRotate":"beginRotate",event:I}),k._rotating=1,k.rotate(A,O)}}}),O.defineProperties(Im.prototype,{panButton:{get:function(){return this._panButton},set:function(K){this._panButton=K}},minPhi:{get:function(){return this._minPhi},set:function(_){this._minPhi=_}},maxPhi:{get:function(){return this._maxPhi},set:function(j){this._maxPhi=j}},keepHorizon:{get:function(){return this._keepHorizon},set:function($){this._keepHorizon=$}},threshold:{get:function(){return this._threshold},set:function(o){this._threshold=o}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(t){this._touchScaleThreshold=t}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(_){this._touchRotateThreshold=_}}});var el=function(t){this.gv=t};yr(el,O,{_iv:!0,iv:function(){this._iv=!0},face:function(j,O){var q=this,D=q.gv.getGL();if(!D||!fk(j))return E;var V=O.x,m=O.width,U=O.height,I=q.height-O.y-U,z=A(m/2),X=new Uint8Array(4*m*U),T=0;for(q.iv(),q.validate(j),Up(D,q.frame),D.readPixels(V,I,m,U,D.RGBA,D.UNSIGNED_BYTE,X),Hc(D),q.iv();z>=T;T++)for(var R=z-T,L=z+T,Q=R;L>=Q;Q++)for(var w=R;L>=w;w++)if(Q===R||Q===L||w===R||w===L){var y=Lc.m[X[4*(Q*m+w)]];if(y)return y}},get:function(d,g){this.validate();var l=this,R=l.gv.getGL();if(!R)return E;var j,n,s=d.x,X=d.width,v=d.height,x=l.height-d.y-v,T=A(X/2),h=new Uint8Array(4*X*v),N=0,f=h.length,B=g?E:new yb,M=g?E:{};if(Up(R,l.frame),R.readPixels(s,x,X,v,R.RGBA,R.UNSIGNED_BYTE,h),Hc(R),g){for(;T>=N;N++)for(var $=T-N,H=T+N,D=$;H>=D;D++)for(var z=$;H>=z;z++)if((D===$||D===H||z===$||z===H)&&(j=l.info(h,4*(D*X+z))))return j}else for(;f>N;N+=4)j=l.info(h,N),j&&(n=j.data,M[n._id]||(B.add(n),M[n._id]=n));return B},info:function(a,z){return this.colorMap[(a[z]<<16)+(a[z+1]<<8)+a[z+2]+((127&a[z+3])<<24)]},validate:function(v){var q=this,z=q.gv,F=z.getGL();if(F){var f=z.getWidth(),c=z.getHeight(),s=F.RGBA,J=F.TEXTURE_2D,C=F.RENDERBUFFER,G=F.FRAMEBUFFER;q.texture||(q.texture=fb(F),q.render=F.createRenderbuffer(),q.frame=F.createFramebuffer()),(q.width!==f||q.height!==c)&&(Yn(F,q.texture),F.texImage2D(J,0,s,f,c,0,s,F.UNSIGNED_BYTE,E),Ek(F,F.TEXTURE_MIN_FILTER,F.LINEAR),F.bindRenderbuffer(C,q.render),F.renderbufferStorage(C,F.DEPTH_COMPONENT16,f,c),Up(F,q.frame),F.framebufferTexture2D(G,F.COLOR_ATTACHMENT0,J,q.texture,0),F.framebufferRenderbuffer(G,F.DEPTH_ATTACHMENT,C,q.render),Yn(F,E),F.bindRenderbuffer(C,E),Hc(F),q.width=f,q.height=c),q._iv&&(q._iv=!1,Up(F,q.frame),z._42(v||(q.colorMap={}),1),Hc(F))}}});var Pj=function(F){this.gv=F};yr(Pj,O,{gap:0,size:0,_42:function(b,y){var q=this,F=q.gv,R=F._gridGap,a=F._gridSize;if(F._gridVisible){if(q.gap!==R||q.size!==a){for(var l=[],X=F._gridSize/2,V=R*X,d=0;2*X+1>d;d++){var o=6*d,u=6*(2*X+1)+o;l[o]=-V,l[o+1]=0,l[o+2]=-V+d*R,l[o+3]=V,l[o+4]=0,l[o+5]=-V+d*R,l[u]=-V+d*R,l[u+1]=0,l[u+2]=-V,l[u+3]=-V+d*R,l[u+4]=0,l[u+5]=V}q.vs=new Vi(l),q.gap=R,q.size=a}Yl(F),bj(b,y),$h(b),Uk(b,y,1,F._gridColor,F._buffer.vs,q.vs),cn(b,0,q.vs.length/3,b.LINES),Nj(b),Od(b,y)}else q.vs=q.gap=q.size=E}});var mi=function(f){this.gv=f};yr(mi,O,{_42:function(q,$){var D=this.gv,c=D._buffer.vs,W=D._axisXColor,d=D._axisYColor,n=D._axisZColor,J=D._originAxisVisible,x=D._centerAxisVisible;if(J||x){var _=b?q.TRIANGLES:q.TRIANGLE_FAN,z=q.LINES;if(Yl(D),bj(q,$),$h(q),J){var k=D.getCenterInfo(),S=s(k.width,k.height)/5,h=.8*S,U=.05*S;Uk(q,$,1.5,W,c,new Vi([0,0,0,S,0,0,h,U,0,h,0,U,h,-U,0,h,0,-U,h,U,0,0,0,0,0,S,0,U,h,0,0,h,U,-U,h,0,0,h,-U,U,h,0,0,0,0,0,0,S,U,0,h,0,U,h,-U,0,h,0,-U,h,U,0,h])),cn(q,0,2,z),cn(q,1,6,_),Uk(q,$,E,d),cn(q,7,2,z),cn(q,8,6,_),Uk(q,$,E,n),cn(q,14,2,z),cn(q,15,6,_)}if(x){var O=D._center,M=O[0],H=O[1],Q=O[2],k=D.getPositionInfo(O);S=s(k.width,k.height)/20,Uk(q,$,1.5,W,c,new Vi([M,H,Q,M+S,H,Q,M,H,Q,M,H+S,Q,M,H,Q,M,H,Q+S])),cn(q,0,2,z),Uk(q,$,E,d),cn(q,2,2,z),Uk(q,$,E,n),cn(q,4,2,z)}Nj(q),Od(q,$)}}});var Qb=function(T){this.gv=T,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Qb.Mode.Disable};Qb.Mode={Disable:0,Selection:1,MouseOver:2},yr(Qb,O,{onMouseOver:function(H){$.preventDefault(H);var Z=this.gv.getDataAt(H);Z!==this.mouseOverData&&(this.mouseOverData=Z,this.gv.iv())},setFetchTargetFunc:function(J){this.fetchTargetFunc=J},_42:function(X,O){var v,o=this,Z=o._mode;if(Z!==Qb.Mode.Disable&&(Z===Qb.Mode.Selection?v=o.gv.sm().getSelection().toArray(function(L){return L.s("highlight.visible")}):Z===Qb.Mode.MouseOver&&o.mouseOverData&&o.mouseOverData.s("highlight.visible")&&(v=[o.mouseOverData]),o.fetchTargetFunc&&(v=o.fetchTargetFunc(v)),v&&v.length)){var a=o.gv,L=a.vr.isPresenting(),Q=a.getWidth();if(L){var A=a.getWidth;Q/=2,a.getWidth=function(){return Q};var x=a.getViewport()}var P,i=a.getDevicePixelRatio(),I=Q*i,n=a.getHeight()*i;(P=o._renderTarget)?P.setSize(X,I,n):o._renderTarget=P=new Ip.RenderTarget(a,X,I,n),Up(X,P.frame),a.drawFilter=function(F){return v.indexOf(F)<0?!0:void 0},a._42({}),a.drawFilter=null,Hc(X),L&&(a.getWidth=A,a.setViewport(X,x[0],x[1],x[2],x[3])),o.shader||(o.shader=new uc.Shader(X,Cr.vs,Cr.fs));var d=o.shader;if(o.shader.bind(),X.enable(X.BLEND),X.activeTexture(X.TEXTURE0+0),X.bindTexture(X.TEXTURE_2D,P.texture),d.uniforms.image=0,d.uniforms.textureSize=[I,n],d.uniforms.edgeWidth=r["highlight.width"],o.highlightColor!==r["highlight.color"]){var G=ue(o.highlightColor=r["highlight.color"]);o.highlightColorData=[G[0]/255,G[1]/255,G[2]/255,G[3]/255]}d.uniforms.edgeColor=o.highlightColorData,o.ibuffer?(o.ibuffer.upload(),o.vbuffer.upload()):(o.ibuffer=uc.Buffer.createIndexBuffer(X,new Uint16Array([0,2,1,1,2,3])),o.vbuffer=uc.Buffer.createVertexBuffer(X,new Float32Array([0,0,1,0,0,1,1,1]))),d.attributes.pos.pointer(o.vbuffer),X.drawElements(X.TRIANGLES,6,X.UNSIGNED_SHORT,0),X.disable(X.BLEND),X.bindTexture(X.TEXTURE_2D,null),X.useProgram(O)}}}),O.defineProperties(Qb.prototype,{mode:{get:function(){return this._mode},set:function(X){var O=this._mode;X!==O&&(this._mode=X,X===Qb.Mode.MouseOver?this.gv.getView().addEventListener("mousemove",this.onMouseOver,!1):O===Qb.Mode.MouseOver&&this.gv.getView().removeEventListener("mousemove",this.onMouseOver))}}});var Cr={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Zf=function(m){this.gv=m},Tg="edit_tx",xd="edit_ty",Cs="edit_tz",Oj="edit_rx",Lj="edit_ry",Dn="edit_rz",Mc="edit_sx",Pr="edit_sy",od="edit_sz",Sf={};Sf[Tg]=1,Sf[xd]=1,Sf[Cs]=1,Sf[Oj]=1,Sf[Lj]=1,Sf[Dn]=1,Sf[Mc]=1,Sf[Pr]=1,Sf[od]=1,yr(Zf,O,{_42:function(J,G,W){var K=this,w=K.gv,_=w.sm().ld();if(_&&w.isEditable(_)&&!w.isEditHelperDisabled()&&fk(_)&&(!w.isFirstPersonMode()||!w.isMouseRoamable()&&!im)){Yl(w);var D,I,n=w.isMovable(_),N=w.isRotationEditable(_),l=w.isSizeEditable(_),U=w._axisXColor,H=w._axisYColor,P=w._axisZColor,k=w._editSizeColor,v=_.p3(),$=gn(w.getEye(),v)/10,t=$/(W?5:10),B=.7*$,L=.4*B,S=v[0],E=v[1],z=v[2];D=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],n&&K._17O(J,G,_,W,Tg,U,D,[S,E-t,z,S+B,E-t,z,S+B,E,z,S+B,E,z,S,E,z,S,E-t,z,S,E-t,z+t,S+B,E-t,z+t,S+B,E-t,z,S+B,E-t,z,S,E-t,z,S,E-t,z+t]),I=S+B,l&&K._17O(J,G,_,W,Mc,k,D,[I,E-t,z,I+L,E-t,z,I+L,E,z,I+L,E,z,I,E,z,I,E-t,z,I,E-t,z+t,I+L,E-t,z+t,I+L,E-t,z,I+L,E-t,z,I,E-t,z,I,E-t,z+t]),I+=L,N&&K._17O(J,G,_,W,Oj,U,D,[I,E-t,z,I+L,E-t,z,I+L,E,z,I+L,E,z,I,E,z,I,E-t,z,I,E-t,z+t,I+L,E-t,z+t,I+L,E-t,z,I+L,E-t,z,I,E-t,z,I,E-t,z+t]),D=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],n&&K._17O(J,G,_,W,xd,H,D,[S,E,z,S,E+B,z,S-t,E+B,z,S-t,E+B,z,S-t,E,z,S,E,z,S,E,z,S,E,z-t,S,E+B,z-t,S,E+B,z-t,S,E+B,z,S,E,z]),I=E+B,l&&K._17O(J,G,_,W,Pr,k,D,[S,I,z,S,I+L,z,S-t,I+L,z,S-t,I+L,z,S-t,I,z,S,I,z,S,I,z,S,I,z-t,S,I+L,z-t,S,I+L,z-t,S,I+L,z,S,I,z]),I+=L,N&&K._17O(J,G,_,W,Lj,H,D,[S,I,z,S,I+L,z,S-t,I+L,z,S-t,I+L,z,S-t,I,z,S,I,z,S,I,z,S,I,z-t,S,I+L,z-t,S,I+L,z-t,S,I+L,z,S,I,z]),D=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],n&&K._17O(J,G,_,W,Cs,P,D,[S,E,z,S,E,z+B,S,E-t,z+B,S,E-t,z+B,S,E-t,z,S,E,z,S,E-t,z,S-t,E-t,z,S-t,E-t,z+B,S-t,E-t,z+B,S,E-t,z+B,S,E-t,z]),I=z+B,l&&K._17O(J,G,_,W,od,k,D,[S,E,I,S,E,I+L,S,E-t,I+L,S,E-t,I+L,S,E-t,I,S,E,I,S,E-t,I,S-t,E-t,I,S-t,E-t,I+L,S-t,E-t,I+L,S,E-t,I+L,S,E-t,I]),I+=L,N&&K._17O(J,G,_,W,Dn,P,D,[S,E,I,S,E,I+L,S,E-t,I+L,S,E-t,I+L,S,E-t,I,S,E,I,S,E-t,I,S-t,E-t,I,S-t,E-t,I+L,S-t,E-t,I+L,S,E-t,I+L,S,E-t,I])}},_17O:function(r,w,P,K,R,n,j,q){var k=this.gv._buffer;Db(r,w,K,!0,P,R),Si(r,w,E,!0,E,!0,E,!1),dn(r,w.uDiffuse,n),os(r,k.vs,new Vi(q),w.aPosition),os(r,k.ns,new Vi(j),w.aNormal),$h(r),cn(r,0,12),Nj(r),kc(r,w)}});var Ad=B.Raycaster=function(J){this.gv=J,this.maxTriangleTest=1/0};Ig("Raycaster",O,{intersect:function(U){var p=this,h=p.gv,t=h.getDataAt(U);return t?p.intersectObject(U,t):null},intersectObjects:function(p,x,I){var R,N,Y,s,v=this,H=1/0,d=p.origin||(new ud).fromArray(v.gv.getEye()),B=v.maxTriangleTest,V=[];return x.forEach(function(j){I&&I(j)===!1||j.s("intersect")!==!1&&V.push(j)}),V.sort(function(e,b){return d.distanceToSquared2(e.p3())-d.distanceToSquared2(b.p3())}),v.countTriangles=0,V.forEach(function(l){v.countTriangles>B||(R=v.intersectObject(p,l),R&&(N=d.distanceToSquared(R.world),H>N&&(Y=l,s=R,H=N)))}),v.countTriangles=0,{data:Y,intersect:s}},intersectObject:function(M,a){if(M instanceof ml)return this._intersectObjectImpl(M,a);var D,S,c=this,q=c.gv;S=q.unproject(M);var L=q.getEye();q.isOrtho()?(D=qi(q.getCenter(),L),D[0]+=D[0],D[1]+=D[1],D[2]+=D[2]):D=L,D=new ud(D);var k=new ud(S).sub(D).normalize(),O=new B.Math.Ray(D,k);return c._intersectObjectImpl(O,a)},_intersectObjectImpl:function(){function q(){var x=new ud;return x.subVectors(D,t),I.subVectors(C,t),x.cross(I).normalize(),x}function R(h,T,n,w,S,A,H){return An.barycoordFromPoint(h,T,n,w,k),S.multiplyScalar(k.x),A.multiplyScalar(k.y),H.multiplyScalar(k.z),S.add(A).add(H),S.clone()}var W=new fg,i=new fg,p=new ml,o=new ud,O=new ud,b=new ud,u=new ud,Y=new ud,C=new ud,t=new ud,D=new ud,l=new Jl,$=new Jl,L=new Jl,I=new ud,z={vs:_o,is:xp,uv:Wq},k=new ud;return function(X,v){var E=this.gv.getData3dUI(v),A=v.mat||E.mat;if(A){W.fromArray(A),i.getInverse(W),p.copy(X).applyMatrix4(i);var G,j,U="body",w=E.shapeModel;if(w||(w=Mb(E)),w||(v instanceof B.Node&&!(v instanceof B.Shape)?(G=!0,w=z):(j=!0,w=[E.left,E.front,E.right,E.back,E.top,E.bottom])),!w)return console.log("Can not find shape model."),null;Km(w)||(w=[w]);var N,n,S,y,Z,Q,g,P,_,J,e,M,d,K,r,f,F=1/0,T=["","top_","bottom_"],a=!1;for(N=0,n=w.length;n>N;N++)if(d=w[N])for(S=0,y=T.length;y>S;S++)if(K=T[S],g=d[K+"vs"],P=d[K+"is"],_=d[K+"uv"]||d[K+"tuv"],g){if(r=d[K+"boundingBox"]){var e=p.intersectBox(r);
if(!e)continue;if(p.origin.distanceTo(e)>F)continue;f=!1}else d[K+"boundingBox"]=r=new B.Math.Box3,f=!0;for(Z=0,Q=P?P.length:g.length/3;Q>Z;Z+=3)this.countTriangles++,P?(O.fromArray(g,3*P[Z]),b.fromArray(g,3*P[Z+1]),u.fromArray(g,3*P[Z+2])):(O.fromArray(g,3*Z),b.fromArray(g,3*(Z+1)),u.fromArray(g,3*(Z+2))),f&&(r.expandByPoint(O),r.expandByPoint(b),r.expandByPoint(u)),J=p.intersectTriangle(O,b,u,!0,o),J&&(M=p.origin.distanceTo(J),F>M&&(F=M,Y.copy(J),C.copy(O),t.copy(b),D.copy(u),""!==K?U=K.slice(0,-1):G?U=Li[Math.floor(Z/6)]:j&&(U=Li[N]),_&&(a=!0,P?(l.fromArray(_,2*P[Z]),$.fromArray(_,2*P[Z+1]),L.fromArray(_,2*P[Z+2])):(l.fromArray(_,2*Z),$.fromArray(_,2*(Z+1)),L.fromArray(_,2*(Z+2))))))}if(!isFinite(F))return null;var H,h=Y.clone().applyMatrix4(W);a&&(H=R(Y,C,t,D,l,$,L));var m=q(C,t,D),k=q(C.applyMatrix4(W),t.applyMatrix4(W),D.applyMatrix4(W)),x=p.direction.dot(m);return x>0&&(m.multiplyScalar(-1),k.multiplyScalar(-1)),{world:h,local:Y.clone(),worldNormal:k,normal:m,uv:H,part:U}}}}()});var eb=function(d,G){this.gv=d,this.s=function(m,e,S){return e==E&&(e=S),e==E?G.getStyle(m):aq(e,G,d)},this.data=G};yr(eb,O,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(k,v,Q,T){var b=this,R=b.data;if(!(R instanceof Go)){var K,t,c,o,Y,n,p,d=b.gv,h=R._id,f=b.s("shape3d.alwaysOnTop")?null:b.s("batch"),r=d._batchIndexMap,i=d._batchModelMap,D=d.isSelectable(R),u=d.getBrightness(R),$=u!=E&&1!==u;if(b.needValidate(k)){if(c=_m(r,i,R,f),b.validate(c,f?he[f]||mf:E),c&&(o=r[h],Y=o.size=c.vs.length/3-o.begin,p=c.rs))for(u=$?u:1,n=0;Y>n;n++)p.push(u);if(fk(R)){var x=d.getWireframeGeometry(R);if(x)Ti(d,R,x);else{var C=d.getWireframe(R);C&&Ti(d,R,C)}}b.labelInfo=b.label2Info=b.noteInfo=b.note2Info=b._38o=E,b._24O(Eo,"getLabel"),b._24O(re,"getLabel2"),b._26O(No,"getNote"),b._26O(ss,"getNote2"),b._15O(),b.interactiveInfo=d.isInteractive(R)?{}:E,b._iv=!1}$&&dn(k,v.uBrightness,u),dn(k,v.uAlphaTest,b.s("alphaTest")),dn(k,v.uUseEnvMap,R.s("envmap")?!0:!1),dn(k,v.uReflectivity,R.s("envmap")||.01),t=Db(k,v,Q,D,R,Mk),t&&(Gn(t,r[h],i),Gn(t,d._polylineIndexMap[h],d._polylineModelMap),Gn(t,d._wireframeIndexMap[h],d._wireframeModelMap)),r[h]||b._80o(k,v,T),d.isLabelVisible(R)&&((K=b.labelInfo)&&(Db(k,v,Q,D,R,Eo),b._28O(K,Eo,T)),(K=b.label2Info)&&(Db(k,v,Q,D,R,re),b._28O(K,re,T))),d.isNoteVisible(R)&&((K=b.noteInfo)&&(Db(k,v,Q,D,R,No),b._29O(K,No,T)),(K=b.note2Info)&&(Db(k,v,Q,D,R,ss),b._29O(K,ss,T))),(K=b._38o)&&b._99O(k,v,K,Q,D,T),$&&dn(k,v.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return uk},_80o:function(){},dispose:function(){},_calcAnchorMat:function(q){if(q.hasOwnProperty("_anchor")||q.hasOwnProperty("_anchorElevation")){var r=q.getAnchor3d(),b={x:r.x-.5,y:r.y-.5,z:r.z-.5},Y=ig();return Qf(Y,[-b.x,-b.y,-b.z]),Y}},getBodyColor:function(R){var e=this.data,o=this.gv.getBodyColor(e);return o?o:R?e.getStyle(R):E},_24O:function(M,s){var k=this,$=k.data,W=k.gv,Z=k.s,w=W[s]($);if(w!=E){var y=Z(M+".scale"),h=Z(M+".max"),o=k[M+"Info"]={label:w,textureScale:Z(M+".texture.scale"),color:W[s+"Color"]($),font:Z(M+".font"),align:Z(M+".align"),background:W[s+"Background"]($)},L=o.rect=Qi(o,w);h>0&&h<L.width&&(o.labelWidth=L.width,L.width=h),L.x=L.y=0,L.width*=y,L.height*=y,o.mat=k._16O(Z(M+".autorotate"),Z(M+".position"),L,Z(M+".face"),Z(M+".t3"),Z(M+".r3"),Z(M+".rotationMode"));var z=L.width/2,G=L.height/2;o.vs=new Vi([-z,G,0,-z,-G,0,z,-G,0,z,G,0]),L.width/=y,L.height/=y}},_26O:function(T,C){var d=this,Y=d.data,I=d.gv,W=d.s,o=I[C](Y);if(o!=E){var n=W(T+".scale"),F=this[T+"Info"]={note:o,textureScale:W(T+".texture.scale"),expanded:W(T+".expanded"),font:W(T+".font"),color:W(T+".color"),align:W(T+".align"),borderWidth:W(T+".border.width"),borderColor:W(T+".border.color"),background:I[C+"Background"](Y)};if(F.expanded){var f=W(T+".max"),k=Qi(F,o);k.width+=6,k.height+=2,f>0&&f<k.width&&(F.labelWidth=k.width,k.width=f);var A={x:-k.width/2,y:-8-k.height,width:k.width,height:k.height+8}}else A={x:-6,y:-18,width:12,height:18};F.mat=d._16O(W(T+".autorotate"),W(T+".position"),E,W(T+".face"),W(T+".t3"),W(T+".r3"),W(T+".rotationMode")),F.rect=A,1!==n&&(A=Rn(A),A.x*=n,A.height*=n,A.y=-A.height,A.width*=n);var H=A.x,S=A.y,j=A.width,c=A.height;F.vs=new Vi([H,-S,0,H,-S-c,0,H+j,-S-c,0,H+j,-S,0])}},_28O:function(U,F,A){if(A(this.s(F+".transparent"))){var M=U.rect,R=U.textureScale,n=M.width*R,H=M.height*R;if(n>=1&&H>=1){var b=yl(n,H);1!==R&&(b.translate(b,M.x,M.y),b.scale(R,R),b.translate(b,-M.x,-M.y)),Dm(b,U),b.restore(),zp(this,F,U.mat,U.vs,!0)}}},_29O:function(G,p,w){if(w(this.s(p+".transparent"))){var k=G.rect,J=G.textureScale,c=k.x,n=k.y,W=k.width*J,T=k.height*J;if(W>=1&&T>=1){k.x=k.y=0;var f=yl(W,T);1!==J&&f.scale(J,J),$c(f,G),f.restore(),k.x=c,k.y=n,zp(this,p,G.mat,G.vs,!1)}}},_99O:function(X,y,_,U,w,c){if(_){var N=this,q=N.gv,M=N.data,i=q._buffer,L=q._1O,a=_.icons;for(var R in a){var e=a[R],J=_.rects[R];if(J&&c(aq(e.transparent,M,q))){Db(X,y,U,w,M,R);var b=aq(e.shape3d,M,q),C=b?[b]:aq(e.names,M,q),T=C?C.length:0,B=aq(e.textureScale,M,q)||1,x=aq(e.light,M,q);x==E&&(x=b?!0:!1),Si(X,y,aq(e.blend,M,q),x,aq(e.opacity,M,q),aq(e.reverseFlip,M,q),aq(e.reverseColor,M,q),aq(e.reverseCull,M,q));for(var I=0;T>I;I++){var m=C[I],D=J[I];if(Ck(N,D.mat),b)Ej(q,M,Mb(N,b),N);else{var G=wc(m);if(G){var V=D.width*B,O=D.height*B;if(V>=1&&O>=1){var z=yl(V,O);zm(z,G,aq(e.stretch,M,q),0,0,V,O,M,q),z.restore(),fb(X,_n,L),$h(X,y,L,aq(e.discardSelectable,M,q),i.uv,Zj),os(X,i.vs,D.vs,y.aPosition),Nr(X,i.ns,sg,y.aNormal),Op(X,i.is,tm),Cb(X,0,tm.length),Nj(X,y,L)}}}Wp(q)}kc(X,y)}}}}});var Yg=function(T,B){bs(Yg,this,[T,B])};yr(Yg,eb,{_16O:function(O,z,i,U,H,$,A,g,E){var N=this.data,o=N.getFinalScale3d(),X=wp(z,o,i,U,g,E);if(N.hasOwnProperty("_anchor")||N.hasOwnProperty("_anchorElevation")){var C=N.getAnchor3d();X[0]-=(C.x-.5)*o[0],X[1]-=(C.y-.5)*o[1],X[2]-=(C.z-.5)*o[2]}return tj(ig(),X,N.p3(),U,H,$,A,O,N.getFinalRotation3d(),N.getRotationMode())},clear:function(){var U=this;U.faceMat=U.mat=U.shapeModel=U.left=U.right=U.front=U.back=U.top=U.bottom=U.csg=E},needValidate:function(r){if(this._iv)return this._validateFrameId=r._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var p=r._renderInfo.frame;if(this._validateFrameId!==p)return this._validateFrameId=p,!0}return!1},validate:function(d,t){var S=this,G=S.gv,X=S.data,O=S.shapeName=S.s(cd),r=Mb(S,O);S._updateAutoRotation(),S._updateFixSize2d(),S._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(ck(G,X,"_wireframeModelMap","_wireframeIndexMap"),ck(G,X,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var s=fl(X,G.getMat(X),r?S.s("shape3d.scaleable"):!0),F=S._calcAnchorMat(X);if(F&&so(s,s,F),X.mat=s,S.clear(),r||O==E)if(d){var l=[];r?zf(G,X,r,S,S.getBodyColor(),[s],d,l):($k(G,X,d,t,s,Pi,l,Nb),$k(G,X,d,t,s,tl,l,jc),$k(G,X,d,t,s,Ui,l,nr),$k(G,X,d,t,s,Ki,l,Mh),$k(G,X,d,t,s,Gr,l,pm),$k(G,X,d,t,s,hq,l,rp)),l.length&&(mb(d.vs,l),mb(d.ns,jp(l)))}else S.mat=s,(S.shapeModel=r)||(S._cubeUvs=null,S.vf(Pi,0),S.vf(tl,16),S.vf(Gr,8),S.vf(hq,24),S.vf(Ui,32),S.vf(Ki,40))},_updateAutoRotation:function(){var b=new ln;return function(){var h=this,r=h.data,c=h.s("shape3d.autorotate");if(!c)return r._dynamicRotation&&delete r._dynamicRotation,void 0;var Q,j=h.gv;Q="string"==typeof c?[c.indexOf("x")<0?j._eye[0]:j._center[0],c.indexOf("y")<0?j._eye[1]:j._center[1],c.indexOf("z")<0?j._eye[2]:j._center[2]]:j._eye;var K=j._center,x=r.p3(),L=Xp([x[0]+Q[0]-K[0],x[1]+Q[1]-K[1],x[2]+Q[2]-K[2]],x,j._up),q=r.r3();b.set(0,0,0,r.getRotationMode(),!0).setFromRotationMatrix(L),Math.abs(q[0]-b.x)<1e-5&&Math.abs(q[1]-b.y)<1e-5&&Math.abs(q[2]-b.z)<1e-5||(r._dynamicRotation=[b.x,b.y,b.z])}}(),_updateFixSize2d:function(){var a=this,r=a.data,A=a.s("shape3d.fixSizeOnScreen");if(!A)return r._dynamicScale3d&&delete r._dynamicScale3d,void 0;var z=a.gv;r.getFinalScale3d();var T=fl(r,z.getMat(r)),O=_b([0,0,0],T),m=z.toViewPosition(O);if(!isNaN(m.x)&&!isNaN(m.y)){var c=_b([1,0,0],T),E=z.toViewPosition(c),q=_b([0,1,0],T),s=z.toViewPosition(q),w=E.x-m.x,e=s.y-m.y;if(w&&e){var R=r._dynamicScale3d||[1,1,1],f=wc(r.s("shape3d.image")),F=A[0]>0?A[0]:f?Ap(f,r):20,d=A[1]>0?A[1]:f?pi(f,r):20,X=Math.abs(w/F),t=Math.abs(e/d);Math.abs(X-1)<.001&&Math.abs(t-1)<.001||(r._dynamicScale3d=[R[0]/X,R[1]/t,R[2]])}}},_updateOverlapping:function(){var w=this,u=w.s("hide.overlapping.group");if(!u)return w._rectOverlapping&&(w._rectOverlapping=n),void 0;var j,E,b,L=w.gv,r=w.data,v=fl(r,L.getMat(r)),W=1/0,T=1/0,M=-1/0,P=-1/0,k=r.getAnchor3d(),V=k.x,f=k.y,x=k.z;for(j=0;8>j;j++){if(E=_b([(j>>2)-V,(1&j>>1)-f,(1&j)-x],v),b=L.toViewPosition(E),isNaN(b.x)||isNaN(b.y))return;W=Math.min(W,b.x),M=Math.max(M,b.x),T=Math.min(T,b.y),P=Math.max(P,b.y)}var a={x:W,y:T,w:M-W,h:P-T};w._rectOverlapping=L.overlappingBox.isOverlapping(u,a)},getVectorDynamicSize:function(){var n,I=this,x=I.s("shape3d"),K=I.data;if("billboard"===x||"plane"===x||(n=K._currentCubeElementId)!=E){var Y,A,P=I.gv,M=fl(K,P.getMat(K)),C=K.getAnchor3d(),v=.5-C.x,u=.5-C.y,z=.5-C.z,e=I.s("shape3d.vector.dynamic.maxsize"),U=function(q,Q){q[0]+=v,q[1]+=u,q[2]+=z,Q[0]+=v,Q[1]+=u,Q[2]+=z;var b=P.toViewPosition(_b(q,M)),x=P.toViewPosition(_b(Q,M)),I=b.x-x.x,C=b.y-x.y;return Math.min(e,Math.sqrt(I*I+C*C))};if("billboard"===x)Y=U([-.5,0,0],[.5,0,0]),A=U([0,-.5,0],[0,.5,0]);else if("plane"===x)Y=U([-.5,0,0],[.5,0,0]),A=U([0,0,-.5],[0,0,.5]);else if(K._currentCubeElementId!=E){var T=3*xp[n+1],j=3*xp[n],$=3*xp[n+2];Y=U([_o[T],_o[T+1],_o[T+2]],[_o[$],_o[$+1],_o[$+2]]),A=U([_o[T],_o[T+1],_o[T+2]],[_o[j],_o[j+1],_o[j+2]])}return[Y,A]}},getCachedTexture:function(){var O=this,V=O.data,A=V._currentCubeElementId;return A!=E?O._cubeCachedImage?O._cubeCachedImage[A]:null:O._shape3dCachedImage},setCachedTexture:function(F){var C=this,k=C.data,s=k._currentCubeElementId;if(s!=E){if(!C._cubeCachedImage)return C._cubeCachedImage={};C._cubeCachedImage[s]=F}else C._shape3dCachedImage=F},invalidateCachedTexture:function(S){var G,b,N,F=this;if((N=F._shape3dCachedImage)&&(S.deleteTexture(N),F._shape3dCachedImage=null),b=F._cubeCachedImage){for(G in b)S.deleteTexture(b[G]);F._cubeCachedImage=null}},vf:function(B,a){var d=this;if(d.gv.getFaceVisible(d.data,B)){var s=tn(d,B);s.mat&&(d.faceMat=!0);var x=s.uv;if(x){var V=d._cubeUvs;V||(V=d._cubeUvs=new Vi([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var e=0;8>e;e++)V[a+e]=x[e]}return s}},_80o:function(r,k,U){var e=this;if(e._rectOverlapping)return!0;var u=e.shapeModel;if(u||e.shapeName==E){var $=e.gv,L=e.data,Z=$._cube;Yl($,e.mat),u?Ej($,L,u,e,e.getBodyColor(),U):(os(r,Z.vs,E,k.aPosition),os(r,Z.ns,E,k.aNormal),kd(r,Z.is),e._18O(r,k,e.left,0,U),e._18O(r,k,e.front,6,U),e._18O(r,k,e.right,12,U),e._18O(r,k,e.back,18,U),e._18O(r,k,e.top,24,U),e._18O(r,k,e.bottom,30,U)),Wp($),e.faceMat&&(e._18O(r,k,e.left,0,U,!0),e._18O(r,k,e.front,6,U,!0),e._18O(r,k,e.right,12,U,!0),e._18O(r,k,e.back,18,U,!0),e._18O(r,k,e.top,24,U,!0),e._18O(r,k,e.bottom,30,U,!0))}},_18O:function(D,a,I,i,Z,Y){if(I){if(!Z(I.transparent))return;if(Y&&!I.mat||!Y&&I.mat)return;var d=this.data.s("polygonOffset");d&&wj(D,d),Y&&Yl(this.gv,I.mat);var X=this,n=X.data;n._currentCubeElementId=i;var j=X.gv,A=j.getTexture(I.texture,n),y=I.uv,N=I.uvScale,$=I.uvOffset,u=I.discardSelectable;A?y?$h(D,a,A,u,j._buffer.uv,X._cubeUvs,$,N):$h(D,a,A,u,j._cube.uv,E,$,N):$h(D),Si(D,a,I.blend,I.light,I.opacity,I.reverseFlip,I.reverseColor,I.reverseCull),dn(D,a.uDiffuse,I.color||r["color.empty"]),Cb(D,i,6),kc(D,a),Nj(D,a,A),Y&&Wp(j),d&&Vo(D),n._currentCubeElementId=null}}});var Rj=function(M,v){bs(Rj,this,[M,v])};yr(Rj,eb,{_25Q:1,validate:function(F){var R=this,f=R.gv,U=R.data,J=R.s,x=J("edge.width"),j=U._40I,p=U._41I;if(R.shapeModel=R.info=E,j&&p){var d,N,c,v,I,T,o,M,Z,r,Y=U.isLooped(),K=J(Qr),C=$.getEdgeType(K);if(C){var q=C(U,Hk(R,f,U,Y,K),f,R._19Q);if(!q.points||q.points.isEmpty())return;T=R.info={},o=q.segments,I=q.points,M=I.size();for(var h=j.getElevation(),A=p.getElevation(),Q=0;M>Q;Q++){var W=I.get(Q);W.e==E&&(W.e=h+(A-h)*Q/(M-1))}Z=hb(I.get(0)),r=hb(I.get(M-1));var y=M%2;0===y?(T.c1=hb(I.get(M/2-1)),T.c2=hb(I.get(M/2))):T.p3=hb(I.get((M-y)/2)),T.s1=Z,T.s2=hb(I.get(1)),T.t1=hb(I.get(M-2)),T.t2=r}else{I=new yb,T=R.info={};var G=J("edge.offset"),S=J("edge.center"),l=J("edge.source.t3"),L=J("edge.target.t3"),u=j.p3(),t=p.p3();if(l&&(u[0]+=l[0],u[1]+=l[1],u[2]+=l[2]),L&&(t[0]+=L[0],t[1]+=L[1],t[2]+=L[2]),K===mc){o=J("edge.segments");var P=T.points=J(Og)||Yo;if(M=P.size()){Z=hb(P.get(0)),r=hb(P.get(M-1)),!S&&G&&(c=qi(Z,u,!0),G=s(G,gn(u,Z)),u=[u[0]+c[0]*G,u[1]+c[1]*G,u[2]+c[2]*G],c=qi(t,r,!0),G=s(G,gn(r,t)),t=[t[0]-c[0]*G,t[1]-c[1]*G,t[2]-c[2]*G]);var y=M%2;0===y?(d=hb(P.get(M/2-1)),N=hb(P.get(M/2))):T.p3=hb(P.get((M-y)/2)),T.s1=u,T.s2=Z,T.t1=r,T.t2=t}else!S&&G&&(c=qi(t,u,!0),v=gn(u,t),G=ag(G,v),u=[u[0]+c[0]*G,u[1]+c[1]*G,u[2]+c[2]*G],t=[t[0]-c[0]*G,t[1]-c[1]*G,t[2]-c[2]*G]),d=u,N=t;I.add({x:u[0],y:u[2],e:u[1]}),I.addAll(P),I.add({x:t[0],y:t[2],e:t[1]})}else{var b=Hk(R,f,U,Y,K);if(R._19Q||(b=-b),Y){var V=u[0],k=u[1],B=u[2],g=j.getTall()/2+b;d=[V-b,k+g,B],N=[V+b,k+g,B],I.add({x:V-b,y:B,e:k}),I.add({x:V-b,y:B,e:k+g}),I.add({x:V+b,y:B,e:k+g}),I.add({x:V+b,y:B,e:k})}else{c=qi(t,u,!0),v=gn(u,t);var z={x:u[0],y:u[2]},_={x:t[0],y:t[2]},e=Ze(E,z,_,b),H=e.x-z.x,n=e.y-z.y;G=ag(G,v),c[0]*=G,c[1]*=G,c[2]*=G,d=[u[0]+c[0]+H,u[1]+c[1],u[2]+c[2]+n],N=[t[0]-c[0]+H,t[1]-c[1],t[2]-c[2]+n],S?(I.add({x:u[0],y:u[2],e:u[1]}),I.add({x:d[0],y:d[2],e:d[1]}),I.add({x:N[0],y:N[2],e:N[1]}),I.add({x:t[0],y:t[2],e:t[1]})):(I.add({x:d[0],y:d[2],e:d[1]}),I.add({x:N[0],y:N[2],e:N[1]}))}}T.c1=d,T.c2=N}T.list=J(cd)===dk?R.createTubeModel(I,o,x/2,F):R.createLineModel(I,o,x,"edge","edge.dash")}}});var xm=function(D,f){bs(xm,this,[D,f])};yr(xm,Yg,{_80o:function(B,r,v){var t=this,z=t.gv,X=t.shapeModel;Yl(z,t.mat),X?Ej(z,t.data,X,t,t.getBodyColor(),v):(qk(t,B,r,t.left,v),qk(t,B,r,t.front,v),qk(t,B,r,t.right,v),qk(t,B,r,t.back,v),qk(t,B,r,t.top,v),qk(t,B,r,t.bottom,v)),Wp(z)},validate:function(s,z){var h,R,r=this,m=r.s,U=r.data,D=U.p3(),Z=U._thickness/2,A=U.isClosePath(),W=U.getPoints(),_=U.getSegments(),i=m(jn),b=s&&s.uv;if(r.clear(),0>Z)R=r.shapeModel=pl(W,_,m(pf),m(af),i,m(Ol),U.getTall(),U.getShapeElevation(),A),m(Gm)?m("shape3d.image")||delete R.uv:(delete R.vs,delete R.ns,delete R.uv),m("shape3d.top.image")||delete R.top_uv,m("shape3d.bottom.image")||delete R.bottom_uv;else if(m(cd)===dk)h=vm(W,_,i,A),R=r.shapeModel={vs:[]},m("shape3d.image")&&(R.uv=[],R.sum=m(Ol)||kf(h)||1,R.len=0),m(pf)&&!A&&(R.top_vs=[],m("shape3d.top.image")&&(R.top_uv=[])),m(af)&&!A&&(R.bottom_vs=[],m("shape3d.bottom.image")&&(R.bottom_uv=[])),r._12O(h,Z);else{var C,k,Q,L,j,N,I,O,P,J;if(h=vm(W,_,i,A),j=r.vf(Gr,b,!1,z),Z&&(N=r.vf(hq,b,!1,z),I=A?E:r.vf(Pi,b,!1,z),O=A?E:r.vf(tl,b,!1,z),P=r.vf(Ui,b,!1,z),J=r.vf(Ki,b,!1,z)),Z){for(var g=0,d=h.length;d>g;g++)h[g]=r._tryRemoveBezierPoints(h[g],Z);r._12O(h,Z)}else j&&h.forEach(function(B){if(L=B.length,L>0)for(C=B[0],Q=1;L>Q;Q++)k=B[Q],r.addV(j.vs,C,k),C=k});r._20Q(h),s||(j&&(j.ns=jp(j.vs),dd(j,"vs"),dd(j,Jd)),Z&&(N&&(N.ns=jp(N.vs),dd(N,"vs"),dd(N,Jd)),I&&(I.ns=jp(I.vs),dd(I,"vs"),dd(I,Jd)),O&&(O.ns=jp(O.vs),dd(O,"vs"),dd(O,Jd)),P&&(P.ns=jp(P.vs),dd(P,"vs"),dd(P,Jd)),J&&(J.ns=jp(J.vs),dd(J,"vs"),dd(J,Jd))))}var x=r.mat=ig();Qf(x,D),ao(x,U.getFinalRotation3d(),U.getRotationMode());var a=U.getScale3d(),M=U._dynamicScale3d;M&&(a[0]*=M[0],a[1]*=M[1],a[2]*=M[2]),Kc(x,a),Qf(x,ld(D)),s&&(fn(r,x,s,R),r.clear())},_20Q:function(w){var i,x,U,b,Y,d,D,s=this,$=s.front,B=s.back,e=s.top,V=s.bottom,t=$?$.tuv:E,J=B?B.tuv:E,u=e?e.tuv:E,z=V?V.tuv:E,o=0;(t||J||u||z)&&(i=s.s(Ol)||kf(w)||1,w.forEach(function(h){if(x=h.length,x>0)for(d=h[0],U=1;x>U;U++)D=h[U],b=o/i,o+=gn(d,D),Y=o/i,s._14O($,b,Y),s._14O(B,1-Y,1-b),s._14O(e,b,Y),s._14O(V,b,Y),d=D}))},_14O:function(X,t,y){if(X){var V=X.uv,p=X.tuv;if(p){if(V)var U=V[0]+(V[6]-V[0])*t,H=V[1]+(V[7]-V[1])*t,E=V[2]+(V[4]-V[2])*t,R=V[3]+(V[5]-V[3])*t,r=V[2]+(V[4]-V[2])*y,L=V[3]+(V[5]-V[3])*y,J=V[0]+(V[6]-V[0])*y,s=V[1]+(V[7]-V[1])*y;else U=t,H=0,E=t,R=1,r=y,L=1,J=y,s=0;p.push(E,R,r,L,J,s,J,s,U,H,E,R)}}},_13O:function(F){var f=F.uv,V=F.tuv;V&&(f?V.push(f[2],f[3],f[4],f[5],f[6],f[7],f[6],f[7],f[0],f[1],f[2],f[3]):V.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(s,f){var z=s.length;if(4>z)return s;var U,N,J,q,S,g,n=!1,B=function(K){return s[K]},G=function(h){return s[z-1-h]};for(S=0;1>=S;S++)for(g=S?G:B,N=g(0),J=g(1),U=2;z-1>U;U++)if(q=g(U),!q.remove)if(q.b){var k=Ze(N,J,q,f);k.adjust?(q.remove=!0,n=!0):(N=J,J=q)}else N=J,J=q;if(!n)return s;var u=[];for(U=0;z>U;U++)s[U].remove||u.push(s[U]);return u},_12O:function(N,r){var H,i,u,w,Y,G=this;N.forEach(function(A){if(Y=A.length,Y>0)for(H={p:A[0],n:!0},w=1;Y>w;w++)i=A[w],u=Y-1>w?A[w+1]:E,G.addPoint(H,i,u,r,A)})},addPoint:function(s,p,M,R,C){var n,g,S,Y,G,H,h,K,V,w=this,l=s.p,J=s.f,v=s.b,a=w.s("shape3d.side")||jo,q=w.s("shape3d.start.angle"),y=w.s("shape3d.sweep.angle"),$=w.shapeModel,_=w.data.isClosePath();if(s.n&&(s.n=!1,J=_&&C.length>2?Ze(C[C.length-2],l,p,R):Ze(E,l,p,R),v=Te(l,J),$?$.top_vs&&w._10O(v,J,a,q,y,$.top_vs,$.top_uv):(n=w.left)&&(w.addV(n.vs,v,J),w._13O(n))),g=M?Ze(l,p,M,R):_&&C.length>2?Ze(l,p,C[1],R):Ze(l,p,E,R),S=Te(p,g),$){var Z,j,W=$.vs,x=$.uv,P=$.sum;for(x&&(Z=$.len/P,$.len+=gn(l,p),j=$.len/P),H=w._9O(v,J,a,q,y),h=w._9O(S,g,a,q,y),K=0;a>K;K++)V=K+1,mb(W,H[V]),mb(W,h[K]),mb(W,H[K]),mb(W,h[K]),mb(W,H[V]),mb(W,h[V]),x&&(Y=K/a,G=V/a,x.push(Z,G,j,Y,Z,Y,j,Y,Z,G,j,G));!M&&$.bottom_vs&&w._10O(S,g,a,q,y,$.bottom_vs,$.bottom_uv,!0)}else!M&&(n=w.right)&&(w.addV(n.vs,g,S),w._13O(n)),(n=w.front)&&w.addV(n.vs,J,g),(n=w.back)&&w.addV(n.vs,S,v),(n=w.top)&&w.addH(n.vs,J,g,S,v,!0),(n=w.bottom)&&w.addH(n.vs,v,S,g,J);s.p=p,s.f=g,s.b=S},_10O:function(n,F,H,s,C,J,g,j){var U,N,X=this,K=X.data,V=X._9O(n,F,H,s,C),d=(n.x+F.x)/2,z=(n.y+F.y)/2,e=K.getShapeElevation(),I=0;for(I=0;H>I;I++)j?(mb(J,V[I]),mb(J,V[I+1])):(mb(J,V[I+1]),mb(J,V[I])),mb(J,[d,e,z]),g&&(j?(U=f*(I+1)/H+s,N=f*I/H+s):(U=f*I/H+s,N=f*(I+1)/H+s),g.push(.5-.5*T(N),.5-.5*y(N),.5-.5*T(U),.5-.5*y(U),.5,.5))},_9O:function(B,k,H,S,j){var h,A,I=this,V=I.data,U=[],i=(B.x+k.x)/2,t=(B.y+k.y)/2,m=V.getTall()/2,Q=V.getShapeElevation(),u=0;for(j=j||f;H>=u;u++)h=j*u/H+S,A=T(h),U.push([i+(B.x-i)*A,Q+m*y(h),t+(B.y-t)*A]);return U},addV:function(V,P,l){var i=P.x,S=P.y,D=l.x,F=l.y,_=this.data,b=_.getShapeElevation(),h=_.getTall()/2;V.push(i,b-h,S,D,b-h,F,D,b+h,F,D,b+h,F,i,b+h,S,i,b-h,S)},addH:function(G,w,T,I,C,x){var u=this.data,h=u.getTall()/2,d=u.getShapeElevation()+(x?h:-h);G.push(w.x,d,w.y,T.x,d,T.y,I.x,d,I.y,I.x,d,I.y,C.x,d,C.y,w.x,d,w.y)},vf:function(I,G,H,B){var P,V=this,s=V.gv.getFaceVisible(V.data,I);return(H||s)&&(P=tn(V,I,B),P.vs=[],P.tuv=s&&(P.texture||G)?[]:E,P.visible=s),P}});var Jq=function(B,W){bs(Jq,this,[B,W])};yr(Jq,eb,{_25Q:1,validate:function(a){var I=this,s=I.data,N=I.s,Z=s.getPoints(),C=Z.size();if(I.shapeModel=I.info=E,C>1){var m=I.info={},g=s.getSegments(),i=s.getThickness(),p=hb(Z.get(0)),G=hb(Z.get(C-1)),f=C%2;0===f?(m.c1=hb(Z.get(C/2-1)),m.c2=hb(Z.get(C/2))):m.p3=hb(Z.get((C-f)/2)),m.s1=p,m.s2=hb(Z.get(1)),m.t1=hb(Z.get(C-2)),m.t2=G,m.list=N(cd)===dk?I.createTubeModel(Z,g,i/2,a):I.createLineModel(Z,g,i,"shape.border","shape.dash")}var B=s.p3(),W=I.mat=ig();Qf(W,B),ao(W,s.getFinalRotation3d(),s.getRotationMode());var y=s.getScale3d(),x=s._dynamicScale3d;x&&(y[0]*=x[0],y[1]*=x[1],y[2]*=x[2]),Kc(W,y),Qf(W,ld(B))},_80o:function(v,j,A){var T=this,Q=T.shapeModel;if(Q){var m=T.gv;Yl(m,T.mat),Ej(m,T.data,Q,T,T.getBodyColor(),A),Wp(m)}}});var _g=B.graph3d.VR=function(L){var D=this;D.gv=L,D._controllers=[],D.switch=new zg(D),D._enable=!1,D._defaultCallLater=B.Default.callLater,D._defaultCancelLater=gl,"undefined"!=typeof S&&"VRFrameData"in S&&(D._frameData=new S.VRFrameData),D.measureOflength=1,D.eyesOffset=[0,0,0],D._orientation=new B.Math.Quaternion,D._lastHeadPose=[0,0,0],D._offsetToBeAdd=[0,0,0],D._fpsInfo={time:0,fps:0,frames:0}};yr(_g,O,{ms_fire:!0,_42:function(Q,f,w,S){var J=this,d=J.gv;if(!d.drawFilter&&J._deviceInAction){var K=J._device;if(K){var a=J._measureOflength;K.depthNear=d.getNear()*a,K.depthFar=d.getFar()*a;var x=J._offsetToBeAdd;if(J.eyesOffset[0]+=x[0],J.eyesOffset[1]+=x[1],J.eyesOffset[2]+=x[2],x[0]=0,x[1]=0,x[2]=0,K.isPresenting===!1)return J._controllers.forEach(function(G){G&&G.update()}),d.iv(),!1;var v=J._frameData;K.getFrameData(v);var h=v.pose.position;if(h){var Y=J.toViewPosition(h);d.setEye(Y),J._orientation.fromArray(v.pose.orientation);var O=new B.Math.Vector3(0,0,-10*J._scaleFactor);O.applyQuaternion(J._orientation),d.setCenter([Y[0]+O.x,Y[1]+O.y,Y[2]+O.z])}J._controllers.forEach(function(L){L&&L.update()}),d.setViewport(Q,0,0,f/2,w),J._viewMatrix=J._copyViewMatrix(v.leftViewMatrix),J._projectMatrix=J._copyProjectMatrix(v.leftProjectionMatrix),S(),d.setViewport(Q,f/2,0,f/2,w),J._viewMatrix=J._copyViewMatrix(v.rightViewMatrix),J._projectMatrix=J._copyProjectMatrix(v.rightProjectionMatrix),S(),J._lastViewMatrix=J._viewMatrix,J._lastProjectMatrix=J._projectMatrix,J._viewMatrix=null,J._projectMatrix=null,J.submitFrame();var H=Date.now(),R=J._fpsInfo;return H-R.time>1e3?(R.fps=Math.round(1e3*(R.frames+1)/(H-R.time)),R.time=H,R.frames=0):R.frames++,!0}}},onVRDisplayPresentChange:function(){var q=this.isPresenting();this._injectGraphView(q),this.fp("present",!q,q)},getOrientation:function(){return this._orientation},addController:function(x){x=x||0;var i=this,r=i.getController(x);return r?r:(r=new vq(i,x),i._controllers.push(r),r)},getController:function(X){X=X||0;for(var m=this._controllers,D=0,u=m.length;u>D;D++)if(m[D]&&m[D].id===X)return m[D];return null},removeController:function(R){R=R||0;for(var w=this._controllers,o=0,m=w.length;m>o;o++)if(w[o]&&w[o].id===R)return w.splice(o,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(L,v){var $=this,T=$._scaleFactor,S=$._eyesOffset,I=$._lastHeadPose;return I[0]=L[0]*T,I[1]=L[1]*T,I[2]=L[2]*T,v?(v[0]=I[0]+S[0],v[1]=I[1]+S[1],v[2]=I[2]+S[2],v):[I[0]+S[0],I[1]+S[1],I[2]+S[2]]},addEyesOffset:function(f,X,G){var z=this._offsetToBeAdd;z[0]+=f,z[1]+=X,z[2]+=G},_copyViewMatrix:function(L){var T=this.dup(L),F=this._scaleFactor;T[12]*=F,T[13]*=F,T[14]*=F;var Z=this._eyesOffset;if(Z&&(Z[0]||Z[1]||Z[2])){var E=Z[0],$=Z[1],w=Z[2];T[12]-=T[0]*E+T[4]*$+T[8]*w,T[13]-=T[1]*E+T[5]*$+T[9]*w,T[14]-=T[2]*E+T[6]*$+T[10]*w}return T},shutdown:function(){var i=this._device;i&&i.isPresenting&&i.exitPresent()},isPresenting:function(){var w=this._device;return w&&w.isPresenting},_copyProjectMatrix:function(O){var u=this.dup(O),V=this._scaleFactor;return u[14]*=V,u},dup:function(X,$){for(var l=X.length,J=$||new Array(l);l--;)J[l]=X[l];return J},getViewMatrix:function(o){var K=this._viewMatrix;return K?this.dup(K,o):void 0},getProjectMatrix:function(){var Q=this._projectMatrix;return Q?this.dup(Q):void 0},submitFrame:function(){var Q=this;if(Q._enable&&Q._deviceInAction){var j=Q._device;j&&j.isPresenting&&(j.submitFrame(),Q.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(Z){var F=this.gv;return F.intersectObjects(Z,F.dm().getDatas())},setDevice:function(z){var h=this;h._device=z},_injectGraphView:function(){var w,b,t;return function($){var Z=this.gv;if(!$)return w&&(Z.getWidth=w,Z.getHeight=b,Z.getDevicePixelRatio=t),void 0;var C=this._device,o=C.getEyeParameters("left"),u=o.renderWidth,J=o.renderHeight;w=Z.getWidth,b=Z.getHeight,t=Z.getDevicePixelRatio,Z.getWidth=function(){return 2*u},Z.getHeight=function(){return J},Z.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(V){var c=this;if(!V)return Sm=B.Default.callLater=c._defaultCallLater,gl=B.Default.cancelLater=c._defaultCancelLater,void 0;var c=this;Sm=B.Default.callLater=function(K,J,a,B){var l=c._device;return l&&l.isPresenting?B?x(function(){Sm(K,J,a)},B):l.requestAnimationFrame(function(){c._deviceInAction=!0,K.apply(J,a),c._deviceInAction=!1}):c._defaultCallLater(K,J,a,B)},gl=B.Default.cancelLater=function(o,h){var L=c._device;return L&&L.isPresenting?h?P(o):L.cancelAnimationFrame(o):c._defaultCancelLater(o,h)}}}),O.defineProperties(_g.prototype,{enable:{get:function(){return this._enable},set:function(w){var d=this;d._enable!==w&&(d._enable=w,w?(d.switch.showButton(),d._injectCallLaterFunc(!0)):(d.shutdown(),d.switch.hideButton(),d._injectCallLaterFunc(!1)),d.fp("enable",!w,w))}},measureOflength:{get:function(){return this._measureOflength},set:function(T){this._measureOflength=T;var s=this._scaleFactor=1/T;this._controllers.forEach(function(H){H&&H._setScaleFactor(s)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(U){this._eyesOffset=U}},controllerModel:{get:function(){return this._controllerModel},set:function(n){var m;"object"==typeof n?(m=n.mtl,n=n.obj):(m=n+".mtl",n+=".obj");var k=this,i=k._controllerModel;i&&i.obj===n&&i.mtl===m||(i=k._controllerModel={obj:n,mtl:m},$.loadObj(n,m,{finishFunc:function(w,H){k._controllerModel===i&&$.setShape3dModel("vrControllerModel",H)}}))}},interactive:{get:function(){return!!this._interactive},set:function(V){!!V!=!!this._interactive&&(this._interactive=V,V&&this.addController(0),this.gv.getCoreInteractor().enableVR(V))}}});var vq=function(D,b){function g(E){var e=navigator.getGamepads&&navigator.getGamepads();if(e)for(var I=0,a=0,k=e.length;k>I;I++){var z=e[I];if(z){var c=z.id;if("OpenVR Gamepad"===c||"OpenVR Controller"===c||0===c.indexOf("Oculus Touch")||0===c.indexOf("Spatial Controller")){if(a===E)return z;a++}}}}function y(a,T,C){return Math.abs(a[0]-T[0])<C&&Math.abs(a[1]-T[1])<C&&Math.abs(a[2]-T[2])<C?!0:!1}var F=this;F.vr=D,F.id=b;var U,w,d=[0,0],Z=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],Y=new Ur;Y.s("shape3d","vrControllerModel"),Y.isController=!0,Y.s("intersect",!1),F.getGamepad=function(){return w},F.isButtonPressed=function(G){for(var O,M=0,D=Z.length;D>M;M++)if(O=Z[M],O.id===G)return O.pressed;return!1},F.getNode=function(){return Y};var p=.003;F.setRotationEpsilon=function(E){p=E};var L=5e-4,R=L;F.setPositionEpsilon=function(x){L=x,R=x*F.vr._scaleFactor},F._setScaleFactor=function(M){Y.s3(M,M,M),R=L*M},F._setScaleFactor(F.vr._scaleFactor);var s,r=new vp,t=new fg,h=[0,0,0],v=[0,0,0],S=new ln,A=new ud,f=new ml;F.getRay=function(){return s?(f.origin.fromArray(h),f.direction.copy(A),s=!1,f):f},F.update=function(){if(U=w,w=g(b),U!=w&&console.log("gamepad changed",w),!w||w.pose===n)return w=null,Y.s("3d.visible",!1),void 0;if($.getShape3dModel("vrControllerModel")){Y.dm()||D.gv.dm().add(Y),Y.s("3d.visible",!0);var C=w.pose;if(null!==C){C.position&&(F.vr.toViewPosition(C.position,h),y(Y.p3(),h,R)||(s=!0,Y.p3(h))),C.orientation&&(r.fromArray(C.orientation),A.set(0,0,-1).applyQuaternion(r).normalize(),t.makeRotationFromQuaternion(r),S.set(0,0,0,Y.getRotationMode(),!0).setFromRotationMatrix(t),v[0]=S.x,v[1]=S.y,v[2]=S.z,y(Y.r3(),v,p)||(s=!0,Y.r3(v))),s&&D.fp("gamepad.pose",null,{position:h,rotation:v,id:b});var T=w.axes;(d[0]!==T[0]||d[1]!==T[1])&&(d=[T[0],T[1]],D.fp("gamepad.axes",null,{id:b,axes:d}));var X,V,u,N,o=w.buttons;for(X=0,V=o.length;V>X;X++)if(u=o[X],N=u.pressed,N!==Z[X].pressed){Z[X].pressed=N;var c={id:b},e="state";c[e]=c._62O=N?"down":"up",D.fp("gamepad.button."+Z[X].id,null,c)}}}}},zg=function(o){this.vr=o,this._button=null};yr(zg,O,{showButton:function(){var q=this.assureButton();if(!q.parentNode){var g=this.vr.gv,K=g.getView();g._79O?K.insertBefore(q,g._79O):K.appendChild(q)}},hideButton:function(){var Q=this._button;Q&&Q.parentNode&&Q.parentNode.removeChild(Q)},assureButton:function(){var f=this._button;return f?f:this._button=this.createButton(this.vr.gv)},createButton:function(q){function w(t,d){t.textContent=d&&d.isPresenting?" VR ":" VR "}function A(N){L.style.display="",L.style.cursor="pointer",L.style.left="calc(50% - 50px)",L.style.width="100px",w(L,N),L.onmouseenter=function(){L.style.opacity="1.0"},L.onmouseleave=function(){L.style.opacity="0.5"},L.onclick=function(){N.isPresenting?N.exitPresent():N.requestPresent([{source:q.getCanvas()}])},q.vr.setDevice(N)}function $(){L.style.display="",L.style.cursor="auto",L.style.left="calc(50% - 75px)",L.style.width="150px",w(L,null),L.onmouseenter=null,L.onmouseleave=null,L.onclick=null,q.vr.setDevice(null)}function X(X){X.style.position="absolute",X.style.bottom="20px",X.style.padding="12px 6px",X.style.border="1px solid #fff",X.style.borderRadius="4px",X.style.color="#000",X.style.font="normal 13px sans-serif",X.style.textAlign="center",X.style.opacity="0.5",X.style.outline="none",X.style.zIndex="999"}if("getVRDisplays"in navigator){var L=this._button=W.createElement("button");return L.style.display="none",X(L),S.addEventListener("vrdisplayconnect",function(e){A(e.display)},k),S.addEventListener("vrdisplaydisconnect",function(){$()},k),S.addEventListener("vrdisplaypresentchange",function(h){w(L,h.display),q.vr.onVRDisplayPresentChange()},k),navigator.getVRDisplays().then(function(n){n.length>0?A(n[0]):$()}),L}var e=W.createElement("a");return e.href="https://webvr.info",e.innerHTML=" webvr",e.style.left="calc(50% - 90px)",e.style.width="180px",e.style.textDecoration="none",X(e),e}}),O.defineProperties(zg.prototype,{});var wi=B.graph3d.PostProcessing=function(d){function n(){if(!N){var _=d.getGL();N=new Ip.RenderTarget(d,_),T=new uc.Shader(_,z.vs,z.fs),P=uc.Buffer.createIndexBuffer(_,new Uint16Array([0,2,1,1,2,3])),M=uc.Buffer.createVertexBuffer(_,new Float32Array([0,0,1,0,0,1,1,1]))}}var N,T,P,M,f=this,G={},H=!1;!function(){O.keys(wi).forEach(function($){G[$]=new wi[$](d)})}(),f.getModule=function(N){return N?G[N]:G},f.getModuleList=function(){return O.keys(G)},f.handleDataModleChange=function(m,D){m&&(m.setPostProcessingData(f.serialize()),m.removeSerializeListener(f.onDataModelSerialize,f)),D&&(D.addSerializeListener(f.onDataModelSerialize,f),f.deserialize(D.getPostProcessingData()))},f.onDataModelSerialize=function(t){"serialize"===t.type?d.dm()._postProcessingData=f.serialize():"deserialize"===t.type&&f.deserialize(d.dm().getPostProcessingData())},f.serialize=function(){var b,A,w,c={};for(b in G)A=G[b],c[b]={enable:A.enable},w=A.serializeProperties,w&&w.forEach(function(F){c[b][F]=A[F]});return c},f.deserialize=function(Q){if(Q){var c,D,i,u;for(c in Q)if(D=G[c]){i=Q[c],f.enableModule(c,i.enable);for(u in i)"enable"!==u&&(D[u]=i[u])}}else{var c,D;for(c in G)D=G[c],D.enable=!1,D.resetProperties&&D.resetProperties()}},f.enableModule=function(w,U){var x,E,d,e=w.split(",");for(x=0,E=e.length;E>x;x++)d=e[x].trim(),G[d]&&(G[d].enable=U);H=!1;for(d in G)if(G[d].enable){H=!0;break}H&&n()};var z={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};f._42=function(n,S,w,R,e){if(H&&!e){N.setSize(n,S,w),Up(n,N.frame),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),d.setViewport(n,0,0,S,w),R();var s,I=N;for(s in G)I=G[s]._42(n,I)||I;return Hc(n),d.setViewport(n,0,0,S,w),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),T.bind(),n.activeTexture(n.TEXTURE0+0),n.bindTexture(n.TEXTURE_2D,I.texture),T.uniforms.image=0,P.upload(),M.upload(),T.attributes.pos.pointer(M),n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0),n.bindTexture(n.TEXTURE_2D,null),n.useProgram(d._prg),!0}}},Yj=B.graph3d.PostProcessing.Bloom=function(r){function d(){var X=r.getWidth(),l=r.getHeight();if(X&&l){S=[X,l],H=!0;var D,c=r.getGL(),V=Math.round(S[0]/2),L=Math.round(S[1]/2);for(W=new Ip.RenderTarget(r,c,V,L),D=0;C>D;D++)x.push(new Ip.RenderTarget(r,c,V,L)),G.push(new Ip.RenderTarget(r,c,V,L)),V=Math.round(V/2),L=Math.round(L/2);Y=new uc.Shader(c,Yj.highPassShader.vs,Yj.highPassShader.fs);for(var D=0;C>D;D++)m[D]=new uc.Shader(c,Yj.blurShader.vs,Yj.blurShader.fs.replace(/DEFINE_VALUE/g,Z[D]));b=new uc.Shader(c,Yj.compositeShader.vs,Yj.compositeShader.fs.replace(/NUM_MIPS/g,C)),$=new uc.Shader(c,Yj.finalShader.vs,Yj.finalShader.fs),Q=uc.Buffer.createIndexBuffer(c,new Uint16Array([0,2,1,1,2,3])),z=uc.Buffer.createVertexBuffer(c,new Float32Array([0,0,1,0,0,1,1,1]))
}}var g,u,T,Q,z,c=this,B=!1,H=!1;this.serializeProperties="strength,threshold,radius".split(","),this.resetProperties=function(){g=1.5,u=.55,T=.4},O.defineProperties(c,{enable:{get:function(){return B},set:function(N){!!B!=!!N&&(B=N,N&&!H&&d())}},strength:{get:function(){return g},set:function(F){g=F}},threshold:{get:function(){return u},set:function(A){u=A}},radius:{get:function(){return T},set:function(L){T=L}}}),this.resetProperties();var W,Y,b,$,S=[256,256],x=[],G=[],C=5,Z=[3,5,7,9,11],m=[];c._42=function(K,L){function y(o,l,G,B){Up(K,l.frame),r.setViewport(K,0,0,l.width,l.height),B?B(K):K.clear(K.COLOR_BUFFER_BIT|K.DEPTH_BUFFER_BIT),J!==o&&o.bind();var t=0;for(var U in G){var _=G[U];_ instanceof WebGLTexture&&(K.activeTexture(K.TEXTURE0+t),K.bindTexture(K.TEXTURE_2D,_),_=t,t++),o.uniforms[U]=_}for(J!==o&&(Q.upload(),z.upload(),o.attributes.pos.pointer(z),J=o),K.drawElements(K.TRIANGLES,6,K.UNSIGNED_SHORT,0);t--;)K.activeTexture(K.TEXTURE0+t),K.bindTexture(K.TEXTURE_2D,null);Hc(K)}if(B){H||d();var J;y(Y,W,{smoothWidth:.01,luminosityThreshold:u,tDiffuse:L.texture});var i,l=W,e=Math.round(S[0]/2),O=Math.round(S[1]/2);for(i=0;C>i;i++)y(m[i],x[i],{colorTexture:l.texture,direction:[1,0],texSize:[e,O]}),y(m[i],G[i],{colorTexture:x[i].texture,direction:[0,1],texSize:[e,O]}),e=Math.round(e/2),O=Math.round(O/2),l=G[i];return y(b,x[0],{blurTexture1:G[0].texture,blurTexture2:G[1].texture,blurTexture3:G[2].texture,blurTexture4:G[3].texture,blurTexture5:G[4].texture,bloomStrength:g,bloomRadius:T,bloomTintColor:[1,1,1]}),y($,L,{image:x[0].texture},function(f){f.enable(f.BLEND),f.blendEquation(f.FUNC_ADD),f.blendFunc(f.SRC_ALPHA,f.ONE)}),K.blendEquationSeparate(K.FUNC_ADD,K.FUNC_ADD),K.blendFuncSeparate(K.SRC_ALPHA,K.ONE_MINUS_SRC_ALPHA,K.ONE,K.ONE_MINUS_SRC_ALPHA),L}}};Yj.highPassShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D tDiffuse;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","vec4 outputColor = vec4(0.0, 0.0, 0.0, 0.0);","float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","gl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")},Yj.blurShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D colorTexture;","uniform vec2 texSize;","uniform vec2 direction;","#define KERNEL_RADIUS DEFINE_VALUE","#define SIGMA DEFINE_VALUE","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float fSigma = float(SIGMA);","float weightSum = gaussianPdf(0.0, fSigma);","vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;","for( int i = 1; i < KERNEL_RADIUS; i ++ ) {","float x = float(i);","float w = gaussianPdf(x, fSigma);","vec2 uvOffset = direction * invSize * x;","vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;","vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;","diffuseSum += (sample1 + sample2) * w;","weightSum += 2.0 * w;","}","gl_FragColor = vec4(diffuseSum/weightSum, 1.0);","}"].join("\n")},Yj.compositeShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D blurTexture1;","uniform sampler2D blurTexture2;","uniform sampler2D blurTexture3;","uniform sampler2D blurTexture4;","uniform sampler2D blurTexture5;","uniform sampler2D dirtTexture;","uniform float bloomStrength;","uniform float bloomRadius;","uniform vec3 bloomTintColor;","float lerpBloomFactor(const in float factor) {","float mirrorFactor = 1.2 - factor;","return mix(factor, mirrorFactor, bloomRadius);","}","void main() {","gl_FragColor = bloomStrength * ( lerpBloomFactor(1.0) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture1, vUv) + ","lerpBloomFactor(0.8) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture2, vUv) + ","lerpBloomFactor(0.6) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture3, vUv) + ","lerpBloomFactor(0.4) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture4, vUv) + ","lerpBloomFactor(0.2) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture5, vUv) );","}"].join("\n")},Yj.finalShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")},yp($,{accordionViewExpandIcon:np(kr),accordionViewCollapseIcon:np(kr,!0),accordionViewLabelColor:cj,accordionViewLabelFont:Mr,accordionViewTitleBackground:cp,accordionViewSelectBackground:dq,accordionViewSelectWidth:3,accordionViewSeparatorColor:n,splitViewDividerSize:1,splitViewDividerBackground:cp,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:pk,rect:[2,2,12,12],background:kr}]},propertyViewLabelColor:Wn,propertyViewLabelSelectColor:cj,propertyViewLabelFont:Mr,propertyViewExpandIcon:np(hr),propertyViewCollapseIcon:np(hr,!0),propertyViewBackground:Gq,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Of,propertyViewColumnLineColor:Of,propertyViewSelectBackground:dq,listViewLabelColor:Wn,listViewLabelSelectColor:cj,listViewLabelFont:Mr,listViewRowLineVisible:!1,listViewRowLineColor:Of,listViewSelectBackground:dq,treeViewLabelColor:Wn,treeViewLabelSelectColor:cj,treeViewLabelFont:Mr,treeViewExpandIcon:np(Ed),treeViewCollapseIcon:np(Ed,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Of,treeViewSelectBackground:dq,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Wn,tableViewLabelSelectColor:cj,tableViewLabelFont:Mr,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Of,tableViewColumnLineColor:Of,tableViewSelectBackground:dq,treeTableViewLabelColor:Wn,treeTableViewLabelSelectColor:cj,treeTableViewLabelFont:Mr,treeTableViewExpandIcon:np(Ed),treeTableViewCollapseIcon:np(Ed,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Of,treeTableViewColumnLineColor:Of,treeTableViewSelectBackground:dq,tableHeaderLabelColor:Wn,tableHeaderLabelFont:Mr,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:nn,tableHeaderBackground:Gq,tableHeaderMoveBackground:Nm,tableHeaderInsertColor:dq,tableHeaderSortDescIcon:cs(hr,!0),tableHeaderSortAscIcon:cs(hr),tabViewTabGap:1,tabViewLabelColor:cj,tabViewLabelFont:Mr,tabViewTabBackground:cp,tabViewSelectWidth:3,tabViewSelectBackground:dq,tabViewMoveBackground:Nm,tabViewInsertColor:dq,toolbarLabelColor:Wn,toolbarLabelSelectColor:cj,toolbarLabelFont:Mr,toolbarBackground:Gq,toolbarSelectBackground:dq,toolbarItemGap:8,toolbarSeparatorColor:Ef},!0);var Pq={translateX:1,sortColumn:1},ms={sortable:1,sortOrder:1,sortFunc:1},Bk={focusData:1},ve={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Lp={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},yn=function(I,$){$.add(I),I.hasChildren()&&I.eachChild(function(C){yn(C,$)})},Eq=function(I,L,a,H,y,S,C,U,r,q,o){var h,K=a.getValueType(q),W=a.getAlign(q);if(a.getEnumValues(q)){var Z=a.toEnumLabel(L,q),s=Sh||0,J=0,_=S,w=$.getTextSize(H,Z).width;return h=wc(a.toEnumIcon(L,q)),h&&(J=S+Sh/2,"center"===W?J+=(U-(s+w))/2:"right"===W&&(J=J+U-(s+w)),Wf(I,h,J,C+r/2,q,o),_=J+Sh/2),Z!=E&&(h?Cd(I,Z,H,y,_,C,U-(_-S),r):Cd(I,Z,H,y,S,C,U,r,W)),void 0}return L=a.formatValue(L),L!=E?K===Ep?(Fp(I,S,C,U,r,L),void 0):K===Hr||!K&&Uf(L)?(h=wc(L?Je:vf),Wf(I,h,S+U/2,C+r/2,q,o),void 0):(Cd(I,L,H,y,S,C,U,r,W),void 0):void 0},fs=function(W,w){var h=w.view,G=Jg(W),S=w.column||w.property;h.getDataModel().beginTransaction(),w.editor=W,W.info=w,h.setCurrentEditor(W),h.getView().insertBefore(G,h._79O),ib(W,w.editorRect),W.setFocus?W.setFocus():Gk(W),W.commitValue=function(Y,H){W._17Q&&(W=W._17Q),H||h.setValue(w.data,S,W.getValue?W.getValue():W.value),W.close&&W.close(),ii(G)},S.onEditorCreated&&S.onEditorCreated(w)},Bd=function(i,q,h,t,p){var r=pd(i,h),a=q.value,V=q.view,X=p.getValueType(q.data);return r.onblur=r.onchange=function(){V.endEditing()},"input"===i?(a=p.formatValue(a),a!=E&&(r.value=a),r.onkeydown=function(f){Qd(f)?V.endEditing():$j(f)&&V.endEditing(!0)},(X===Qh||X===Ch)&&r.addEventListener(Pp,$.numberListener,k)):i===Qn&&t.forEach(function(y){var M=W.createElement("option");M.innerHTML=p.toEnumLabel(y),M.value=y,p.isEnumEqual(a,y)&&(M.selected=!0),Hi(r,M)}),fs(r,q),r},hd=B.widget={},ie=function(e,A,S){yr(J+".widget."+e,A,S)};yp(gs,{ms_value:function(R){R.getValue=function(K){var H=this.getItemById(K),Y=H.element;return Qo(Y)?Y:Y?Y.getValue?Y.getValue():Y.value:H.selected},R.setValue=function(w,h){var K=this.getItemById(w);if(K){var a=K.element;a&&!Qo(a)?a.setValue?a.setValue(h):a.value=h:Uf(h)?(K.selected=h,this.iv()):(K.element=h,this.iv())}},R.v=function(p,V){var M=this;if(2===arguments.length)M.setValue(p,V);else{if(!Kq(p))return M.getValue(p);for(var G in p)M.setValue(G,p[G])}return M}},_46o:function(j){j._icon=E,j._accessType=E,j._valueType=E,j._editable=!1,j._batchEditable=!0,j._align=Pi,j._nullable=!0,j._emptiable=!1,j.setParent=Sp,j.formatValue=function(D){var l=this,X=l._valueType;return l.getEnumValues()?l.toEnumLabel(D):X===Hr?!!D:D!=E&&X===Qh?C(D):D},j.setEnum=function(d,P,J,r,t,H,q){var V=this;d&&!Km(d)&&d.values&&(r=d.editable,J=d.icons,P=d.labels,t=d.strict,H=d.maxHeight,q=d.dropDownWidth,d=d.values),om(d)&&(d=d._as),om(P)&&(P=P._as),om(J)&&(J=J._as),V._enumValues=d,V._enumLabels=P,V._enumIcons=J,V._enumEditable=r,V._enumStrict=t==E?!0:t,V._enumMaxHeight=H,V._enumDropDownWidth=q,d&&d.length&&Ib(d[0])&&(V._valueType=Ch),V.fp("enum",!1,!0)},j.getEnumDropDownWidth=function(){return this._enumDropDownWidth},j.getEnumMaxHeight=function(){return this._enumMaxHeight},j.isEnumEditable=function(){return this._enumEditable},j.getEnumValues=function(){return this._enumValues},j.getEnumLabels=function(){return this._enumLabels},j.getEnumIcons=function(){return this._enumIcons},j.isEnumStrict=function(){return this._enumStrict},j.isEnumEqual=function(S,I){return this._enumStrict?S===I:S==I},j.toEnumLabel=function(q,f){var j=this,C=j.getEnumValues(f),y=j.getEnumLabels(f);if(C&&y)for(var S=0;S<C.length;S++)if(j.isEnumEqual(q,C[S]))return y[S];return q},j.toEnumIcon=function(Q,Z){var E=this,B=E.getEnumValues(Z),q=E.getEnumIcons(Z);if(B&&q)for(var P=0;P<B.length;P++)if(E.isEnumEqual(Q,B[P]))return q[P];return n}},_45o:function(K){K._87o=function(r,e,q,g,T,w){if(r){var v=this,o=v._90I,i=Rd(1);v._columnLineVisible&&(T-=1),v._rowLineVisible&&(w-=1),0>=T||0>=w||(v._90I||(o=v._90I={}),o[e]||(o[e]=new yb),ib(i,v.tx()+q,v.ty()+g,T,w),Hi(i,r),v._view.insertBefore(i,v._79O),r.onParentAdded&&r.onParentAdded(i),o[e].add(i))}},K._76o=function(){var s=this,Q=s._90I;if(Q){for(var v in Q)Q[v].each(function(b){ii(b)});delete s._90I}},K._77o=function(H){var D=this;if(D._90I){var T=D._90I[H];T&&(T.each(function(K){ii(K)}),delete D._90I[H])}}},_47o:function(f){f.getValue=function(f,T){return T.getValue?T.getValue(f,T,this):Se(f,T.getAccessType(),T.getName())},f.setValue=function(c,I,C){if(I.isEmptiable(c)||""!==C||(C=n),I.isNullable(c)||C!=E){var B=this,d=I.getName(c),j=I.getAccessType(c),X=I.getValueType(c);X===Qh&&Qo(C)?C=Y(C):X===Ch&&Qo(C)?C=parseFloat(C):X===Hr&&Qo(C)&&(C="true"===C),B._batchEditable&&I._batchEditable&&B.isSelected(c)?B.sm().each(function(K){I.setValue?I.setValue(K,I,C,B):tr(K,j,d,C)}):I.setValue?I.setValue(c,I,C,B):tr(c,j,d,C)}},f.setCurrentEditor=function(z){this.endEditing(),this._currentEditor=z,this.redraw()},f.isEditing=function(d,X){var $=this,K=$._currentEditor;if(!K)return!1;if(X){var c=K.info;return c?(c.column||c.property)===X&&c.data===d:!1}return!0},f.endEditing=function(J){var o=this,R=o._currentEditor;R&&(delete o._currentEditor,R.commitValue&&R.commitValue(R.info,J),o.redraw(),o.getDataModel().endTransaction())},f.beginEditing=function(Q){this.endEditing();var o=this,M=Q.column||Q.property;if(M.beginEditing)M.beginEditing(Q);else{var S=Q.data,n=Q.value,Z=o.getSelectBackground(S),d=M.getEnumValues(S),k=M.getSlider(S),a=M.getColorPicker(S);if(k){var p=mq(hd.Slider,k);return p.setValue(n),p.getView().onblur=function(){o.endEditing()},p.isInstant()&&(p.onValueChanged=function(){o.setValue(S,M,p.getValue())}),fs(p,Q),void 0}if(a||M.getValueType(S)===Ep){var $=mq(hd.ColorPicker,a);return $.setValue(n),$.onClosed=function(){o.endEditing()},$.isInstant()&&($.onValueChanged=function(D,J){o.setValue(S,M,J)}),fs($,Q),$.open(),void 0}if(d){if(hd.ComboBox){var L=new hd.ComboBox;L.setValue(n),L.setValues(d),L.setLabels(M.getEnumLabels(S)),L.setIcons(M.getEnumIcons(S)),L.setEditable(M.isEnumEditable(S)),L.setStrict(M.isEnumStrict(S)),L.setMaxHeight(M.getEnumMaxHeight(S)),L.setDropDownWidth(M.getEnumDropDownWidth(S)),L.onClosed=function(){o.endEditing()},fs(L,Q),L.open()}else Bd(Qn,Q,Z,d,M);return}var K=M.getValueType(S);if(K===Hr||Uf(n))return o.setValue(S,M,!n),void 0;if(M.getItemEditor(S)){var N=zs(M.getItemEditor(S)),V=new N(S,M,o,Q),y=V.getView();return y._17Q=V,V.setValue(n),Mn(y),fs(y,Q),V.editBeginning&&V.editBeginning(),void 0}Bd("input",Q,Z,E,M)}}},_44o:function(e){e.init=function(h){var M=this,N=M.th=new Ml(h),R=M._view=Hn(1,M);M.tv=M._tableView=h,Hi(R,N.getView()),Hi(R,h.getView()),N.mp(function(t){t.property===ur&&M.iv()}),M.iv()},e.getTableView=function(){return this.tv},e.getTableHeader=function(){return this.th},e.getDataModel=function(){return this.tv.dm()},e.getColumnModel=function(){return this.tv.getColumnModel()},e.setColumns=function(M){this.tv.setColumns(M)},e.addColumns=function(I){this.tv.addColumns(I)},e.endEditing=function(){this.tv.endEditing()},e.validateImpl=function(){var s=this,y=s.th,n=lk(y),u={x:0,y:0,width:s.getWidth(),height:n};ib(y,u),u.y=n,u.height=N(0,s.getHeight()-n),ib(s.tv,u)}},ms_vs:function(p){p._41o=function(){return this._29I.height<this._59I},p._43o=function(){var N=this;N._41o()&&(N._58I||(x(function(){N._94O()},kb),N.iv()),N._58I=new Date)},p._94O=function(){var L=this;if(L._58I){var R=new Date;R.getTime()-L._58I.getTime()>=kb?(delete L._58I,L.iv()):x(function(){L._94O()},kb)}},p._93I=function(){var x=this,m=x._27I;if(x._58I||!x._autoHideScrollBar){m||Hi(x._79O,m=x._27I=Rd());var X=x._29I,F=X.height,u=x._59I,Y=x.getScrollBarSize(),S=X.width-Y-2,q=F*(-x.ty()/u),U=F*(F/u),H=m.style;u>F?(mr>U&&(q=q+U/2-mr/2,0>q&&(q=0),q+mr>F&&(q=F-mr),U=mr),H.visibility=vh,H.background=x.getScrollBarColor(),H.borderRadius=Y/2+sb,ib(m,S,q,Y,U)):H.visibility=ko}else m&&(m.style.visibility=ko)}},ms_hs:function(Q){Q._40o=function(){return this._29I.width<this._91I},Q._42o=function(){var J=this;J._40o()&&(J._95O||(x(function(){J._94I()},kb),J.iv()),J._95O=new Date)},Q._94I=function(){var m=this;if(m._95O){var p=new Date;p.getTime()-m._95O.getTime()>=kb?(delete m._95O,m.iv()):x(function(){m._94I()},kb)}},Q._92I=function(){var x=this,r=x._28I;if(x._95O||!x._autoHideScrollBar){r||Hi(x._79O,r=x._28I=Rd());var O=x._29I,E=O.width,g=x._91I,v=x.getScrollBarSize(),M=O.height-v-2,A=E*(-x.tx()/g),n=E*(E/g),d=r.style;g>E?(mr>n&&(A=A+n/2-mr/2,0>A&&(A=0),A+mr>E&&(A=E-mr),n=mr),d.visibility=vh,d.background=x.getScrollBarColor(),d.borderRadius=v/2+sb,ib(r,A,M,n,v)):d.visibility=ko}else r&&(r.style.visibility=ko)}}}),yc(Je,Mm(16,16,[{type:Fe,rect:[1,1,14,14],background:dq},{type:Kb,rect:[1,1,14,14],width:1,color:tc},{type:xc,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),yc(vf,Mm(16,16,{type:Kb,rect:[1,1,14,14],width:1,color:tc})),yc(gq,Mm(16,16,[{type:bg,rect:[2,2,12,12],borderWidth:1,borderColor:tc,background:"#FFF"},{type:bg,rect:[4,4,8,8],background:dq}])),yc(Rq,Mm(16,16,{type:bg,rect:[2,2,12,12],borderWidth:1,borderColor:tc})),gs._15Q=function(c){c._29I=sm,c._59I=0,c._91I=0,c._5o=function(N){var b=this;b._30I=new yb,b._rows=new yb,b._rowMap={},b._31I=0,b._14I=0,b._view=Hn(1,b),b._canvas=Fj(b._view),Hi(b._view,b._79O=Rd()),b.dm(N?N:new bq)},c.getCheckIcon=function(k){var T=this.sm(),o=T.co(k);return T.sg()?wc(o?gq:Rq):wc(o?Je:vf)},c.checkData=function(H){var o=this.sm(),D=o.co(H);o.sg()&&D||(this._32o=1,D?o.rs(H):o.as(H),delete this._32o)},c.getDataAt=function(x){x.target&&(x=this.lp(x));var Y=A(x.y/this._rowHeight),d=this._rows;return 0>Y||Y>=d.size()?E:d.get(Y)},c.onDataDoubleClicked=function(){},c.onDataClicked=function(){},c.adjustTranslateX=function(){return 0},c.adjustTranslateY=function(k){var O=this.getHeight()-this._59I;return O>k&&(k=O),k>0?0:C(k)},c.onPropertyChanged=function(C){var r=this,b=C.property;ve[b]?r.ivm():Bk[b]||r.redraw(),b===Xd?r._42o():b===rk&&r._43o()},c.getLabel=function(P){return P.toLabel()},c.getLabelFont=function(){return this._labelFont},c.getLabelColor=function(T){var m=this;if(m.isCheckMode()){if(m._focusData===T)return m._labelSelectColor}else if(m.isSelected(T))return m._labelSelectColor;return m._labelColor},c.getStartRowIndex=function(){return this._31I},c.getEndRowIndex=function(){return this._14I},c.getRowDatas=function(){return this._rows},c.getRowIndex=function(C){return this._rowMap[C._id]},c.getRowSize=function(){return this._rows.size()},c.getViewRect=function(){return Rn(this._29I)},c.isVisible=function(w){return this._visibleFunc?this._visibleFunc(w):!0},c.getCurrentSortFunc=function(){return this._sortFunc},c.setDataModel=function(N){var Q=this,f=Q._dataModel,e=Q._selectionModel;f!==N&&(f&&(f.umm(Q.handleDataModelChange,Q),f.umd(Q.handleDataPropertyChange,Q),f.umh(Q.handleHierarchyChange,Q),e||f.sm().ums(Q.handleSelectionChange,Q)),Q._dataModel=N,N.mm(Q.handleDataModelChange,Q),N.md(Q.handleDataPropertyChange,Q),N.mh(Q.handleHierarchyChange,Q),e?e._21I(N):N.sm().ms(Q.handleSelectionChange,Q),Q.fp("dataModel",f,N))},c.validateModel=function(){var P=this;P._rows.clear(),P._rowMap={},P.buildChildren(P._dataModel._roots);var m=P._rows=P._rows.toList(P.isVisible,P),I=0,G=P.getCurrentSortFunc(),e=m.size();for(G&&m.sort(G);e>I;I++)P._rowMap[m.get(I)._id]=I},c.buildChildren=function(R){var r=this;R.each(function(X){r._rows.add(X),r.buildChildren(X._children)})},c.handleDataModelChange=function(){this.ivm()},c.handleDataPropertyChange=function(M){"parent"===M.property?this.ivm():this.invalidateData(M.data)},c.handleHierarchyChange=function(){this.ivm()},c.handleSelectionChange=function(c){c.datas.each(this.invalidateData,this),this.onSelectionChanged(c)},c.onSelectionChanged=function(t){var U=this,H=U.sm();!U.isAutoMakeVisible()||1!==H.size()||"set"!==t.kind&&"append"!==t.kind||U._32o||U.makeVisible(H.ld())},c.handleBackgroundClick=function(U){rq(U)&&!this.isCheckMode()&&this.sm().cs()},c.makeVisible=function(O){O&&(this._23I=O,this.iv())},c.scrollToIndex=function(F){var n=this,G=n._29I,B=G.height,t=n._rowHeight,z=t*F;F>=0&&F<n._rows.size()&&B>0&&(z+t>G.y+B?n.ty(-z+B-t):z<G.y&&n.ty(-z))},c.autoScroll=function(f,m){var T=this,K=T._rowHeight,k=K,M=K/4,I=T._29I,l=T.lp(f),t={x:T.tx(),y:T.ty()};return K>0&&I&&(l.x-I.x<k?T.translate(M,0):I.x+I.width-l.x<k&&T.translate(-M,0),l.y-I.y<k?T.translate(0,M):I.y+I.height-l.y<k&&T.translate(0,-M)),t.x=T.tx()-t.x,t.y=T.ty()-t.y,m&&(m.x+=t.x,m.y+=t.y),t},c.getTopRowOrderSelection=function(){var f=this.sm().getTopSelection(),F={},G=new yb;return f.each(function(b){F[b._id]=b}),this._rows.each(function(v){F[v._id]&&G.add(v)}),G},c.getRowOrderSelection=function(){var i=new yb;return this._rows.each(function(s){this.isSelected(s)&&i.add(s)},this),i},c.ivm=function(){this.invalidateModel()},c.invalidateModel=function(){var U=this;U._96I||(U._96I=1,U._32I=1,delete U._24I),U.iv()},c.redraw=function(){var q=this;q._32I||(q._32I=1,delete q._24I,q.iv())},c.invalidateData=function(u){var f=this;a?f.redraw():f._32I||(f._24I||(f._24I={}),f._24I[u._id]=u,f.iv())},c.getFocusData=function(){return this._focusData},c.setFocusDataById=function(s){this.setFocusData(this.dm().getDataById(s))},c.setFocusData=function(C){var Z=this,N=Z._focusData;N!==C&&(Z._focusData=C,Z.fp("focusData",N,C),N&&Z.invalidateData(N),C&&(Z.invalidateData(C),Z.isAutoMakeVisible()&&Z.makeVisible(C)))},c.drawRowBackground=function(w,G,B,T,A,F,c){var U=this,L=U.isCheckMode();(G===U._focusData&&L||B&&!L)&&Fp(w,T,A,F,c,U.getSelectBackground(G))},c.drawData=function(K,C,w){var T=this,Q=T._rowHeight,p=Q*w,X=T._29I,g=X.x,Y=X.width;K.save(),K.beginPath(),K.rect(g,p,Y,Q),K.clip(),T._87o(T.drawRow(K,C,T.isSelected(C),g,p,Y,Q),w,g,p,Y,Q),K.restore(),T._rowLineVisible&&Fp(K,g,p+Q-1,Y,1,T._rowLineColor)},c._12I=function(G){var v=this,f=v._31I,X=v._29I,q=X.x,D=X.y,S=X.width,l=X.height;for(G.beginPath(),G.rect(q,D,S,l),G.clip(),G.clearRect(q,D,S,l),v._76o(),v._93db(G);f<v._14I;f++)v.drawData(G,v._rows.get(f),f);v._92db(G)},c._13I=function(K){for(var M,y=this,r=y._rowHeight,e=y._29I,O=e.x,z=e.width,Y=y._31I,H=y._30I;Y<y._14I;Y++)M=y._rows.get(Y),y._24I[M._id]&&H.add({data:M,index:Y});H.isEmpty()||(K.beginPath(),H.each(function(M){K.rect(O,M.index*r,z,r)}),K.clip(),H.each(function(s){K.clearRect(O,s.index*r,z,r)}),H.each(function(R){y._77o(R.index)}),y._93db(K),H.each(function(L){y.drawData(K,L.data,L.index)}),y._92db(K),H.clear())},c.preValidateModel=function(){this.endEditing&&this.endEditing()},c.validateImpl=function(){var x=this,Z=x._canvas,V=x.getWidth(),B=x.getHeight(),e=x._rowHeight,$=x._32I;(V!==Z.clientWidth||B!==Z.clientHeight)&&(nf(Z,V,B),$=1);var l=w&&!q;x._96I&&!l&&(x.preValidateModel(),x.validateModel());var G=x._29I,L={x:-x.tx(),y:-x.ty(),width:V,height:B},f=x._rows.size(),j=Qc(Z),h=x._23I;$||zr(L,G)||($=1),x._29I=L,x._59I=f*e+x.getScrollBarSize(),x._31I=A(L.y/e),x._14I=d((L.y+L.height)/e),x._31I<0&&(x._31I=0),x._14I>f&&(x._14I=f),x._99I&&$&&x._99I(),of(j,x.tx(),x.ty(),1),$?x._12I(j):x._24I&&x._13I(j),x._93I(),x._92I(),j.restore(),x._32I=x._24I=x._96I=E,h&&(x.scrollToIndex(x.getRowIndex(h)),delete x._23I),x.tx(x.tx()),x.ty(x.ty())}},gs._48o=function(z){z._rootVisible=!0,z._rootData=E,z._35o=function(){this._expandMap={},this._levelMap={}},z.validateModel=function(){var p=this,c=p._rootData;p._rows.clear(),p._levelMap={},p._rowMap={},p._currentLevel=0,c?p._rootVisible?p.isVisible(c)&&p.buildData(c):p.buildChildren(c):p.buildChildren(),delete p._currentLevel},z.buildData=function(C){var $=this,N=C._id,Z=$._rows;$._rowMap[N]=Z.size(),Z.add(C),$._levelMap[N]=$._currentLevel,$.isExpanded(C)&&($._currentLevel++,$.buildChildren(C),$._currentLevel--)},z.buildChildren=function(u){var x=this,q=u?u._children:x._dataModel._roots,X=x.getCurrentSortFunc();X&&x.isChildrenSortable(u)?q.toList(x.isVisible,x).sort(X).each(x.buildData,x):q.each(function(E){x.isVisible(E)&&x.buildData(E)})},z.getLevel=function(Z){return this._levelMap[Z._id]},z.getToggleIcon=function(g){var i=this,m=i._loader,H=i._collapseIcon;return m&&!m.isLoaded(g)?H:g.hasChildren()?i.isExpanded(g)?i._expandIcon:H:E},z.isCheckMode=function(){return this._checkMode!=E},z.isChildrenSortable=function(){return!0},z.handleDataModelChange=function(F){var u=this;F.kind===ab?delete u._expandMap[F.data._id]:F.kind===Wb&&(u._expandMap={}),u.ivm()},z.toggle=function(D){var I=this;I.isExpanded(D)?I.collapse(D):I.expand(D)},z.isExpanded=function(h){return 1===this._expandMap[h._id]},z.expand=function(Z){var b=this,q=b._loader;b.isExpanded(Z)||(q&&!q.isLoaded(Z)&&q.load(Z),b._expandMap[Z._id]=1,b.ivm(),b.onExpanded(Z))},z.onExpanded=function(){},z.collapse=function(v){var B=this;B.isExpanded(v)&&(delete B._expandMap[v._id],B.ivm(),B.onCollapsed(v))},z.onCollapsed=function(){},z.expandAll=function(z){if(z)this.expand(z),z.eachChild(function(Q){this.expandAll(Q)},this);else{var u=this;u._dataModel.each(function(A){A.hasChildren()&&(u._expandMap[A._id]=1)}),u.ivm()}},z.collapseAll=function(){this._expandMap={},this.ivm()},z.makeVisible=function(K){if(K){var d=this;if(!d._rootData||K.isDescendantOf(d._rootData)){for(var H=K._parent;H;)d.expand(H),H=H._parent;d._23I=K,d.iv()}}},z.checkData=function(P){var x,R=this,N=R._checkMode,Y=R.sm(),l=Y.co(P);if(!Y.sg()||!l){if(R._32o=1,N===hm)l?Y.rs(P):Y.as(P);else if(N===vo)x=new yb(P),x.addAll(P._children);else if("descendant"===N)x=new yb,yn(P,x);else if("all"===N&&(x=new yb,yn(P,x),!l))for(var s=P._parent;s;)x.add(s),s=s._parent;x&&(l?Y.rs(x):Y.as(x)),delete R._32o}},z._97I=function(X,p,a,Y,M,f,e){var W=this,t=W._indent,g=W._levelMap[p._id],q=W.getIconWidth(p),s=wc(W.getToggleIcon(p));s?(Y+=t*g,Wf(X,s,Y+t/2,M+e/2,p,W),Y+=t):Y+=t*(g+1),W._checkMode&&(Wf(X,W.getCheckIcon(p),Y+t/2,M+e/2,p,W),Y+=t),W.drawIcon(X,p,Y,M,q,e),W.drawLabel(X,p,Y+q,M,e)}},gs._14Q=function(v){v.getIcon=function(s){return s.getIcon()},v.getIconWidth=function(V){return this.getIcon(V)?this._indent:0},v.drawIcon=function(j,S,x,r,s,q){if(s){var Y=this,w=Y.getBodyColor(S),G=wc(Y.getIcon(S),w);G&&(q-=Y.isRowLineVisible()?1:0,zm(j,G,oi,x,r,s,q,S,Y,w),gj(j,Y.getBorderColor(S),x,r,s,q))}},v.drawLabel=function(y,J,O,G,i){var W=this;Cd(y,W.getLabel(J),W.getLabelFont(J),W.getLabelColor(J),O,G,0,i)}},gs._50o=function(p){p._98I=function(){var C=this,_=C._39o=new bq;C._60I=new yb,_.mm(C._17o,C),_.md(C._18o,C),_.mh(C._19o,C)},p.setColumns=function(D){this._39o.clear(),this.addColumns(D)},p.addColumns=function(w){var z=this._39o;w.forEach(function(q){if(!(q instanceof ji)){var h=zs(q.className);q=mq(h?h:ji,q)}z.add(q)})},p.onColumnClicked=function(){},p.onCheckColumnClicked=function(){},p._3Q=function(g){for(var G,i=0,b=this._60I,t=b.size();t>i;i++)if(G=b.get(i),G.column===g)return G;return E},p.getColumnAt=function(G){var K=this._4Q(G);return K?K.column:E},p._4Q=function(u){for(var H=this,T=u.target?H.lp(u).x:u.x,Q=H._60I,N=0;N<Q.size();N++){var l=Q.get(N),S=l.startX;if(T>=S&&T<S+l.column.getWidth())return l}return E},p.getToolTip=function(y){var R=this,S=R.getDataAt(y),Z=R.getColumnAt(y);return S&&Z?Z.getToolTip(S,R):E},p.adjustTranslateX=function(B){var A=this.getWidth()-this._91I;return A>B&&(B=A),B>0?0:C(B)},p._99I=function(){var S=this,T=S._29I,n=S._60I;n.clear(),S._91I=0,S._39o._roots.each(function(j){if(j.isVisible()){var G=S._91I+j.getWidth();S._91I<=T.x+T.width&&G>=T.x&&n.add({column:j,startX:S._91I}),S._91I=G}}),S._91I+=S.getScrollBarSize()},p.drawData=function(S,z,V){var L=this,M=L._rowHeight,k=M*V,I=L.isSelected(z),Q=L._29I,i=Q.x,d=Q.width;L.drawRowBackground(S,z,I,i,k,d,M),L._60I.each(function(K){var X=K.column,y=K.startX,u=X.getWidth();u>0&&!L.isEditing(z,X)&&(S.save(),S.beginPath(),S.rect(y,k,u,M),S.clip(),L._87o(L.drawCell(S,z,I,X,y,k,u,M),V,y,k,u,M),L._columnLineVisible&&Fp(S,y+u-1,k,1,M,L._columnLineColor),S.restore())}),L._rowLineVisible&&Fp(S,i,k+M-1,d,1,L._rowLineColor)},p.drawCell=function(A,M,d,R,x,z,F,E){var S=this;if(R.drawCell)return R.drawCell(A,M,d,R,x,z,F,E,S);var h=S.getValue(M,R);Eq(A,h,R,S.getLabelFont(M,R,h),S.getLabelColor(M,R,h),x,z,F,E,M,S)},p.getColumnModel=function(){return this._39o},p._17o=function(){this.redraw()},p._18o=function(a){var A=this;a.data===A._sortColumn&&ms[a.property]?A.ivm():(A._42o(),A.redraw())},p._19o=function(){this.redraw()},p.getCurrentSortFunc=function(){var j=this,Q=j._sortColumn;if(Q&&Q.isSortable()){var r=Q.getSortFunc(),J=Hm===Q.getSortOrder()?1:-1;return r||(r=Xh),function(v,C){return r.call(j,j.getValue(v,Q),j.getValue(C,Q),v,C)*J}}return j._sortFunc},p.isCellEditable=function(Q,U,$){return U.isEditable()&&this.isEditable()?U.isCellEditable?U.isCellEditable(Q,U,$,this):!0:!1},p._37O=function(i,K){if(rq(K))for(var v=this,P=v.lp(K),Z=v._60I,E=v._rowHeight,J=v._29I,X=J.x,D=J.y,h=J.width,e=J.height,l=0;l<Z.size();l++){var O=Z.get(l),Q=O.startX,q=O.column,I=q.getWidth();if(q!==v._31o&&q!==v._4o&&P.x>=Q&&P.x<Q+I&&v.isCellEditable(i,q,K)){var p={x:Q,y:v.getRowIndex(i)*E,width:I,height:E},j={x:p.x+v.tx(),y:p.y+v.ty(),width:p.width,height:p.height},A=0,F=0;return p.x<X?A=p.x-X:p.x+p.width>X+h&&(A=p.x+p.width-X-h),A&&(v.tx(v.tx()-A),j.x-=A),p.y<D?F=p.y-D:p.y+E>D+e&&(F=p.y+E-D-e),F&&(v.ty(v.ty()-F),j.y-=F),v.beginEditing({data:i,column:q,value:v.getValue(i,q),event:K,rect:p,editorRect:j,view:v}),void 0}}}},hd.BaseItemEditor=function(k,T,X,u){this._data=k,this._column=T,this._master=X,this._editInfo=u},ie("BaseItemEditor",O,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Le=B.Tab=function(){bs(Le,this)};Ig("Tab",Ye,{ms_ac:["view","closable","disabled"],_icon:E,_closable:!1,_disabled:!1,setParent:Sp});var ji=B.Column=function(){bs(ji,this)};Ig("Column",Ye,{_46o:1,ms_ac:["accessType","valueType",vh,Zh,lf,og,"align",Ep,"sortOrder",Rf,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Hm,_sortFunc:E,_sortable:!0,_clickable:!0,setWidth:function(g){16>g&&(g=16);var T=this._width;this._width=g,this.fp(og,T,g)},getToolTip:function(G,X){return this.formatValue(X.getValue(G,this))}});var Xq=B.Property=function(){bs(Xq,this)};Ig("Property",Ye,{_46o:1,ms_ac:["accessType","valueType",Zh,lf,"categoryName",Ep,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:E,getToolTip:function(I,l,y){var u=this;return l?u.formatValue(y.getValue(I,u)):y.getPropertyName(u)}}),hd.AccordionView=function(){var w=this;w._20o={},w._21o=new yb,w._10o=E,w._9o=E,w._11o=E,w._view=Hn(0,w),w.iv()},ie("AccordionView",O,{ms_v:1,ms_fire:1,ms_ac:[an,yf,"titleHeight",Kk,Kj,"titleBackground","selectWidth",Iq,"orientation","separatorColor"],_expandIcon:$.accordionViewExpandIcon,_collapseIcon:$.accordionViewCollapseIcon,_titleHeight:hg,_labelColor:$.accordionViewLabelColor,_labelFont:$.accordionViewLabelFont,_titleBackground:$.accordionViewTitleBackground,_selectBackground:$.accordionViewSelectBackground,_selectWidth:$.accordionViewSelectWidth,_orientation:"v",_separatorColor:$.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(I,H,o,V){var A=this,U=Rd();if(A._20o[I])throw I+" already exists";U.onmousedown=ki,U.style.cursor=Ho,U.addEventListener(im?sl:Rl,function(d){ki(d)},k),U.addEventListener(im?Mi:Gh,function(q){ki(q),rq(q)&&(A._10o===I?A.collapse():A.expand(I))},k),Hi(A._view,U),A._20o[I]={content:H,div:U,canvas:Fj(U),icon:V},A._21o.add(I),o&&A.expand(I),A.iv()},remove:function(M){var U=this,n=U._20o[M];n&&(ii(n.div),delete U._20o[M],U._21o.remove(M),U.iv())},clear:function(){var X=this;X._21o.toArray().forEach(X.remove,X),X._20o={},X._21o.clear(),X.iv()},isExpanded:function(o){return this._10o===o},expand:function(w){var j=this;j._20o[w]&&j._10o!==w&&(j._10o=w,j.onExpanded(w),j.iv())},onExpanded:function(){},collapse:function(){var d=this;d._10o&&(d.onCollapsed(d._10o),delete d._10o,d.iv())},onCollapsed:function(){},initCanvas:function(p,P,L){nf(p,P,L);var K=Qc(p);return of(K,0,0,1),K.clearRect(0,0,P,L),K},drawTitle:function(I,$,h,Q,X){var z=this,S=wc(X.icon),c=z.isExpanded($),x=z._titleHeight,t=z._titleBackground,b=z._selectWidth,M=z._separatorColor,W=wc(c?z._expandIcon:z._collapseIcon),O=b+4;Fp(I,0,0,h,Q,t),c&&b&&Fp(I,0,0,b,Q,z._selectBackground),(c||z._21o.get(z._21o.size()-1)!==$)&&Fp(I,0,Q-1,h,1,M?M:tk(t)),S&&(Wf(I,S,O+Ap(S)/2,x/2),O+=Ap(S)+2),Cd(I,$,z.getLabelFont($),z.getLabelColor($),O,0,0,x),W&&Wf(I,W,h-Ap(W)/2-4,x/2)},validateImpl:function(){var x=this,y=x._view,U=0,f=0,Z=x.getWidth(),z=x.getHeight(),T=x._titleHeight,O=x._21o.size()*T,E=x._11o,w=x._9o;delete x._11o,delete x._9o,x._21o.each(function(A){var d,V,I=x._20o[A],P=I.content,o=x._10o===A;Ni(x)?(ib(I.div,U,0,T,z),d=x.initCanvas(I.canvas,T,z),Gg(d,0,z),Ke(d,-H),x.drawTitle(d,A,z,T,I),d.restore(),o?(V=N(0,Z-O),P&&(x._11o=P,x._9o=Jg(P),ib(P,U+T,0,V,z)),U+=T+V):U+=T):(ib(I.div,0,f,Z,T),d=x.initCanvas(I.canvas,Z,T),x.drawTitle(d,A,Z,T,I),d.restore(),o?(V=N(0,z-O),P&&(x._11o=P,x._9o=Jg(P),ib(P,0,f+T,Z,V)),f+=T+V):f+=T)
});var u=x._9o;E&&E!==x._11o&&E.endEditing&&E.endEditing(),u&&u!==w&&Hi(y,u),w&&w!==u&&ii(w)}}),hd.SplitView=function(O,x,K,C){var f=this,$=f._dividerDiv=Rd(),w=f._60O=Fj(),e=f._61O=Fj(),r=w.style,N=e.style;f._view=Hn(1,f),Hi(f._view,$),r.msTouchAction=hs,r.pointerEvents=hs,r.cursor=Ho,N.msTouchAction=hs,N.pointerEvents=hs,N.cursor=Ho,O&&f.setLeftView(O),x&&f.setRightView(x),K&&f.setOrientation(K),C!=E&&f.setPosition(C),f.setStatus(Ae),new Al(f)},ie("SplitView",O,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:$.splitViewDividerSize,_dividerBackground:$.splitViewDividerBackground,_dragOpacity:$.splitViewDragOpacity,_toggleIcon:$.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(x,r){var w=this,j=w._position;isNaN(x)||(r||(w._82O=0>x?-1:x>1?1:0),w._position=x,w.fp(xl,j,x))},getLeftView:function(){return this._leftView},setLeftView:function(Y){var X=this,n=X._leftView,K=X._view;if(X._leftView!==Y){if(n&&n!==X._rightView){var z=Jg(n);z.parentNode===K&&ii(z)}if(X._leftView=Y,Y){var b=Jg(Y);b.parentNode!==K&&K.insertBefore(b,X._dividerDiv)}X.fp("leftView",n,Y)}},getRightView:function(){return this._rightView},setRightView:function(U){var S=this,N=S._rightView,J=S._view;if(S._rightView!==U){if(N&&N!==S._leftView){var w=Jg(N);w.parentNode===J&&ii(w)}if(S._rightView=U,U){var v=Jg(U);v.parentNode!==J&&J.insertBefore(v,S._dividerDiv)}S.fp("rightView",N,U)}},validateImpl:function(){var K=this,Q=K._draggable,F=K._position,u=K.getWidth(),X=K.getHeight(),h=K._dividerSize,W=K._dividerBackground,n=im?18:8,m=K._dividerDiv,$=K._82O,i=K._60O,v=K._61O,k=K._toggleIcon,G=K._status,_=m.style,x=null,S=im?20:4,A=k.comps[0];h>=n||0===h?K._coverDiv&&(ii(K._coverDiv),delete K._coverDiv):K._coverDiv||(K._coverDiv=Rd(),b&&(K._coverDiv.style.background=To),Hi(m,K._coverDiv)),K._togglable?i.parentNode||(Hi(m,i),Hi(m,v)):(ii(i),ii(v));var r=K._coverDiv,p=K._leftView,J=K._rightView;if(Ni(K)){if(h>u&&(h=u),G===Ae)if(1===$)var D=s(F,u),T=N(0,u-h-D);else-1===$?(T=s(-F,u),D=N(0,u-h-T)):(D=C((u-h)*F),T=N(0,u-h-D));else"cl"===G?(D=0,T=N(0,u-h)):"cr"===G&&(T=0,D=N(0,u-h));p&&ib(p,0,0,D,X),J&&ib(J,D+h,0,T,X),ib(m,D,0,h,X),K._22o=D,r&&(ib(r,h/2-n/2,0,n,X),r.style.cursor=Q?Cp:""),m.style.cursor=Q?Cp:"";var l=m.clientHeight/2,L=m.clientWidth;nf(i,L,L),ib(i,0,l-L-S,L,L),x=Qc(i),of(x,0,0,1),A.rotation=-H,uq(x,k,0,0,L,L),x.restore(),nf(v,L,L),ib(v,0,l+S,L,L),x=Qc(v),of(x,0,0,1),A.rotation=H,uq(x,k,0,0,L,L),x.restore()}else{if(h>X&&(h=X),G===Ae)if(1===$)var o=s(F,X),O=N(0,X-h-o);else-1===$?(O=s(-F,X),o=N(0,X-h-O)):(o=C((X-h)*F),O=N(0,X-h-o));else"cl"===G?(o=0,O=N(0,X-h)):"cr"===G&&(O=0,o=N(0,X-h));p&&ib(p,0,0,u,o),J&&ib(J,0,o+h,u,O),ib(m,0,o,u,h),K._22o=o,r&&(ib(r,0,h/2-n/2,u,n),r.style.cursor=Q?Mf:""),_.cursor=Q?Mf:"";var V=m.clientWidth/2,L=m.clientHeight;nf(i,L,L),ib(i,V-L-S,0,L,L),x=Qc(i),of(x,0,0,1),A.rotation=0,uq(x,k,0,0,L,L),x.restore(),nf(v,L,L),ib(v,V+S,0,L,L),x=Qc(v),of(x,0,0,1),A.rotation=t,uq(x,k,0,0,L,L),x.restore()}_.background=W}});var Al=function(m){this.sv=m,this.addListeners()};yr(Al,O,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(t){var B=this,D=B.sv,Y=D._dividerDiv,Z=D._60O,E=D._61O,o=D._status,J=t.target;if(J===Z)o===Ae?D.setStatus("cl"):"cr"===o&&D.setStatus(Ae);else if(J===E)o===Ae?D.setStatus("cr"):"cl"===o&&D.setStatus(Ae);else if(lm(t)&&(J===Y||J===D._coverDiv)&&(ki(t),D.isDraggable())){D.getLeftView(),D.getRightView();var y=B.maskDiv=Rd();if(y.style.left=0,y.style.top=0,y.style.width=D.getWidth()+"px",y.style.height=D.getHeight()+"px",D.getView().appendChild(y),!D.isContinuousLayout()){var n=B.resizeDiv=Rd();n.style.left=Y.style.left,n.style.top=Y.style.top,n.style.width=Y.style.width,n.style.height=Y.style.height,n.style.opacity=D.getDragOpacity(),n.style.background=D.getDividerBackground(),Hi(B.getView(),n)}B._lastAbsPosition=D._22o,B._86o=Ni(D)?Rb(t).x:Rb(t).y,to(B,t)}},handleWindowTouchMove:function($){lm($)&&this.update($,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(y){var e=this;e.update(y,!0),e.sv.setStatus(Ae),e.maskDiv&&ii(e.maskDiv),e.resizeDiv&&ii(e.resizeDiv),e.maskDiv=e.resizeDiv=E},handle_mousedown:function(y){rq(y)&&this.handle_touchstart(y)},handleWindowMouseMove:function(v){this.handleWindowTouchMove(v)},handleWindowMouseUp:function(t){this.handleWindowTouchEnd(t)},update:function(w,i){var Y=this,J=Y.sv,E=Ni(J)?J.getWidth():J.getHeight(),S=J._dividerSize,_=Y._lastAbsPosition-Y._86o;Ni(J)?(_+=Rb(w).x,_>E-S&&(_=E-S),0>_&&(_=0),Y.resizeDiv&&(Y.resizeDiv.style.left=_+sb)):(_+=Rb(w).y,_>E-S&&(_=E-S),0>_&&(_=0),Y.resizeDiv&&(Y.resizeDiv.style.top=_+sb)),i&&E!==S&&(1===J._82O?J.setPosition(_,1):-1===J._82O?J.setPosition(_-E+S,1):J.setPosition(_/(E-S),1))}}),hd.TabView=function(){var u=this,B=u._view=Hn(1,u),$=u._91O=Rd(1),v=u._tabModel=new bq,r=v.sm(),t=u.invalidate;u._7o=new yb,u._canvas=Fj($),Hi(B,$),Hi(B,u._92O=Rd(1)),r.setSelectionMode(hn),r.ms(u.handleSelectionChange,u),v.mm(t,u),v.md(t,u),v.mh(t,u),u._interactor=new Lq(u),u.iv()},ie("TabView",O,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Kk,Kj,"tabBackground","selectWidth",Iq,"moveBackground","insertColor"],_tabPosition:Ui,_tabHeight:hg,_tabGap:$.tabViewTabGap,_labelColor:$.tabViewLabelColor,_labelFont:$.tabViewLabelFont,_tabBackground:$.tabViewTabBackground,_selectWidth:$.tabViewSelectWidth,_selectBackground:$.tabViewSelectBackground,_moveBackground:$.tabViewMoveBackground,_insertColor:$.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(J,G,W){var k,L=this._tabModel;return J instanceof Le?(k=J,G&&k.setView(G)):(k=new Le,k.setName(J),k.setView(G)),L.add(k),W&&L.sm().ss(k),k},getLabel:function(b){return b.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(k){this._23o=k,this.iv()},get:function(R){var d=this,J=d._tabModel;if(Ib(R))return J._roots.get(R);if(Qo(R)){var f;return J.each(function(U){R===d.getLabel(U)&&(f=U)}),f}return R instanceof Le?R:E},select:function(y){this._tabModel.sm().ss(this.get(y))},remove:function(U){var G=this;if(U=G.get(U)){var Z=G._tabModel,K=Z._roots.indexOf(U);G._tabModel.remove(U),G.selectByIndex(--K)}},getCurrentTab:function(){return this._8o},hideTabView:function(N,X){X.parentNode===this._92O&&(Qq(X)?(X.style.display=Uo,X._tab_=N):ii(X),ij())},showTabView:function(D,c){Qq(c)&&(c.style.display="block",c._tab_=D),c.parentNode!==this._92O&&(Hi(this._92O,c),ij())},_24o:function(){var C,Z=this,j=Z._8o,w=Z._9o,A=Z._tabModel.sm().ld();A&&(C=Jg(A.getView())),C!==w&&(w&&(j.getView()&&j.getView().endEditing&&j.getView().endEditing(),Z.hideTabView(j,w)),C&&Z.showTabView(A,C)),Z._8o=A,Z._9o=C,j!==A&&Z.onTabChanged(j,A)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function($,y){this.selectByIndex(--y)},selectByIndex:function(L){var j=this,v=j._tabModel,o=v.size();if(o&&!v.sm().ld()){L==E&&(L=0),L>=o&&(L=o-1),0>L&&(L=0);for(var k=L;k>=0;k--){var X=j.get(k);if(!X.isDisabled())return j.select(X),X}for(k=L+1;o>k;k++)if(X=j.get(k),!X.isDisabled())return j.select(X),X}},getTabWidth:function(P){var N=4,X=wc(P.getIcon());X&&(N+=Ap(X,P)+4);var q=this.getLabel(P);return q&&(N+=er(this.getLabelFont(P),q).width+4),P.isClosable()&&(N+=10),N},drawTab:function(X,D,E,h,o,Y,W){var z,g=this,u=g._tabPosition,i=E+4,y=g._selectWidth,O=wc(D.getIcon()),v=D.isDisabled(),Q=g.getLabelColor(D),K=g.getLabelFont(D),w=g.getLabel(D),G=g._selectBackground,x=u===Pi+"-vertical",j=u===tl+"-vertical";(x||j)&&(i=h+4),v&&(X.globalAlpha=Dh),Fp(X,E,h,o,Y,W),D===g._8o&&y&&(u===Ui?Fp(X,E,h+Y-y,o,y,G):u===Pi?Fp(X,E+o-y,h,y,Y,G):u===tl?Fp(X,E,h,y,Y,G):x?Fp(X,E+o-y,h,y,Y,G):j?Fp(X,E,h,y,Y,G):Fp(X,E,h,o,y,G));var b=o/2;if(x&&(Gg(X,b,h+Y/2),Ke(X,t),Gg(X,-b,-h-Y/2)),O){var Z=pi(O,D),I=Ap(O,D);if(x||j){var M=E+o/2,m=i+Z/2;Gg(X,M,m),Ke(X,H),Gg(X,-M,-m),Wf(X,O,E+o/2,i+Z/2,D,g),Gg(X,M,m),Ke(X,-H),Gg(X,-M,-m),i+=Z+4}else Wf(X,O,i+I/2,h+Y/2,D,g),i+=I+4}return x||j?(Gg(X,o/2,i+o/2),Ke(X,H),Gg(X,-o/2,-i-o/2),Cd(X,w,K,Q,E,i,Y,o),Gg(X,o/2,i+o/2),Ke(X,-H),Gg(X,-o/2,-i-o/2)):Cd(X,w,K,Q,i,h,o,Y),x&&(Gg(X,b,h+Y/2),Ke(X,-t),Gg(X,-b,-h-Y/2)),D.isClosable()&&(z=j?{x:E+o-12,y:h+Y-12,width:12,height:12}:{x:E+o-12,y:h+2,width:12,height:12},this.drawCloseIcon(D,X,Q,z)),v&&(X.globalAlpha=1),z},drawCloseIcon:function(q,o,e,T){var A=T.x,K=T.y;o.strokeStyle=e,o.lineWidth=1,o.beginPath(),o.moveTo(A+2,K+8),o.lineTo(A+8,K+2),o.moveTo(A+8,K+8),o.lineTo(A+2,K+2),o.stroke()},getTabAt:function(p){var Q=this._interactor._8Q(p);return Q?Q.tab:null},validateImpl:function(){var E=this;E._24o();var a,D=E._canvas,U=E._tabPosition,X=E._91O,F=E._92O,o=E._tabModel,y=E.getWidth(),H=E.getHeight(),d=E._tabHeight,S=E._7o,c=E._tabGap,i=U===Ui,Q=U===Pi,v=U===tl,Z=U===Pi+"-vertical",P=U===tl+"-vertical",Y=E._23o,x=0;if((Q||v)&&o._roots.each(function(b){x=N(E.getTabWidth(b),x)}),i?(ib(X,0,0,y,d),a={x:0,y:d,width:y,height:N(0,H-d)}):Q?(ib(X,0,0,x,H),a={x:x,y:0,width:N(0,y-x),height:H}):v?(ib(X,y-x,0,x,H),a={x:0,y:0,width:N(0,y-x),height:H}):Z?(ib(X,0,0,d,H),a={x:d,y:0,width:N(0,y-d),height:H}):P?(ib(X,y-d,0,d,H),a={x:0,y:0,width:N(0,y-d),height:H}):(ib(X,0,H-d,y,d),a={x:0,y:0,width:y,height:N(0,H-d)}),ib(F,a),Z||P){E._9o&&(a.x=0,ib(E._8o.getView(),a)),nf(D,d,H);var L=Qc(D),W=0;if(of(L,0,E.ty(),1),L.clearRect(0,0,d,H),S.clear(),o._roots.each(function(G){var r,X=E.getTabWidth(G);Y&&Y.tab===G||(r=E.drawTab(L,G,0,W,d,X,E._tabBackground)),S.add({_75o:r,tab:G,startY:W,endY:W+X,height:X}),W+=X+c}),E._23Q=N(0,W-c),Y){var J=Y.position;E.drawTab(L,Y.tab,0,Y.startY,d,Y.height,E._moveBackground),Fp(L,0,J,d,1,E._insertColor)}if(L.restore(),E._selectionChanged){E._selectionChanged=!1;for(var g=E.ty(),V=0;V<S.size();V++){var m=S.get(V);if(m.tab===E._8o){if(m.endY+g<0){E.ty(-m.startY);break}if(m.startY+g>H){E.ty(H-m.endY);break}}}}E.ty(E.ty())}else if(Q||v){E._9o&&(a.x=0,ib(E._8o.getView(),a)),nf(D,x,H);var L=Qc(D),W=0;if(of(L,0,E.ty(),1),L.clearRect(0,0,x,H),S.clear(),o._roots.each(function(g){var U;Y&&Y.tab===g||(U=E.drawTab(L,g,0,W,x,d,E._tabBackground)),S.add({_75o:U,tab:g,startY:W,endY:W+d,height:d}),W+=d+c}),E._23Q=N(0,W-c),Y){var J=Y.position;E.drawTab(L,Y.tab,0,Y.startY,x,Y.height,E._moveBackground),Fp(L,0,J,x,1,E._insertColor)}if(L.restore(),E._selectionChanged){E._selectionChanged=!1;for(var g=E.ty(),V=0;V<S.size();V++){var m=S.get(V);if(m.tab===E._8o){if(m.endY+g<0){E.ty(-m.startY);break}if(m.startY+g>H){E.ty(H-m.endY);break}}}}E.ty(E.ty())}else{E._9o&&(a.y=0,ib(E._8o.getView(),a)),nf(D,y,d);var L=Qc(D),R=0;if(of(L,E.tx(),0,1),L.clearRect(0,0,y,d),S.clear(),o._roots.each(function(a){var _,A=E.getTabWidth(a);Y&&Y.tab===a||(_=E.drawTab(L,a,R,0,A,d,E._tabBackground)),S.add({_75o:_,tab:a,startX:R,endX:R+A,width:A}),R+=A+c}),E._64I=N(0,R-c),Y){var J=Y.position;E.drawTab(L,Y.tab,Y.startX,0,Y.width,d,E._moveBackground),as(L,E._insertColor,J,0,d)}if(L.restore(),E._selectionChanged){E._selectionChanged=!1;for(var t=E.tx(),V=0;V<S.size();V++){var m=S.get(V);if(m.tab===E._8o){if(m.endX+t<0){E.tx(-m.startX);break}if(m.startX+t>y){E.tx(y-m.endX);break}}}}E.tx(E.tx())}for(var A=[],K=F.children,V=0;V<K.length;V++){var p=K[V],w=p._tab_;w&&!o.contains(w)&&A.push(p)}A.forEach(function(N){F.removeChild(N)})}});var Lq=function(R){this.tv=R,this.addListeners()};yr(Lq,O,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(k){this.handleScroll(k,10*(k.wheelDelta/40))},handle_DOMMouseScroll:function(P){this.handleScroll(P,10*-P.detail)},handleScroll:function(m,e){ki(m);var N=this.tv,W=N._tabPosition;!N._40o()||W!==Ui&&W!==Ki||N.tx(this.tv.tx()+e),!N._41o()||W!==Pi&&W!==tl&&W!==Pi+"-vertical"&&W!==tl+"-vertical"||N.ty(this.tv.ty()+e)},_8Q:function(O){var $,m,S=this.tv,K=S._tabPosition,f=S._7o;if(K===Ui||K===Ki){var C=S.lp(O).x;for($=0;$<f.size();$++)if(m=f.get($),m.startX<=C&&C<=m.endX)return m}else if(K===Pi||K===tl||K===Pi+"-vertical"||K===tl+"-vertical"){var X=S.lp(O).y;for($=0;$<f.size();$++)if(m=f.get($),m.startY<=X&&X<=m.endY)return m}return E},isClickable:function(n){var U=this.tv,w=U._tabPosition,W=this._73o=this._8Q(n);return!U._40o()||w!==Ui&&w!==Ki?!U._41o()||w!==Pi&&w!==tl&&w!==Pi+"-vertical"&&w!==tl+"-vertical"?W&&(!W.tab.isDisabled()||U.isMovable()):!0:!0},handle_mousemove:function(U){var X=this;df?X._74o=X._8Q(U):X.getView().style.cursor=X.isClickable(U)?Ho:""},handle_mousedown:function(n){this.handle_mousemove(n),this.handle_touchstart(n)},handle_touchstart:function(Q){var E=this,G=E.tv,D=G._tabPosition;ki(Q),rq(Q)&&E.isClickable(Q)&&(D===Ui||D===Ki?(E.x=Rb(Q).x,E.lp=G.lp(Q),E.tx=G.tx()):(E.y=Rb(Q).y,E.lp=G.lp(Q),E.ty=G.ty()),to(E,Q))},handleWindowMouseMove:function(L){this.handleWindowTouchMove(L)},handleWindowTouchMove:function(z){var r,h=this,Q=h.tv,H=Q._tabPosition,Z=h._73o;if(H===Ui||H===Ki){if(r=Rb(z).x-h.x,!h._25o&&!h.moving&&F(r)>2&&(Q._40o()&&!In(z)?h._25o=1:Z&&Q.isMovable()&&(h.moving=1)),h._25o)Q.tx(h.tx+r);else if(h.moving){var E=h.lp.x+r,U=Q._tabGap/2;Q._7o.each(function(k){var e=k.endX,W=E-k.startX<e-E;E>=k.startX&&e>=E&&Q._7Q({tab:Z.tab,startX:Z.startX+r,width:Z.width,front:W,insertTab:k.tab,position:W?N(0,k.startX-U):s(Q._64I,e+U)})})}}else if(r=Rb(z).y-h.y,!h._25o&&!h.moving&&F(r)>2&&(Q._41o()&&!In(z)?h._25o=1:Z&&Q.isMovable()&&(h.moving=1)),h._25o)Q.ty(h.ty+r);else if(h.moving){var W=h.lp.y+r,U=Q._tabGap/2;Q._7o.each(function(X){var $=X.endY,h=W-X.startY<$-W;W>=X.startY&&$>=W&&Q._7Q({tab:Z.tab,startY:Z.startY+r,height:Z.height,front:h,insertTab:X.tab,position:h?N(0,X.startY-U):s(Q._23Q,$+U)})})}},handleWindowMouseUp:function(p){this.handleWindowTouchEnd(p)},handleWindowTouchEnd:function(){var P=this,S=P.tv,c=S._tabPosition,r=S.getTabModel(),A=r._roots,U=P._73o;if(P.moving){var F=S._23o;if(F&&F.insertTab!==F.tab){var $=F.tab,v=A.remove($),l=A.indexOf(F.insertTab);l>=0&&(F.front||l++,l<=A.size()&&(A.add($,l),r._38I($,v,l)))}S._7Q(E),delete P.moving}else if(!P._25o&&U){$=U.tab;var V=P._74o;if(!V||V.tab===$)if(!$.isDisabled()&&Yr(U._75o,P.lp)){var k=function(){var T=A.indexOf($);r.remove($),S.onTabClosed($,T)};S.onTabClosing($,k)&&k()}else $.isDisabled()||S._8o===$||r.sm().ss($)}P._25o=P._73o=P._74o=c===Ui||c===Ki?P.x=P.lp=P.tx=E:P.y=P.lp=P.ty=E}}),hd.PropertyView=function(j){var D=this;D._view=Hn(1,D),D._canvas=Fj(D._view),Hi(D._view,D._79O=Rd()),D._rows=new yb,D._28o=new yb,D._26o={},D._26Q={};var i=D._propertyModel=new bq,S=D.ivm;i.mm(S,D),i.md(S,D),i.mh(S,D),D.dm(j?j:new bq),new jq(D)},ie("PropertyView",O,{ms_ac:[Kk,id,Kj,Zh,lf,"categorizable",vi,Rf,Eg,an,yf,ir,Ab,fi,"selectRowIndex",Iq,"background",Pk,Cq,je,Xf,Jo],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:sm,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Sh,_background:$.propertyViewBackground,_expandIcon:$.propertyViewExpandIcon,_collapseIcon:$.propertyViewCollapseIcon,_scrollBarColor:jl,_scrollBarSize:bn,_autoHideScrollBar:ul,_selectBackground:$.propertyViewSelectBackground,_rowHeight:dm,_rowLineVisible:$.propertyViewRowLineVisible,_rowLineColor:$.propertyViewRowLineColor,_10I:.5,_columnLineVisible:$.propertyViewColumnLineVisible,_columnLineColor:$.propertyViewColumnLineColor,_labelColor:$.propertyViewLabelColor,_labelSelectColor:$.propertyViewLabelSelectColor,_labelFont:$.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(c){0>c&&(c=0),c>1&&(c=1);var i=this,G=i._10I;i._10I=c,i.fp("columnPosition",G,c)},getPropertyName:function(K){return K.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function($,p,M){return M===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(V,j){return j===this._selectRowIndex?this._labelSelectColor:V.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(N){var b=this.getHeight()-this._59I;return b>N&&(N=b),N>0?0:C(N)},isExpanded:function(H){if(!H)return!0;var S=this._26o[H];return S?S.isExpanded:!(this._26Q[H]===!1)},toggle:function(L){var o=this;o.isExpanded(L)?o.collapse(L):o.expand(L)},expandAll:function(){this.validate();for(var Z in this._26o)this.expand(Z)},expand:function(e){if(e&&e!==Uo){var T=this,G=T._26o[e];G&&!G.isExpanded&&(G.isExpanded=!0,T.onExpanded(e),T.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var t in this._26o)this.collapse(t)},collapse:function(U){if(U&&U!==Uo){var Q=this,G=Q._26o[U];G&&G.isExpanded&&(G.isExpanded=!1,Q.onCollapsed(U),Q.ivm())}},onCollapsed:function(){},getCategoryName:function(X){if(!this.isCategorizable())return Uo;var Q=X.getCategoryName();return Q?Q:Uo},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(w){var L=this,Z=L._dataModel;Z!==w&&(Z&&(Z.umd(L.handlePropertyChange,L),L._selectionModel||Z.sm().ums(L.handleSelectionChange,L)),L._dataModel=w,w.md(L.handlePropertyChange,L),L._selectionModel?L._selectionModel._21I(w):w.sm().ms(L.handleSelectionChange,L),L.fp(Td,Z,w))},isVisible:function(c){return this._visibleFunc?this._visibleFunc(c):!0},onPropertyChanged:function(d){var s=this,C=d.property;Lp[C]?s.ivm():s.iv(),C===rk&&s._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Yo},handlePropertyChange:function(L){this._27o===L.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var P=this;P._96I||(P.setSelectRowIndex(-1),P._96I=1,P.iv())},redraw:function(){this.iv()},validateModel:function(){var X=this,e=X._rows,b=X._28o,x={},z=new yb,C=X._27o;X.updateCurrentData(),C!==X._27o&&X.endEditing(),e.clear(),b.clear(),X.getRawProperties().each(function(Y){if(X.isVisible(Y)){z.add(Y);var s=X.getCategoryName(Y);x[s]||(b.add(s,s===Uo?0:n),x[s]={isExpanded:X.isExpanded(s),properties:new yb})}}),X._sortFunc&&z.sort(X._sortFunc);for(var H in X._26o)X._26Q[H]=X.isExpanded(H);X._26o=x,b.each(function(h){h!==Uo&&e.add(h);var k=x[h];k.isExpanded&&z.each(function(E){X.getCategoryName(E)===h&&(k.properties.add(E),e.add({property:E,data:X._27o}))},X)})},validateImpl:function(){var C=this;C._76o(),C._96I&&(C.validateModel(),delete C._96I);var s=C._canvas,M=C.getWidth(),t=C.getHeight(),Q=-C.ty(),V=C._rowHeight,R=C._indent,i=M-R,r=C._rows,h=r.size(),w=C._9I=R+i*C._10I,G=C._59I=h*V;nf(s,M,t),C._29I={x:0,y:Q,width:M,height:t},C._31I=A(Q/V),C._14I=d((Q+t)/V),C._31I<0&&(C._31I=0),C._14I>h&&(C._14I=h);var f,Y=Qc(s),c=C._background;of(Y,0,-Q,1),Y.beginPath(),Y.rect(0,Q,M,t),Y.clip(),Y.clearRect(0,Q,M,t),C._93db(Y),c&&Fp(Y,0,0,R,G,c);for(var T=C._31I;T<C._14I;T++){var X=r.get(T),Q=V*T;if(Qo(X))c&&Fp(Y,R,Q,i,V,c),f=wc(C.isExpanded(X)?C._expandIcon:C._collapseIcon),f&&zm(Y,f,oi,0,Q,R,V),Y.save(),Y.beginPath(),Y.rect(R,Q,i,V),Y.clip(),C.drawCategoryName(Y,X,T,R,Q,i,V),Y.restore();else{var K=X.property,n=X.data,f=wc(K.getIcon()),o=C._selectRowIndex===T?C.getSelectBackground():E;if(f&&zm(Y,f,oi,0,Q,R,V),o&&Fp(Y,R,Q,i,V,o),Y.save(),Y.beginPath(),Y.rect(R,Q,w-R,V),Y.clip(),C.drawPropertyName(Y,K,T,R,Q,w-R,V),Y.restore(),!C.isEditing(n,K)){var k=w+1,u=M-w-1;Y.save(),Y.beginPath(),Y.rect(k,Q,u,V),Y.clip(),C._87o(C.drawPropertyValue(Y,K,C.getValue(n,K),T,k,Q,u,V,n),T,k,Q,u,V),Y.restore()}}C._rowLineVisible&&Fp(Y,R,Q+V-1,i,1,C._rowLineColor)}C._columnLineVisible&&(Fp(Y,w,0,1,G,C._columnLineColor),Fp(Y,M-1,0,1,G)),C._92db(Y),C._93I(),Y.restore(),C.ty(C.ty())},drawCategoryName:function(G,v,$,D,R,f,w){Cd(G,v,this.getCategoryFont(v),this.getCategoryColor(v),D,R,f,w)},drawPropertyName:function(P,F,f,z,t,w,H){return F.drawPropertyName?(F.drawPropertyName(P,F,f,z,t,w,H,this),void 0):(Cd(P,this.getPropertyName(F),this.getPropertyFont(F,f),this.getPropertyColor(F,f),z,t,w,H),void 0)},drawPropertyValue:function(r,l,i,A,h,y,G,M,t){return l.drawPropertyValue?l.drawPropertyValue(r,l,i,A,h,y,G,M,t,this):(Eq(r,i,l,this.getLabelFont(l,i,A),this.getLabelColor(l,i,A),h,y,G,M,t,this),void 0)},isPropertyEditable:function(g){return g.isEditable()&&this.isEditable()},setProperties:function(M){this._propertyModel.clear(),this.addProperties(M)},addProperties:function(B){if(B){var I=this._propertyModel;B.forEach(function(_){if(!(_ instanceof Xq)){var G=zs(_.className);_=mq(G?G:Xq,_)}I.add(_)})}},getRowIndexAt:function(l){var $=this,m=A($.lp(l).y/$._rowHeight);return m>=0&&m<$._rows.size()?m:-1},getPropertyAt:function(x){var C=this,M=C.getRowIndexAt(x);return M>=0?C._rows.get(M).property:E},getToolTip:function(D){var W=this,Z=W.getPropertyAt(D),v=W._27o;return Z&&v?Z.getToolTip(v,W._9I<W.lp(D).x,W):E}});var jq=function(H){this.pv=H,this.addListeners()};yr(jq,O,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(J){this.getView().style.cursor=J},clear:function(){var w=this;w._62O=w.cp=w.ty=w.p=E,w.setCursor(hm)},handle_mousedown:function(O){this.handle_touchstart(O)},handle_touchstart:function(N){var A=this,J=A.pv;ki(N),J.setFocus(N)&&(rq(N)?(A.cp=Rb(N),A.ty=J.ty(),A.p=J.getColumnPosition(),A.handle_touchmove(N)):J.setSelectRowIndex(J.getRowIndexAt(N)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(W){this.handle_touchend(W)},handle_touchend:function(p){var E=this;if(E.cp&&!E._62O){var G=E.pv,w=G.lp(p),k=w.x,H=w.y,r=G._indent,S=G.getRowIndexAt(p),m=G._9I;if(S>=0){var C=G._rowHeight,O=C*S,N=G._rows.get(S),R=N.property;if(Qo(N))wc(G.isExpanded(N)?G._expandIcon:G._collapseIcon)&&k>=0&&r>=k&&H>=O&&O+C>=H?G.toggle(N):nd(p)&&G.toggle(N);else if(k>m&&G.isPropertyEditable(R,p)){var I={x:m+1,y:O,width:G.getWidth()-m-1,height:C},V={x:I.x+G.tx(),y:I.y+G.ty(),width:I.width,height:I.height},h=0,M=G._29I;I.y<M.y?h=I.y-M.y:I.y+C>M.y+M.height&&(h=I.y+C-M.y-M.height),h&&(G.ty(G.ty()-h),V.y-=h),G.beginEditing({data:N.data,property:R,value:G.getValue(N.data,R),event:p,rect:I,editorRect:V,view:G})}}G.setSelectRowIndex(S)}E.clear()},handleWindowMouseMove:function($){this.handleWindowTouchMove($)},handleWindowTouchMove:function(p){var s=this,B=s.pv,e=s.ty,R=s.cp,D=Rb(p),T=s._62O;if("p"===T)B.setTranslateY(e+D.y-R.y);else if("c"===T){var U=B.getWidth()-B._indent;if(U>16){var v=s.p-(R.x-D.x)/U,x=16/U;x>v&&(v=x),v>1-x&&(v=1-x),B.setColumnPosition(v)}}else"s"===T&&B.setTranslateY(e+(R.y-D.y)*B._59I/B._29I.height)},handle_mousemove:function(p){this.handle_touchmove(p)},handle_touchmove:function(S){if(!df&&rq(S)){var m=this,u=m.pv,q=F(u.lp(S).x-u._9I)<=(im?8:3);m.cp?m._62O||(q?(m._62O="c",to(m)):F(Rb(S).y-m.cp.y)>=2&&(m._62O=m.isV(S)?"s":"p",to(m))):(q?m.setCursor(Cp):m.setCursor(hm),m.isV(S)&&u._43o())}},isV:function(Q){var U=this.pv,k=U._29I;return U._41o()&&k.x+k.width-U.lp(Q).x<kp},handle_mousewheel:function(B){this.handleScroll(B,B.wheelDelta/40)},handle_DOMMouseScroll:function(i){2===i.axis&&this.handleScroll(i,-i.detail)},handleScroll:function(h,S){var d=this.pv;ki(h),d.endEditing(),d.translate(0,S*d.getRowHeight())},handle_keydown:function(a){var B=this.pv,K=B._rows.size(),S=B._selectRowIndex+(uh(a)?-1:1);(uh(a)||ps(a))&&(0>S&&(S=0),S>=K&&(S=K-1),B.setSelectRowIndex(S))}}),hd.ListView=function(t){this._5o(t),new Xm(this)},ie("ListView",O,{ms_ac:[Kk,id,Kj,Pk,vi,Cq,je,Rf,Eg,ir,Ab,fi,wd,Iq],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Sh,_rowHeight:dm,_rowLineVisible:$.listViewRowLineVisible,_rowLineColor:$.listViewRowLineColor,_scrollBarColor:jl,_scrollBarSize:bn,_autoMakeVisible:ks,_autoHideScrollBar:ul,_selectBackground:$.listViewSelectBackground,_labelColor:$.listViewLabelColor,_labelSelectColor:$.listViewLabelSelectColor,_labelFont:$.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(g){var t=this,u=t._checkMode;t._checkMode=g,t.fp(iq,u,g)},drawRow:function(o,d,X,$,E,T,c){var n=this,Z=0,Y=n._indent,D=n.getIconWidth(d);n.drawRowBackground(o,d,X,$,E,T,c),n._checkMode&&(Wf(o,wc(n.getCheckIcon(d)),Z+Y/2,E+c/2,d,n),Z+=Y),n.drawIcon(o,d,Z,E,D,c),n.drawLabel(o,d,Z+D,E,c)}});var Xm=function(i){this.list=i,this._lastSelectDataTime=xq(),this.addListeners()};yr(Xm,O,{ms_listener:1,getView:function(){return this.list._view},clear:function(O){var c=this,N=c.list;O&&"d"===c._62O&&!c.dragCancel&&N.handleDragAndDrop(O,"end"),N.draggingData&&(N.draggingData=null,N.redraw()),c.dragCancel=c._62O=c._isV=c._isH=c.cp=c.tx=c.ty=E},handle_mousedown:function(q){this.handle_touchstart(q)},handle_touchstart:function(h){var U=this,a=U.list;if(ki(h),a.setFocus(h)){var w=a.getDataAt(h);U.cp=Rb(h),U.tx=a.tx(),U.ty=a.ty(),rq(h)?w&&a.handleDragAndDrop&&!U.isV(h)&&!U.isH(h)&&(a.draggingData=w,a.redraw(),a.handleDragAndDrop(h,"prepare")):(w&&U._33o(h,w),U.clear(h))}},handleWindowMouseUp:function($){this.clear($)},handleWindowTouchEnd:function(S){this.clear(S)},handle_mouseup:function(K){this.handle_touchend(K)},handle_touchend:function(I){var q=this,X=q.list;if(!q._isV&&!q._isH&&q.cp&&!q._62O){var H=X.getDataAt(I);H?(X.isCheckMode()?q._34o(I,H):q._33o(I,H),nd(I)?X.onDataDoubleClicked(H,I):X.onDataClicked(H,I)):X.handleBackgroundClick(I)}q.clear(I)},handleWindowMouseMove:function(_){this.handleWindowTouchMove(_)},handleWindowTouchMove:function(j){var X=this,G=X.list,c=X._62O,A=X.tx,R=X.ty,r=X.cp,Z=Rb(j),t=G._29I;"p"===c?G.setTranslate(A+Z.x-r.x,R+Z.y-r.y):"v"===c?G.ty(R+(r.y-Z.y)*G._59I/t.height):"h"===c?G.tx(A+(r.x-Z.x)*G._91I/t.width):"d"===c&&(X.dragCancel||G.handleDragAndDrop(j,"between"))},handle_mousemove:function(G){this.handle_touchmove(G)},handle_touchmove:function(u){if(!df&&rq(u)){var V=this,k=V.list;if(V._isV=V.isV(u),V._isH=V.isH(u),V.cp){if(!V._62O){if(gn(Rb(u),V.cp)<2)return;V._isV?V._62O="v":V._isH?V._62O="h":k.draggingData&&!this.dragCancel?(V._62O="d",k.handleDragAndDrop(u,"begin")):V._62O="p",V._62O&&"d"!==V._62O&&k.draggingData&&(k.draggingData=null,k.redraw()),to(V)}}else V._isV&&k._43o(),V._isH&&k._42o()}},isV:function(S){var B=this.list,L=B._29I;return B._41o()&&L.x+L.width-B.lp(S).x<kp},isH:function(x){var S=this.list,X=S._29I;return S._40o()&&X.y+X.height-S.lp(x).y<kp},handle_mousewheel:function(E){this.handleScroll(E,E.wheelDelta/40,E.wheelDelta!==E.wheelDeltaX)},handle_DOMMouseScroll:function(h){this.handleScroll(h,-h.detail,1)},handleScroll:function(v,s,W){var K=this.list;ki(v),K.endEditing&&K.endEditing(),W&&K._41o()?K.translate(0,s*K.getRowHeight()):K._40o()&&K.translate(10*s,0)},handle_keydown:function(h){if(!$.isInput(h.target)){var I,n=this.list,e=n.sm(),k=n._rows,a=k.size();if(kj(h))n.selectAll();else if(Bb(h))n.handleDelete&&n.handleDelete(h);else if($j(h))"d"!==this._62O||this.dragCancel||(n.handleDragAndDrop(h,"cancel"),this.dragCancel=!0);else if(dg(h))n.isCheckMode()&&(I=n.getFocusData(),I&&n.checkData(I));else if(uh(h)||ps(h)){var Y=n.isCheckMode();if(I=Y?n.getFocusData():e.ld()){var w=n.getRowIndex(I);w>=0&&(uh(h)?0!==w&&(I=k.get(w-1),Y?n.setFocusData(I):e.ss(I)):w!==a-1&&(I=k.get(w+1),Y?n.setFocusData(I):e.ss(I)))}else a>0&&(I=k.get(0),Y?n.setFocusData(I):e.ss(I))}}},_34o:function(L,$){var R=this.list,Z=R.lp(L).x;return Z>=0&&Z<=R._indent?(R.checkData($),void 0):(R.setFocusData($),void 0)},_33o:function(w,R){var C=this.list,u=C.sm(),U=u.ld();if(In(w))C.isSelected(R)?u.rs(R):u.as(R);else if(Cj(w))if(U)for(var t=C.getRowIndex(U),G=C.getRowIndex(R);t!==G;)t+=G>t?1:-1,u.as(C._rows.get(t));else u.ss(R);else if(rq(w)){var M=xq();if(u.contains(R)){var K=M-this._lastSelectDataTime;C.handleDataDoubleSelect&&K>500&&1500>K&&C.handleDataDoubleSelect(w,R)}u.ss(R),this._lastSelectDataTime=M}else u.contains(R)||u.ss(R)}}),hd.TreeView=function(v){var t=this;t._35o(),t._5o(v),new Dg(t)},ie("TreeView",O,{ms_ac:[Kk,id,Kj,"rootVisible",iq,"rootData",Rf,Eg,ir,Ab,fi,vi,Pk,Cq,je,an,yf,wd,Iq,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:E,_indent:Sh,_rowHeight:dm,_rowLineVisible:$.treeViewRowLineVisible,_rowLineColor:$.treeViewRowLineColor,_scrollBarColor:jl,_scrollBarSize:bn,_autoHideScrollBar:ul,_expandIcon:$.treeViewExpandIcon,_collapseIcon:$.treeViewCollapseIcon,_autoMakeVisible:ks,_selectBackground:$.treeViewSelectBackground,_labelColor:$.treeViewLabelColor,_labelSelectColor:$.treeViewLabelSelectColor,_labelFont:$.treeViewLabelFont,_doubleClickToToggle:$.treeViewDoubleClickToToggle,drawRow:function(v,D,G,C,m,s,F){var g=this;g.drawRowBackground(v,D,G,C,m,s,F),g._97I(v,D,G,0,m,s,F)},isOnToggleIcon:function(b){var a=this.getDataAt(b);if(a){var B=this.getIndent(),u=this.lp(b).x;if(wc(this.getToggleIcon(a))){var A=B*this.getLevel(a);if(u>=A&&A+B>=u)return!0}}return!1}});var Dg=function(L){bs(Dg,this,[L])};yr(Dg,Xm,{toggle:function(U,Y,e,E){var X=this.list,N=X.lp(U).x;if(wc(X.getToggleIcon(Y))){var A=e*E;if(N>=A&&A+e>=N)return X.toggle(Y),!0}return X.isDoubleClickToToggle()&&nd(U)?(X.toggle(Y),!0):!1},_34o:function(v,j){var n=this.list,Y=n.lp(v).x,b=n._levelMap[j._id],i=n._indent,p=i*(b+1);return Y>=p&&p+i>=Y?(n.checkData(j),void 0):(this.toggle(v,j,i,b)||n.setFocusData(j),void 0)},_33o:function(D,y){var e=this,M=e.list;e.toggle(D,y,M._indent,M.getLevel(y))||Dg.superClass._33o.call(e,D,y)},handle_keydown:function(u){if(Hf(u)||eg(u)){var t=this.list,j=t._rows,a=t.isCheckMode(),I=t.sm(),f=a?t.getFocusData():I.ld();f?f.hasChildren()&&(Hf(u)?t.collapse(f):t.expand(f)):j.size()>0&&(f=j.get(0),a?t.setFocusData(f):I.ss(f))}else Dg.superClass.handle_keydown.call(this,u)}});var Hd=hd.TableView=function(F){this._98I(),this._5o(F),new sj(this)};ie("TableView",O,{ms_ac:[Kk,id,Kj,"sortMode",Zh,lf,Pk,Cq,je,Xf,Jo,"sortColumn",Rf,Eg,ir,Ab,fi,wd,Iq],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:$d,_editable:!0,_batchEditable:!1,_rowHeight:dm,_rowLineVisible:$.tableViewRowLineVisible,_rowLineColor:$.tableViewRowLineColor,_columnLineVisible:$.tableViewColumnLineVisible,_columnLineColor:$.tableViewColumnLineColor,_scrollBarColor:jl,_scrollBarSize:bn,_autoHideScrollBar:ul,_autoMakeVisible:ks,_selectBackground:$.tableViewSelectBackground,_labelColor:$.tableViewLabelColor,_labelSelectColor:$.tableViewLabelSelectColor,_labelFont:$.tableViewLabelFont,getCheckColumn:function(){var V=this;if(!V._31o){var x=V._31o=new ji;x.setEditable(!0),x.setWidth(40),x.getValue=V.getCheckColumValue,x.drawCell=V.drawCheckColumnCell}return V._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(D){var y=this,m=y._39o,j=y.getCheckColumn();D!==y.isCheckMode()&&(D?m.add(j,0):m.remove(j),y.fp(iq,!D,D))},getCheckColumValue:function(I,A,S){return S.isSelected(I)},drawCheckColumnCell:function(e,v,K,g,G,P,i,L,Q){Wf(e,Q.getCheckIcon(v),G+i/2,P+L/2,v,Q)}});var sj=function(C){bs(sj,this,[C])};yr(sj,Xm,{_34o:function(A,G){var P=this.list,l=P._31o;if(P.isCellEditable(G,l,A)){var U=P._3Q(l),w=P.lp(A).x;if(U&&w>=U.startX&&w<U.startX+l.getWidth())return P.checkData(G),void 0}P._37O(G,A),P.setFocusData(G)},_33o:function(w,M){this.list._37O(M,w),sj.superClass._33o.apply(this,arguments)}});var Ci=hd.TreeTableView=function(J){var v=this,o=v._4o=new ji;v._35o(),v._98I(),v._5o(J),o.setDisplayName("Name"),o.setEditable(!0),o.setWidth(180),o.drawCell=en,o.getValue=Tb,v._39o.add(o),new Vf(v)},en=function(A,K,q,Z,z,X,j,D,Q){Q._97I(A,K,q,z,X,j,D)},Tb=function(M,C,i){return i.getLabel(M)};ie("TreeTableView",O,{ms_ac:[Kk,id,Kj,"sortMode",Zh,lf,vi,iq,"rootData","rootVisible",Rf,Eg,"sortColumn",an,yf,ir,Ab,fi,wd,je,Pk,Cq,Xf,Jo,Iq,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:$d,_checkMode:E,_editable:!0,_batchEditable:!1,_indent:Sh,_rowHeight:dm,_rowLineVisible:$.treeTableViewRowLineVisible,_rowLineColor:$.treeTableViewRowLineColor,_columnLineVisible:$.treeTableViewColumnLineVisible,_columnLineColor:$.treeTableViewColumnLineColor,_expandIcon:$.treeTableViewExpandIcon,_collapseIcon:$.treeTableViewCollapseIcon,_scrollBarColor:jl,_scrollBarSize:bn,_autoHideScrollBar:ul,_autoMakeVisible:ks,_selectBackground:$.treeTableViewSelectBackground,_labelColor:$.treeTableViewLabelColor,_labelSelectColor:$.treeTableViewLabelSelectColor,_labelFont:$.treeTableViewLabelFont,getTreeColumn:function(){return this._4o
}});var Vf=function(N){bs(Vf,this,[N])};yr(Vf,Xm,{_34o:function(y,Q){var P=this.list,G=P._4o,b=P._3Q(G),J=P.lp(y).x;if(b){var _=P._indent,M=b.startX+_*P.getLevel(Q);if(wc(P.getToggleIcon(Q))&&J>=M&&M+_>=J)return P.toggle(Q),void 0;if(P.isCellEditable(Q,G)&&(M+=_,J>=M&&M+_>=J))return P.checkData(Q),void 0}P._37O(Q,y),P.setFocusData(Q)},_33o:function(P,E){var R=this.list,Q=R.lp(P).x;if(wc(R.getToggleIcon(E))){var T=R._3Q(R._4o);if(T){var g=R._indent,b=T.startX+g*R.getLevel(E);if(Q>=b&&b+g>=Q)return R.toggle(E),void 0}}R._37O(E,P),Vf.superClass._33o.apply(this,arguments)}});var Ml=hd.TableHeader=function(b){var t=this,e=t._view=Hn(1,t),Z=t._39o=b.getColumnModel(),h=t.iv;t.tv=t._tableView=b,t._60I=new yb,t._canvas=Fj(e),e.style.background=$.tableHeaderBackground||"",e.style.height=Kr+sb,Z.mm(h,t),Z.md(h,t),Z.mh(h,t),b.mp(function(m){Pq[m.property]&&t.iv()},t),new Sk(t),t.iv()};ie("TableHeader",O,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Kk,Kj,vi,"moveBackground","insertColor",Xf,Jo,"resizable","movable"],_checkIcon:vf,_movable:!0,_resizable:!0,_labelColor:$.tableHeaderLabelColor,_labelFont:$.tableHeaderLabelFont,_columnLineColor:$.tableHeaderColumnLineColor,_columnLineVisible:$.tableHeaderColumnLineVisible,_sortDescIcon:$.tableHeaderSortDescIcon,_sortAscIcon:$.tableHeaderSortAscIcon,_moveBackground:$.tableHeaderMoveBackground,_insertColor:$.tableHeaderInsertColor,_indent:Sh,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(k){return k.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(c){return c.getColor()||this._labelColor},getLabelAlign:function(d){return d._align},onPropertyChanged:function(){this.iv()},_5Q:function(g){this._61I=g,this.iv()},getLogicalPoint:function(e){return He(e,this._canvas,this.tv.tx())},validateImpl:function(){var I=this,b=I._canvas,s=I.getWidth(),w=I.getHeight(),m=I.tv,j=I._60I,F=I._61I,W=-m.tx(),a=0;(s!==b.clientWidth||w!==b.clientHeight)&&nf(b,s,w),j.clear(),I._39o._roots.each(function(v){if(v.isVisible()){var C=a+v.getWidth();W+s>=a&&C>=W&&j.add({column:v,startX:a}),a=C}});var i=Qc(b);if(of(i,-W,0,1),i.beginPath(),i.rect(W,0,s,w),i.clip(),i.clearRect(W,0,s,w),j.each(function(l){var L=l.column,c=l.startX,P=L.getWidth();P>0&&(i.save(),i.beginPath(),i.rect(c,0,P,w),i.clip(),F&&F.column===L||I.drawColumn(i,L,c,0,P,w),I._columnLineVisible&&Fp(i,c+P-1,0,1,w,I._columnLineColor),i.restore())}),F){var N=F.column,a=F.startX,X=F.position,z=N.getWidth();i.save(),i.beginPath(),i.rect(a,0,z,w),i.clip(),i.fillStyle=I._moveBackground,i.fill(),I.drawColumn(i,N,a,0,z,w),i.restore(),as(i,I._insertColor,X,0,w)}i.restore()},_6Q:function(s){var I=this.tv;return I._31o===s&&I.sm().getSelectionMode()===bp},drawColumn:function(S,P,Z,N,l,I){var J=this,X=J.tv,s=wc(P.getIcon()),H=J.getLabelAlign(P);if(J._6Q(P)){var M=wc(J._checkIcon);Wf(S,M,Z+l/2,N+I/2,P,J)}else{var x=J.getLabel(P),Y=J.getLabelFont(P),m=J.getLabelColor(P),V=er(Y,x).width,o=s?J._indent:0;H===Pi?(s&&zm(S,s,oi,Z,N,o,I),Cd(S,x,Y,m,Z+o,N,l,I,Pi)):H===tl?(s&&zm(S,s,oi,Z+l-V-o,N,o,I),Cd(S,x,Y,m,Z,N,l,I,tl)):(s&&zm(S,s,oi,Z+(l-V-o)/2,N,o,I),Cd(S,x,Y,m,Z+(l-V+o)/2,N,0,I,Pi))}if(P.isSortable()&&X.getSortColumn()===P&&(s=wc(P.getSortOrder()===Hm?J._sortAscIcon:J._sortDescIcon))){var b=Ap(s,P)/2+2;Wf(S,s,H===tl?Z+b:Z+l-b,N+I/2,P,X)}}});var Sk=function(b){var B=this;B.th=b,B.tv=b._tableView,B.addListeners()};yr(Sk,O,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(I){this.getView().style.cursor=I},handle_mousemove:function(L){if(!df){var E=this;delete E._29o,E.setCursor(hm);for(var k=E.th,W=k._60I,y=k.lp(L).x,K=W.size()-1;K>=0;K--){var b=W.get(K),P=b.column,g=b.startX+P.getWidth();if(k.isResizable()&&F(g-y)<=(im?10:3))return E._29o=b,E.setCursor(Cp),void 0;y>b.startX&&g>y&&(E._29o=b),(P.isClickable()||P.isSortable()||k.isMovable()||E.tv.getCheckColumn&&P===E.tv.getCheckColumn())&&y>b.startX&&g>y&&E.setCursor(Ho)}}},handle_mousedown:function(q){this.handle_touchstart(q)},handle_touchstart:function(w){var C=this;ki(w),C.tv.endEditing(),C.handle_mousemove(w),C._29o&&(C.x=Rb(w).x,C.lx=C.th.lp(w).x,C.w=C._29o.column.getWidth(),to(C,w))},handleWindowMouseMove:function(V){this.handleWindowTouchMove(V)},handleWindowTouchMove:function(q){var j=this,O=j.th,k=j.getView().style.cursor,J=j._29o,u=Rb(q).x-j.x;if(j.resizing||j.moving||(k===Cp?j.resizing=1:O.isMovable()&&k===Ho&&F(u)>2&&(j.moving=1)),j.resizing)J.column.setWidth(j.w+u);else if(j.moving){var x=j.lx+u;O._60I.each(function(X){var $=X.startX,t=$+X.column.getWidth();if(x>=$&&t>=x){var D={column:J.column,startX:J.startX+u,front:t-x>x-$,insertColumn:X.column};D.position=D.front?$:t,O._5Q(D)}})}},_16Q:function(K,A){var j=this,k=j.tv,d=j.th,O=d._checkIcon;if(d._6Q(K)){var M=wc(O),e=j.lx,v=K.getWidth(),W=Ap(M,K);if(e>=A+v/2-W&&A+v/2+W>=e){d.setCheckIcon(O===Je?vf:Je);var q=k.sm(),_=k._rows;return O===Je?q.rs(_):q.ss(_),k.onCheckColumnClicked(K),!0}}return!1},handleWindowMouseUp:function(z){this.handleWindowTouchEnd(z)},handleWindowTouchEnd:function(l){var x=this,r=x.tv,A=x.th,U=x._29o;if(x.moving){var K=A._61I;if(K&&K.insertColumn!==K.column){var j=K.column,n=r.getColumnModel()._roots,y=n.remove(j),F=n.indexOf(K.insertColumn);F>=0&&(K.front||F++,F<=n.size()&&(n.add(j,F),r.getColumnModel()._38I(j,y,F)))}A._5Q(E),delete x.moving}else if(!x.resizing&&U){j=U.column;var i=A.lp(l).x,b=U.startX,z=!0;if(A.onColumnClicked){var e=A.onColumnClicked(j,l,b);e===!1&&(z=!1)}if(z&&i>=b&&i<=b+j.getWidth()&&!x._16Q(j,b)){if(j.isSortable()){var q=r.getSortMode(),T=j.getSortOrder();q===$d?r.getSortColumn()===j?(T===Xg&&r.setSortColumn(E),j.setSortOrder(T===Hm?Xg:Hm)):r.setSortColumn(j):"bistate"===q&&(r.getSortColumn()===j?j.setSortOrder(T===Hm?Xg:Hm):r.setSortColumn(j))}r.onColumnClicked(j,l,b)}}x._29o=x.resizing=x.x=x.lx=x.w=E}}),hd.TablePane=function(L){this.init(new Hd(L))},ie("TablePane",O,{ms_v:1,_44o:1}),hd.TreeTablePane=function(N){this.init(new Ci(N))},ie("TreeTablePane",O,{ms_v:1,_44o:1}),hd.Toolbar=function(T){var g=this,Q=g._view=Hn(1,g),l=Q.style;l.background=$.toolbarBackground||"",l.height=hg+sb,g._canvas=Fj(Q),g._30o=new yb,g._90I=new yb,g.setItems(T||[]),Q.handleGroupSelectedChanged=function(F){if(F.isSelected()){var G=F.getGroupId();null!=G&&g._items.forEach(function(y){var J=y.element;J&&J!==F&&J.setSelected&&J.getGroupId&&J.getGroupId()===G&&J.setSelected(!1)})}},new lj(g)},ie("Toolbar",O,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Zd,Kk,Kj,id,Iq,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:$.toolbarLabelColor,_labelSelectColor:$.toolbarLabelSelectColor,_labelFont:$.toolbarLabelFont,_selectBackground:$.toolbarSelectBackground,_itemGap:$.toolbarItemGap,_separatorColor:$.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(J){var W=this.getItemInfoAt(J);return W?W.item.toolTip:E},getLabelColor:function(q){return q&&q.selected&&q.type!==Je&&q.type!==_j?this._labelSelectColor:this._labelColor},onPropertyChanged:function(U){this.iv(),U.property===Zd&&this._items.forEach(function(x){qp(x)})},redraw:function(){this.iv()},addItem:function(I,l){var Q=this._items;l==E?Q.push(I):Q.splice(l,0,I),this.fp(Zd,E,Q)},removeItem:function(J){if(J)for(var r=this._items,q=0;q<r.length;q++)J===r[q]&&(r.splice(q,1),this.fp(Zd,E,r))},removeItemById:function(Z){if(Z!=E)for(var t=this._items,u=0;u<t.length;u++)if(Z===t[u].id){var b=t.splice(u,1)[0];return this.fp(Zd,E,t),b}},getItemById:function(M){if(M!=E)for(var Y=this._items,S=0;S<Y.length;S++){var o=Y[S];if(M===o.id)return o}},setItemVisible:function(_,c){var A=this.getItemById(_);A&&(A.visible=c)},getItemInfos:function(){return this._30o},getItemInfoAt:function(s){var c=this,J=0,K=c._30o,m=c.lp(s),M=m.x,S=m.y;if(S>=0&&S<=c.getHeight())for(;J<K.size();J++){var I=K.get(J);if(I.startX<=M&&M<=I.endX)return I}return E},drawItem:function(U,Z,b,i,e){if(Z.visible===!1)return 0;if(hp(Z.visible)&&!Z.visible())return 0;var m=this,t=Z.disabled;t&&(U.globalAlpha=Dh);var p=m.drawItemImpl(U,Z,b,i,e),I=m._itemGap;return t&&(U.globalAlpha=1),this._currentItem!==Z||"separator"===Z||Z.separator===!0||Z.unfocusable||gj(U,m._separatorColor,b-I/2,0,p+I,i),p},drawItemImpl:function(S,V,j,D,t){var L=this,R=L._view,O=L._itemGap,F=D/2,Z=V.type,I=V.element,P=V.label;Qo(I)&&(P=I,I=E);var G,k=L.getLabelFont(V),H=L.getLabelColor(V),$=V.selected,e=wc(V.icon),g=Ap(e,V),v=0,r=g+(P?er(k,P).width:0);if("separator"===V||V.separator===!0)return as(S,L._separatorColor,j,D/4,F),1;if(I){e&&Wf(S,e,j+g/2,F,V,L),Cd(S,P,k,H,j+g,0,0,D);var h=Jg(I);t||L._90I.add(h),h.parentNode!==R&&Hi(R,h),I.iv&&I.iv(),I.validate&&I.validate();var K=h.getBoundingClientRect(),f=K.width,n=h.style;return Mn(h),n.left=L.tx()+j+r+sb,n.top=(D-K.height)/2+sb,r+f}return Z===_j?G=wc($?gq:Rq):Z===Je&&(G=wc($?Je:vf)),G?(v=Ap(G,V),Wf(S,G,j+v/2,F,V,L),j+=v,r+=v):$&&Fp(S,j-O/2,0,r+O,D,L.getSelectBackground(V)),e&&Wf(S,e,j+g/2,F,V,L),Cd(S,P,k,H,j+g,0,0,D),r},validateImpl:function(){var J=this,V=J._canvas,t=J.getWidth(),y=J.getHeight(),p=J._30o,F=J._items;nf(V,t,y);var U=Qc(V),c=J._itemGap,A=c/2;of(U,J.tx(),0,1),U.clearRect(0,0,t,y);var z=J._90I;J._90I=new yb,p.clear(),F.forEach(function(w){var r=J.drawItem(U,w,A,y);p.add({item:w,startX:A,endX:A+r,width:r}),r&&(A+=r+c)}),z.each(function(u){J._90I.contains(u)||ii(u)});var G=J._64I;J._64I=N(0,A),U.restore(),J._stickToRight?(J._65O=0,U=Qc(V),A=t-J._64I+c,of(U,0,0,1),U.clearRect(0,0,t,y),p.clear(),F.forEach(function(L){var l=J.drawItem(U,L,A,y,!0);p.add({item:L,startX:A,endX:A+l,width:l}),l&&(A+=l+c)}),U.restore()):J.tx(J.tx()),G!==J._64I&&J.onSumWidthChanged(G,J._64I)},onSumWidthChanged:function(){},handleClick:function(a,v){var T=this,M=a.type,R=a.action,l=a.groupId,V=a.selected;a.disabled||(l!=E?V||(a.selected=!0,this._items.forEach(function(n){n.groupId===l&&a!==n&&(n.selected=!1)}),R&&a.action(a,T,v)):M===Je||"toggle"===M?(a.selected=!V,R&&a.action(a,T,v)):R&&a.action(a,T,v)),ij(),T.iv()}});var lj=function(f){this.tb=f,this.addListeners()};yr(lj,O,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(N){this.handleScroll(N,10*(N.wheelDelta/40))},handle_DOMMouseScroll:function(o){this.handleScroll(o,10*-o.detail)},handleScroll:function(j,g){ki(j);var F=this.tb;F.isScrollable()&&!F._stickToRight&&(F.tx(F.tx()+g),Rh())},handle_mousemove:function(f){var J=this;df||J.setItem(f)},handle_mouseout:function(k){var J=this;k.target===J.getView()?J.tb.setCurrentItem(E):J.handle_mousemove(k)},handle_mousedown:function(i){this.handle_mousemove(i),this.handle_touchstart(i)},handle_touchstart:function(e){var W=this,i=W.tb,k=e.target;rq(e)&&(k===W.getView()||k===i._canvas)&&(ki(e),i.setFocus(e)&&(this.setItem(e,!0),(i.isScrollable()||W.info&&!W.info.item.disabled)&&(W.x=Rb(e).x,W.tx=i.tx(),to(W,e))))},handleWindowMouseMove:function(h){this.handleWindowTouchMove(h)},handleWindowTouchMove:function(K){var R=this,O=R.tb;if(!O._stickToRight){var H=Rb(K).x-R.x;!R._25o&&F(H)>2&&O.isScrollable()&&(R._25o=1),R._25o&&O.tx(R.tx+H)}},handleWindowMouseUp:function(R){this.handleWindowTouchEnd(R)},handleWindowTouchEnd:function(c){var f=this,n=f.tb,L=f.info,Q=f.tb.getItemInfoAt(c);if(!f._25o&&L){var p=L.item;Q&&Q.item===p&&n.handleClick(p,c)}f._25o=f.x=f.tx=E,f.setItem()},setItem:function(r,v){var y=this,N=y.tb,m=y.info=r?N.getItemInfoAt(r):E,z=m?m.item:E;N.setCurrentItem(z),v&&z&&hp(z.onDown)&&z.onDown(r)}}),hd.BorderPane=function(){this._view=Hn(1,this),this.iv()},ie("BorderPane",O,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function($,U){this._12o("leftView",$),U!=E&&this.setLeftWidth(U)},getRightView:function(){return this._rightView},setRightView:function(D,Y){this._12o("rightView",D),Y!=E&&this.setRightWidth(Y)},getTopView:function(){return this._topView},setTopView:function(F,L){this._12o("topView",F),L!=E&&this.setTopHeight(L)},getBottomView:function(){return this._bottomView},setBottomView:function(p,F){this._12o("bottomView",p),F!=E&&this.setBottomHeight(F)},getCenterView:function(){return this._centerView},setCenterView:function(U){this._12o("centerView",U)},_12o:function(Y,j){var q=this,t="_"+Y,J=q._view,b=q[t];b!==j&&(b&&(b.getView?ii(b.getView()):ii(b)),q[t]=j,j&&(j.getView?Hi(J,j.getView(),1):Hi(J,j,1)),q.fp(Y,b,j))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var Z=this,Q=Z._topView,s=Z._bottomView,n=Z._leftView,c=Z._rightView,m=Z._centerView,V=Z.getWidth(),h=Z.getHeight(),K=0,w=0,i=V,v=h,W=0,x=0,l=0,f=0;Q&&(W=Z._topHeight==E?lk(Q):Z._topHeight,w=W),s&&(x=Z._bottomHeight==E?lk(s):Z._bottomHeight,v=h-x),n&&(l=Z._leftWidth==E?Wl(n):Z._leftWidth,K=l),c&&(f=Z._rightWidth==E?Wl(c):Z._rightWidth,i=V-f);var H=N(0,i-K),A=N(0,v-w);Q&&ib(Q,0,0,V,W),s&&ib(s,0,v,V,x),n&&ib(n,0,w,l,A),c&&ib(c,i,w,f,A),m&&ib(m,K,w,H,A)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);