(window.webpackJsonp=window.webpackJsonp||[]).push([[136],{1155:function(t,n,a){"use strict";a.r(n);var e=function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("div",{staticClass:"c-main-border"},[a("div",{staticClass:"c-left-border-blue"},[a("h3",[t._v("批量配置综合测点")]),t._v(" "),a("div",{staticClass:"c-btns-right"},[a("Button",{attrs:{type:"primary",shape:"circle",disabled:t.submitLoading},on:{click:function(n){return t.handleSubmit("pointValidate")}}},[t._v("保存")]),t._v(" "),a("Button",{staticClass:"c-btn-back",attrs:{type:"primary",shape:"circle"},on:{click:t.back}},[t._v("取消")])],1)]),t._v(" "),a("div",{staticClass:"c-top-border-gray padding20-14"},[a("Form",{ref:"pointValidate",attrs:{model:t.point,rules:t.ruleValidate,"label-width":140}},[a("div",{staticClass:"c-form-common"},[a("div",{staticClass:"c-title-css"},[t._v("基本信息")]),t._v(" "),a("Row",{staticStyle:{"padding-left":"20px","padding-top":"20px"}},[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"信号类型:",prop:"datype"}},[a("Select",{on:{"on-change":t.datypeChange},model:{value:t.point.datype,callback:function(n){t.$set(t.point,"datype",n)},expression:"point.datype"}},t._l(t.datypeMap,(function(n,e){return a("Option",{key:e,attrs:{value:e}},[t._v(t._s(n))])})),1)],1)],1),t._v(" "),a("Col",{attrs:{span:"8",offset:"3"}},[a("FormItem",{attrs:{label:"数据分类:",prop:"categoryId"}},[a("Select",{on:{"on-change":t.changeSetUnit},model:{value:t.point.categoryId,callback:function(n){t.$set(t.point,"categoryId",n)},expression:"point.categoryId"}},t._l(t.categoryList,(function(n){return a("Option",{key:n.id,attrs:{value:n.id}},[t._v(t._s(n.categoryName))])})),1)],1)],1)],1),t._v(" "),a("Row",{staticStyle:{"padding-left":"20px"}},["State"==t.point.datype?a("Col",{attrs:{span:"8"}},[a("FormItem",{class:["c-custom-left","-1"==t.point.enumvalue?"w65":"w100"],attrs:{label:"状态值:",prop:"enumvalue"}},[a("Select",{model:{value:t.point.enumvalue,callback:function(n){t.$set(t.point,"enumvalue",n)},expression:"point.enumvalue"}},t._l(t.statusMap,(function(n){return a("Option",{key:n.statusName,attrs:{value:n.id}},[t._v(t._s(n.statusName))])})),1)],1),t._v(" "),"-1"==t.point.enumvalue&&"State"==t.point.datype?a("FormItem",{staticClass:"form-custom",class:["c-custom-right","-1"==t.point.enumvalue?"w35":"w0"],attrs:{prop:"enumvalueInput"}},[a("Input",{model:{value:t.point.enumvalueInput,callback:function(n){t.$set(t.point,"enumvalueInput",n)},expression:"point.enumvalueInput"}})],1):t._e()],1):t._e(),t._v(" "),"State"!=t.point.datype?a("Col",{attrs:{span:"8"}},[a("FormItem",{class:["c-custom-left","-1"==t.point.unit?"w65":"w100"],attrs:{label:"单位:",prop:"unit"}},[a("Select",{model:{value:t.point.unit,callback:function(n){t.$set(t.point,"unit",n)},expression:"point.unit"}},t._l(t.unitMap,(function(n,e){return a("Option",{key:e,attrs:{value:e}},[t._v(t._s(n))])})),1)],1),t._v(" "),"-1"==t.point.unit&&"State"!=t.point.datype?a("FormItem",{staticClass:"form-custom",class:["c-custom-right","-1"==t.point.unit?"w35":"w0"],attrs:{prop:"unitInput"}},[a("Input",{model:{value:t.point.unitInput,callback:function(n){t.$set(t.point,"unitInput",n)},expression:"point.unitInput"}})],1):t._e()],1):t._e(),t._v(" "),a("Col",{attrs:{span:"8",offset:"3"}},[a("FormItem",{attrs:{label:"显示小数位:",prop:"numtail"}},[a("Select",{attrs:{disabled:"State"==t.point.datype},model:{value:t.point.numtail,callback:function(n){t.$set(t.point,"numtail",n)},expression:"point.numtail"}},t._l(t.numtailMap,(function(n){return a("Option",{key:n.numtailName,attrs:{value:n.id}},[t._v(t._s(n.numtailName))])})),1)],1)],1)],1)],1)])],1)])};e._withStripped=!0;var o=a(23),i=a(520),p=(a(11),{data:function(){return{submitLoading:!1,categoryList:[],unitDefalutMap:{"-2":"无","-1":"自定义"},point:{categoryId:0,datype:"",enumvalue:"0,关;1,开;",enumvalueInput:"0,关;1,开;",unit:"",numtail:2},ruleValidate:{datype:[{required:!0,message:"请选择信号类型"}],enumvalue:[{required:!0,message:"请选择状态值"}],enumvalueInput:[{required:!0,message:"自定义状态值不能为空",trigger:"blur"},{validator:function(t,n,a){if(n){/^((\d+)(,{1})([\u4e00-\u9fa5]+)(;{1}))*$/.test(n)?a():a(new Error("自定义格式不对"))}else a()}}],unitInput:[{required:!0,message:"自定义单位不能为空",trigger:"blur"}]}}},created:function(){this.getCategroyList(),this.unitMap=this.unitDefalutMap},computed:Object(o.b)({datypeMap:function(t){return t.map.mpoint.datypeText},numtailMap:function(t){return t.map.mpoint.numtail},statusMap:function(t){return t.map.mpoint.status}}),methods:{getCategroyList:function(){var t=this;this.$http.get(i.a.getCategroyData).then((function(n){n&&(t.categoryList=n)}))},changeSetUnit:function(t){var n=(this.categoryList.filter((function(n){return n.id==t}))[0]||{}).unit,a=null==n?[]:n.split(";"),e={};a.forEach((function(t){return e[t]=t})),this.unitMap=Object.assign({},e,this.unitDefalutMap)},datypeChange:function(t){"State"==t&&(this.point.enumvalue||(this.point.enumvalue="0,关;1,开;"))},handleSubmit:function(t){var n=this;this.$refs[t].validate((function(t){if(t){n.submitLoading=!0;var a=JSON.parse(JSON.stringify(n.point));"-2"==a.unit?a.unit="":"-1"==a.unit&&(a.unit=a.unitInput),a.enumvalue="-1"==a.enumvalue?a.enumvalueInput:a.enumvalue,"State"==a.datype&&(a.unit="",delete a.unitInput,delete a.enumvalueInput),"Digtal"==a.datype&&(a.enumvalue="",delete a.enumvalueInput,delete a.unitInput);var e={};e.bmpoint=a,e.ids="all"==n.$route.params.ids?sessionStorage.getItem("batchMpointIds"):n.$route.params.ids,e.type="COMPLEX",n.$http.put(i.a.batchSave,e).then((function(t){n.submitLoading=!1,t.count?(n.$Notice.success({title:"成功",desc:"数据保存成功",duration:3}),n.$routeBack()):n.submitLoading=!1}))}}))},back:function(){this.$router.back()}}}),l=(a(943),a(1)),s=Object(l.a)(p,e,[],!1,null,null,null);s.options.__file="src/views/mpoint/mpoint/components/batch-multiple.vue";n.default=s.exports},520:function(t,n,a){"use strict";var e=a(22),o={modalMpoints:"/loong/api/mpoints/dialog",alarmChart:"/loong/api/mpoints/alarm-condition",downloadTemplate:e.a+"/loong/api/mpoints/excel-template-download",exportTemplate:e.a+"/loong/api/mpoints/export",importExcel:e.a+"/loong/api/mpoints/import",saveExcelData:"/loong/api/mpoints/import-save",cancelExcelData:"/loong/api/mpoints/import-cancel",getCategroyData:"/loong/api/mpoints-datacategory",getMpointsList:"/loong/api/mpoints",deleteMpoints:"/loong/api/mpoints",deleteAllMpoints:"/loong/api/mpoints/all",batchSave:"/loong/api/mpoints/batch",autoMpoints:"/loong/api/mpoints-auto",datainputMpoints:"/loong/api/mpoints-datainput",taskMpoints:"/loong/api/mpoints-task",getCalcMpointDetail:"/loong/api/mpoints-calc",getCycle:"/loong/api/mpoints-calc-cycle",getAnalysisMpointDetail:"/loong/api/mpoints-analysis",getMpointNumByType:"/loong/api/mpoints/batch/all",getMpointDataImportList:"/loong/api/mpoint-data-imports",deleteMpointDataImport:"/loong/api/mpoint-data-imports",stopMpointDataImport:"/loong/api/mpoint-data-imports",pointDataImportTempleDownload:e.a+"/loong/api/mpoint-data-imports/templeDownload",pointDataImportFileUpload:e.a+"/loong/api/mpoint-data-imports/fileUpload"};n.a=o},703:function(t,n,a){var e=a(944);"string"==typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);(0,a(17).default)("48ad4205",e,!1,{})},943:function(t,n,a){"use strict";var e=a(703);a.n(e).a},944:function(t,n,a){(n=a(10)(!1)).push([t.i,".c-form-common .siteTreeHight .cmp-dropdown-tree {\n  width: 100% !important;\n}\n.c-form-common .form-custom .ivu-form-item-content {\n  margin-left: 0 !important;\n}\n.c-form-common .c-custom-left {\n  float: left;\n}\n.c-form-common .c-custom-right {\n  float: right;\n  padding-left: 10px;\n}\n.c-form-common .w0 {\n  width: 0;\n}\n.c-form-common .w35 {\n  width: 35%;\n}\n.c-form-common .w65 {\n  width: 65%;\n}\n.c-form-common .w100 {\n  width: 100%;\n}\n",""]),t.exports=n}}]);