(window.webpackJsonp=window.webpackJsonp||[]).push([[103],{1135:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"c-main-border"},[a("div",{staticClass:"c-left-border-blue"},[a("h3",[t._v("用户反馈")]),t._v(" "),a("div",{staticClass:"c-btns-right"},[a("Button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("提交")])],1)]),t._v(" "),a("div",{staticClass:"c-top-border-gray padding20"},[a("Form",{ref:"feedbackForm",attrs:{model:t.feedback,rules:t.ruleValidate}},[a("div",{staticClass:"feedback-form"},[a("div",{staticClass:"c-form-row-1col"},[a("div",{staticClass:"c-form-item"},[a("h4",[t._v("意见类型:")]),t._v(" "),a("RadioGroup",{model:{value:t.feedback.type,callback:function(e){t.$set(t.feedback,"type",e)},expression:"feedback.type"}},t._l(t.types,(function(e){return a("Radio",{key:e.value,attrs:{label:e.value}},[t._v(t._s(e.label))])})),1)],1)]),t._v(" "),a("div",{staticClass:"c-form-row-1col"},[a("div",{staticClass:"c-form-item full-width"},[a("h4",[t._v("请将您的意见反馈给我们:")]),t._v(" "),a("FormItem",{staticClass:"full-width",attrs:{prop:"content"}},[a("Input",{attrs:{type:"textarea",rows:3,placeholder:"请输入"},model:{value:t.feedback.content,callback:function(e){t.$set(t.feedback,"content",e)},expression:"feedback.content"}})],1)],1)]),t._v(" "),a("div",{staticClass:"c-form-row-1col"},[a("div",{staticClass:"c-form-item"},[a("h4",{staticStyle:{display:"inline-block"}},[t._v("添加图片或视频（最多4张）:")]),t._v(" "),a("mg-uploader",{attrs:{max:20,btnText:"上传",accept:"image/*,video/*",before:t.onBeforeUpload},on:{"on-success":t.uploadSuccess}})],1),t._v(" "),a("div",{staticStyle:{"margin-left":"18px"}},[a("ul",t._l(t.uploadList,(function(e){return a("li",{key:e.id},[t._v("\r\n                            "+t._s(e.name)+"\r\n                            "),a("a",{staticStyle:{"margin-left":"30px"},attrs:{href:"javascript:;"},on:{click:function(a){return t.delUpload(e)}}},[a("Icon",{attrs:{type:"android-close",size:"16",color:"#ff5050"}})],1)])})),0)])]),t._v(" "),a("div",{staticClass:"c-form-row-2col",staticStyle:{"margin-top":"25px","padding-top":"10px","border-top":"1px solid #EEE"}},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("您的名字:")]),t._v(" "),a("FormItem",{attrs:{prop:"name"}},[a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入你的名字"},model:{value:t.feedback.name,callback:function(e){t.$set(t.feedback,"name",e)},expression:"feedback.name"}})],1)],1),t._v(" "),a("div",{staticClass:"c-form-item"},[a("label",[t._v("您的手机号:")]),t._v(" "),a("FormItem",{attrs:{prop:"phone"}},[a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入你的手机号"},model:{value:t.feedback.phone,callback:function(e){t.$set(t.feedback,"phone",e)},expression:"feedback.phone"}})],1)],1)])])])],1)])};o._withStripped=!0;var i=a(148),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._l(t.uploadList,(function(e){return a("div",{staticClass:"demo-upload-list"},["finished"===e.status?[a("img",{attrs:{src:e.thumbFullPath}}),t._v(" "),a("div",{staticClass:"demo-upload-list-cover"},[a("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(a){return t.handleView(e)}}}),t._v(" "),a("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(a){return t.handleRemove(e)}}})],1)]:[e.showProgress?a("Progress",{attrs:{percent:e.percentage,"hide-info":""}}):t._e()]],2)})),t._v(" "),a("Upload",{directives:[{name:"show",rawName:"v-show",value:t.showUpload,expression:"showUpload"}],ref:"upload",staticStyle:{display:"inline-block",width:"120px","margin-right":"10px"},attrs:{"show-upload-list":!1,"default-file-list":t.defaultList,"on-success":t.handleSuccess,format:["jpg","jpeg","png"],"max-size":2048,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,"before-upload":t.handleBeforeUpload,multiple:"",type:"drag",action:t.uploadUrl}},[a("div",{staticStyle:{width:"120px",height:"120px","padding-top":"30px",color:"#4b7efe"}},[a("Icon",{attrs:{type:"plus-round",size:"20"}}),t._v(" "),a("div",[t._v("添加图片")])],1)]),t._v(" "),a("Modal",{attrs:{width:"900",styles:{top:"20px"}},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("div",{staticStyle:{margin:"auto","text-align":"center"}},[t.visible?a("img",{staticStyle:{"max-width":"100%"},attrs:{src:t.currentImg}}):t._e()]),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"})])],2)};n._withStripped=!0;var s=a(39),r={props:{maxLength:{type:Number,default:4}},data:function(){return{defaultList:[],uploadUrl:s.a.upload,currentImg:"",visible:!1,showUpload:!0,uploadList:[]}},watch:{uploadList:function(t){t.length==this.maxLength||t.length>this.maxLength?this.showUpload=!1:this.showUpload=!0}},methods:{handleView:function(t){this.currentImg=t.fullPath,this.visible=!0},handleRemove:function(t){var e=this.$refs.upload.fileList;this.$refs.upload.fileList.splice(e.indexOf(t),1)},handleSuccess:function(t,e,a){e.fullPath=e.response.fullPath,e.thumbFullPath=e.response.thumbFullPath,e.path=e.response.path,e.status},handleFormatError:function(t){this.$Notice.warning({title:"文件格式不正确",desc:"文件名："+t.name+" 格式不正确, 请选择 jpg 或者 png."})},handleMaxSize:function(t){this.$Notice.warning({title:"文件大小超过限制",desc:"文件大小不能超过2M."})},handleBeforeUpload:function(){var t=this.uploadList.length<4;return t||this.$Notice.warning({title:"上传数量不能超过4张."}),t}},mounted:function(){this.uploadList=this.$refs.upload.fileList}},l=(a(798),a(1)),c=Object(l.a)(r,n,[],!1,null,null,null);c.options.__file="src/components/upload-multiple-image.vue";c.exports;var d=a(549),p=a(11),u={components:{mgUploader:d.a},data:function(){return{feedback:{name:this.$store.state.user.account.name,phone:this.$store.state.user.account.tel,type:0,content:"",attachments:[],platform:"PC"},uploadList:[],types:[{label:"业务需求",value:0},{label:"系统问题",value:1},{label:"其他意见",value:2}],ruleValidate:{name:[{required:!0,message:"请输入你的名字",trigger:"blur"},{max:20,message:"不能超过20个字符",trigger:"change"}],phone:[{required:!0,message:"请输入你的电话",trigger:"blur"},{max:20,message:"不能超过20个字符",trigger:"change"}],content:[{required:!0,message:"请输入你的反馈意见",trigger:"change"},{max:200,message:"不能超过200个字符",trigger:"change"}]}}},methods:{cleanData:function(){this.feedback={name:this.$store.state.user.account.name,phone:this.$store.state.user.account.tel,type:0,content:"",attachments:[],platform:"PC"},this.uploadList=[],this.$refs.feedbackForm.resetFields()},submit:function(t){var e=this;this.$refs.feedbackForm.validate((function(t){t&&(e.feedback.attachments=[],e.uploadList.forEach((function(t){e.feedback.attachments.push(t.path)})),e.feedback.attachments=JSON.stringify(e.feedback.attachments),e.$http.post(i.a.submitFeedback,e.feedback).then((function(t){t.id&&(e.$Modal.success({title:"意见提交成功",content:"感谢您提交意见，我们将尽快回复"}),e.cleanData())})))}))},back:function(){this.$router.back()},uploadSuccess:function(t){t.id=p.a.gusid(8),this.uploadList.push(t)},delUpload:function(t){for(var e=this.uploadList,a=0,o=e.length;a<o;a++)if(e[a].id==t.id){e.splice(a,1);break}},onBeforeUpload:function(){return!(this.uploadList.length>=4)||(this.$Notice.error({title:"最多添加4个附件"}),!1)}}},f=(a(800),Object(l.a)(u,o,[],!1,null,null,null));f.options.__file="src/views/feedback/form.vue";e.default=f.exports},549:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{display:"inline-block"}},[a("Upload",{ref:t.ref,attrs:{accept:t.accept,"max-size":t.maxSize,action:t.uploadUrl,"show-upload-list":!1,"before-upload":t.onBeforeUpload,"on-success":t.onSuccessUpload,"on-error":t.onErrorUpload,"on-progress":t.onProgressUpload,"on-exceeded-size":t.onExceededUpload,data:t.params}},[a("Button",{staticClass:"c-btn-add",attrs:{type:"primary",size:t.btnSize}},[t._v(t._s(t.btnText))])],1)],1)};o._withStripped=!0;var i=a(39),n=(a(23),a(11)),s={name:"mgUploader",props:{uploadUrl:{type:String,default:i.a.upload},pid:String,accept:String,max:{type:Number,default:2},btnText:{type:String,default:"点击上传"},before:Function,btnSize:{type:String,default:"default"},params:Object},data:function(){return{ref:"uploader-ref-"+n.a.gusid(8)}},computed:{maxSize:function(){return 1024*this.max}},methods:{onUpload:function(t){return t.size/1024/1024<this.max?(this.$store.commit("uploader/add",{id:t.uid,name:t.name,ref:this.$refs[this.ref],percent:0,page:this.$route.path,error:!1}),!0):(this.$Notice.warning({title:"上传文件大小不能超过"+this.max+"Mb"}),!1)},onBeforeUpload:function(t){var e=this;if(!this.before)return this.onUpload(t);var a=this.before();return a&&a.then?a.then((function(){e.onUpload(t)})):!1!==a&&this.onUpload(t)},onSuccessUpload:function(t,e){this.$store.commit("uploader/update",{id:e.uid,percent:100}),this.$emit("on-success",t,e)},onErrorUpload:function(t,e,a){this.$Notice.error({title:"上传失败",desc:"文件名："+a.name}),this.$store.commit("uploader/failed",a.uid)},onProgressUpload:function(t,e,a){this.$store.commit("uploader/update",{id:e.uid,percent:parseInt(e.percentage,10)})},onExceededUpload:function(t,e){}}},r=a(1),l=Object(r.a)(s,o,[],!1,null,null,null);l.options.__file="src/components/mg-uploader.vue";e.a=l.exports},612:function(t,e,a){var o=a(799);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,a(17).default)("01fb9554",o,!1,{})},613:function(t,e,a){var o=a(801);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,a(17).default)("7d1c79a2",o,!1,{})},798:function(t,e,a){"use strict";var o=a(612);a.n(o).a},799:function(t,e,a){(e=a(10)(!1)).push([t.i,"\n.demo-upload-list{\n    display: inline-block;\n    width: 120px;\n    height: 120px;\n    text-align: center;\n    line-height: 120px;\n    border: 1px solid transparent;\n    border-radius: 4px;\n    overflow: hidden;\n    background: #fff;\n    position: relative;\n    box-shadow: 0 1px 1px rgba(0,0,0,.2);\n    margin-right: 4px;\n}\n.demo-upload-list img{\n    width: 100%;\n    height: 100%;\n}\n.demo-upload-list-cover{\n    display: none;\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    background: rgba(0,0,0,.6);\n}\n.demo-upload-list:hover .demo-upload-list-cover{\n    display: block;\n}\n.demo-upload-list-cover i{\n    color: #fff;\n    font-size: 20px;\n    cursor: pointer;\n    margin: 0 2px;\n}\n",""]),t.exports=e},800:function(t,e,a){"use strict";var o=a(613);a.n(o).a},801:function(t,e,a){(e=a(10)(!1)).push([t.i,"\n.feedback-form .c-form-item h4 {\r\n    height: 30px;\r\n    margin-top: 20px;\n}\n.feedback-form .c-form-row-2col .c-form-item label{\r\n    width: auto;\n}\r\n\r\n\r\n",""]),t.exports=e}}]);