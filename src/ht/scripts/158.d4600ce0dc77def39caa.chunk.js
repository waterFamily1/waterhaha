(window.webpackJsonp=window.webpackJsonp||[]).push([[158],{1263:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"c-main-border"},[a("div",{staticClass:"c-left-border-blue"},[a("div",{staticClass:"c-search-main"},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("关键字：")]),a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"用户姓名/手机号/邮箱"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.searchParams.queryName,callback:function(e){t.$set(t.searchParams,"queryName",e)},expression:"searchParams.queryName"}})],1),t._v(" "),a("div",{staticClass:"c-form-item"},[a("label",[t._v("所属组织：")]),a("dropdown-tree",{attrs:{url:t.treeApi.getOrgTreeData,multiple:!0},model:{value:t.org,callback:function(e){t.org=e},expression:"org"}})],1),t._v(" "),a("div",{staticClass:"c-adv-search-btn"},[a("Button",{attrs:{type:"primary",shape:"circle"},on:{click:t.search}},[t._v("搜索")]),t._v(" "),a("Button",{staticClass:"c-btn-reset",attrs:{type:"primary",shape:"circle"},on:{click:t.searchParamsClean}},[t._v("重置")])],1)])]),t._v(" "),a("div",{staticClass:"c-top-border-gray"},[a("div",{directives:[{name:"role",rawName:"v-role",value:"user-add",expression:"'user-add'"}],staticClass:"c-table-top-btns"},[a("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle"},on:{click:t.createUser}},[t._v("新增用户")]),t._v(" "),a("Button",{directives:[{name:"role",rawName:"v-role",value:"import-user",expression:"'import-user'"}],staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle"},on:{click:t.importUser}},[t._v("批量导入")])],1),t._v(" "),a("Table",{attrs:{columns:t.columns,data:t.userList,loading:t.loading,stripe:""}}),t._v(" "),a("Page",{staticClass:"table-page",attrs:{total:t.total,"page-size":t.searchParams.pageSize,current:t.searchParams.currentPage,"show-total":"","show-elevator":""},on:{"on-change":t.pageChange}})],1)])};s._withStripped=!0;var r=a(23),i=a(519),n=a(145),o=a(11),l=a(107),c=a(148),d=a(544),u={components:{CollapseTransition:i.a,dropdownTree:n.a},name:"basic-user-list",data:function(){var t=this;return{treeApi:l.a,searchParams:{queryName:"",orgIds:"",pageSize:10,currentPage:1},org:{id:"",title:"请选择"},operations:!1,columns:[{type:"index",title:"序号",width:80,align:"center"},{title:"用户姓名",key:"name"},{title:"部门",key:"dept",align:"left"},{title:"所属组织",key:"orgName"},{title:"手机号",key:"tel"},{title:"邮箱地址",key:"email"},{title:"权限角色",key:"roleNames",render:function(t,e){return t("span",{attrs:{title:e.row.roleMap.map((function(t){return t.roleName})).join()}},[e.row.roleMap.map((function(t){return t.roleName})).join()])}},{title:"操作",key:"action",render:function(e,a){return e("div",[o.a.tableBtnStyle(e,(function(){t.showUserDetail(a.row)}),"查看"),o.a.tableBtnStyle(e,(function(){t.delUser(a.row)}),"删除","user-del")])}}],userList:[],total:0,loading:!1}},computed:Object(r.b)({opers:function(t){return t.user.account.webOpers}}),mounted:function(){this.getData(),this.operations=d.a.authorityAdmin(this.opers)},methods:{getData:function(){var t=this;this.$setSearchParams((function(e){t.searchParams=e,t.org.id=t.searchParams.orgIds,t.org.title=t.searchParams.orgNames})),this.loading=!0,this.$http.get(c.a.getUsers,this.searchParams).then((function(e){e.items&&(o.a.countDept(e.items),t.userList=e.items,t.total=e.total),t.loading=!1}))},search:function(){this.searchParams.orgIds=this.org.id,this.searchParams.orgNames=this.org.title,this.searchParams.currentPage=1,this.getData(),this.$addRouteFilter({routeName:"basic-user-list",searchParams:this.searchParams})},searchParamsClean:function(){this.org={id:"",title:"请选择"};this.searchParams=Object.assign({},this.searchParams,{queryName:"",orgIds:"",pageSize:10,currentPage:1}),this.$cleanRouteFilter()},createUser:function(){this.$router.push({name:"basic-user-add"})},showUserDetail:function(t){this.$router.push({name:"basic-user-detail",params:t})},editUser:function(t){this.$router.push({name:"basic-user-edit",params:t})},delUser:function(t){var e=this;this.$Modal.confirm({title:"提示",content:"<p>您确定要删除吗？</p>",onOk:function(){e.$http.del(c.a.deleteUser,{ids:t.id}).then((function(t){t.count&&(e.$Notice.success({title:"用户删除成功！"}),e.getData())}))}})},pageChange:function(t){this.searchParams.currentPage=t,this.getData(),this.$addRouteFilter({routeName:"basic-user-list",searchParams:this.searchParams})},importUser:function(){this.$router.push({name:"import",params:{id:"user"}})}},created:function(){o.a.initTableColumnTitle(this.columns)}},h=a(1),p=Object(h.a)(u,s,[],!1,null,null,null);p.options.__file="src/views/basic/user-list.vue";e.default=p.exports},519:function(t,e,a){"use strict";function s(t,e){if(!t||!e)return!1;if(-1!==e.indexOf(" "))throw new Error("className should not contain space.");return t.classList?t.classList.contains(e):(" "+t.className+" ").indexOf(" "+e+" ")>-1}function r(t,e){if(t){for(var a=t.className,r=(e||"").split(" "),i=0,n=r.length;i<n;i++){var o=r[i];o&&(t.classList?t.classList.add(o):s(t,o)||(a+=" "+o))}t.classList||(t.className=a)}}function i(t,e){if(t&&e){for(var a=e.split(" "),r=" "+t.className+" ",i=0,n=a.length;i<n;i++){var o=a[i];o&&(t.classList?t.classList.remove(o):s(t,o)&&(r=r.replace(" "+o+" "," ")))}t.classList||(t.className=trim(r))}}var n={beforeEnter:function(t){r(t,"collapse-transition"),t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.style.height="0",t.style.paddingTop=0,t.style.paddingBottom=0},enter:function(t){t.dataset.oldOverflow=t.style.overflow,0!==t.scrollHeight?(t.style.height=t.scrollHeight+"px",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom):(t.style.height="",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom),t.style.overflow="hidden"},afterEnter:function(t){i(t,"collapse-transition"),t.style.height="",t.style.overflow=t.dataset.oldOverflow},beforeLeave:function(t){t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.dataset.oldOverflow=t.style.overflow,t.style.height=t.scrollHeight+"px",t.style.overflow="hidden"},leave:function(t){0!==t.scrollHeight&&(r(t,"collapse-transition"),t.style.height=0,t.style.paddingTop=0,t.style.paddingBottom=0)},afterLeave:function(t){i(t,"collapse-transition"),t.style.height="",t.style.overflow=t.dataset.oldOverflow,t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom}};e.a={name:"CollapseTransition",functional:!0,render:function(t,e){var a=e.children;return t("transition",{on:n},a)}}},544:function(t,e,a){"use strict";var s=a(49),r={authorityAdmin:function(t){if(-1!=t.indexOf("ROLE_TENANT_ADMIN")||-1!=t.indexOf("UAA_ROLE_EDIT"))return!0},authorityEquAdmin:function(t){if(-1!=t.indexOf("ROLE_TENANT_ADMIN")||-1!=t.indexOf("EQU_EQUTYPE_EDIT"))return!0},authorityProcAdmin:function(t){if(-1!=t.indexOf("UAA_PROC_EDIT"))return!0},author0:function(t){if(-1!=t.indexOf("ROLE_TENANT_ADMIN"))return!0},authority:function(t){var e=JSON.parse(sessionStorage.getItem("__MANGO_U_")||"{}").webOpers;return!!e&&(-1!==e.indexOf(s.a[t])||-1!=e.indexOf(s.a.all))},author2:function(t){if(-1!=t.indexOf("UAA_ORG_EDIT"))return!0}};e.a=r}}]);