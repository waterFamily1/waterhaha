(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1261:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"c-main-border"},[a("Form",{ref:"defineForm",attrs:{model:e.params,rules:e.formRules,"label-width":100}},[a("div",{staticClass:"c-left-border-blue"},[a("h3",[e._v("报警定义")]),e._v(" "),a("div",{staticClass:"c-btns-right"},[a("Button",{attrs:{type:"primary",shape:"circle",loading:e.submitLoading},on:{click:e.submit}},[e._v("保存")]),e._v(" "),a("Button",{staticClass:"c-btn-back",attrs:{type:"primary",shape:"circle"},on:{click:e.back}},[e._v("取消")])],1)]),e._v(" "),a("div",{staticClass:"c-top-border-gray padding20-0"},[a("Row",{staticStyle:{"padding-left":"20px"}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{prop:"siteId",label:"区域位置："}},[a("my-process-tree-authority",{ref:"processTree",staticStyle:{width:"250px"},attrs:{url:e.treeApi.getProcessTreeData},on:{"on-change":e.processSelect},model:{value:e.relProcess,callback:function(t){e.relProcess=t},expression:"relProcess"}})],1),e._v(" "),a("FormItem",{attrs:{label:"确认方法："}},[a("Select",{staticStyle:{width:"250px"},model:{value:e.params.disarmMethod,callback:function(t){e.$set(e.params,"disarmMethod",t)},expression:"params.disarmMethod"}},e._l(e.relieveMap,(function(t,n){return a("Option",{key:n,attrs:{value:n}},[e._v(e._s(t))])})),1)],1),e._v(" "),a("FormItem",{attrs:{label:"触发时间："}},[a("Select",{staticStyle:{width:"250px"},model:{value:e.params.alarmWaitTime,callback:function(t){e.$set(e.params,"alarmWaitTime",t)},expression:"params.alarmWaitTime"}},e._l(e.triggerMap,(function(t,n){return a("Option",{key:n,attrs:{value:n}},[e._v(e._s(t))])})),1)],1),e._v(" "),a("FormItem",{attrs:{label:"报警条件："}},[a("Select",{staticStyle:{width:"250px"},model:{value:e.params.alarmCondition,callback:function(t){e.$set(e.params,"alarmCondition",t)},expression:"params.alarmCondition"}},e._l(e.alarmCondition,(function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1)],1),e._v(" "),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{prop:"alarmName",label:"报警名称："}},[a("Input",{staticStyle:{width:"250px"},attrs:{placeholder:"报警名称"},model:{value:e.params.alarmName,callback:function(t){e.$set(e.params,"alarmName",t)},expression:"params.alarmName"}})],1),e._v(" "),a("FormItem",{attrs:{label:"报警等级："}},[a("Select",{staticStyle:{width:"250px"},model:{value:e.params.alarmLevel,callback:function(t){e.$set(e.params,"alarmLevel",t)},expression:"params.alarmLevel"}},e._l(e.levelMap,(function(t,n){return a("Option",{key:n,attrs:{value:n}},[e._v(e._s(t))])})),1)],1),e._v(" "),a("FormItem",{attrs:{label:"使用状态："}},[a("RadioGroup",{model:{value:e.params.enabledStatus,callback:function(t){e.$set(e.params,"enabledStatus",t)},expression:"params.enabledStatus"}},e._l(e.statesMap,(function(t,n){return a("Radio",{attrs:{value:n,label:n}},[e._v(e._s(t))])})),1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"padding0-20"},[a("Tabs",{attrs:{value:e.tabValue,animated:!1}},[a("TabPane",{attrs:{label:"报警条件",name:"condition"}},[a("div",{staticClass:"c-table-top-btns"},[a("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle"},on:{click:e.addCondition}},[e._v("新增")])],1),e._v(" "),a("Table",{attrs:{columns:e.condColumns,data:e.condListDataView,stripe:""}})],1),e._v(" "),a("TabPane",{attrs:{label:"报警订阅",name:"subscribe"}},[a("div",{staticClass:"c-table-top-btns"},[a("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle"},on:{click:e.addSubscribe}},[e._v("新增")]),e._v(" "),a("Checkbox",{staticStyle:{float:"right"},model:{value:e.syncReceive,callback:function(t){e.syncReceive=t},expression:"syncReceive"}},[e._v("同步接收报警确认消息")])],1),e._v(" "),a("Table",{attrs:{columns:e.subscrColumns,data:e.subscrListDataView,stripe:""}})],1),e._v(" "),a("TabPane",{staticClass:"dealPlan-content",attrs:{label:"处理预案",name:"dealPlan"}},[a("Table",{attrs:{columns:e.dealPlanColumns,data:e.dealPlanColumnsDataView,stripe:""}})],1)],1)],1),e._v(" "),a("Modal",{attrs:{width:"600",title:"测点选择"},model:{value:e.modalShown,callback:function(t){e.modalShown=t},expression:"modalShown"}},[a("mg-select-table",{ref:"conTable",attrs:{columns:e.modalColumns,url:e.modalUrl,manual:!0,searchPlaceholder:"测点编号/名称"},on:{"on-submit":e.modalSubmit,"on-cancel":e.modalCancel}}),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"})],1),e._v(" "),a("Modal",{attrs:{width:"600",title:"测点更换"},model:{value:e.modifyModalShown,callback:function(t){e.modifyModalShown=t},expression:"modifyModalShown"}},[a("mg-single-select-table",{ref:"modifyTable",attrs:{columns:e.modifyModalColumns,url:e.modalUrl,manual:!0,searchPlaceholder:"测点编号/名称"},on:{"on-select":e.modifyMpoint}}),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"})],1)],1)],1)};n._withStripped=!0;var i=a(23),s=a(519),r=a(11),o=a(543),l=a(107),c=a(39),d=a(520),u=a(531),p=(a(523),a(537)),h=a(149);function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function f(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var g={datasource:"AUTO",fire:!0,siteId:""},b={components:{CollapseTransition:s.a,myProcessTreeAuthority:u.a,mgSelectTable:p.a,mgSingleSelectTable:h.a},computed:function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){f(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},Object(i.b)({account:function(e){return e.user.account}})),data:function(){var e=this;return{submitLoading:!1,pageStatus:"add",id:"",tabValue:"condition",treeApi:l.a,params:{id:"",siteId:"",alarmName:"",disarmMethod:"AutoOrManual",alarmLevel:"1",alarmWaitTime:"0",enabledStatus:"ON",conditions:[],subscribeList:[],alarmCondition:"1",processingPlan:"",contactPersonId:""},relProcess:{id:"",title:"请选择"},statesMap:{ON:"启用",OFF:"停用"},relieveMap:{Auto:"自动",AutoOrManual:"自动或者人工",Manual:"人工"},levelMap:{1:"1级",2:"2级",3:"3级"},triggerMap:{0:"立即触发",1:"延迟1分钟触发",5:"延迟5分钟触发",10:"延迟10分钟触发"},alarmCondition:[{label:"满足其中一条规则触发",value:"1"},{label:"满足所有规则后触发",value:"2"}],symbolOptions:[{key:"=",value:"=",label:"="},{key:">",value:">",label:">"},{key:"<",value:"<",label:"<"},{key:"≠",value:"≠",label:"≠"},{key:"≥",value:"≥",label:"≥"},{key:"≤",value:"≤",label:"≤"},{key:"5分钟无数据",value:"5分钟无数据",label:"5分钟无数据"}],formRules:{alarmName:[{required:!0,message:"请输入名称",trigger:"blur"},{max:20,message:"名称不能超过20个字符",trigger:"change"}],siteId:[{validator:function(e,t,a){t?a():a(new Error("请选择区域位置"))}}]},recieverMap:[{label:"在线消息",value:"SysMsg"},{label:"短信",value:"SMS"}],pushMap:[{label:"5分钟",value:"1"},{label:"10分钟",value:"2"},{label:"15分钟",value:"3"},{label:"30分钟",value:"4"},{label:"1小时",value:"5"},{label:"2小时",value:"6"},{label:"12小时",value:"7"},{label:"24小时",value:"8"},{label:"仅推送1次",value:"9"}],delayMap:[{label:"5分钟",value:"1"},{label:"10分钟",value:"2"},{label:"15分钟",value:"3"},{label:"30分钟",value:"4"},{label:"1小时",value:"5"},{label:"2小时",value:"6"},{label:"12小时",value:"7"},{label:"24小时",value:"8"},{label:"仅推送1次",value:"9"},{label:"不推送",value:"10"}],modalShown:!1,modalColumns:[{type:"selection",width:50},{title:"测点编号",key:"mpointId"},{title:"区域位置",key:"siteName"},{title:"测点名称",key:"mpointName"}],modalUrl:d.a.modalMpoints,condColumns:[{title:"测点名称",key:"mpointName",render:function(t,a){return t("div",{class:"alarm-define-mp-name"},[t("span",a.row.mpointName||"未知"),t("a",{class:"alarm-define-mp-btn",on:{click:function(){e.modifyModalShown=!0,e.modifyTblData=a}}},"[更换]")])}},{title:"条件",key:"symbol",width:150,render:function(t,a){var n=e.symbolOptions.map((function(e){return t("Option",{props:{value:e.value,key:e.key,label:e.label}})}));return t("Select",{style:{width:"120px"},props:{size:"small",transfer:!0,value:a.row.symbol},on:{"on-change":function(t){a.row.symbol=t,e.condListDataView.splice(a.index,1,a.row)}}},n)}},{title:"阈值",key:"threshold",width:150,render:function(t,a){return"5分钟无数据"==a.row.symbol?(e.condListDataView[a.index].threshold="",t("span","--")):t("Input",{style:{width:"80px"},props:{size:"small",value:e.condListDataView[a.index].threshold},on:{input:function(t){e.condListDataView[a.index]=Object.assign({},e.condListDataView[a.index],{threshold:t})}}})}},{title:"单位",key:"unit",width:150},{title:"所属设备",key:"equipmentName"},{title:"操作",key:"",width:100,render:function(t,a){return t("div",[r.a.tableBtnStyle(t,(function(){e.delCondition(a)}),"删除")])}}],modifyModalShown:!1,modifyModalColumns:[{title:"测点编号",key:"mpointId"},{title:"区域位置",key:"siteName"},{title:"测点名称",key:"mpointName"}],modifyTblData:{},subscrColumns:[{title:"接收对象",key:"",render:function(t,a){var n=e.staffs.map((function(e){return t("Option",{props:{value:e.value,key:e.value,label:e.label}})}));return t("Select",{style:{width:"200px"},props:{size:"small",transfer:!0,value:e.subscrListDataView[a.index].userId},on:{"on-change":function(t){e.subscrListDataView[a.index].userId=t}}},n)}},{title:"接收方式",key:"subscribeMode",render:function(t,a){var n=e.recieverMap.map((function(e){return t("Option",{props:{value:e.value,key:e.value,label:e.label}})}));return t("Select",{style:{width:"200px"},props:{size:"small",transfer:!0,multiple:!0,value:e.subscrListDataView[a.index].subscribeModeArr},on:{"on-change":function(t){e.subscrListDataView[a.index]=Object.assign({},e.subscrListDataView[a.index],{subscribeModeArr:t})}}},n)}},{title:"推送频率",key:"",render:function(t,a){var n=e.pushMap.map((function(e){return t("Option",{props:{value:e.value,key:e.value,label:e.label}})}));return t("Select",{style:{width:"150px"},props:{size:"small",transfer:!0,value:e.subscrListDataView[a.index].pushFrequency},on:{"on-change":function(t){e.subscrListDataView[a.index].pushFrequency=t}}},n)}},{title:"延迟推送时间",key:"",render:function(t,a){var n=e.delayMap.map((function(e){return t("Option",{props:{value:e.value,key:e.value,label:e.label}})}));return t("Select",{style:{width:"150px"},props:{size:"small",transfer:!0,value:e.subscrListDataView[a.index].delayPushTime},on:{"on-change":function(t){e.subscrListDataView[a.index].delayPushTime=t}}},n)}},{title:"操作",key:"",render:function(t,a){return t("div",[r.a.tableBtnStyle(t,(function(){e.delSubscr(a)}),"删除")])}}],staffs:[],syncReceive:!0,subscrListData:[],subscrListDataView:[],condListData:[],condListDataView:[],dealPlanColumns:[{title:"预案内容",key:"processingPlan",render:function(t,a){return t("Input",{attrs:{type:"textarea"},style:{width:"width:90%",margin:"10px"},props:{value:a.row.processingPlan},on:{input:function(t){e.params.processingPlan=t}}})}},{title:"联系人",key:"contactPersonId",width:300,render:function(t,a){var n=e.staffs.map((function(e){return t("Option",{props:{value:e.value,key:e.value,label:e.label}})}));return t("Select",{style:{width:"90%"},props:{transfer:!0,value:a.row.contactPersonId},on:{"on-change":function(t){e.params.contactPersonId=t}}},n)}}],dealPlanColumnsDataView:[{contactPersonId:"",processingPlan:""}]}},mounted:function(){this.getStaffs(),this.$refs.conTable.getData(g),this.$refs.modifyTable.getData(g),"alarm-define-edit"==this.$route.name&&this.$route.params.id&&(this.pageStatus="edit",this.id=this.$route.params.id,this.getData())},methods:{getData:function(){var e=this;this.$http.get(o.a.defines+"/"+this.id).then((function(t){e.params=t;var a=JSON.stringify(t.conditions),n=JSON.stringify(t.subscribeList);e.condListData=JSON.parse(a),e.condListDataView=t.conditions,e.subscrListData=JSON.parse(n),e.subscrListDataView=t.subscribeList,e.relProcess.id=t.siteId,e.relProcess.title=t.siteName;var i=e.subscrListDataView;if(i.length){var s=i[0].pushReleaseMessage;e.syncReceive="Y"==s,i.forEach((function(e){e.subscribeModeArr=e.subscribeMode.split(",")}))}e.dealPlanColumnsDataView=[{contactPersonId:t.contactPersonId,processingPlan:t.processingPlan}],g.siteId=t.siteId,e.$refs.conTable.getData(g),e.$refs.modifyTable.getData(g)}))},getStaffs:function(){var e=this;this.$http.get(c.a.underOrganizationUsers).then((function(t){e.staffs=t}))},processSelect:function(e){this.params.siteId=e.id,g.siteId=e.id,this.$refs.conTable.getData(g),this.$refs.modifyTable.getData(g),"add"==this.pageStatus?(this.condListData=[],this.condListDataView=[]):(this.condListData.forEach((function(e){e.status="delete"})),this.condListDataView=[])},checkCondList:function(){return!!this.condListDataView.length},checkSubscrList:function(){var e=this.subscrListData,t=!0,a={},n=!1,i=!1;return e.forEach((function(e){"delete"!=e.status&&(e.userId&&(a[e.userId]?n=!0:a[e.userId]=!0),e.userId&&e.subscribeModeArr.length||(i=!0))})),n?(t=!1,this.$Notice.warning({title:"报警订阅的接收对象不能重复"}),this.tabValue="subscribe"):i&&(t=!1,this.$Notice.warning({title:"请将报警订阅填写完整"}),this.tabValue="subscribe"),t},mergeCond:function(){"add"==this.pageStatus?this.condListData=[]:this.condListData=this.condListData.filter((function(e){return!!e.id}));var e=this.condListData;this.condListDataView.forEach((function(t){t.id?e.forEach((function(e){if(e.id==t.id)for(var a in t)e[a]=t[a]})):t.tempId&&e.push(t)}))},mergeSubscr:function(){"add"==this.pageStatus?this.subscrListData=[]:this.subscrListData=this.subscrListData.filter((function(e){return!!e.id}));var e=this.subscrListData,t=this.subscrListDataView;e.forEach((function(e){e.subscribeModeArr=e.subscribeMode.split(",")})),t.forEach((function(t){t.id?e.forEach((function(e){if(e.id==t.id)for(var a in t)e[a]=t[a]})):t.tempId&&e.push(t)}))},submit:function(){var e=this;this.mergeCond(),this.mergeSubscr();var t=this.condListData,a=this.subscrListData,n=this,i=this.syncReceive?"Y":"N";if(a.length){if(!this.checkSubscrList())return;a.forEach((function(e){e.pushReleaseMessage=i,e.subscribeMode=e.subscribeModeArr.join(",")}))}this.$refs.defineForm.validate((function(i){if(i)if(e.checkCondList()){var s=!0;if(t.forEach((function(e){var t=e.threshold&&e.threshold.toString().replace(/\s/g,"");"delete"!=e.status&&"5分钟无数据"!=e.symbol&&""===t&&(s=!1)})),s){n.params.conditions=t,n.params.subscribeList=a,e.submitLoading=!0;var r="post";"edit"==e.pageStatus&&(r="put",n.params.id=n.id),e.$http[r](o.a.defines,n.params).then((function(t){e.$Notice.success({title:"数据保存成功"}),e.$routeBack()})).catch((function(t){e.submitLoading=!1}))}else e.$Notice.warning({title:"请填写测点报警阈值"})}else e.$Notice.warning({title:"请新增报警条件"})}))},back:function(){this.$router.back()},addCondition:function(){this.modalShown=!0},tagDelete:function(e,t){var a=this;e.forEach((function(e){e.id==t&&a.$set(e,"status","delete")}))},delViewData:function(e,t){var a,n;t.row.id?(a=t.row.id,n="id"):t.row.tempId&&(a=t.row.tempId,n="tempId"),e.forEach((function(t,i){t[n]==a&&e.splice(i,1)}))},delCondition:function(e){var t=this;this.$Modal.confirm({title:"提示",content:"<p>确定要删除？</p>",onOk:function(){e.row.id&&t.tagDelete(t.condListData,e.row.id),t.delViewData(t.condListDataView,e)}})},modalSubmit:function(e){e.length?(e.forEach((function(e){e.symbol="=",e.threshold="",e.equipment=e.equipmentName,e.mpointId=e.id,e.id="",e.tempId=r.a.gusid(8)})),this.condListDataView=this.condListDataView.concat(e),this.$refs.conTable.cleanup(),this.modalShown=!1):this.$Notice.warning({title:"请选择测点"})},modalCancel:function(e){this.modalShown=!1},modifyMpoint:function(e){var t=this.modifyTblData.index,a=(e={mpointName:e.mpointName,mpointId:e.id,equipment:e.equipmentName,unit:e.unit},Object.assign({},this.condListDataView[t],e));this.condListDataView.splice(t,1,a),this.modifyModalShown=!1},addSubscribe:function(){var e={id:"",tempId:r.a.gusid(8),userId:"",subscribeModeArr:["SysMsg"],pushFrequency:"9",delayPushTime:"9"};this.subscrListDataView.push(e)},delSubscr:function(e){var t=this;this.$Modal.confirm({title:"提示",content:"<p>确定要删除？</p>",onOk:function(){e.row.id&&t.tagDelete(t.subscrListData,e.row.id),t.delViewData(t.subscrListDataView,e)}})}}},v=(a(860),a(1)),y=Object(v.a)(b,n,[],!1,null,null,null);y.options.__file="src/views/alarm/define/form.vue";t.default=y.exports},515:function(e,t,a){var n=a(522);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(17).default)("43cd0b0e",n,!1,{})},517:function(e,t,a){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i={F:function(e,t){if(!e)return"";"object"!=n(e)&&(e=new Date(e)),t=t||"yyyy-MM-dd";var a=e.getFullYear().toString(),i={M:e.getMonth()+1,d:e.getDate(),h:e.getHours(),m:e.getMinutes(),s:e.getSeconds()};for(var s in t=t.replace(/(y+)/gi,(function(e,t){return a.substr(4-Math.min(4,t.length))})),i)t=t.replace(new RegExp("("+s+"+)","g"),(function(e,t){return i[s]<10&&t.length>1?"0"+i[s]:i[s]}));return t},str2Date:function(e){if(e)return"object"!=n(e)?new Date(e):e},firstDayByWeek:function(e){var t=i.str2Date(e)||new Date,a=t.getDay(),n=(0==a?7:a)-1;return i.midnight(new Date(t.getTime()-24*n*60*60*1e3))},firstDayByMonth:function(e){var t=i.str2Date(e)||new Date;return i.midnight(new Date(t.getFullYear(),t.getMonth(),1))},firstDayByYear:function(e){var t=i.str2Date(e)||new Date;return i.midnight(new Date(t.getFullYear(),0,1))},countDateByStep:function(e,t,a,n){e=i.formatePolyfill(e);var s,r=i.str2Date(e)||new Date(e),o=r.getTime(),l=(new Date).getTime();switch(a){case"day":s=o+864e5*t;break;case"week":s=o+6048e5*t;break;case"month":s=new Date(r.getFullYear(),r.getMonth()+t,r.getDate()).getTime(),n&&(s=new Date(r.getFullYear(),r.getMonth()+t,r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds()).getTime());break;case"year":s=new Date(r.getFullYear()+t,r.getMonth(),r.getDate()).getTime(),n&&(s=new Date(r.getFullYear()+t,r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds()).getTime())}return s>l&&(s=l),n?s:i.midnight(s)},midnight:function(e){return e?i.F(e)+" 00:00:00":""},beforeMidnight:function(e){return e?i.F(e)+" 23:59:59":""},midnightMill:function(e){var t=i.str2Date(e)||new Date;return new Date(i.midnight(t)).getTime()},chain:function(e,t){return i.countDateByStep(e,-1,t)},yearOFyear:function(e){return i.countDateByStep(e,-1,"year")},getPeriods:function(e){var t,a=e.beginDate,n=new Date(i.formatePolyfill(a)),s=n.getTime();switch(e.cycle){case"day":t=s+864e5;break;case"week":t=s+6048e5;break;case"month":t=new Date(n.getFullYear(),n.getMonth()+1,n.getDate(),0,0,0).getTime();break;case"year":t=new Date(n.getFullYear()+1,n.getMonth(),n.getDate(),0,0,0).getTime()}return{min:s,max:new Date(t).getTime()}},formatePolyfill:function(e){return"string"!=typeof e?e:("string"==typeof e&&0==/[TZ]/.test(e)&&(e=e.replace(/-/g,"/")),e)},getTerminalsByMonth:function(e,t){var a,n;return 0==t?(a=new Date(e,0,1,0,0,0),n=new Date(e,11,31,23,59,59)):(a=new Date(e,t-1,1,0,0,0),n=new Date(e,t,0,23,59,59)),{start:a,end:n}},transDateFromServer:function(e,t){return e?("string"==typeof e&&0==/[TZ]/.test(e)&&(e=e.replace(/-/g,"/")),i.F(e,t||"yyyy-MM-dd hh:mm")):""},transDateFromLocale:function(e){return e?("string"==typeof e&&(0==/[TZ]/.test(e)&&(e=e.replace(/-/g,"/")),e=new Date(e)),e.toISOString()):""},strToData:function(e){var t=e.split(" ")[0].split("-"),a=[];return void 0!==e.split(" ")[1]&&(a=e.split(" ")[1].split(":")),new Date(t[0],t[1]-1,t[2],null!==a[0]?a[0]:0,null!==a[1]?a[1]:0,null!==a[2]?a[2]:0)}};t.a=i},518:function(e,t,a){var n=a(530);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(17).default)("4411afe8",n,!1,{})},519:function(e,t,a){"use strict";function n(e,t){if(!e||!t)return!1;if(-1!==t.indexOf(" "))throw new Error("className should not contain space.");return e.classList?e.classList.contains(t):(" "+e.className+" ").indexOf(" "+t+" ")>-1}function i(e,t){if(e){for(var a=e.className,i=(t||"").split(" "),s=0,r=i.length;s<r;s++){var o=i[s];o&&(e.classList?e.classList.add(o):n(e,o)||(a+=" "+o))}e.classList||(e.className=a)}}function s(e,t){if(e&&t){for(var a=t.split(" "),i=" "+e.className+" ",s=0,r=a.length;s<r;s++){var o=a[s];o&&(e.classList?e.classList.remove(o):n(e,o)&&(i=i.replace(" "+o+" "," ")))}e.classList||(e.className=trim(i))}}var r={beforeEnter:function(e){i(e,"collapse-transition"),e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.style.height="0",e.style.paddingTop=0,e.style.paddingBottom=0},enter:function(e){e.dataset.oldOverflow=e.style.overflow,0!==e.scrollHeight?(e.style.height=e.scrollHeight+"px",e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom):(e.style.height="",e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom),e.style.overflow="hidden"},afterEnter:function(e){s(e,"collapse-transition"),e.style.height="",e.style.overflow=e.dataset.oldOverflow},beforeLeave:function(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.dataset.oldOverflow=e.style.overflow,e.style.height=e.scrollHeight+"px",e.style.overflow="hidden"},leave:function(e){0!==e.scrollHeight&&(i(e,"collapse-transition"),e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0)},afterLeave:function(e){s(e,"collapse-transition"),e.style.height="",e.style.overflow=e.dataset.oldOverflow,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom}};t.a={name:"CollapseTransition",functional:!0,render:function(e,t){var a=t.children;return e("transition",{on:r},a)}}},520:function(e,t,a){"use strict";var n=a(22),i={modalMpoints:"/loong/api/mpoints/dialog",alarmChart:"/loong/api/mpoints/alarm-condition",downloadTemplate:n.a+"/loong/api/mpoints/excel-template-download",exportTemplate:n.a+"/loong/api/mpoints/export",importExcel:n.a+"/loong/api/mpoints/import",saveExcelData:"/loong/api/mpoints/import-save",cancelExcelData:"/loong/api/mpoints/import-cancel",getCategroyData:"/loong/api/mpoints-datacategory",getMpointsList:"/loong/api/mpoints",deleteMpoints:"/loong/api/mpoints",deleteAllMpoints:"/loong/api/mpoints/all",batchSave:"/loong/api/mpoints/batch",autoMpoints:"/loong/api/mpoints-auto",datainputMpoints:"/loong/api/mpoints-datainput",taskMpoints:"/loong/api/mpoints-task",getCalcMpointDetail:"/loong/api/mpoints-calc",getCycle:"/loong/api/mpoints-calc-cycle",getAnalysisMpointDetail:"/loong/api/mpoints-analysis",getMpointNumByType:"/loong/api/mpoints/batch/all",getMpointDataImportList:"/loong/api/mpoint-data-imports",deleteMpointDataImport:"/loong/api/mpoint-data-imports",stopMpointDataImport:"/loong/api/mpoint-data-imports",pointDataImportTempleDownload:n.a+"/loong/api/mpoint-data-imports/templeDownload",pointDataImportFileUpload:n.a+"/loong/api/mpoint-data-imports/fileUpload"};t.a=i},521:function(e,t,a){"use strict";var n=a(515);a.n(n).a},522:function(e,t,a){(t=a(10)(!1)).push([e.i,"\n.cmp-datepicker {\r\n\tdisplay: inline-block;\n}\r\n",""]),e.exports=t},523:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cmp-datepicker"},[a("DatePicker",{style:{width:e.width},attrs:{type:"date",placeholder:"开始日期",value:e.dateRange.start,disabled:e.disabled,options:e.startDateOptions},on:{"on-change":e.startDateChange}}),e._v(" "),a("span",[e._v(" - ")]),e._v(" "),a("DatePicker",{style:{width:e.width},attrs:{type:"date",placeholder:"结束日期",value:e.dateRange.end,disabled:e.disabled,options:e.endDateOptions},on:{"on-change":e.endDateChange}})],1)};n._withStripped=!0;var i=a(11),s=a(517),r={name:"datepickerRanger",props:{value:Object,width:String,disabled:{type:Boolean,default:!1},enabled:String},watch:{"value.start":function(e){this.dateRange.start=i.a.transDateFromServer(e,"yyyy-MM-dd")},"value.end":function(e){this.dateRange.end=i.a.transDateFromServer(e,"yyyy-MM-dd")}},data:function(){var e=this,t=s.a.midnightMill();return{dateRange:{start:i.a.transDateFromServer(this.value.start,"yyyy-MM-dd"),end:i.a.transDateFromServer(this.value.end,"yyyy-MM-dd")},startDateOptions:{disabledDate:function(a){return"coming"==e.enabled?a&&a.valueOf()<t:"halfYear"===e.enabled?a&&a.valueOf()<t-15552e6:e.dateRange.end&&a&&a.valueOf()>1*new Date(e.dateRange.end+" 23:59:59")}},endDateOptions:{disabledDate:function(a){var n=1*new Date(e.dateRange.start+" 00:00:00"),i=a&&a.valueOf();return"past"==e.enabled?a&&i>t:e.dateRange.start&&a&&i<n}}}},methods:{startDateChange:function(e){this.dateRange.start=e;var t=this.dateRange.start?i.a.transDateFromLocale(this.dateRange.start+" 00:00:00"):"",a=this.dateRange.end?i.a.transDateFromLocale(this.dateRange.end+" 23:59:59"):"";this.$emit("input",{start:t,end:a}),this.$emit("on-change",{start:t,end:a})},endDateChange:function(e){this.dateRange.end=e;var t=this.dateRange.start?i.a.transDateFromLocale(this.dateRange.start+" 00:00:00"):"",a=this.dateRange.end?i.a.transDateFromLocale(this.dateRange.end+" 23:59:59"):"";this.$emit("input",{start:t,end:a}),this.$emit("on-change",{start:t,end:a})}}},o=(a(521),a(1)),l=Object(o.a)(r,n,[],!1,null,null,null);l.options.__file="src/components/datepicker-ranger.vue";t.a=l.exports},528:function(e,t,a){var n=a(535);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(17).default)("ad278fbc",n,!1,{})},529:function(e,t,a){"use strict";var n=a(518);a.n(n).a},530:function(e,t,a){(t=a(10)(!1)).push([e.i,"\n.cmp-dropdown-tree {\r\n    display: inline-block;\r\n    position: relative;\r\n    vertical-align: middle;\r\n    line-height: normal;\n}\n.ivu-form-item-error .cmp-dropdown-tree-label {\r\n    border: 1px solid #ed3f14;\n}\n.ivu-form-item-error .cmp-dropdown-tree-arrow {\r\n    border-left: 1px solid #ed3f14;\n}\n.cmp-dropdown-tree-label {\r\n    height: 28px;\r\n    width: 100%;\r\n    border: 1px solid #eaeaea;\r\n    display: flex;\r\n    border-radius: 3px;\r\n    cursor: pointer;\n}\n.cmp-dropdown-tree-text {\r\n    line-height: 28px;\r\n    text-indent: 5px;\r\n    flex: 1;\r\n    white-space: nowrap;\r\n    text-overflow: ellipsis;\r\n    overflow: hidden;\n}\n.cmp-dropdown-tree-arrow {\r\n    margin-top: -1px;\r\n    width: 28px;\r\n    height: 28px;\r\n    border-left: 1px solid #eaeaea;\r\n    text-align: center;\r\n    line-height: 28px;\n}\n.cmp-dropdown-tree .ivu-input-group-append {\r\n    width: 25px;\r\n    height: 28px;\r\n    overflow: hidden;\r\n    padding: 0;\n}\n.cmp-dropdown-tree .ivu-btn {\r\n    padding: 5px 10px;\n}\n.cmp-dropdown-tree-tree {\r\n    z-index: 901;\r\n    position: absolute;\r\n    top: 37px;\r\n    left: 0;\r\n    min-width: 300px;\r\n    max-height: 400px;\r\n    overflow: auto;\r\n    padding: 5px 10px;\r\n    background-color: #fff;\r\n    box-shadow: 1px 1px 5px #999;\r\n    border-radius: 3px;\n}\r\n",""]),e.exports=t},531:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.hideTree,expression:"hideTree"}],staticClass:"cmp-dropdown-tree",style:{width:e.width+"px"}},[a("div",{staticClass:"cmp-dropdown-tree-label",on:{click:e.labelClick}},[a("div",{staticClass:"cmp-dropdown-tree-text"},[e._v(e._s(e.value.title))]),e._v(" "),a("div",{staticClass:"cmp-dropdown-tree-arrow"},[a("Icon",{directives:[{name:"show",rawName:"v-show",value:1!=e.isShowTree,expression:"isShowTree != true"}],attrs:{type:"ios-arrow-down"}}),e._v(" "),a("Icon",{directives:[{name:"show",rawName:"v-show",value:1==e.isShowTree,expression:"isShowTree == true"}],attrs:{type:"ios-arrow-up"}})],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowTree,expression:"isShowTree"}],staticClass:"cmp-dropdown-tree-tree"},[a("Tree",{attrs:{data:e.datas,"show-checkbox":e.showCheckbox,multiple:e.multiple},on:{"on-select-change":e.selectTree}})],1)])};n._withStripped=!0;var i=a(11),s=a(146),r=a(147);function o(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(e){!function e(t){t.forEach((function(t,a){t.childrenIds=function e(t,a){a=a||[];return t.forEach((function(t){t.children.length&&e(t.children,a),a.push(Math.abs(t.id))})),a}(t.children),t.children.length&&e(t.children)}))}(e)}var c={name:"myProcessTreeAuthority",mixins:[s.a],props:{field:String,value:Object,data:Array,url:String,query:Object,showCheckbox:Boolean,multiple:Boolean,width:{type:[Number,String],default:300},type:String},watch:{"value.id":function(e){e?this.flatDatas.length&&(i.a.setTrueTreeExpand(this.datas,e),i.a.setTrueTreeSelected(this.datas,e)):(!function e(t){for(var a,n=t.length,i=0;i<n;i++)1==(a=t[i]).selected&&(a.selected=!1),a.children.length&&e(a.children)}(this.datas),this.$emit("input",{id:"",title:"请选择"}))},data:function(e){this.datas=e}},data:function(){return{datas:this.data,flatDatas:[],isShowTree:!1}},methods:{selectTree:function(e){var t=this,a=[],n=[],i=[],s=this.field||"id",r=[];e.forEach((function(e){a.push(Math.abs(e[s])),n.push(e.key),i.push(e.title),r=r.concat(Math.abs(e[s]),e.childrenIds)})),r=o(new Set(r)),this.$emit("input",{id:a.join(),key:n.join(),title:i.join(),childrenIds:r}),this.$emit("on-change",{id:a.join(),key:n.join(),title:i.join(),childrenIds:r}),this.multiple||(this.isShowTree=!1),setTimeout((function(){t.dispatch("FormItem","on-form-change",{id:a.join(),key:n.join(),title:i.join(),childrenIds:r})}),100)},hideTree:function(){this.isShowTree=!1},labelClick:function(){this.isShowTree=!this.isShowTree}},directives:{clickoutside:r.a},mounted:function(){var e=this;this.url&&this.$http.get(this.url,this.query).then((function(t){t&&t.length&&(t.forEach((function(e){!1===e.authorized&&(e.render=function(e,t){t.root,t.node;return e("span",[t.data.name])})})),"EQUTYPE"==e.type&&t.forEach((function(e){var a=t.filter((function(t){return t.parentId==e.id}));("org"==e.type||a.length>0)&&(e.render=function(e,t){t.root,t.node;return e("span",[t.data.name])})})),"PROCESS"==e.type&&t.forEach((function(e){1==e.type&&(e.render=function(e,t){t.root,t.node;return e("span",[t.data.name])})})),e.flatDatas=t,e.value.id&&(i.a.setTreeExpand(e.flatDatas,e.value.id),i.a.setFlatTreeSelected(e.flatDatas,e.value.id)),e.datas=i.a.transDataToTree(e.flatDatas),l(e.datas))}))}},d=(a(529),a(1)),u=Object(d.a)(c,n,[],!1,null,null,null);u.options.__file="src/components/my-process-tree-authority.vue";t.a=u.exports},534:function(e,t,a){"use strict";var n=a(528);a.n(n).a},535:function(e,t,a){(t=a(10)(!1)).push([e.i,"\n.mg-select-table-tip {\r\n\ttext-align: right;\r\n\tline-height: 30px;\r\n\tcolor: #999;\n}\n.mg-select-table-tip strong {\r\n\tcolor: #777;\r\n\tmargin: 0 3px;\n}\n.mg-select-table-search .ivu-icon {\r\n\tright: 35px;\n}\r\n",""]),e.exports=t},537:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mg-select-table"},[e._t("top"),e._v(" "),a("div",{staticClass:"mg-select-table-header"},[e._t("default",[a("div",{staticClass:"mg-select-table-search"},[a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:e.searchPlaceholder,clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.searchParams.queryName,callback:function(t){e.$set(e.searchParams,"queryName",t)},expression:"searchParams.queryName"}},[a("Button",{attrs:{slot:"append",icon:"ios-search"},on:{click:e.search},slot:"append"})],1)],1)]),e._v(" "),a("div",{staticClass:"mg-select-table-tip"},[e._v("已选择"),a("strong",[e._v(e._s(e.selectedTemp.length))]),e._v("个 "),a("a",{staticClass:"c-btn-text",attrs:{href:"javascript:;"},on:{click:e.cleanup}},[e._v("[清空]")])])],2),e._v(" "),a("div",{attrs:{id:e.TID}},[a("Table",{ref:e.tableRef,attrs:{columns:e.columns,data:e.listData,loading:e.loading,stripe:"",size:e.size},on:{"on-select":e.onSelect,"on-select-cancel":e.onSelectCancel,"on-select-all":e.onSelectAll}})],1),e._v(" "),a("Page",{staticClass:"table-page",attrs:{total:e.total,"page-size":e.searchParams.pageSize,current:e.searchParams.currentPage,"show-total":"","show-elevator":"",size:e.size},on:{"on-change":e.pageChange}}),e._v(" "),a("div",{staticClass:"c-modal-footer-btns",staticStyle:{margin:"30px auto 0"}},[a("Button",{attrs:{type:"default",shape:"circle"},on:{click:e.cancel}},[e._v("取消")]),e._v(" "),a("Button",{attrs:{type:"primary",shape:"circle"},on:{click:e.submit}},[e._v("确定")])],1)],2)};n._withStripped=!0;var i=a(11),s={name:"mgSelectTable",props:{disabledRow:Boolean,selected:Array,searchPlaceholder:String,columns:{type:Array,default:[]},url:String,size:{type:String,default:"small"},max:Number,manual:Boolean,field:String},watch:{selected:function(e){var t=JSON.stringify(e);this.selectedTemp=JSON.parse(t),this.selectedTruth=JSON.parse(t),this.checkSelection()}},data:function(){return{TID:"",searchParams:{queryName:"",currentPage:1,pageSize:10},listData:[],selectedTemp:[],selectedTruth:[],loading:!1,total:0,tableRef:""}},methods:{cleanup:function(){this.selectedTemp=[],this.selectedTruth=[],this.checkSelection()},getData:function(e){var t=this;e&&(this.searchParams=Object.assign({},{queryName:"",currentPage:1,pageSize:10},e)),this.loading=!0,this.$http.get(this.url,this.searchParams).then((function(e){var a=e.items?e.items:[];t.disabledRow&&a.forEach((function(e){e.disabled&&(e._disabled=!0)})),t.field&&a.forEach((function(e){e.id||(e.id=e[t.field])})),t.listData=a,t.total=e.total,t.loading=!1,t.checkSelection()}))},pageChange:function(e){this.searchParams.currentPage=e,this.getData()},search:function(){this.searchParams.currentPage=1,this.getData()},onSelect:function(e,t){var a=this.selectedTemp;this.max&&a.length>=this.max?(this.$Notice.info({title:"最多选择"+this.max+"个"}),this.cancelChecked(t.id)):this.selectedTemp.push(t)},onSelectCancel:function(e,t){var a=this;this.selectedTemp.forEach((function(e,n){e.id==t.id&&a.selectedTemp.splice(n,1)}))},onSelectAll:function(e){0==e.length?this.removeTableFromTemp(this.listData):this.addTableToTemp(e)},addTableToTemp:function(e){var t=this.selectedTemp;e.forEach((function(e){var a=!1;t.forEach((function(t,n){t.id==e.id&&(a=!0)})),a||t.push(e)}))},removeTableFromTemp:function(e){for(var t=this.selectedTemp,a=t.length;a--;){var n=!1;e.forEach((function(e){e.id==t[a].id&&(n=!0)})),n&&t.splice(a,1)}},cancelChecked:function(e){var t=this;this.checkSelection();var a=this.selectedTemp,n=[];a.forEach((function(a){a.id==e&&t.$set(a,"_checked",!1),n.push(a)})),this.selectedTemp=n},checkSelection:function(){var e=this;this.$nextTick((function(){var t=e.listData,a=e.selectedTemp,n=e.$refs[e.tableRef];t.forEach((function(e,t){var i=n.$refs.tbody.objData[t];i._isChecked=!1,a.forEach((function(t){t.id==e.id&&(i._isChecked=!0)}))}))}))},submit:function(){this.selectedTruth=i.a.copyArray(this.selectedTemp),this.$emit("on-submit",this.selectedTruth)},cancel:function(){this.selectedTemp=i.a.copyArray(this.selectedTruth),this.checkSelection(),this.$emit("on-cancel")}},mounted:function(){this.max&&(document.querySelector("#"+this.TID).querySelector(".ivu-table-header").querySelector(".ivu-table-cell").style.display="none"),this.manual||this.getData()},created:function(){var e=i.a.gusid(6);this.TID="J_TABLE_"+e,this.tableRef="mg-select-table-"+e,i.a.initTableColumnTitle(this.columns)}},r=(a(534),a(1)),o=Object(r.a)(s,n,[],!1,null,null,null);o.options.__file="src/components/mg-select-table.vue";t.a=o.exports},543:function(e,t,a){"use strict";a(22);t.a={updateDefineStatus:"/loong/api/alarm-definitions/status",defines:"/loong/api/alarm-definitions",modalDefines:"/loong/api/alarm-definitions",history:"/loong/api/alarm-records",history_detail:"/loong/api/alarm-records/detail",release:"/loong/api/alarm-records/confirm",getAlarmData:"/loong/api/alarm-records",subscribe:"/loong/api/alarm-subscriptions"}},639:function(e,t,a){var n=a(861);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(17).default)("02377394",n,!1,{})},860:function(e,t,a){"use strict";var n=a(639);a.n(n).a},861:function(e,t,a){(t=a(10)(!1)).push([e.i,"\n.alarm-define-mp-name {\r\n    position: relative;\n}\n.alarm-define-mp-btn {\r\n    position: absolute;\r\n    right: 0;\r\n    top: 0;\r\n    color: #4b7efe;\n}\n.dealPlan-content textarea.ivu-input {\r\n    font-size: 13px;\n}\r\n",""]),e.exports=t}}]);