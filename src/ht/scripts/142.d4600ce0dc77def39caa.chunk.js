(window.webpackJsonp=window.webpackJsonp||[]).push([[142],{1007:function(t,e,i){"use strict";var a=i(728);i.n(a).a},1008:function(t,e,i){(e=i(10)(!1)).push([t.i,"\n.material .ivu-tabs-bar {\r\n    margin-bottom: 0;\n}\n.c-btns-right .c-btn-add {\r\n    padding: 3px 15px;\n}\r\n",""]),t.exports=e},1206:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"material c-main-border"},[i("div",{staticClass:"c-left-border-blue"},[i("h3",[t._v("物料详细")]),t._v(" "),i("div",{staticClass:"c-btns-right"},[i("Button",{attrs:{type:"primary",shape:"circle",loading:t.submitLoading},on:{click:t.submit}},[t._v("保存")]),t._v(" "),i("Button",{staticClass:"c-btn-back",attrs:{type:"primary",shape:"circle"},on:{click:t.back}},[t._v("返回")])],1)]),t._v(" "),i("Form",{ref:"materialForm",attrs:{model:t.detailInfo,rules:t.formRules,"label-width":100}},[i("div",{staticClass:"c-top-border-gray"},[i("div",{staticClass:"c-form-row-2col"},[i("div",{staticClass:"c-form-item"},[i("label",[t._v("物料编号：")]),t._v("\n                    "+t._s(t.detailInfo.materielNumber)+"\n                ")]),t._v(" "),i("div",{staticClass:"c-form-item"},[i("FormItem",{attrs:{prop:"orgId",label:"组织信息："}},[i("dropdown-tree",{attrs:{url:t.orgTreeApi},on:{input:t.chooseOrg},model:{value:t.org,callback:function(e){t.org=e},expression:"org"}})],1)],1)]),t._v(" "),i("div",{staticClass:"c-form-row-2col"},[i("div",{staticClass:"c-form-item"},[i("FormItem",{attrs:{prop:"materielName",label:"物料名称："}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text"},model:{value:t.detailInfo.materielName,callback:function(e){t.$set(t.detailInfo,"materielName",e)},expression:"detailInfo.materielName"}})],1)],1),t._v(" "),i("div",{staticClass:"c-form-item"},[i("FormItem",{attrs:{prop:"materielCategoryId",label:"物料类别："}},[i("dropdown-tree",{attrs:{data:t.materielCategoryArr},on:{input:t.chooseMaterialCategory},model:{value:t.materielCategory,callback:function(e){t.materielCategory=e},expression:"materielCategory"}})],1)],1)]),t._v(" "),i("div",{staticClass:"c-form-row-2col"},[i("div",{staticClass:"c-form-item"},[i("FormItem",{attrs:{prop:"abc",label:"ABC分类："}},[i("Select",{staticStyle:{width:"300px"},model:{value:t.detailInfo.abc,callback:function(e){t.$set(t.detailInfo,"abc",e)},expression:"detailInfo.abc"}},t._l(t.ABCClassify,(function(e,a){return i("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1),t._v(" "),i("div",{staticClass:"c-form-item"},[i("FormItem",{attrs:{prop:"measurementUnit",label:"计量单位："}},[i("Select",{staticStyle:{width:"300px"},model:{value:t.detailInfo.measurementUnit,callback:function(e){t.$set(t.detailInfo,"measurementUnit",e)},expression:"detailInfo.measurementUnit"}},t._l(t.unit,(function(e,a){return i("Option",{key:e.id,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1)]),t._v(" "),i("div",{staticClass:"c-form-row-2col"},[i("div",{staticClass:"c-form-item"},[i("FormItem",{attrs:{prop:"standard",label:"规格："}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text"},model:{value:t.detailInfo.standard,callback:function(e){t.$set(t.detailInfo,"standard",e)},expression:"detailInfo.standard"}})],1)],1),t._v(" "),i("div",{staticClass:"c-form-item"},[i("FormItem",{attrs:{label:"品牌："}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text"},model:{value:t.detailInfo.brand,callback:function(e){t.$set(t.detailInfo,"brand",e)},expression:"detailInfo.brand"}})],1)],1)]),t._v(" "),i("div",{staticClass:"c-form-row-2col"},[i("div",{staticClass:"c-form-item"},[i("FormItem",{attrs:{label:"型号："}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text"},model:{value:t.detailInfo.model,callback:function(e){t.$set(t.detailInfo,"model",e)},expression:"detailInfo.model"}})],1)],1),t._v(" "),i("div",{staticClass:"c-form-item"},[i("FormItem",{attrs:{label:"备注："}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"textarea"},model:{value:t.detailInfo.remark,callback:function(e){t.$set(t.detailInfo,"remark",e)},expression:"detailInfo.remark"}})],1)],1)])])]),t._v(" "),i("div",{staticClass:"c-top-border-gray"},[i("Tabs",{attrs:{animated:!1}},[i("TabPane",{staticClass:"padding10",attrs:{label:"库存分布"}},[i("div",{staticClass:"padding10-0"},[i("Input",{staticStyle:{width:"180px"},attrs:{placeholder:"仓库名称",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchDistribution(e)}},model:{value:t.searchParamsByDistr.warehouseName,callback:function(e){t.$set(t.searchParamsByDistr,"warehouseName",e)},expression:"searchParamsByDistr.warehouseName"}}),t._v(" "),i("Button",{staticClass:"c-btn-add",attrs:{type:"primary"},on:{click:t.searchDistribution}},[t._v("搜索")])],1),t._v(" "),i("Table",{attrs:{columns:t.columnsByDistr,data:t.listDataByDistr,loading:t.loadingByDistr,stripe:""}}),t._v(" "),i("Page",{staticClass:"table-page",attrs:{total:t.totalByDistr,"page-size":t.searchParamsByDistr.pageSize,current:t.searchParamsByDistr.currentPage,"show-total":"","show-elevator":""},on:{"on-change":t.pageChangeByDistr}})],1),t._v(" "),i("TabPane",{staticClass:"padding10",attrs:{label:"存储上下限"}},[i("div",{staticClass:"padding10-0 clearfix"},[i("div",{staticClass:"c-btns-right"},[i("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle",size:"small"},on:{click:t.addRow}},[t._v("新增")])],1)]),t._v(" "),i("Table",{attrs:{columns:t.columnsByLimit,data:t.listDataByLimit,loading:t.loadingByLimit,stripe:""}}),t._v(" "),i("Page",{staticClass:"table-page",attrs:{total:t.totalByLimit,"page-size":t.searchParamsByLimit.pageSize,current:t.searchParamsByLimit.currentPage,"show-total":"","show-elevator":""},on:{"on-change":t.pageChangeByLimit}})],1)],1)],1)],1)};a._withStripped=!0;var r=i(23),o=i(11),n=i(145),s=i(527),l=i(107);function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var m=[],p={components:{dropdownTree:n.a},data:function(){var t=this;return{detailInfo:{},ABCClassify:[{label:"A",value:"A"},{label:"B",value:"B"},{label:"C",value:"C"}],unit:[],materielCategoryArr:[],org:{id:"",title:"请选择"},materielCategory:{id:"",title:"请选择"},searchParamsByDistr:{materielNumber:"",warehouseName:"",currentPage:1,pageSize:5},totalByDistr:0,loadingByDistr:!1,columnsByDistr:[{title:"仓库名称",key:"warehouseName"},{title:"库位",key:"locationNo"},{title:"数量",key:"amount"}],listDataByDistr:[],searchParamsByLimit:{materielNumber:"",warehouseName:"",currentPage:1,pageSize:5},totalByLimit:0,loadingByLimit:!1,submitLoading:!1,columnsByLimit:[{title:"仓库名称",key:"warehouseName",render:function(e,i){return e("Select",{props:{placeholder:"请选择",value:i.row.warehouseNo,"label-in-value":!0},on:{"on-change":function(e){i.row.warehouseNo=e.value,i.row.warehouseName=e.label,t.listDataByLimit[i.index]=i.row}}},m.map((function(t,i){return e("Option",{props:{value:t.warehouseNo,label:t.warehouseName}})})))}},{title:"下限",key:"lower",render:function(e,i){return e("div",[e("InputNumber",{props:{min:0,precision:2,value:i.row.lower||0},on:{input:function(e){i.row.lower=e,t.listDataByLimit[i.index]=i.row}}})])}},{title:"上限",key:"upper ",render:function(e,i){return e("div",[e("InputNumber",{props:{min:0,precision:2,value:i.row.upper||0},on:{input:function(e){i.row.upper=e,t.listDataByLimit[i.index]=i.row}}})])}},{title:"操作",key:"act",render:function(e,i){return e("div",[e("a",{attrs:{href:"javascript:;"},style:{color:"#4b7efe",margin:"0 10px 0 0"},on:{click:function(){i.row.id?t.$http.del(s.a.material.delMaterielStockLimit,{ids:i.row.id}).then((function(e){t.listDataByLimit.splice(i.index,1),t.$Notice.success({title:"删除成功！"})})):t.listDataByLimit.splice(i.index,1)}}},"删除")])}}],listDataByLimit:[],formRules:{orgId:[{required:!0,validator:function(t,e,i){e?i():i(new Error("请选择组织"))}}],materielName:[{required:!0,message:"物料名称不能为空",trigger:"blur"}],materielCategoryId:[{required:!0,validator:function(t,e,i){e?i():i(new Error)},message:"请选择物科类别",trigger:"change"}],abc:[{required:!0,message:"请选择ABC分类",trigger:"change"}],measurementUnit:[{required:!0,message:"请选择计量单位",trigger:"change"}],standard:[{required:!0,message:"规格不能为空",trigger:"blur"}]},orgTreeApi:l.a.getOrgTreeData}},computed:Object(r.b)({account:function(t){return t.user.account}}),methods:{back:function(){this.$router.back()},getListByDistr:function(){var t=this;this.loadingByDistr=!0,this.$http.get(s.a.material.getDistribution,this.searchParamsByDistr).then((function(e){t.listDataByDistr=e.items,t.totalByDistr=e.total,t.loadingByDistr=!1}))},getListByLimit:function(){var t=this;this.loadingByLimit=!0,this.$http.get(s.a.material.getMaterielStockLimits,this.searchParamsByLimit).then((function(e){t.listDataByLimit=e.items,t.totalByLimit=e.total,t.loadingByLimit=!1}))},searchDistribution:function(){this.searchParamsByDistr.currentPage=1,this.getListByDistr()},searchLimit:function(){this.searchParamsByLimit.currentPage=1,this.getListByLimit()},pageChangeByDistr:function(t){this.searchParamsByDistr.currentPage=t,this.getListByDistr()},pageChangeByLimit:function(t){this.searchParamsByLimit.currentPage=t,this.getListByLimit()},addRow:function(){this.listDataByLimit.push({materielNumber:this.detailInfo.materielNumber,warehouseName:"",warehouseNo:"",upper:0,lower:0,isEdit:!0})},submit:function(){var t=this,e=this;if(e.listDataByLimit.some((function(t,i){return t.warehouseName?t.lower?t.upper?t.upper<t.lower&&(e.$Notice.warning({title:"第"+(i+1)+"行中输入的上限不应该小于下限"}),!0):(e.$Notice.warning({title:"请输入第"+(i+1)+"行中的上限"}),!0):(e.$Notice.warning({title:"请输入第"+(i+1)+"行中的下限"}),!0):(e.$Notice.warning({title:"请选择第"+(i+1)+"行中的仓库名称"}),!0)})))return!1;this.submitLoading=!0,this.$http.put(s.a.material.changeMateriel,function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){u(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},this.detailInfo,{materielStockLimits:this.listDataByLimit})).then((function(i){t.submitLoading=!1,t.$Notice.success({title:"保存成功！"}),e.$router.push({name:"storage-material-detail",params:{id:t.$route.params.id}})})).catch((function(){t.submitLoading=!1}))},chooseOrg:function(t){this.detailInfo.orgId=this.org.id,this.materielCategoryArr=[],this.detailInfo.materielCategoryId="",this.org.id&&this.getMaterielCategoryTree(this.org.id)},getMaterielCategoryTree:function(t){var e=this;this.$http.get(s.a.material.getMaterielCategoryTree,{orgId:t}).then((function(t){t.forEach((function(t){t.name=t.categoryName})),e.materielCategoryArr=o.a.transDataToTree(t)}))},chooseMaterialCategory:function(){this.detailInfo.materielCategoryId=this.materielCategory.id}},created:function(){var t=this,e=this.$route.params.id;o.a.initTableColumnTitle(this.columnsByDistr),o.a.initTableColumnTitle(this.columnsByLimit),this.$http.get(s.a.material.getMaterielDetail+"/"+e).then((function(e){t.org={id:e.orgId,title:e.orgName},t.materielCategory={id:e.materielCategoryId,title:e.categoryName},t.detailInfo=e,t.searchParamsByDistr.materielNumber=e.materielNumber,t.searchParamsByLimit.materielNumber=e.materielNumber,t.getListByDistr(),t.getListByLimit(),t.getMaterielCategoryTree(e.orgId)})),this.$http.get(s.a.material.getUnitList).then((function(e){t.unit=e})),this.$http.get(s.a.getWarehouseComboList).then((function(t){m=t}))}},d=(i(1007),i(1)),y=Object(d.a)(p,a,[],!1,null,null,null);y.options.__file="src/views/storage/material/edit.vue";e.default=y.exports},527:function(t,e,i){"use strict";var a=i(22),r={getWarehouseComboList:"/inventory/api/warehouse/comboList",getManaginguser:"/inventory/api/users/managinguser",category:{getTree:"/inventory/api/materiel-category/tree",getInfo:"/inventory/api/materiel-category/materiel",add:"/inventory/api/materiel-category/materiel",edit:"/inventory/api/materiel-category/materiel",del:"/inventory/api/materiel-category/materiel",search:"/inventory/api/materiel-category/list"},inventory:{audit:"/inventory/api/store-adjustment/audited",export:a.a+"/inventory/api/store-adjustment/export",url:"/inventory/api/store-adjustment/adjusment",list:"/inventory/api/store-adjustment/list",detailList:"/inventory/api/store-adjustment/detail/list",itemList:"/inventory/api/store-adjustment/materiel/list",move:"/inventory/api/store-adjustment/move",materielSearch:"/inventory/api/stock/materiel",materielPosition:"/inventory/api/stock/position",materielDepot:"/inventory/api/stock/warehous"},takeStock:{audit:"/inventory/api/materiel-inventory/audited",export:a.a+"/inventory/api/materiel-inventory/export",import:a.a+"/inventory/api/materiel-inventory/import",url:"/inventory/api/materiel-inventory/inventory",detailList:"/inventory/api/materiel-inventory/detail/list",list:"/inventory/api/materiel-inventory/list"},storage:{comboList:"/inventory/api/warehouse/comboList"},material:{getMaterielCategoryTree:"/inventory/api/materiel-category/tree/external",getMateriel:"/inventory/api/materiels",delMateriel:"/inventory/api/materiels",exportMateriel:a.a+"/inventory/api/materiels/excel-export",addMateriel:"/inventory/api/materiel",changeMateriel:"/inventory/api/materiel",getMaterielDetail:"/inventory/api/materiel",getDistribution:"/inventory/api/materielStocks/distribution",getMaterielStockLimits:"/inventory/api/materielStockLimits",bacthAddMaterielStockLimit:"/inventory/api/materielStockLimit/batch-save",updateMaterielStockLimit:"/inventory/api/materielStockLimit",delMaterielStockLimit:"/inventory/api/materielStockLimits",getUnitList:"/inventory/api/materiel/unit",modalMateriel:"/inventory/api/materiel/external",getExcel:a.a+"/inventory/api/excel-temlate-down",importExcel:a.a+"/inventory/api/excel-import",cancelExcelData:"/inventory/api/excel-data-cancel",saveExcelData:"/inventory/api/excel-data-save"},repertory:{getWarehouses:"/inventory/api/warehouses",exportWarehouse:a.a+"/inventory/api/warehouse/excel-export",delWarehouses:"/inventory/api/warehouses",changeWarehouses:"/inventory/api/warehouse",addWarehouse:"/inventory/api/warehouse",getWarehouseDetail:"/inventory/api/warehouse",getWarehouseInfo:"/inventory/api/warehouse/getWarehouseInfo",getPositionOfWarehouse:"/inventory/api/warehousePosition/positionList",bacthAddWarehouseposition:"/inventory/api/warehouseposition/batch-save",updateWarehousePosition:"/inventory/api/warehousePosition",delWarehousePosition:"/inventory/api/warehousePositions",positionByWarehouse:"/inventory/api/warehousePosition/move",checkWarehousenameIsExist:"/inventory/api/warehouse/check-warehousename-isexist",getExcel:a.a+"/inventory/api/warehousePosition/excel-temlate-down",importExcel:a.a+"/inventory/api/warehousePosition/excel-import",cancelExcelData:"/inventory/api/warehousePosition/excel-data-cancel",saveExcelData:"/inventory/api/warehousePosition/excel-data-save"},checkin:{getInbond:"/inventory/api/inbounds",delInbond:"/inventory/api/inbounds",addInbond:"/inventory/api/inbound",getInbondDetail:"/inventory/api/inbound",getInbondRecordList:"/inventory/api/inbound/inboundDetails",getPositionComboxList:"/inventory/api/warehousePosition/positionComboxList",auditeInbound:"/inventory/api/inbound/audite",getMaterielsByWareHouseNo:"/inventory/api/materiel/getMaterielsByWareHouseNo",getMateriels:"/inventory/api/materiel/getMateriels",updateInboundDetail:"/inventory/api/inboundDetail"},checkout:{getApplicantMember:"/uaa/api/users/select",getOutbond:"/inventory/api/outbounds",delOutbond:"/inventory/api/outbounds",addOutbond:"/inventory/api/outbound",getOutbondDetail:"/inventory/api/outbound",getOutbondRecordList:"/inventory/api/outboundDetail",auditeOutbound:"/inventory/api/outbound/audite",updateOutboundDetail:"/inventory/api/outboundDetail",getstock:"/inventory/api/stock/getstock",getMaterielsOutBound:"/inventory/api/materiel/getMaterielsOutBound"},allot:{getTransfer:"/inventory/api/transfer/list",delTransfer:"/inventory/api/transfer/transfer",addTransfer:"/inventory/api/transfer/transfer",getTransferDetail:"/inventory/api/transfer/transfer",getTransferDetailList:"/inventory/api/transfer/detail/list",auditTransfer:"/inventory/api/transfer/audited",updateTransfer:"/inventory/api/transfer/transfer",getMaterielList:"/inventory/api/transfer/materiel/list",getStockPosiComboList:"/inventory/api/stock/position",getWarehousePosition:"/inventory/api/warehousePosition/move"},reporting:{getStockInfo:"/inventory/api/stock/getstock-info",exportStockInfo:a.a+"/inventory/api/stock/getstock-info-excel-export",getStockInoutbound:"/inventory/api/stock/getstock-info-inoutbound",exportStockInoutbound:a.a+"/inventory/api/stock/getstock-info-inoutbound-excel-export",getStockMove:"/inventory/api/stock/get-inventory-mobility-report",exportStockMove:a.a+"/inventory/api/stock/get-inventory-mobility-report-excel-export",getInventoryProfitLossList:"/inventory/api/materiel-inventory/inventory-report",exportInventoryProfitLoss:a.a+"/inventory/api/materiel-inventory/inventory-report-export",getInventoryNumberList:"/inventory/api/materiel-inventory/inventory-report-inventory-number"}};e.a=r},728:function(t,e,i){var a=i(1008);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i(17).default)("794843b4",a,!1,{})}}]);