(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{1172:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"c-main-border"},[a("div",{staticClass:"c-left-border-blue"},[a("h3",[e._v("终端详情")]),e._v(" "),a("div",{staticClass:"c-btns-right"},[a("Button",{attrs:{type:"primary",shape:"circle",loading:e.btnLoadding},on:{click:e.save}},[e._v("保存")]),e._v(" "),a("Button",{staticClass:"c-btn-back",attrs:{type:"primary",shape:"circle"},on:{click:e.back}},[e._v("返回")])],1)]),e._v(" "),a("div",{staticClass:"c-top-border-gray"},[a("Form",{ref:"form",attrs:{model:e.params,rules:e.formRules,"label-width":150}},[a("div",{staticClass:"c-form-row-2col",staticStyle:{"margin-top":"20px"}},[a("div",{staticClass:"c-form-item"},[a("FormItem",{attrs:{prop:"terminalName",label:"终端名称："}},[a("Input",{staticStyle:{width:"280px"},attrs:{placeholder:""},model:{value:e.params.terminalName,callback:function(t){e.$set(e.params,"terminalName",t)},expression:"params.terminalName"}})],1)],1),e._v(" "),"edit"==e.pageStatus?a("div",{staticClass:"c-form-item"},[a("FormItem",{attrs:{label:"终端编号："}},[e._v(e._s(e.params.terminalNo))])],1):e._e()]),e._v(" "),a("div",{staticClass:"c-form-row-2col"},[a("div",{staticClass:"c-form-item"},[a("FormItem",{attrs:{prop:"terminalType",label:"终端类型："}},[a("Select",{staticStyle:{width:"280px"},model:{value:e.params.terminalType,callback:function(t){e.$set(e.params,"terminalType",t)},expression:"params.terminalType"}},e._l(e.types,(function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1)],1),e._v(" "),a("div",{staticClass:"c-form-item"},[a("FormItem",{attrs:{prop:"model",label:"型号："}},[a("Input",{staticStyle:{width:"280px"},attrs:{placeholder:""},model:{value:e.params.model,callback:function(t){e.$set(e.params,"model",t)},expression:"params.model"}})],1)],1)]),e._v(" "),a("div",{staticClass:"c-form-row-2col"},[a("div",{staticClass:"c-form-item"},[a("FormItem",{attrs:{prop:"parseMethod",label:"协议解析方法："}},[a("Select",{staticStyle:{width:"280px"},model:{value:e.params.parseMethod,callback:function(t){e.$set(e.params,"parseMethod",t)},expression:"params.parseMethod"}},e._l(e.parseMethods,(function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1)],1),e._v(" "),a("div",{staticClass:"c-form-item",staticStyle:{width:"50%"}},[a("FormItem",{attrs:{prop:"equNo",label:"设备编号："}},[a("Input",{staticStyle:{width:"280px"},attrs:{disabled:!("Y"!=e.params.autoEquno),placeholder:""},model:{value:e.params.equNo,callback:function(t){e.$set(e.params,"equNo",t)},expression:"params.equNo"}}),e._v(" "),a("Checkbox",{attrs:{"true-value":"Y","false-value":"N",disabled:"edit"==e.pageStatus},model:{value:e.params.autoEquno,callback:function(t){e.$set(e.params,"autoEquno",t)},expression:"params.autoEquno"}},[e._v("自动生成")])],1)],1)]),e._v(" "),a("div",{staticClass:"c-form-row-2col"},[a("div",{staticClass:"c-form-item"},[a("FormItem",{attrs:{label:"区域位置："}},[a("my-process-tree-authority",{attrs:{url:e.processTreeApi,width:280},on:{"on-change":e.processChange},model:{value:e.relProcess,callback:function(t){e.relProcess=t},expression:"relProcess"}})],1)],1),e._v(" "),a("div",{staticClass:"c-form-item"},[a("FormItem",{attrs:{prop:"installSite",label:"安装位置："}},[a("Input",{staticStyle:{width:"280px"},attrs:{placeholder:""},model:{value:e.params.installSite,callback:function(t){e.$set(e.params,"installSite",t)},expression:"params.installSite"}})],1)],1)]),e._v(" "),a("div",{staticClass:"c-form-row-2col"},[a("div",{staticClass:"c-form-item"},[a("FormItem",{attrs:{prop:"network",label:"网络方式："}},[a("Select",{staticStyle:{width:"280px"},on:{"on-change":e.networkChange},model:{value:e.params.network,callback:function(t){e.$set(e.params,"network",t)},expression:"params.network"}},e._l(e.networks,(function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1)],1),e._v(" "),a("div",{staticClass:"c-form-item"},[a("FormItem",{attrs:{prop:"iccid",label:"SIM卡号："}},[a("Select",{staticStyle:{width:"280px"},model:{value:e.params.iccid,callback:function(t){e.$set(e.params,"iccid",t)},expression:"params.iccid"}},e._l(e.sims,(function(t){return a("Option",{key:t.iccid,attrs:{value:t.iccid}},[e._v(e._s(t.iccid))])})),1)],1)],1)]),e._v(" "),a("div",{staticClass:"c-form-row-2col"},[a("div",{staticClass:"c-form-item"},[a("FormItem",{attrs:{label:"监控设备型号："}},[a("Input",{staticStyle:{width:"280px"},attrs:{placeholder:""},model:{value:e.params.monitorModel,callback:function(t){e.$set(e.params,"monitorModel",t)},expression:"params.monitorModel"}})],1)],1)]),e._v(" "),a("div",{staticClass:"c-plain-bg-h"},[a("h3",[e._v("心跳测点")])]),e._v(" "),a("div",{staticClass:"c-form-row-2col",staticStyle:{"margin-top":"20px"}},[a("div",{staticClass:"c-form-item"},[a("FormItem",{attrs:{prop:"heartbeatCycle",label:"心跳周期："}},[a("Input",{staticStyle:{width:"80px"},attrs:{number:"",placeholder:""},model:{value:e.params.heartbeatCycle,callback:function(t){e.$set(e.params,"heartbeatCycle",t)},expression:"params.heartbeatCycle"}}),e._v("秒\n                    ")],1)],1)])])],1)])};r._withStripped=!0;a(11);var i=a(532),n=(a(39),a(107)),s=a(531),o=a(149),l={components:{myProcessTreeAuthority:s.a,mgSingleSelectTable:o.a},data:function(){var e=this;return{pageStatus:"info",relProcess:{id:"",title:"请选择"},heartbeatMpoint:{id:"",name:""},processTreeApi:n.a.getProcessTreeData,params:{terminalName:"",terminalNo:"",terminalType:"0",model:"",autoEquno:"N",equNo:"",processId:"",installSite:"",network:"2",iccid:"",parseMethod:"",monitorModel:"",heartbeatMpoint:"",heartbeatCycle:30},formRules:{terminalName:[{required:!0,message:"请输入终端名称",trigger:"blur"}],terminalType:[{required:!0,message:"请选择终端类型",trigger:"change"}],parseMethod:[{required:!0,message:"请选择解析方法",trigger:"change"}],network:[{required:!0,message:"请选择网络方式",trigger:"change"}],model:[{required:!0,message:"请输入型号",trigger:"blur"}],equNo:[{validator:function(t,a,r){var i=a.toString().replace(/^\s+|\s+$/,"");"Y"==e.params.autoEquno?r():i?a.toString().length>30?r(new Error("最多输入30个字符")):r():r(new Error("请输入设备编号"))},trigger:"change"}],installSite:[{required:!0,message:"请输入安装位置",trigger:"blur"}],heartbeatCycle:[{type:"number",message:"请输入整数",trigger:"blur"},{validator:function(e,t,a){t&&t<=0?a(new Error("请输入正整数")):a()}}],iccid:[{validator:function(t,a,r){1==e.params.network||a?r():r(new Error("请选择SIM卡号"))},trigger:"change"}]},types:[{label:"网关",value:"0"},{label:"独立式设备",value:"1"}],networks:[{label:"2G",value:"2"},{label:"3G",value:"3"},{label:"4G",value:"4"},{label:"5G",value:"5"},{label:"有线",value:"1"}],sims:[],parseMethods:[],btnLoadding:!1}},methods:{getData:function(){var e=this;this.$http.get(i.a.terminalDetail+this.$route.params.id).then((function(t){e.relProcess.id=t.processId||"",e.relProcess.title=t.processName||"请选择",e.heartbeatMpoint.name=t.heartbeatMpointName,e.heartbeatMpoint.id=t.heartbeatMpoint,e.params=t}))},getSimSelect:function(){var e=this;this.$http.get(i.a.simSelect).then((function(t){e.sims=t||[]}))},getParseMethods:function(){var e=this;this.$http.get(i.a.gatewayParseMethod).then((function(t){t=t.filter((function(e){return"NULL"!==e.value})),e.parseMethods=t||[]}))},processChange:function(){},back:function(){this.$router.back()},save:function(){var e=this,t="post";"edit"==this.pageStatus&&(t="put"),this.$refs.form.validate((function(a){a&&(e.params.processId=e.relProcess.id,e.btnLoadding=!0,e.$http[t](i.a.addTerminal,e.params).then((function(){e.$Notice.success({title:"保存成功"}),e.btnLoadding=!1,e.$router.push({name:"terminal-setting"})})).catch((function(){e.btnLoadding=!1})))}))},networkChange:function(e){this.params.iccid="",this.$refs.form.validateField("iccid")}},created:function(){"terminal-edit"==this.$route.name&&(this.pageStatus="edit",this.getData())},mounted:function(){this.getParseMethods(),this.getSimSelect()}},c=a(1),p=Object(c.a)(l,r,[],!1,null,null,null);p.options.__file="src/views/system/terminal-setting/edit.vue";t.default=p.exports},518:function(e,t,a){var r=a(530);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,a(17).default)("4411afe8",r,!1,{})},529:function(e,t,a){"use strict";var r=a(518);a.n(r).a},530:function(e,t,a){(t=a(10)(!1)).push([e.i,"\n.cmp-dropdown-tree {\r\n    display: inline-block;\r\n    position: relative;\r\n    vertical-align: middle;\r\n    line-height: normal;\n}\n.ivu-form-item-error .cmp-dropdown-tree-label {\r\n    border: 1px solid #ed3f14;\n}\n.ivu-form-item-error .cmp-dropdown-tree-arrow {\r\n    border-left: 1px solid #ed3f14;\n}\n.cmp-dropdown-tree-label {\r\n    height: 28px;\r\n    width: 100%;\r\n    border: 1px solid #eaeaea;\r\n    display: flex;\r\n    border-radius: 3px;\r\n    cursor: pointer;\n}\n.cmp-dropdown-tree-text {\r\n    line-height: 28px;\r\n    text-indent: 5px;\r\n    flex: 1;\r\n    white-space: nowrap;\r\n    text-overflow: ellipsis;\r\n    overflow: hidden;\n}\n.cmp-dropdown-tree-arrow {\r\n    margin-top: -1px;\r\n    width: 28px;\r\n    height: 28px;\r\n    border-left: 1px solid #eaeaea;\r\n    text-align: center;\r\n    line-height: 28px;\n}\n.cmp-dropdown-tree .ivu-input-group-append {\r\n    width: 25px;\r\n    height: 28px;\r\n    overflow: hidden;\r\n    padding: 0;\n}\n.cmp-dropdown-tree .ivu-btn {\r\n    padding: 5px 10px;\n}\n.cmp-dropdown-tree-tree {\r\n    z-index: 901;\r\n    position: absolute;\r\n    top: 37px;\r\n    left: 0;\r\n    min-width: 300px;\r\n    max-height: 400px;\r\n    overflow: auto;\r\n    padding: 5px 10px;\r\n    background-color: #fff;\r\n    box-shadow: 1px 1px 5px #999;\r\n    border-radius: 3px;\n}\r\n",""]),e.exports=t},531:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.hideTree,expression:"hideTree"}],staticClass:"cmp-dropdown-tree",style:{width:e.width+"px"}},[a("div",{staticClass:"cmp-dropdown-tree-label",on:{click:e.labelClick}},[a("div",{staticClass:"cmp-dropdown-tree-text"},[e._v(e._s(e.value.title))]),e._v(" "),a("div",{staticClass:"cmp-dropdown-tree-arrow"},[a("Icon",{directives:[{name:"show",rawName:"v-show",value:1!=e.isShowTree,expression:"isShowTree != true"}],attrs:{type:"ios-arrow-down"}}),e._v(" "),a("Icon",{directives:[{name:"show",rawName:"v-show",value:1==e.isShowTree,expression:"isShowTree == true"}],attrs:{type:"ios-arrow-up"}})],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowTree,expression:"isShowTree"}],staticClass:"cmp-dropdown-tree-tree"},[a("Tree",{attrs:{data:e.datas,"show-checkbox":e.showCheckbox,multiple:e.multiple},on:{"on-select-change":e.selectTree}})],1)])};r._withStripped=!0;var i=a(11),n=a(146),s=a(147);function o(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(e){!function e(t){t.forEach((function(t,a){t.childrenIds=function e(t,a){a=a||[];return t.forEach((function(t){t.children.length&&e(t.children,a),a.push(Math.abs(t.id))})),a}(t.children),t.children.length&&e(t.children)}))}(e)}var c={name:"myProcessTreeAuthority",mixins:[n.a],props:{field:String,value:Object,data:Array,url:String,query:Object,showCheckbox:Boolean,multiple:Boolean,width:{type:[Number,String],default:300},type:String},watch:{"value.id":function(e){e?this.flatDatas.length&&(i.a.setTrueTreeExpand(this.datas,e),i.a.setTrueTreeSelected(this.datas,e)):(!function e(t){for(var a,r=t.length,i=0;i<r;i++)1==(a=t[i]).selected&&(a.selected=!1),a.children.length&&e(a.children)}(this.datas),this.$emit("input",{id:"",title:"请选择"}))},data:function(e){this.datas=e}},data:function(){return{datas:this.data,flatDatas:[],isShowTree:!1}},methods:{selectTree:function(e){var t=this,a=[],r=[],i=[],n=this.field||"id",s=[];e.forEach((function(e){a.push(Math.abs(e[n])),r.push(e.key),i.push(e.title),s=s.concat(Math.abs(e[n]),e.childrenIds)})),s=o(new Set(s)),this.$emit("input",{id:a.join(),key:r.join(),title:i.join(),childrenIds:s}),this.$emit("on-change",{id:a.join(),key:r.join(),title:i.join(),childrenIds:s}),this.multiple||(this.isShowTree=!1),setTimeout((function(){t.dispatch("FormItem","on-form-change",{id:a.join(),key:r.join(),title:i.join(),childrenIds:s})}),100)},hideTree:function(){this.isShowTree=!1},labelClick:function(){this.isShowTree=!this.isShowTree}},directives:{clickoutside:s.a},mounted:function(){var e=this;this.url&&this.$http.get(this.url,this.query).then((function(t){t&&t.length&&(t.forEach((function(e){!1===e.authorized&&(e.render=function(e,t){t.root,t.node;return e("span",[t.data.name])})})),"EQUTYPE"==e.type&&t.forEach((function(e){var a=t.filter((function(t){return t.parentId==e.id}));("org"==e.type||a.length>0)&&(e.render=function(e,t){t.root,t.node;return e("span",[t.data.name])})})),"PROCESS"==e.type&&t.forEach((function(e){1==e.type&&(e.render=function(e,t){t.root,t.node;return e("span",[t.data.name])})})),e.flatDatas=t,e.value.id&&(i.a.setTreeExpand(e.flatDatas,e.value.id),i.a.setFlatTreeSelected(e.flatDatas,e.value.id)),e.datas=i.a.transDataToTree(e.flatDatas),l(e.datas))}))}},p=(a(529),a(1)),d=Object(p.a)(c,r,[],!1,null,null,null);d.options.__file="src/components/my-process-tree-authority.vue";t.a=d.exports},532:function(e,t,a){"use strict";var r=a(22),i={getAllEqu:"/equipment/api/equipments",deleteEqu:"/equipment/api/equipments",getEquDetail:"/equipment/api/equipments/detail/",saveEqu:"/equipment/api/equipments/detail",delAttachment:"/equipment/api/equ-attachs",getSingleEqu:"/equipment/api/equipments/",getParentEqu:"/equipment/api/equipments/parent/",getEquState:"/equipment/api/equipments/state/",getRemarkByEqu:"/equipment/api/equ-comments",addRemarkByEqu:"/equipment/api/equ-comments",pointsByEqu:"/equipment/api/equipments/mpoint",alarmByEqu:"/equipment/api/alarm-records",equRelPoints:"/equipment/api/mpoints/dropdown-box",getQrcode:r.a+"/equipment/api/equipments/qrcode-export",import:"/equipment/api/excel-import",saveExcelData:"/equipment/api/excel-data-save",cancelExcelData:"/equipment/api/excel-data-cancel",getExcel:r.a+"/equipment/api/excel-temlate-down",importExcel:r.a+"/equipment/api/excel-import",qrcodeExportStart:"/equipment/api/equipments/qrcode-export",qrcodeExportProgress:"/equipment/api/equipments/qrcode-export/progress",qrcodeExportDownload:r.a+"/equipment/api/equipments/qrcode-export/download",equTypeTree:"/equipment/api/equ-types/tree",equTypes:"/equipment/api/equ-types",equType:"/equipment/api/equ-types",gatewayParseMethod:"/box/api/terminals/parse-method",getTerminalList:"/box/api/terminals",terminalDetail:"/box/api/terminals/",addTerminal:"/box/api/terminals",delTerminal:"/box/api/terminals",simSelect:"/box/api/sim-manager/cards/select"};t.a=i}}]);