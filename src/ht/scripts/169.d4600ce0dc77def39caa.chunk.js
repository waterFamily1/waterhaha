(window.webpackJsonp=window.webpackJsonp||[]).push([[169],{1246:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fault c-main-border"},[i("div",{staticClass:"c-left-border-blue"},[i("h3",[e._v("盘点信息")]),e._v(" "),i("div",{staticClass:"c-btns-right"},[i("Button",{directives:[{name:"role",rawName:"v-role",value:"take-stock-add",expression:"'take-stock-add'"}],attrs:{type:"primary",shape:"circle",loading:e.submitLoading},on:{click:e.submit}},[e._v("保存")]),e._v(" "),i("Button",{staticClass:"c-btn-back",attrs:{type:"primary",shape:"circle"},on:{click:e.back}},[e._v("取消")])],1)]),e._v(" "),i("div",{staticClass:"c-top-border-gray padding20-0"},[i("Form",{ref:"addForm",attrs:{model:e.params,rules:e.formRules,"label-width":100}},[i("div",{staticClass:"c-form-row-2col"},[i("div",{staticClass:"c-form-item"},[i("FormItem",{attrs:{prop:"orgId",label:"组织信息："}},[i("dropdown-tree",{attrs:{url:e.orgTreeApi},on:{"on-change":e.orgSelect},model:{value:e.org,callback:function(t){e.org=t},expression:"org"}})],1)],1),e._v(" "),i("div",{staticClass:"c-form-item"},[i("FormItem",{attrs:{prop:"userId",label:"盘点人员："}},[i("Select",{staticStyle:{width:"300px"},model:{value:e.params.userId,callback:function(t){e.$set(e.params,"userId",t)},expression:"params.userId"}},e._l(e.operators,(function(t){return i("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1)],1)]),e._v(" "),i("div",{staticClass:"c-form-row-2col"},[i("div",{staticClass:"c-form-item"},[i("FormItem",{attrs:{prop:"warehouseId",label:"盘点仓库："}},[i("Select",{staticStyle:{width:"300px"},model:{value:e.params.warehouseId,callback:function(t){e.$set(e.params,"warehouseId",t)},expression:"params.warehouseId"}},e._l(e.depots,(function(t){return i("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.warehouseName))])})),1)],1)],1),e._v(" "),i("div",{staticClass:"c-form-item"},[i("FormItem",{attrs:{label:"备注："}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"textarea"},model:{value:e.params.remark,callback:function(t){e.$set(e.params,"remark",t)},expression:"params.remark"}})],1)],1)])])],1)])};a._withStripped=!0;var o=i(23),r=i(145),n=(i(11),i(527)),s=i(107),p={components:{dropdownTree:r.a},computed:Object(o.b)({account:function(e){return e.user.account}}),data:function(){return{org:{title:"请选择",id:""},depots:[],operators:[],params:{orgId:"",orgName:"",userId:"",warehouseId:"",remark:""},formRules:{orgId:[{required:!0,validator:function(e,t,i){t?i():i(new Error("请选择组织"))}}],userId:[{required:!0,type:"number",message:"请选择人员",trigger:"change"}],warehouseId:[{required:!0,type:"number",message:"请选择仓库",trigger:"change"}]},orgTreeApi:s.a.getOrgTreeData,submitLoading:!1}},methods:{getDepotsList:function(e){var t=this;this.$http.get(n.a.storage.comboList,{orgIds:e}).then((function(e){t.depots=e}))},getUnderOrganizationUsers:function(e,t){var i=this;this.$http.get(n.a.getManaginguser,{orgIds:e.id}).then((function(e){e&&e.items&&(i.operators=e.items,t&&t(i))})),this.getDepotsList(e.id)},orgSelect:function(e){this.params.orgId=e.id,this.params.orgName=e.title,this.params.warehouseId="",this.params.userId="",this.depots=[],this.operators=[],this.getUnderOrganizationUsers(e)},submit:function(){var e=this;this.$refs.addForm.validate((function(t){t&&(e.submitLoading=!0,e.$http.post(n.a.takeStock.url,e.params).then((function(t){e.$Notice.success({title:"添加成功！"}),e.$router.push({name:"take-stock-detail",params:{id:t.id}}),e.submitLoading=!1})).catch((function(){e.submitLoading=!1})))}))},back:function(){this.$router.back()}},mounted:function(){var e="",t="",i=(this.account.name,this.account.id);this.account.orgChain.reverse().some((function(i){return 2==i.type&&(e=i.id,t=i.name,!0)})),e&&t&&(this.org.id=e,this.org.title=t,this.params.orgId=e,this.params.orgName=t,this.getUnderOrganizationUsers({id:e},(function(e){e.operators.forEach((function(t){t.id==i&&(e.params.userId=i)}))})))},created:function(){}},u=i(1),l=Object(u.a)(p,a,[],!1,null,null,null);l.options.__file="src/views/storage/take-stock/add.vue";t.default=l.exports},527:function(e,t,i){"use strict";var a=i(22),o={getWarehouseComboList:"/inventory/api/warehouse/comboList",getManaginguser:"/inventory/api/users/managinguser",category:{getTree:"/inventory/api/materiel-category/tree",getInfo:"/inventory/api/materiel-category/materiel",add:"/inventory/api/materiel-category/materiel",edit:"/inventory/api/materiel-category/materiel",del:"/inventory/api/materiel-category/materiel",search:"/inventory/api/materiel-category/list"},inventory:{audit:"/inventory/api/store-adjustment/audited",export:a.a+"/inventory/api/store-adjustment/export",url:"/inventory/api/store-adjustment/adjusment",list:"/inventory/api/store-adjustment/list",detailList:"/inventory/api/store-adjustment/detail/list",itemList:"/inventory/api/store-adjustment/materiel/list",move:"/inventory/api/store-adjustment/move",materielSearch:"/inventory/api/stock/materiel",materielPosition:"/inventory/api/stock/position",materielDepot:"/inventory/api/stock/warehous"},takeStock:{audit:"/inventory/api/materiel-inventory/audited",export:a.a+"/inventory/api/materiel-inventory/export",import:a.a+"/inventory/api/materiel-inventory/import",url:"/inventory/api/materiel-inventory/inventory",detailList:"/inventory/api/materiel-inventory/detail/list",list:"/inventory/api/materiel-inventory/list"},storage:{comboList:"/inventory/api/warehouse/comboList"},material:{getMaterielCategoryTree:"/inventory/api/materiel-category/tree/external",getMateriel:"/inventory/api/materiels",delMateriel:"/inventory/api/materiels",exportMateriel:a.a+"/inventory/api/materiels/excel-export",addMateriel:"/inventory/api/materiel",changeMateriel:"/inventory/api/materiel",getMaterielDetail:"/inventory/api/materiel",getDistribution:"/inventory/api/materielStocks/distribution",getMaterielStockLimits:"/inventory/api/materielStockLimits",bacthAddMaterielStockLimit:"/inventory/api/materielStockLimit/batch-save",updateMaterielStockLimit:"/inventory/api/materielStockLimit",delMaterielStockLimit:"/inventory/api/materielStockLimits",getUnitList:"/inventory/api/materiel/unit",modalMateriel:"/inventory/api/materiel/external",getExcel:a.a+"/inventory/api/excel-temlate-down",importExcel:a.a+"/inventory/api/excel-import",cancelExcelData:"/inventory/api/excel-data-cancel",saveExcelData:"/inventory/api/excel-data-save"},repertory:{getWarehouses:"/inventory/api/warehouses",exportWarehouse:a.a+"/inventory/api/warehouse/excel-export",delWarehouses:"/inventory/api/warehouses",changeWarehouses:"/inventory/api/warehouse",addWarehouse:"/inventory/api/warehouse",getWarehouseDetail:"/inventory/api/warehouse",getWarehouseInfo:"/inventory/api/warehouse/getWarehouseInfo",getPositionOfWarehouse:"/inventory/api/warehousePosition/positionList",bacthAddWarehouseposition:"/inventory/api/warehouseposition/batch-save",updateWarehousePosition:"/inventory/api/warehousePosition",delWarehousePosition:"/inventory/api/warehousePositions",positionByWarehouse:"/inventory/api/warehousePosition/move",checkWarehousenameIsExist:"/inventory/api/warehouse/check-warehousename-isexist",getExcel:a.a+"/inventory/api/warehousePosition/excel-temlate-down",importExcel:a.a+"/inventory/api/warehousePosition/excel-import",cancelExcelData:"/inventory/api/warehousePosition/excel-data-cancel",saveExcelData:"/inventory/api/warehousePosition/excel-data-save"},checkin:{getInbond:"/inventory/api/inbounds",delInbond:"/inventory/api/inbounds",addInbond:"/inventory/api/inbound",getInbondDetail:"/inventory/api/inbound",getInbondRecordList:"/inventory/api/inbound/inboundDetails",getPositionComboxList:"/inventory/api/warehousePosition/positionComboxList",auditeInbound:"/inventory/api/inbound/audite",getMaterielsByWareHouseNo:"/inventory/api/materiel/getMaterielsByWareHouseNo",getMateriels:"/inventory/api/materiel/getMateriels",updateInboundDetail:"/inventory/api/inboundDetail"},checkout:{getApplicantMember:"/uaa/api/users/select",getOutbond:"/inventory/api/outbounds",delOutbond:"/inventory/api/outbounds",addOutbond:"/inventory/api/outbound",getOutbondDetail:"/inventory/api/outbound",getOutbondRecordList:"/inventory/api/outboundDetail",auditeOutbound:"/inventory/api/outbound/audite",updateOutboundDetail:"/inventory/api/outboundDetail",getstock:"/inventory/api/stock/getstock",getMaterielsOutBound:"/inventory/api/materiel/getMaterielsOutBound"},allot:{getTransfer:"/inventory/api/transfer/list",delTransfer:"/inventory/api/transfer/transfer",addTransfer:"/inventory/api/transfer/transfer",getTransferDetail:"/inventory/api/transfer/transfer",getTransferDetailList:"/inventory/api/transfer/detail/list",auditTransfer:"/inventory/api/transfer/audited",updateTransfer:"/inventory/api/transfer/transfer",getMaterielList:"/inventory/api/transfer/materiel/list",getStockPosiComboList:"/inventory/api/stock/position",getWarehousePosition:"/inventory/api/warehousePosition/move"},reporting:{getStockInfo:"/inventory/api/stock/getstock-info",exportStockInfo:a.a+"/inventory/api/stock/getstock-info-excel-export",getStockInoutbound:"/inventory/api/stock/getstock-info-inoutbound",exportStockInoutbound:a.a+"/inventory/api/stock/getstock-info-inoutbound-excel-export",getStockMove:"/inventory/api/stock/get-inventory-mobility-report",exportStockMove:a.a+"/inventory/api/stock/get-inventory-mobility-report-excel-export",getInventoryProfitLossList:"/inventory/api/materiel-inventory/inventory-report",exportInventoryProfitLoss:a.a+"/inventory/api/materiel-inventory/inventory-report-export",getInventoryNumberList:"/inventory/api/materiel-inventory/inventory-report-inventory-number"}};t.a=o}}]);