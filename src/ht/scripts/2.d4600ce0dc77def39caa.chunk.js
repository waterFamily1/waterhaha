(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1158:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"c-main-border c-custom-mpoint-form"},[a("div",{staticClass:"c-left-border-blue"},[a("h3",[t._v("自定义型计算任务详情")]),t._v(" "),a("div",{staticClass:"c-btns-right"},[a("Button",{attrs:{type:"primary",shape:"circle",loading:t.submitLoading},on:{click:function(e){return t.handleSubmit("pointForm")}}},[t._v("保存")]),t._v(" "),a("Button",{staticClass:"c-btn-back",attrs:{type:"primary",shape:"circle"},on:{click:t.back}},[t._v("取消")])],1)]),t._v(" "),a("div",{staticClass:"c-top-border-gray padding20-14"},[a("Form",{ref:"pointForm",attrs:{model:t.point,rules:t.ruleValidate,"label-width":130}},[a("form-common",{ref:"formCommon",model:{value:t.point,callback:function(e){t.point=e},expression:"point"}}),t._v(" "),a("div",{staticClass:"c-title-css"},[t._v("\n                计算任务\n                "),a("RadioGroup",{staticStyle:{"margin-left":"23px"},model:{value:t.point.status,callback:function(e){t.$set(t.point,"status",e)},expression:"point.status"}},[a("Radio",{attrs:{label:"ON"}},[t._v("启用")]),t._v(" "),a("Radio",{attrs:{label:"OFF"}},[t._v("停用")])],1)],1),t._v(" "),a("div",[a("Row",{staticStyle:{"padding-left":"20px","padding-top":"20px"}},[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"任务名称:",prop:"taskname"}},[a("Input",{attrs:{placeholder:"任务名称",disabled:t.editDisabled},model:{value:t.point.taskname,callback:function(e){t.$set(t.point,"taskname",e)},expression:"point.taskname"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"8",offset:"3"}},[a("FormItem",{attrs:{label:"计算周期:",prop:"cycle"}},[a("Select",{attrs:{disabled:t.editDisabled},on:{"on-change":t.initCycleTimeValue},model:{value:t.point.cycle,callback:function(e){t.$set(t.point,"cycle",e)},expression:"point.cycle"}},t._l(t.cycleList,(function(e){return a("Option",{key:e.cycleName,attrs:{value:e.id,disabled:e.disabled}},[t._v(t._s(e.cycleName))])})),1)],1)],1)],1),t._v(" "),a("Row",{staticStyle:{"padding-left":"20px"}},[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"任务开始时间",prop:"startdt"}},[a("DatePicker",{staticClass:"w100",attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placement:"top-end",disabled:t.editDisabled},model:{value:t.point.startdt,callback:function(e){t.$set(t.point,"startdt",e)},expression:"point.startdt"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"8",offset:"3"}},[a("FormItem",{attrs:{label:"周期开始时间",prop:"cycleStart"}},[a("Select",{staticStyle:{width:"290px"},attrs:{disabled:1===t.point.cycle||t.editDisabled},model:{value:t.point.cycleStart,callback:function(e){t.$set(t.point,"cycleStart",e)},expression:"point.cycleStart"}},t._l(t.cycleTimeList,(function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.name))])})),1),t._v(" "),a("span",[t._v(t._s(t.cycleTimeUnit))])],1)],1)],1),t._v(" "),a("Row",{staticStyle:{"padding-left":"20px"}},[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"计算公式:",prop:"expression"}},[a("Input",{attrs:{type:"textarea",disabled:t.editDisabled,autosize:{minRows:2,maxRows:5},placeholder:"仅支持+、-、*、/、括号四则运算公式，例如：(a+b)/c-d*2"},on:{"on-change":t.calcExpression},model:{value:t.point.expression,callback:function(e){t.$set(t.point,"expression",e)},expression:"point.expression"}})],1)],1)],1),t._v(" "),a("Row",{staticStyle:{"padding-left":"20px"}},[a("Col",{attrs:{span:"20"}},[a("FormItem",{attrs:{label:"参数设置:"}},[a("table",{staticClass:"c-paramter-layout"},t._l(t.point.parameter,(function(e,n){return a("tr",{key:e.id},[a("td",[t._v("参数"+t._s(e.name))]),t._v(" "),a("td",[a("span",{staticClass:"c-form-required"},[t._v("*")]),t._v(" "),a("FormItem",{staticStyle:{display:"inline-block"},attrs:{span:"10",prop:"parameter."+n+".pointSelect.title",rules:{required:!0,message:"测点不能为空"}}},[a("point-table-select",{attrs:{disabled:t.editDisabled},on:{input:t.choosePoint},model:{value:e.pointSelect,callback:function(a){t.$set(e,"pointSelect",a)},expression:"item.pointSelect"}})],1)],1)])})),0)])],1)],1)],1)],1)],1)])};n._withStripped=!0;var i=a(577),o=a(578),r=a(520),s=a(548),l=a(11),p=a(940),c={components:{formCommon:i.a,pointTableSelect:o.a},data:function(){var t=this;return{submitLoading:!1,dmpoint:{id:null,title:""},cycleList:[],editDisabled:!1,calcTaskId:null,point:{site:{id:null,title:"请选择"},siteId:null,mpointName:"",equipment:"",equipmentName:"",categoryId:null,datype:"",enumvalue:"0,关;1,开;",enumvalueInput:"0,关;1,开;",unit:"",numtail:2,remarks:"",status:"ON",taskname:"",cycle:"",cycleStart:"",expression:"",startdt:l.a.formatDateTime(new Date,"yyyy-MM-dd hh:mm:ss"),parameter:[]},ruleValidate:{siteId:[{validator:function(t,e,a){e?a():a(new Error("请选择区域位置"))}}],mpointName:[{required:!0,message:"请输入测点名称",trigger:"blur"},{max:50,message:"测点名称不能超过50个字符",trigger:"change"}],mpointType:[{required:!0,type:"number",message:"请选择测点类别",trigger:"change"}],datype:[{required:!0,message:"请选择信号类型"}],enumvalue:[{required:!0,message:"请选择状态值"}],enumvalueInput:[{required:!0,message:"自定义状态值不能为空",trigger:"blur"},{validator:function(t,e,a){if(e){/^((\d+)(,{1})([\u4e00-\u9fa5]+)(;{1}))*$/.test(e)?a():a(new Error("自定义格式不对"))}else a()}}],unitInput:[{required:!0,message:"自定义单位不能为空",trigger:"blur"}],remarks:[{type:"string",max:100,message:"备注不能超过100个字符",trigger:"blur"}],taskname:[{required:!0,message:"请输入任务名称"},{maxLength:50,message:"长度限50个字符"}],cycle:[{required:!0,message:"请选择数据周期"}],cycleStart:[{required:!0,validator:function(t,e,a){null===e||""!==e?a():a(new Error("请选择周期开始时间"))}}],expression:[{validator:function(e,a,n){a?t.validateExpression(n):(n(new Error("请填写计算公式")),t.point.parameter=[])}}],startdt:[{required:!0,message:"请选择任务开始时间"}]}}},computed:{cycleTimeUnit:function(){return{2:"时",3:"日",13:"月"}[this.point.cycle]},cycleTimeList:function(){return 1===this.point.cycle?[{name:"",value:null}]:2===this.point.cycle?new Array(24).fill(null).map((function(t,e){return{name:e,value:e}})):3===this.point.cycle?new Array(28).fill(null).map((function(t,e){return{name:e+1,value:e+1}})):13===this.point.cycle?new Array(12).fill(null).map((function(t,e){return{name:e+1,value:e+1}})):void 0}},created:function(){this.loadCycle()},mounted:function(){var t=this;this.$route.params.id&&(this.editDisabled=!0,this.$http.get(r.a.getCalcMpointDetail+"/"+this.$route.params.id).then((function(e){e&&(t.point.site.id=e.siteId,t.point.site.title=e.siteName,t.point=Object.assign({},t.point,e),t.point.mpointType=Number(t.point.mpointType),t.$refs.formCommon.changePointType(t.point.mpointType,(function(){t.$refs.formCommon.changeSetUnit(t.point.categoryId)})),-1==t.$refs.formCommon.statusMap.map((function(t){return t.id})).join().indexOf(t.point.enumvalue)&&(t.point.enumvalueInput=t.point.enumvalue,t.point.enumvalue="-1"),""==t.point.unit||null==t.point.unit?t.point.unit="":-1==Object.keys(t.$refs.formCommon.unitMap).indexOf(t.point.unit)&&(t.point.unitInput=t.point.unit,t.point.unit="-1"),t.$http.get(s.a.editPointSimple,{mpointId:t.point.id}).then((function(e){t.calcTaskId=e.items.id;var a=e.items.id,n=e.items.formulaid;t.point.status=e.items.status,t.point.taskname=e.items.taskname,t.point.cycle=e.items.cycle,t.point.cycleStart=+e.items.cycleStart,t.point.startdt=l.a.F(e.items.startdt,"yyyy-MM-dd hh:mm:ss"),t.point.parameter=[],t.point.expression="",t.$http.get(s.a.getFormulas,{formulaId:n}).then((function(e){t.point.expression=e.formula.expression})),t.$http.get(s.a.getCalcTask,{taskId:a}).then((function(e){var a={parameter:[]};e.items.forEach((function(t,e){a.parameter.push({name:t.code,pointSelect:{index:e,id:t.mpointid,title:t.mpointName}})})),t.point.parameter=a.parameter}))})))})))},methods:{loadCycle:function(){var t=this;this.$http.get(r.a.getCycle).then((function(e){t.cycleList=e}))},validateExpression:function(t){if(/^[\u4e00-\u9fa5]+$/.test(this.point.expression))this.point.parameter=[],t(new Error("参数限英文字母或数字"));else try{p(this.point.expression);t()}catch(e){t(new Error("计算公式格式不正确"))}},calcExpression:function(){try{var t=p(this.point.expression),e=this.printAttr(t);this.addParameter(e)}catch(t){}},printAttr:function(t){var e=[],a=[];for(null!=t&&e.push(t);0!=e.length;){var n=e.pop();n.name&&a.push(n.name),null!=n.right&&e.push(n.right),null!=n.left&&e.push(n.left)}for(var i=[],o=0;o<a.length;o++)i.push({name:a[o]});return i},addParameter:function(t){this.$route.params.id||(t.forEach((function(t,e){t.mpointid=0,t.mpointname="",t.pointSelect={index:e,id:0,title:""},t.index=e})),this.point.parameter=t)},initCycleTimeValue:function(t){1===this.point.cycle&&(this.point.cycleStart=null),2===this.point.cycle&&(this.point.cycleStart=0),3===this.point.cycle&&(this.point.cycleStart=1),13===this.point.cycle&&(this.point.cycleStart=1)},choosePoint:function(t){this.point.parameter[t.index].pointSelect=t,this.point.parameter[t.index].mpointid=t.id,this.point.parameter[t.index].mpointname=t.title},handleSubmit:function(t){var e=this;this.$refs[t].validate((function(t){if(t){e.submitLoading=!0;var a={};a.calcMpoint=JSON.parse(JSON.stringify(e.point)),delete a.calcMpoint.site,a.calcMpoint.datasource="CALC","-2"==a.calcMpoint.unit?a.calcMpoint.unit="":"-1"==a.calcMpoint.unit&&(a.calcMpoint.unit=a.calcMpoint.unitInput),a.calcMpoint.enumvalue="-1"==a.calcMpoint.enumvalue?a.calcMpoint.enumvalueInput:a.calcMpoint.enumvalue,"State"==a.calcMpoint.datype&&(a.calcMpoint.unit="",delete a.calcMpoint.unitInput,delete a.calcMpoint.enumvalueInput),"Digtal"==a.calcMpoint.datype&&(a.calcMpoint.enumvalue="",delete a.calcMpoint.enumvalueInput,delete a.calcMpoint.unitInput);var n={status:"",taskname:"",cycle:"",cycleStart:"",expression:"",mpointid:"",startdt:""};for(var i in n)n[i]=a.calcMpoint[i],delete a.calcMpoint[i];if(delete a.calcMpoint.parameter,e.calcTaskId)a.status=e.point.status,a.task=e.calcTaskId;else{n.mpointid=-1,n.siteid=e.point.siteId;var o={siteid:e.point.siteId,ftype:"Custom",expression:e.point.expression},s=[];e.point.parameter.forEach((function(t){s.push({code:t.name,mpointid:t.mpointid})})),a.calcTask=[],a.calcTask.push({task:n,params:s,formula:o})}(e.$route.params.id?e.$http.put:e.$http.post)(r.a.taskMpoints,a).then((function(t){e.$Notice.success({title:"成功",desc:"数据保存成功",duration:3}),"mpoint"==e.$route.query.type?e.$routeBack():e.$router.push({name:"task-calc"})})).catch((function(){e.submitLoading=!1}))}}))},back:function(){this.$router.back()}}},u=(a(941),a(1)),m=Object(u.a)(c,n,[],!1,null,null,null);m.options.__file="src/views/mpoint/mpoint/components/custom-form.vue";e.default=m.exports},518:function(t,e,a){var n=a(530);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(17).default)("4411afe8",n,!1,{})},520:function(t,e,a){"use strict";var n=a(22),i={modalMpoints:"/loong/api/mpoints/dialog",alarmChart:"/loong/api/mpoints/alarm-condition",downloadTemplate:n.a+"/loong/api/mpoints/excel-template-download",exportTemplate:n.a+"/loong/api/mpoints/export",importExcel:n.a+"/loong/api/mpoints/import",saveExcelData:"/loong/api/mpoints/import-save",cancelExcelData:"/loong/api/mpoints/import-cancel",getCategroyData:"/loong/api/mpoints-datacategory",getMpointsList:"/loong/api/mpoints",deleteMpoints:"/loong/api/mpoints",deleteAllMpoints:"/loong/api/mpoints/all",batchSave:"/loong/api/mpoints/batch",autoMpoints:"/loong/api/mpoints-auto",datainputMpoints:"/loong/api/mpoints-datainput",taskMpoints:"/loong/api/mpoints-task",getCalcMpointDetail:"/loong/api/mpoints-calc",getCycle:"/loong/api/mpoints-calc-cycle",getAnalysisMpointDetail:"/loong/api/mpoints-analysis",getMpointNumByType:"/loong/api/mpoints/batch/all",getMpointDataImportList:"/loong/api/mpoint-data-imports",deleteMpointDataImport:"/loong/api/mpoint-data-imports",stopMpointDataImport:"/loong/api/mpoint-data-imports",pointDataImportTempleDownload:n.a+"/loong/api/mpoint-data-imports/templeDownload",pointDataImportFileUpload:n.a+"/loong/api/mpoint-data-imports/fileUpload"};e.a=i},529:function(t,e,a){"use strict";var n=a(518);a.n(n).a},530:function(t,e,a){(e=a(10)(!1)).push([t.i,"\n.cmp-dropdown-tree {\r\n    display: inline-block;\r\n    position: relative;\r\n    vertical-align: middle;\r\n    line-height: normal;\n}\n.ivu-form-item-error .cmp-dropdown-tree-label {\r\n    border: 1px solid #ed3f14;\n}\n.ivu-form-item-error .cmp-dropdown-tree-arrow {\r\n    border-left: 1px solid #ed3f14;\n}\n.cmp-dropdown-tree-label {\r\n    height: 28px;\r\n    width: 100%;\r\n    border: 1px solid #eaeaea;\r\n    display: flex;\r\n    border-radius: 3px;\r\n    cursor: pointer;\n}\n.cmp-dropdown-tree-text {\r\n    line-height: 28px;\r\n    text-indent: 5px;\r\n    flex: 1;\r\n    white-space: nowrap;\r\n    text-overflow: ellipsis;\r\n    overflow: hidden;\n}\n.cmp-dropdown-tree-arrow {\r\n    margin-top: -1px;\r\n    width: 28px;\r\n    height: 28px;\r\n    border-left: 1px solid #eaeaea;\r\n    text-align: center;\r\n    line-height: 28px;\n}\n.cmp-dropdown-tree .ivu-input-group-append {\r\n    width: 25px;\r\n    height: 28px;\r\n    overflow: hidden;\r\n    padding: 0;\n}\n.cmp-dropdown-tree .ivu-btn {\r\n    padding: 5px 10px;\n}\n.cmp-dropdown-tree-tree {\r\n    z-index: 901;\r\n    position: absolute;\r\n    top: 37px;\r\n    left: 0;\r\n    min-width: 300px;\r\n    max-height: 400px;\r\n    overflow: auto;\r\n    padding: 5px 10px;\r\n    background-color: #fff;\r\n    box-shadow: 1px 1px 5px #999;\r\n    border-radius: 3px;\n}\r\n",""]),t.exports=e},531:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.hideTree,expression:"hideTree"}],staticClass:"cmp-dropdown-tree",style:{width:t.width+"px"}},[a("div",{staticClass:"cmp-dropdown-tree-label",on:{click:t.labelClick}},[a("div",{staticClass:"cmp-dropdown-tree-text"},[t._v(t._s(t.value.title))]),t._v(" "),a("div",{staticClass:"cmp-dropdown-tree-arrow"},[a("Icon",{directives:[{name:"show",rawName:"v-show",value:1!=t.isShowTree,expression:"isShowTree != true"}],attrs:{type:"ios-arrow-down"}}),t._v(" "),a("Icon",{directives:[{name:"show",rawName:"v-show",value:1==t.isShowTree,expression:"isShowTree == true"}],attrs:{type:"ios-arrow-up"}})],1)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowTree,expression:"isShowTree"}],staticClass:"cmp-dropdown-tree-tree"},[a("Tree",{attrs:{data:t.datas,"show-checkbox":t.showCheckbox,multiple:t.multiple},on:{"on-select-change":t.selectTree}})],1)])};n._withStripped=!0;var i=a(11),o=a(146),r=a(147);function s(t){return function(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(t){!function t(e){e.forEach((function(e,a){e.childrenIds=function t(e,a){a=a||[];return e.forEach((function(e){e.children.length&&t(e.children,a),a.push(Math.abs(e.id))})),a}(e.children),e.children.length&&t(e.children)}))}(t)}var p={name:"myProcessTreeAuthority",mixins:[o.a],props:{field:String,value:Object,data:Array,url:String,query:Object,showCheckbox:Boolean,multiple:Boolean,width:{type:[Number,String],default:300},type:String},watch:{"value.id":function(t){t?this.flatDatas.length&&(i.a.setTrueTreeExpand(this.datas,t),i.a.setTrueTreeSelected(this.datas,t)):(!function t(e){for(var a,n=e.length,i=0;i<n;i++)1==(a=e[i]).selected&&(a.selected=!1),a.children.length&&t(a.children)}(this.datas),this.$emit("input",{id:"",title:"请选择"}))},data:function(t){this.datas=t}},data:function(){return{datas:this.data,flatDatas:[],isShowTree:!1}},methods:{selectTree:function(t){var e=this,a=[],n=[],i=[],o=this.field||"id",r=[];t.forEach((function(t){a.push(Math.abs(t[o])),n.push(t.key),i.push(t.title),r=r.concat(Math.abs(t[o]),t.childrenIds)})),r=s(new Set(r)),this.$emit("input",{id:a.join(),key:n.join(),title:i.join(),childrenIds:r}),this.$emit("on-change",{id:a.join(),key:n.join(),title:i.join(),childrenIds:r}),this.multiple||(this.isShowTree=!1),setTimeout((function(){e.dispatch("FormItem","on-form-change",{id:a.join(),key:n.join(),title:i.join(),childrenIds:r})}),100)},hideTree:function(){this.isShowTree=!1},labelClick:function(){this.isShowTree=!this.isShowTree}},directives:{clickoutside:r.a},mounted:function(){var t=this;this.url&&this.$http.get(this.url,this.query).then((function(e){e&&e.length&&(e.forEach((function(t){!1===t.authorized&&(t.render=function(t,e){e.root,e.node;return t("span",[e.data.name])})})),"EQUTYPE"==t.type&&e.forEach((function(t){var a=e.filter((function(e){return e.parentId==t.id}));("org"==t.type||a.length>0)&&(t.render=function(t,e){e.root,e.node;return t("span",[e.data.name])})})),"PROCESS"==t.type&&e.forEach((function(t){1==t.type&&(t.render=function(t,e){e.root,e.node;return t("span",[e.data.name])})})),t.flatDatas=e,t.value.id&&(i.a.setTreeExpand(t.flatDatas,t.value.id),i.a.setFlatTreeSelected(t.flatDatas,t.value.id)),t.datas=i.a.transDataToTree(t.flatDatas),l(t.datas))}))}},c=(a(529),a(1)),u=Object(c.a)(p,n,[],!1,null,null,null);u.options.__file="src/components/my-process-tree-authority.vue";e.a=u.exports},532:function(t,e,a){"use strict";var n=a(22),i={getAllEqu:"/equipment/api/equipments",deleteEqu:"/equipment/api/equipments",getEquDetail:"/equipment/api/equipments/detail/",saveEqu:"/equipment/api/equipments/detail",delAttachment:"/equipment/api/equ-attachs",getSingleEqu:"/equipment/api/equipments/",getParentEqu:"/equipment/api/equipments/parent/",getEquState:"/equipment/api/equipments/state/",getRemarkByEqu:"/equipment/api/equ-comments",addRemarkByEqu:"/equipment/api/equ-comments",pointsByEqu:"/equipment/api/equipments/mpoint",alarmByEqu:"/equipment/api/alarm-records",equRelPoints:"/equipment/api/mpoints/dropdown-box",getQrcode:n.a+"/equipment/api/equipments/qrcode-export",import:"/equipment/api/excel-import",saveExcelData:"/equipment/api/excel-data-save",cancelExcelData:"/equipment/api/excel-data-cancel",getExcel:n.a+"/equipment/api/excel-temlate-down",importExcel:n.a+"/equipment/api/excel-import",qrcodeExportStart:"/equipment/api/equipments/qrcode-export",qrcodeExportProgress:"/equipment/api/equipments/qrcode-export/progress",qrcodeExportDownload:n.a+"/equipment/api/equipments/qrcode-export/download",equTypeTree:"/equipment/api/equ-types/tree",equTypes:"/equipment/api/equ-types",equType:"/equipment/api/equ-types",gatewayParseMethod:"/box/api/terminals/parse-method",getTerminalList:"/box/api/terminals",terminalDetail:"/box/api/terminals/",addTerminal:"/box/api/terminals",delTerminal:"/box/api/terminals",simSelect:"/box/api/sim-manager/cards/select"};e.a=i},541:function(t,e,a){var n=a(575);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(17).default)("273e46e9",n,!1,{})},548:function(t,e,a){"use strict";a(22);e.a={getTask:"/loong/api/calc-tasks/origin-mpoint",getFormulas:"/loong/api/calc-tasks/formula",getFormula:"/loong/api/calc-formulas",editPointSimple:"/loong/api/calc-tasks/target-mpoint",getCalcTask:"/loong/api/calc-parms",delTaskCalc:"/loong/api/calc-tasks",getTasks:"/loong/api/calc-tasks",setTaskStatus:"/loong/api/calc-tasks/status",getTaskLog:"/loong/api/calc-tasks/log",refreshTalc:"/loong/api/calc-tasks/complement",refreshTalcBatch:"/loong/api/calc-tasks/batch-complements"}},574:function(t,e,a){"use strict";var n=a(541);a.n(n).a},575:function(t,e,a){(e=a(10)(!1)).push([t.i,".c-form-common .siteTreeHight .cmp-dropdown-tree {\n  width: 100% !important;\n}\n.c-form-common .form-custom .ivu-form-item-content {\n  margin-left: 0 !important;\n}\n.c-form-common .c-custom-left {\n  float: left;\n}\n.c-form-common .c-custom-right {\n  float: right;\n  padding-left: 10px;\n}\n.c-form-common .w0 {\n  width: 0;\n}\n.c-form-common .w35 {\n  width: 35%;\n}\n.c-form-common .w65 {\n  width: 65%;\n}\n.c-form-common .w100 {\n  width: 100%;\n}\n",""]),t.exports=e},577:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"c-form-common"},[a("div",{staticClass:"c-title-css"},[t._v("基本信息")]),t._v(" "),a("div",{staticStyle:{"padding-top":"20px"}},[a("Row",{staticStyle:{"padding-left":"20px"},style:{display:t.disabledBatch?"none":"block"}},[a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"siteTreeHight",attrs:{label:"区域位置:",prop:"siteId",required:""}},[a("my-process-tree-authority",{ref:"dropdownTree",attrs:{url:t.treeApi.getProcessTreeData},on:{"on-change":t.changeSite},model:{value:t.value.site,callback:function(e){t.$set(t.value,"site",e)},expression:"value.site"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"8",offset:"3"}},[a("FormItem",{attrs:{label:"测点名称:",prop:"mpointName"}},[a("Input",{attrs:{placeholder:"请输入测点名称"},model:{value:t.value.mpointName,callback:function(e){t.$set(t.value,"mpointName",e)},expression:"value.mpointName"}})],1)],1)],1),t._v(" "),a("Row",{staticStyle:{"padding-left":"20px"}},[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"测点类别:",prop:"mpointType"}},[a("Select",{on:{"on-change":t.changePointType},model:{value:t.value.mpointType,callback:function(e){t.$set(t.value,"mpointType",e)},expression:"value.mpointType"}},t._l(t.mpointType,(function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1),t._v(" "),a("Col",{attrs:{span:"8",offset:"3"}},[a("FormItem",{attrs:{label:"数据分类:",prop:"categoryId"}},[a("Select",{on:{"on-change":t.changeSetUnit},model:{value:t.value.categoryId,callback:function(e){t.$set(t.value,"categoryId",e)},expression:"value.categoryId"}},t._l(t.categoryList,(function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.categoryName))])})),1)],1)],1)],1),t._v(" "),a("Row",{staticStyle:{"padding-left":"20px"}},[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"信号类型:",prop:"datype"}},[a("Select",{on:{"on-change":t.datypeChange},model:{value:t.value.datype,callback:function(e){t.$set(t.value,"datype",e)},expression:"value.datype"}},t._l(t.datypeMap,(function(e,n){return a("Option",{key:n,attrs:{value:n}},[t._v(t._s(e))])})),1)],1)],1),t._v(" "),a("Col",{attrs:{span:"8",offset:"3"}},[a("FormItem",{attrs:{label:"显示小数位:",prop:"numtail"}},[a("Select",{attrs:{disabled:"State"==t.value.datype},model:{value:t.value.numtail,callback:function(e){t.$set(t.value,"numtail",e)},expression:"value.numtail"}},t._l(t.numtailMap,(function(e){return a("Option",{key:e.numtailName,attrs:{value:e.id}},[t._v(t._s(e.numtailName))])})),1)],1)],1)],1),t._v(" "),a("Row",{staticStyle:{"padding-left":"20px"}},[a("Col",{attrs:{span:"8"}},["State"==t.value.datype?a("FormItem",{class:["c-custom-left","-1"==t.value.enumvalue?"w65":"w100"],attrs:{label:"状态值:",prop:"enumvalue"}},[a("Select",{model:{value:t.value.enumvalue,callback:function(e){t.$set(t.value,"enumvalue",e)},expression:"value.enumvalue"}},t._l(t.statusMap,(function(e){return a("Option",{key:e.statusName,attrs:{value:e.id}},[t._v(t._s(e.statusName))])})),1)],1):t._e(),t._v(" "),"-1"==t.value.enumvalue&&"State"==t.value.datype?a("FormItem",{staticClass:"form-custom",class:["c-custom-right","-1"==t.value.enumvalue?"w35":"w0"],attrs:{prop:"enumvalueInput"}},[a("Input",{model:{value:t.value.enumvalueInput,callback:function(e){t.$set(t.value,"enumvalueInput",e)},expression:"value.enumvalueInput"}})],1):t._e()],1),t._v(" "),a("Col",{attrs:{span:"8"}},["State"!=t.value.datype?a("FormItem",{class:["c-custom-left","-1"==t.value.unit?"w65":"w100"],attrs:{label:"单位:",prop:"unit"}},[a("Select",{model:{value:t.value.unit,callback:function(e){t.$set(t.value,"unit",e)},expression:"value.unit"}},t._l(t.unitMap,(function(e,n){return a("Option",{key:n,attrs:{value:n}},[t._v(t._s(e))])})),1)],1):t._e(),t._v(" "),"-1"==t.value.unit&&"State"!=t.value.datype?a("FormItem",{staticClass:"form-custom",class:["c-custom-right","-1"==t.value.unit?"w35":"w0"],attrs:{prop:"unitInput"}},[a("Input",{model:{value:t.value.unitInput,callback:function(e){t.$set(t.value,"unitInput",e)},expression:"value.unitInput"}})],1):t._e()],1),t._v(" "),t.showPoint?a("Col",{attrs:{span:"8",offset:"3"}},[a("FormItem",{attrs:{label:"点位:",prop:"point"}},[a("Input",{attrs:{placeholder:"请输入点位"},model:{value:t.value.point,callback:function(e){t.$set(t.value,"point",e)},expression:"value.point"}})],1)],1):t._e()],1),t._v(" "),a("Row",{staticStyle:{"padding-left":"20px"}},[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"所属设备:"}},[t._v("\n                    "+t._s(t.value.equipmentName)+"\n                    "),a("a",{staticClass:"c-btn-text",attrs:{href:"javascript:;"},on:{click:t.openEquList}},[t._v("[选择设备]")]),t._v(" "),a("a",{staticClass:"c-btn-text",attrs:{href:"javascript:;"},on:{click:t.clearEquBind}},[t._v("[清除]")])])],1),t._v(" "),a("Col",{attrs:{span:"8",offset:"3"}},[a("FormItem",{attrs:{label:"曲线Y轴量程:"}},[a("Input",{staticStyle:{width:"80px"},attrs:{placeholder:"最小值"},on:{"on-blur":function(e){return t.checkCurve("curveYaxisLowerRange")}},model:{value:t.value.curveYaxisLowerRange,callback:function(e){t.$set(t.value,"curveYaxisLowerRange",e)},expression:"value.curveYaxisLowerRange"}}),t._v("-\n                    "),a("Input",{staticStyle:{width:"80px"},attrs:{placeholder:"最大值"},on:{"on-blur":function(e){return t.checkCurve("curveYaxisUpperRange")}},model:{value:t.value.curveYaxisUpperRange,callback:function(e){t.$set(t.value,"curveYaxisUpperRange",e)},expression:"value.curveYaxisUpperRange"}})],1)],1)],1),t._v(" "),a("Row",{staticStyle:{"padding-left":"20px"}},[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"备注:",prop:"remarks"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:5}},model:{value:t.value.remarks,callback:function(e){t.$set(t.value,"remarks",e)},expression:"value.remarks"}})],1)],1)],1)],1),t._v(" "),a("Modal",{attrs:{width:"600",title:"选择所属设备"},model:{value:t.isShowEqu,callback:function(e){t.isShowEqu=e},expression:"isShowEqu"}},[a("mg-single-select-table",{ref:"modalTable",attrs:{columns:t.modalColumns,url:t.modalUrl,manual:!0},on:{"on-select":t.equSelect}}),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"})],1)],1)};n._withStripped=!0;var i=a(23),o=a(531),r=a(107),s=a(520),l=(a(11),a(149)),p=a(532),c={props:{value:Object},watch:{"value.curveYaxisLowerRange":function(t){this.checkCurve("curveYaxisLowerRange")},"value.curveYaxisUpperRange":function(t){this.checkCurve("curveYaxisUpperRange")}},components:{myProcessTreeAuthority:o.a,mgSingleSelectTable:l.a},data:function(){return{showPoint:!1,disabledBatch:!1,treeApi:r.a,categoryList:[],unitDefalutMap:{"-2":"无","-1":"自定义"},mpointType:[{label:"工艺测点",value:1},{label:"设备测点",value:2}],modalColumns:[{title:"设备编号",key:"code"},{title:"设备类型",key:"typeName"},{title:"设备名称",key:"name"}],modalUrl:p.a.getAllEqu,isShowEqu:!1}},created:function(){this.unitMap=this.unitDefalutMap},computed:Object(i.b)({datypeMap:function(t){return t.map.mpoint.datypeText},numtailMap:function(t){return t.map.mpoint.numtail},statusMap:function(t){return t.map.mpoint.status}}),methods:{changeSite:function(t){this.value.siteId=t.id,this.value.siteName=t.title,this.value.equipment="",this.value.equipmentName=""},changeSetUnit:function(t){var e=(this.categoryList.filter((function(e){return e.id==t}))[0]||{}).unit,a=null==e?[]:e.split(";"),n={};a.forEach((function(t){return n[t]=t})),this.unitMap=Object.assign({},n,this.unitDefalutMap)},datypeChange:function(t){if("State"==t){if(this.value.enumvalue||(this.value.enumvalue="0,关;1,开;"),this.value.tabs){var e=[];this.value.tabs.forEach((function(t){"pretreatment"!=t.type&&e.push(t)})),this.value.tabs=e}}else{var a=!1;this.value.tabs&&this.value.tabs.forEach((function(t){"pretreatment"==t.type&&(a=!0)})),a||this.value.tabs&&this.value.tabs.unshift({type:"pretreatment"})}},openEquList:function(){this.isShowEqu=!0,this.$refs.modalTable.getData({processIds:this.value.siteId})},equSelect:function(t){this.value.equipment=t.id,this.value.equipmentName=t.name,this.isShowEqu=!1},changePointType:function(t,e){var a=this;this.$http.get(s.a.getCategroyData,{mpointType:t}).then((function(t){a.categoryList=t,e?e():a.value.categoryId=""}))},checkCurve:function(t){var e=this.value[t];Number.isNaN(Number(e))&&(this.value[t]=null)},clearEquBind:function(){this.value.equipment="",this.value.equipmentName=""}}},u=(a(574),a(1)),m=Object(u.a)(c,n,[],!1,null,null,null);m.options.__file="src/views/mpoint/mpoint/components/form-common.vue";e.a=m.exports},578:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.value?a("div",[a("Input",{attrs:{readonly:"",disabled:t.disabled,placeholder:"测点"},on:{"on-focus":function(e){t.show=!0}},model:{value:t.value.title||"",callback:function(e){t.$set(t.value,"title||''",e)},expression:" value.title||'' "}})],1):t._e(),t._v(" "),a("Modal",{ref:"modal1",attrs:{"mask-closable":!1,title:"测点列表选择",width:"600",closable:""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("Row",[a("Col",{attrs:{xs:6,sm:6,md:6,lg:6}},[a("Input",{attrs:{size:"default",placeholder:"测点编号/名称"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.searchParams.queryName,callback:function(e){t.$set(t.searchParams,"queryName",e)},expression:"searchParams.queryName"}})],1),t._v(" "),a("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",shape:"circle"},on:{click:t.search}},[t._v("搜索")])],1),t._v(" "),a("br"),t._v(" "),a("Table",{ref:"table1",attrs:{columns:t.columns,data:t.listData,loading:t.loading,size:"small",stripe:""},on:{"on-select-all":t.onSelect,"on-select":t.onSelect,"on-selection-change":t.selectChange}}),t._v(" "),a("Page",{staticClass:"table-page",attrs:{total:t.total,"page-size":t.searchParams.pageSize,current:t.searchParams.currentPage,"show-total":"","show-elevator":"",size:"small"},on:{"on-change":t.pageChange}}),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},["multiple"==t.type?a("div",{staticClass:"c-modal-footer-btns"},[a("Button",{attrs:{type:"default",shape:"circle",size:"large"},on:{click:function(e){t.show=!1}}},[t._v("取消")]),t._v(" "),a("Button",{attrs:{type:"primary",shape:"circle",size:"large"},on:{click:t.chooses}},[t._v("确定")])],1):t._e()])],1)],1)};n._withStripped=!0;var i=a(39),o=a(11),r={components:{commonApi:i.a,util:o.a},props:{value:Object,tag:"",type:{type:String,default:"single"},disabled:{type:Boolean,default:!1}},data:function(){return{show:!1,searchParams:{filterId:"",tag:this.tag,queryName:"",executeStatus:"",siteId:null,datasource:"",pageSize:10,currentPage:1},listData:[],selected:[],total:0,loading:!1,modalSelected:{}}},mounted:function(){this.search()},computed:{columns:function(){var t=this,e=[];return"multiple"==this.type&&e.push({type:"selection",width:60,align:"left"}),e.push({title:"测点编号",key:"mpointId"}),e.push({title:"区域位置",key:"siteName"}),e.push({title:"测点名称",key:"mpointName"}),"single"==this.type&&e.push({title:"操作",key:"action",width:100,render:function(e,a){return e("div",[o.a.tableBtnStyle(e,(function(){t.choose(a.row)}),"选择")])}}),e}},created:function(){o.a.initTableColumnTitle(this.columns)},methods:{selectChange:function(t){this.modalSelected[this.searchParams.currentPage]=t},getData:function(){var t=this;this.loading=!0,this.$http.get(i.a.point,this.searchParams).then((function(e){t.loading=!1,e&&e.total>=0&&(t.total=e.total,t.listData=e.items?e.items:[],t.checkSelection(t.searchParams.currentPage))}))},checkSelection:function(t){var e=this,a=this.modalSelected[t]||[];this.listData.forEach((function(t){e.$set(t,"_checked",!1),a.forEach((function(a){a.id==t.id&&e.$set(t,"_checked",!0)}))}))},search:function(){this.modalSelected={},this.searchParams.currentPage=1,this.getData()},pageChange:function(t){this.searchParams.currentPage=t,this.getData()},onSelect:function(t,e){this.selected=t},choose:function(t){this.show=!1,this.value?(this.value.id=t.id,this.value.title=t.mpointName,this.value.unit=t.unit,this.$emit("input",this.value)):this.$emit("input",{id:t.id,title:t.mpointName,unit:t.unit})},chooses:function(){if(this.show=!1,"datainput"==this.tag){var t=[],e=this.modalSelected;for(var a in e)e[a].forEach((function(e){t.push(e)}));this.$emit("input",t)}else this.$emit("input",this.selected)}}},s=a(1),l=Object(s.a)(r,n,[],!1,null,null,null);l.options.__file="src/components/point-table-select.vue";e.a=l.exports},702:function(t,e,a){var n=a(942);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(17).default)("d0d4a12e",n,!1,{})},940:function(t,e,a){!function(a){"use strict";var n=function(t,e){var a=new Error(t+" at character "+e);throw a.index=e,a.description=t,a},i={"-":!0,"!":!0,"~":!0,"+":!0},o={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},r=function(t){var e,a=0;for(var n in t)(e=n.length)>a&&t.hasOwnProperty(n)&&(a=e);return a},s=r(i),l=r(o),p={true:!0,false:!1,null:null},c=function(t){return o[t]||0},u=function(t,e,a){return{type:"||"===t||"&&"===t?"LogicalExpression":"BinaryExpression",operator:t,left:e,right:a}},m=function(t){return t>=48&&t<=57},d=function(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=128&&!o[String.fromCharCode(t)]},h=function(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||t>=128&&!o[String.fromCharCode(t)]},f=function(t){for(var e,a,r=0,f=t.charAt,v=t.charCodeAt,g=function(e){return f.call(t,e)},y=function(e){return v.call(t,e)},x=t.length,b=function(){for(var t=y(r);32===t||9===t||10===t||13===t;)t=y(++r)},w=function(){var t,e,a=S();return b(),63!==y(r)?a:(r++,(t=w())||n("Expected expression",r),b(),58===y(r)?(r++,(e=w())||n("Expected expression",r),{type:"ConditionalExpression",test:a,consequent:t,alternate:e}):void n("Expected :",r))},k=function(){b();for(var e=t.substr(r,l),a=e.length;a>0;){if(o.hasOwnProperty(e)&&(!d(y(r))||r+e.length<t.length&&!h(y(r+e.length))))return r+=a,e;e=e.substr(0,--a)}return!1},S=function(){var t,e,a,i,o,s,l,p;if(s=_(),!(e=k()))return s;for(o={value:e,prec:c(e)},(l=_())||n("Expected expression after "+e,r),i=[s,o,l];(e=k())&&0!==(a=c(e));){for(o={value:e,prec:a};i.length>2&&a<=i[i.length-2].prec;)l=i.pop(),e=i.pop().value,s=i.pop(),t=u(e,s,l),i.push(t);(t=_())||n("Expected expression after "+e,r),i.push(o,t)}for(t=i[p=i.length-1];p>1;)t=u(i[p-1].value,i[p-2],t),p-=2;return t},_=function(){var e,a,n;if(b(),e=y(r),m(e)||46===e)return q();if(39===e||34===e)return C();if(91===e)return $();for(n=(a=t.substr(r,s)).length;n>0;){if(i.hasOwnProperty(a)&&(!d(y(r))||r+a.length<t.length&&!h(y(r+a.length))))return r+=n,{type:"UnaryExpression",operator:a,argument:_(),prefix:!0};a=a.substr(0,--n)}return!(!d(e)&&40!==e)&&E()},q=function(){for(var t,e,a="";m(y(r));)a+=g(r++);if(46===y(r))for(a+=g(r++);m(y(r));)a+=g(r++);if("e"===(t=g(r))||"E"===t){for(a+=g(r++),"+"!==(t=g(r))&&"-"!==t||(a+=g(r++));m(y(r));)a+=g(r++);m(y(r-1))||n("Expected exponent ("+a+g(r)+")",r)}return e=y(r),d(e)?n("Variable names cannot start with a number ("+a+g(r)+")",r):46===e&&n("Unexpected period",r),{type:"Literal",value:parseFloat(a),raw:a}},C=function(){for(var t,e="",a=g(r++),i=!1;r<x;){if((t=g(r++))===a){i=!0;break}if("\\"===t)switch(t=g(r++)){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+=t}else e+=t}return i||n('Unclosed quote after "'+e+'"',r),{type:"Literal",value:e,raw:a+e+a}},I=function(){var e,a=y(r),i=r;for(d(a)?r++:n("Unexpected "+g(r),r);r<x&&(a=y(r),h(a));)r++;return e=t.slice(i,r),p.hasOwnProperty(e)?{type:"Literal",value:p[e],raw:e}:"this"===e?{type:"ThisExpression"}:{type:"Identifier",name:e}},T=function(t){for(var e,a,i=[],o=!1;r<x;){if(b(),(e=y(r))===t){o=!0,r++;break}44===e?r++:((a=w())&&"Compound"!==a.type||n("Expected comma",r),i.push(a))}return o||n("Expected "+String.fromCharCode(t),r),i},E=function(){var t,e;for(e=40===(t=y(r))?M():I(),b(),t=y(r);46===t||91===t||40===t;)r++,46===t?(b(),e={type:"MemberExpression",computed:!1,object:e,property:I()}):91===t?(e={type:"MemberExpression",computed:!0,object:e,property:w()},b(),93!==(t=y(r))&&n("Unclosed [",r),r++):40===t&&(e={type:"CallExpression",arguments:T(41),callee:e}),b(),t=y(r);return e},M=function(){r++;var t=w();if(b(),41===y(r))return r++,t;n("Unclosed (",r)},$=function(){return r++,{type:"ArrayExpression",elements:T(93)}},D=[];r<x;)59===(e=y(r))||44===e?r++:(a=w())?D.push(a):r<x&&n('Unexpected "'+g(r)+'"',r);return 1===D.length?D[0]:{type:"Compound",body:D}};f.version="0.3.4",f.toString=function(){return"JavaScript Expression Parser (JSEP) v"+f.version},f.addUnaryOp=function(t){return s=Math.max(t.length,s),i[t]=!0,this},f.addBinaryOp=function(t,e){return l=Math.max(t.length,l),o[t]=e,this},f.addLiteral=function(t,e){return p[t]=e,this},f.removeUnaryOp=function(t){return delete i[t],t.length===s&&(s=r(i)),this},f.removeAllUnaryOps=function(){return i={},s=0,this},f.removeBinaryOp=function(t){return delete o[t],t.length===l&&(l=r(o)),this},f.removeAllBinaryOps=function(){return o={},l=0,this},f.removeLiteral=function(t){return delete p[t],this},f.removeAllLiterals=function(){return p={},this},t.exports?e=t.exports=f:e.parse=f}()},941:function(t,e,a){"use strict";var n=a(702);a.n(n).a},942:function(t,e,a){(e=a(10)(!1)).push([t.i,".c-paramter-layout {\n  position: relative;\n  top: -5px;\n}\n.c-paramter-layout td {\n  padding-right: 15px;\n}\n.c-paramter-layout .c-form-required {\n  font-family: SimSun;\n  position: relative;\n  font-size: 12px;\n  top: 4px;\n  left: 0;\n  color: #ed3f14;\n}\n.c-paramter-layout .ivu-form-item-error-tip {\n  left: inherit;\n  right: -85px;\n  margin-top: -28px;\n}\n.c-custom-mpoint-form .w100 {\n  width: 100%;\n}\n",""]),t.exports=e}}]);