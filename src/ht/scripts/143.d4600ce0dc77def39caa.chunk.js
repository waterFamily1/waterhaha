(window.webpackJsonp=window.webpackJsonp||[]).push([[143],{1169:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"c-main-border"},[i("div",{staticClass:"c-left-border-blue"},[i("h3",[e._v("仓库新增")]),e._v(" "),i("div",{staticClass:"c-btns-right"},[i("Button",{directives:[{name:"role",rawName:"v-role",value:"repertory-add",expression:"'repertory-add'"}],attrs:{type:"primary",shape:"circle",loading:e.submitLoading},on:{click:e.submit}},[e._v("保存")]),e._v(" "),i("Button",{staticClass:"c-btn-back",attrs:{type:"default",shape:"circle"},on:{click:e.backClick}},[e._v("取消")])],1)]),e._v(" "),i("Form",{ref:"repertoryAddForm",attrs:{model:e.params,rules:e.formRules,"label-width":100}},[i("div",{staticClass:"c-top-border-gray"},[i("div",{staticClass:"c-form-row-2col"},[i("div",{staticClass:"c-form-item"},[i("FormItem",{attrs:{prop:"orgId",label:"所属组织："}},[i("dropdown-tree",{attrs:{url:e.orgTreeApi},on:{input:e.chooseOrg},model:{value:e.org,callback:function(t){e.org=t},expression:"org"}})],1)],1),e._v(" "),i("div",{staticClass:"c-form-item"},[i("FormItem",{attrs:{prop:"name",label:"仓库名称："}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text"},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}})],1)],1)]),e._v(" "),i("div",{staticClass:"c-form-row-2col"},[i("div",{staticClass:"c-form-item"},[i("FormItem",{attrs:{prop:"personInCharge",label:"负责人："}},[i("Select",{staticStyle:{width:"300px"},model:{value:e.params.personInCharge,callback:function(t){e.$set(e.params,"personInCharge",t)},expression:"params.personInCharge"}},e._l(e.personInCharge,(function(t,r){return i("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1)],1),e._v(" "),i("div",{staticClass:"c-form-item"},[i("FormItem",{attrs:{prop:"address",label:"仓库地址："}},[i("Input",{staticStyle:{width:"300px"},attrs:{type:"text"},model:{value:e.params.address,callback:function(t){e.$set(e.params,"address",t)},expression:"params.address"}})],1)],1)])]),e._v(" "),i("div",{staticClass:"c-top-border-gray"},[i("div",{staticClass:"c-plain-bg-h"},[i("h3",[e._v("库位新增")]),e._v(" "),i("div",{staticClass:"repertory-add-btns c-btns-right"},[i("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle",size:"small"},on:{click:e.addRow}},[e._v("库位新增")])],1)]),e._v(" "),i("Table",{attrs:{columns:e.columns,data:e.params.warehousePositions,loading:e.loading,stripe:""}})],1)])],1)};r._withStripped=!0;var o=i(23),a=i(11),n=i(145),s=i(527),p=i(107),l={data:function(){var e=this;return{personInCharge:[],org:{id:"",title:"请选择"},params:{orgId:"",name:"",personInCharge:"",address:"",warehousePositions:[]},submitLoading:!1,formRules:{orgId:[{required:!0,validator:function(e,t,i){t?i():i(new Error("请选择组织"))}}],name:[{validator:function(t,i,r){i?e.$http.get(s.a.repertory.checkWarehousenameIsExist,{warehouseName:i}).then((function(e){e.isExist?r(new Error("仓库名称已存在")):r()})):r(new Error("仓库名称不能为空"))},required:!0,trigger:"blur"}],personInCharge:{required:!0,validator:function(e,t,i){t?i():i(new Error("请选择负责人"))}}},orgTreeApi:p.a.getOrgTreeData,columns:[{title:"库位编号",key:"locationNo",render:function(t,i){var r=e;return t("div",[t("Input",{props:{ref:"locationNo",value:i.row.locationNo,disabled:i.row.disabled},on:{input:function(e){i.row.locationNo=e,r.params.warehousePositions[i.index]=i.row}}})])}},{title:"描述",key:"description",render:function(t,i){var r=e;return t("div",[t("Input",{props:{value:i.row.description,disabled:i.row.disabled},on:{input:function(e){i.row.description=e,r.params.warehousePositions[i.index]=i.row}}})])}},{title:"操作",key:"act",width:200,render:function(t,i){var r=e;return t("div",[t("a",{attrs:{href:"javascript:;"},style:{color:"#4b7efe",margin:"0 10px 0 0"},on:{click:function(){r.params.warehousePositions.splice(i.index,1)}}},"删除")])}}],importUrl:s.a.repertory.importExcel,loading:!1}},computed:Object(o.b)({account:function(e){return e.user.account}}),methods:{initData:function(){var e="",t="",i=(this.account.name,this.account.id);this.account.orgChain.reverse().some((function(i){return 2==i.type&&(e=i.id,t=i.name,!0)})),e&&t&&(this.org.id=e,this.org.title=t,this.params.orgId=e,this.params.orgName=t,this.getUnderOrganizationUsers({id:e},(function(e){e.personInCharge.forEach((function(t){t.id==i&&(e.params.personInCharge=i)}))})))},getUnderOrganizationUsers:function(e,t){var i=this;this.$http.get(s.a.getManaginguser,{orgIds:e.id}).then((function(e){e&&e.items&&(i.personInCharge=e.items,t&&t(i))}))},submit:function(){var e=this,t=this;this.params.orgId=this.org.id,this.$refs.repertoryAddForm.validate((function(i){if(i)if(0==e.params.warehousePositions.length)e.$Modal.confirm({title:"提示",content:"尚未增加仓库库位，确认提交吗？",onOk:function(){e.submitLoading=!0,e.$http.post(s.a.repertory.addWarehouse,e.params).then((function(i){e.submitLoading=!1,i.id&&(e.$Notice.success({title:"保存成功！"}),t.$router.push({name:"storage-repertory-detail",params:{id:i.id}}))})).catch((function(){e.submitLoading=!1}))},onCancel:function(){}});else{if(t.params.warehousePositions.some((function(e,i){return!e.locationNo&&(t.$Notice.warning({title:"请输入第"+(i+1)+"行中的库位编号"}),!0)})))return!1;e.submitLoading=!0,e.$http.post(s.a.repertory.addWarehouse,e.params).then((function(i){e.submitLoading=!1,i.id&&(e.$Notice.success({title:"保存成功！"}),t.$router.push({name:"storage-repertory-detail",params:{id:i.id}}))})).catch((function(){e.submitLoading=!1}))}}))},backClick:function(){this.$router.back()},chooseOrg:function(){var e=this;this.params.orgId=this.org.id,this.params.personInCharge="",this.org.id&&(this.$http.get(s.a.getManaginguser,{orgIds:this.org.id}).then((function(t){e.personInCharge=t.items})),this.getUnderOrganizationUsers(this.org))},addRow:function(){this.params.warehousePositions.push({locationNo:"",description:""})}},created:function(){a.a.initTableColumnTitle(this.columns),this.initData()},components:{dropdownTree:n.a}},c=(i(995),i(1)),u=Object(c.a)(l,r,[],!1,null,null,null);u.options.__file="src/views/storage/repertory/add.vue";t.default=u.exports},527:function(e,t,i){"use strict";var r=i(22),o={getWarehouseComboList:"/inventory/api/warehouse/comboList",getManaginguser:"/inventory/api/users/managinguser",category:{getTree:"/inventory/api/materiel-category/tree",getInfo:"/inventory/api/materiel-category/materiel",add:"/inventory/api/materiel-category/materiel",edit:"/inventory/api/materiel-category/materiel",del:"/inventory/api/materiel-category/materiel",search:"/inventory/api/materiel-category/list"},inventory:{audit:"/inventory/api/store-adjustment/audited",export:r.a+"/inventory/api/store-adjustment/export",url:"/inventory/api/store-adjustment/adjusment",list:"/inventory/api/store-adjustment/list",detailList:"/inventory/api/store-adjustment/detail/list",itemList:"/inventory/api/store-adjustment/materiel/list",move:"/inventory/api/store-adjustment/move",materielSearch:"/inventory/api/stock/materiel",materielPosition:"/inventory/api/stock/position",materielDepot:"/inventory/api/stock/warehous"},takeStock:{audit:"/inventory/api/materiel-inventory/audited",export:r.a+"/inventory/api/materiel-inventory/export",import:r.a+"/inventory/api/materiel-inventory/import",url:"/inventory/api/materiel-inventory/inventory",detailList:"/inventory/api/materiel-inventory/detail/list",list:"/inventory/api/materiel-inventory/list"},storage:{comboList:"/inventory/api/warehouse/comboList"},material:{getMaterielCategoryTree:"/inventory/api/materiel-category/tree/external",getMateriel:"/inventory/api/materiels",delMateriel:"/inventory/api/materiels",exportMateriel:r.a+"/inventory/api/materiels/excel-export",addMateriel:"/inventory/api/materiel",changeMateriel:"/inventory/api/materiel",getMaterielDetail:"/inventory/api/materiel",getDistribution:"/inventory/api/materielStocks/distribution",getMaterielStockLimits:"/inventory/api/materielStockLimits",bacthAddMaterielStockLimit:"/inventory/api/materielStockLimit/batch-save",updateMaterielStockLimit:"/inventory/api/materielStockLimit",delMaterielStockLimit:"/inventory/api/materielStockLimits",getUnitList:"/inventory/api/materiel/unit",modalMateriel:"/inventory/api/materiel/external",getExcel:r.a+"/inventory/api/excel-temlate-down",importExcel:r.a+"/inventory/api/excel-import",cancelExcelData:"/inventory/api/excel-data-cancel",saveExcelData:"/inventory/api/excel-data-save"},repertory:{getWarehouses:"/inventory/api/warehouses",exportWarehouse:r.a+"/inventory/api/warehouse/excel-export",delWarehouses:"/inventory/api/warehouses",changeWarehouses:"/inventory/api/warehouse",addWarehouse:"/inventory/api/warehouse",getWarehouseDetail:"/inventory/api/warehouse",getWarehouseInfo:"/inventory/api/warehouse/getWarehouseInfo",getPositionOfWarehouse:"/inventory/api/warehousePosition/positionList",bacthAddWarehouseposition:"/inventory/api/warehouseposition/batch-save",updateWarehousePosition:"/inventory/api/warehousePosition",delWarehousePosition:"/inventory/api/warehousePositions",positionByWarehouse:"/inventory/api/warehousePosition/move",checkWarehousenameIsExist:"/inventory/api/warehouse/check-warehousename-isexist",getExcel:r.a+"/inventory/api/warehousePosition/excel-temlate-down",importExcel:r.a+"/inventory/api/warehousePosition/excel-import",cancelExcelData:"/inventory/api/warehousePosition/excel-data-cancel",saveExcelData:"/inventory/api/warehousePosition/excel-data-save"},checkin:{getInbond:"/inventory/api/inbounds",delInbond:"/inventory/api/inbounds",addInbond:"/inventory/api/inbound",getInbondDetail:"/inventory/api/inbound",getInbondRecordList:"/inventory/api/inbound/inboundDetails",getPositionComboxList:"/inventory/api/warehousePosition/positionComboxList",auditeInbound:"/inventory/api/inbound/audite",getMaterielsByWareHouseNo:"/inventory/api/materiel/getMaterielsByWareHouseNo",getMateriels:"/inventory/api/materiel/getMateriels",updateInboundDetail:"/inventory/api/inboundDetail"},checkout:{getApplicantMember:"/uaa/api/users/select",getOutbond:"/inventory/api/outbounds",delOutbond:"/inventory/api/outbounds",addOutbond:"/inventory/api/outbound",getOutbondDetail:"/inventory/api/outbound",getOutbondRecordList:"/inventory/api/outboundDetail",auditeOutbound:"/inventory/api/outbound/audite",updateOutboundDetail:"/inventory/api/outboundDetail",getstock:"/inventory/api/stock/getstock",getMaterielsOutBound:"/inventory/api/materiel/getMaterielsOutBound"},allot:{getTransfer:"/inventory/api/transfer/list",delTransfer:"/inventory/api/transfer/transfer",addTransfer:"/inventory/api/transfer/transfer",getTransferDetail:"/inventory/api/transfer/transfer",getTransferDetailList:"/inventory/api/transfer/detail/list",auditTransfer:"/inventory/api/transfer/audited",updateTransfer:"/inventory/api/transfer/transfer",getMaterielList:"/inventory/api/transfer/materiel/list",getStockPosiComboList:"/inventory/api/stock/position",getWarehousePosition:"/inventory/api/warehousePosition/move"},reporting:{getStockInfo:"/inventory/api/stock/getstock-info",exportStockInfo:r.a+"/inventory/api/stock/getstock-info-excel-export",getStockInoutbound:"/inventory/api/stock/getstock-info-inoutbound",exportStockInoutbound:r.a+"/inventory/api/stock/getstock-info-inoutbound-excel-export",getStockMove:"/inventory/api/stock/get-inventory-mobility-report",exportStockMove:r.a+"/inventory/api/stock/get-inventory-mobility-report-excel-export",getInventoryProfitLossList:"/inventory/api/materiel-inventory/inventory-report",exportInventoryProfitLoss:r.a+"/inventory/api/materiel-inventory/inventory-report-export",getInventoryNumberList:"/inventory/api/materiel-inventory/inventory-report-inventory-number"}};t.a=o},722:function(e,t,i){var r=i(996);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,i(17).default)("4efd77fd",r,!1,{})},995:function(e,t,i){"use strict";var r=i(722);i.n(r).a},996:function(e,t,i){(t=i(10)(!1)).push([e.i,"\n.repertory-add-btns .ivu-upload{\r\n  display:inline-block\n}\r\n",""]),e.exports=t}}]);