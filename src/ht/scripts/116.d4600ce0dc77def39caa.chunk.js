(window.webpackJsonp=window.webpackJsonp||[]).push([[116],{1077:function(e,t,a){"use strict";var n=a(760);a.n(n).a},1078:function(e,t,a){(t=a(10)(!1)).push([e.i,"\n.base-org-detail {\r\n    padding: 20px 50px;\n}\n.base-org-detail h4 {\r\n    height: 30px;\r\n    margin-top: 10px;\n}\n.base-org-border {\r\n    border-bottom: 1px dashed #f0f0f0;\n}\n.base-org-detail .ivu-form-item {\r\n    margin-bottom: 10px;\n}\n.base-org-detail .c-form-item label {\r\n    width: 70px;\n}\r\n",""]),e.exports=t},1141:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"c-tree"},[a("div",{staticClass:"c-tree-left",attrs:{id:"J_TREE_LEFT"}},[e._m(0),e._v(" "),a("div",{staticStyle:{padding:"2px"}},[a("Select",{staticStyle:{width:"100%"},attrs:{placeholder:"输入标签名称以检索",clearable:"",filterable:"",remote:"","remote-method":e.onSearch,loading:e.searchLoading},on:{"on-change":e.onSearchItemClick}},e._l(e.searchItems,(function(t){return a("Option",{key:t.id,attrs:{value:JSON.stringify(t)}},[e._v(e._s(t.name))])})),1)],1),e._v(" "),a("div",{staticClass:"padding-l-10"},[a("Tree",{attrs:{data:e.treeData,render:e.renderContent}})],1)]),e._v(" "),a("div",{staticClass:"c-main-border c-tree-right"},[a("div",{staticClass:"c-plain-bg-h"},[a("h3",[e._v("标签信息")]),e._v(" "),a("div",{staticClass:"c-btns-right"},[a("Button",{directives:[{name:"show",rawName:"v-show",value:"info"!=e.status,expression:"status != 'info'"}],attrs:{type:"primary",shape:"circle"},on:{click:e.submit}},[e._v("保存")]),e._v(" "),a("Button",{directives:[{name:"show",rawName:"v-show",value:"info"!=e.status,expression:"status != 'info'"}],staticClass:"v-btn-back",attrs:{type:"default",shape:"circle"},on:{click:e.cancel}},[e._v("取消")])],1)]),e._v(" "),a("div",{staticClass:"base-org-detail"},[a("Form",{ref:"form",attrs:{model:e.params,rules:e.rules}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isCurrentLabel,expression:"isCurrentLabel"}],staticStyle:{"margin-bottom":"20px"}},[a("h4",[e._v("当前标签")]),e._v(" "),a("div",{staticClass:"base-org-border"},["info"==e.status?a("span",[e._v(e._s(e.activeData.name))]):e._e(),e._v(" "),"add"==e.status||"edit"==e.status?a("FormItem",{attrs:{prop:"name"}},[a("Input",{staticStyle:{width:"300px"},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}})],1):e._e()],1)]),e._v(" "),a("h4",[e._v("当前类别")]),e._v(" "),a("div",{staticClass:"base-org-border"},["info"==e.status?a("span",[e._v(e._s(e.activeData.parentName||e.activeData.name))]):e._e(),e._v(" "),"add"==e.status||"edit"==e.status?a("FormItem",{attrs:{prop:"type"}},[a("Input",{staticStyle:{width:"300px"},attrs:{disabled:e.isCurrentLabel},model:{value:e.params.type,callback:function(t){e.$set(e.params,"type",t)},expression:"params.type"}})],1):e._e()],1)])],1)])])};n._withStripped=!0;var i=a(23),r=a(554),s=(a(107),a(11)),o=a(544);function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var d={data:function(){return{status:"info",searchLoading:!1,searchItems:[],activeTreeId:"",treeData:[],activeData:{},params:{id:"",parentId:"",name:"",type:""},rules:{name:[{required:!0,message:"请输入名称",trigger:"change"},{max:10,message:"不能超过10个字符",trigger:"change"}],type:[{required:!0,message:"请选择类型",trigger:"change"},{max:10,message:"不能超过10个字符",trigger:"change"}]}}},computed:function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},Object(i.b)({account:function(e){return e.user.account}}),{isCurrentLabel:function(){return 2===this.activeData.type||1===this.activeData.type&&"add"==this.status}}),methods:{getLabelTree:function(e){var t=this;this.$http.get(r.a.getLabelTree).then((function(a){void 0!==e&&(s.a.setTreeExpand(a,e),t.activeTreeId=e),t.treeData=s.a.addTreeRoot(s.a.transDataToTree(a))}))},onSearch:function(e){var t=this;this.$http.get(r.a.getLabels,{queryName:e,currentPage:1,pageSize:0}).then((function(e){t.searchItems=e||[]}))},onSearchItemClick:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"{}",t=JSON.parse(e);t.id&&(this.getLabelTree(t.id),this.showInfo(t))},submit:function(){var e=this,t=this.status;this.rules.name[0].required=this.isCurrentLabel,this.$refs.form.validate((function(a){if(a){var n={tenantId:e.activeData.tenantId,name:e.isCurrentLabel?e.params.name:e.params.type,parentId:e.activeData.parentId,parentName:e.isCurrentLabel?e.params.type:"",type:e.isCurrentLabel?2:1};"add"==t&&(n.parentId=e.activeData.id,n.tenantId=e.account.tenantId,e.$http.post(r.a.addLabel,n).then((function(t){t.id&&(e.showInfo(n),e.$Notice.success({title:"新建成功"}),e.getLabelTree(t.id))}))),"edit"==t&&(n.id=e.activeData.id,e.$http.put(r.a.updateLabel,n).then((function(t){t.count&&(e.showInfo(n),e.$Notice.success({title:"编辑成功"}),e.getLabelTree(n.id))})))}}))},cancel:function(){this.status="info"},showInfo:function(e){this.resetForm(),this.status="info",this.activeData=e,this.activeTreeId=e.id},editLabel:function(e){this.resetForm(),this.status="edit",this.activeData=e,this.params={id:e.id,parentId:e.parentId,name:e.name,type:e.parentName||e.name}},addLabel:function(e){this.resetForm(),this.status="add",this.activeData=e,this.params.type=1===e.type?e.name:""},delLabel:function(e){var t=this;this.$http.del(r.a.delLabel+e.id).then((function(a){a.count&&(t.showInfo({}),t.$Notice.success({title:"删除成功"}),t.getLabelTree(e.parentId))}))},renderContent:function(e,t){var a=this,n=(t.root,t.node,t.data),i=e("a",{attrs:{href:"javascript:;"},class:{"c-tree-btn-add":!0},on:{click:function(){a.addLabel(n)}}},["新建"]),r=e("a",{attrs:{href:"javascript:;"},class:{"c-tree-btn-edit":!0},on:{click:function(){a.editLabel(n)}}},["编辑"]),c=s.a.treeBtnDelStyle(e,(function(){a.delLabel(n)}),(function(){}),(function(){a.activeTreeId=n.id})),l=[],d=null;return n.isRoot&&o.a.authority("label-set")?e("div",{class:{"c-tree-row":!0}},[e("span",{style:{padding:"0 4px"}},n.name),e("span",{class:{"c-tree-btns":!0}},[i])]):(1===n.type&&o.a.authority("label-set")&&(l=[i,r,c]),2===n.type&&(o.a.authority("label-set")&&(l=[r,c]),d=e("Icon",{style:{color:"#4b7efe",margin:"0 2px",fontSize:"16px",verticalAlign:"text-bottom"},props:{type:"ios-pricetags-outline"}},[])),e("div",{class:{"c-tree-row":!0}},[d,e("span",{class:{"ivu-tree-title":!0,"ivu-tree-title-selected":n.id===this.activeTreeId},attrs:{title:n.name},on:{click:function(){a.showInfo(n)}}},[n.name]),e("span",{class:{"c-tree-btns":!0}},l)]))},resetForm:function(){this.params={id:"",parentId:"",name:"",type:""},this.$refs.form.resetFields()}},mounted:function(){this.getLabelTree(),s.a.setTreeLeftHeight()}},u=(a(1077),a(1)),p=Object(u.a)(d,n,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"c-plain-bg-h"},[t("h3",{staticStyle:{"line-height":"2"}},[this._v("标签中心")])])}],!1,null,null,null);p.options.__file="src/views/knowledge/label.vue";t.default=p.exports},544:function(e,t,a){"use strict";var n=a(49),i={authorityAdmin:function(e){if(-1!=e.indexOf("ROLE_TENANT_ADMIN")||-1!=e.indexOf("UAA_ROLE_EDIT"))return!0},authorityEquAdmin:function(e){if(-1!=e.indexOf("ROLE_TENANT_ADMIN")||-1!=e.indexOf("EQU_EQUTYPE_EDIT"))return!0},authorityProcAdmin:function(e){if(-1!=e.indexOf("UAA_PROC_EDIT"))return!0},author0:function(e){if(-1!=e.indexOf("ROLE_TENANT_ADMIN"))return!0},authority:function(e){var t=JSON.parse(sessionStorage.getItem("__MANGO_U_")||"{}").webOpers;return!!t&&(-1!==t.indexOf(n.a[e])||-1!=t.indexOf(n.a.all))},author2:function(e){if(-1!=e.indexOf("UAA_ORG_EDIT"))return!0}};t.a=i},554:function(e,t,a){"use strict";var n={getLabelTree:"/knowledge/api/labels/tree",getLabels:"/knowledge/api/labels",addLabel:"/knowledge/api/labels",updateLabel:"/knowledge/api/labels",delLabel:"/knowledge/api/labels/",getDirTree:"/knowledge/api/directorys/tree",getDirs:"/knowledge/api/directorys",addDir:"/knowledge/api/directorys",updateDir:"/knowledge/api/directorys",delDir:"/knowledge/api/directorys/",getDocs:"/knowledge/api/documents",uploadDoc:"/knowledge/api/documents",updateDoc:"/knowledge/api/documents",delDoc:"/knowledge/api/documents",collect:"/knowledge/api/documents/collect",download:a(22).a+"/knowledge/api/documents/download",move:"/knowledge/api/documents/move",recommend:"/knowledge/api/documents/recommend",myColl:"/knowledge/api/personal/collection",mydownload:"/knowledge/api/personal/download",recommendme:"/knowledge/api/personal/recommend",myupload:"/knowledge/api/personal/upload",mylabels:"/knowledge/api/user-labels",getDocList:"/knowledge/api/home/documents",getmine:"/knowledge/api/home/mine",statistics:"/knowledge/api/home/statistics"};t.a=n},760:function(e,t,a){var n=a(1078);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(17).default)("b8ffc6aa",n,!1,{})}}]);