(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{1216:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"maintain-plan-detail c-main-border"},[a("div",{staticClass:"c-left-border-blue"},[a("h3",[t._v("保养计划分配")]),t._v(" "),a("div",{staticClass:"c-btns-right"},[1===t.headerContent.state||2===t.headerContent.state?a("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle"},on:{click:t.edit}},[t._v("编辑")]):t._e(),t._v(" "),1===t.headerContent.state||2===t.headerContent.state?a("Button",{staticClass:"c-btn-other",attrs:{type:"primary",shape:"circle",loading:t.issuedBtnLoading,disabled:t.headerContent.contentsItemsAll!==t.headerContent.contentsItemsFinished,title:"分配完成才能下达"},on:{click:t.issued}},[t._v("下达")]):t._e(),t._v(" "),a("Button",{staticClass:"c-btn-back",attrs:{type:"primary",shape:"circle"},on:{click:t.back}},[t._v("返回")])],1)]),t._v(" "),a("div",{staticClass:"c-top-border-gray"},[a("div",{staticStyle:{width:"916px"}},[a("Row",{staticClass:"pd3",attrs:{gutter:16}},[a("Col",{attrs:{span:"24"}},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("计划名称：")]),t._v(" "),a("span",[t._v(t._s(t.searchParams.planName))])])])],1),t._v(" "),a("Row",{staticClass:"pd3",attrs:{gutter:16}},[a("Col",{attrs:{span:"12"}},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("起止日期：")]),t._v(" "),a("datepicker-ranger",{attrs:{disabled:!0,width:"160px"},model:{value:t.searchParams.dateRange,callback:function(e){t.$set(t.searchParams,"dateRange",e)},expression:"searchParams.dateRange"}})],1)]),t._v(" "),a("Col",{attrs:{span:"12"}},[a("div",{staticClass:"c-form-item",staticStyle:{color:"#e03d3e"}},[a("label",[t._v("分配完成：")]),t._v(" "),a("span",[t._v(t._s(t.headerContent.contentsItems))])])])],1),t._v(" "),a("Row",{staticClass:"pd3",attrs:{gutter:16}},[a("Col",{attrs:{span:"12"}},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("区域位置：")]),t._v(" "),a("my-process-tree-authority",{ref:"orgTree",staticStyle:{width:"200px"},attrs:{url:t.treeApi.getProcessTreeData,multiple:!0},on:{"on-change":t.getList},model:{value:t.searchParams.area,callback:function(e){t.$set(t.searchParams,"area",e)},expression:"searchParams.area"}})],1)]),t._v(" "),a("Col",{attrs:{span:"12"}},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("保养内容：")]),t._v(" "),a("Select",{staticStyle:{width:"200px"},attrs:{clearable:""},on:{"on-change":t.getList},model:{value:t.searchParams.contents,callback:function(e){t.$set(t.searchParams,"contents",e)},expression:"searchParams.contents"}},t._l(t.repairContents,(function(e){return a("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1)])],1),t._v(" "),a("Row",{staticClass:"pd3",attrs:{gutter:16}},[a("Col",{attrs:{span:"12"}},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("执行人员：")]),t._v(" "),a("Select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择人员"},model:{value:t.searchParams.assignTo,callback:function(e){t.$set(t.searchParams,"assignTo",e)},expression:"searchParams.assignTo"}},t._l(t.operators,(function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1),t._v(" "),a("span",{staticClass:"label-required"},[t._v("*")])],1)]),t._v(" "),a("Col",{attrs:{span:"12"}},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("设备类型：")]),t._v(" "),a("dropdown-tree",{ref:"orgTree",staticStyle:{width:"200px","text-align":"left"},attrs:{url:t.treeApi.getEmpTypeTree,multiple:!0},on:{"on-change":t.getList},model:{value:t.searchParams.equTyp,callback:function(e){t.$set(t.searchParams,"equTyp",e)},expression:"searchParams.equTyp"}})],1)])],1),t._v(" "),a("Row",{staticClass:"pd3",attrs:{gutter:16}},[a("Col",{attrs:{span:"24"}},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("描述：")]),t._v(" "),a("span",{staticStyle:{display:"inline-block","max-width":"86%","vertical-align":"top","margin-top":"8px"}},[t._v(t._s(t.searchParams.remark))])])])],1)],1)]),t._v(" "),a("div",{staticClass:"c-top-border-gray"},[1===t.headerContent.state||2===t.headerContent.state?a("div",{staticClass:"c-table-top-btns"},[a("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle"},on:{click:t.checkAll}},[t._v("全选")]),t._v(" "),a("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle",loading:t.assingBtnLoading},on:{click:t.allocating}},[t._v("分配")])],1):t._e(),t._v(" "),a("Table",{attrs:{columns:t.columns,data:t.curPageList,loading:t.loading,stripe:""},on:{"on-selection-change":t.tableChange}}),t._v(" "),a("Page",{staticClass:"table-page",attrs:{total:t.page.total,"page-size":t.page.pageSize,current:t.page.currentPage,"show-total":"","show-elevator":""},on:{"on-change":t.pageChange}})],1)])};n._withStripped=!0;var i=a(23),r=a(145),s=a(531),o=a(523),l=a(11),c=a(547),d=a(107);function p(t){return function(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function h(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?u(Object(a),!0).forEach((function(e){g(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function g(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var m={components:{dropdownTree:r.a,myProcessTreeAuthority:s.a,datepickerRanger:o.a},data:function(){var t=this;return{ID:this.$route.params.id||this.$route.query.id,treeApi:d.a,loading:!1,issuedBtnLoading:!1,assingBtnLoading:!1,searchParams:{dateRange:{start:"",end:""},area:{id:"",title:"请选择",childrenIds:""},equTyp:{id:"",title:"请选择",childrenIds:""},holidays:"不执行",contents:"",planName:"",remark:"",assignTo:"",ids:""},params:{ids:[],areaId:[],equipmentTypeId:[],contents:[]},page:{pageSize:10,currentPage:1,total:0},columns:[{title:"序号",width:60,render:function(t,e){return t("span",e.index+1)}},{title:"保养周期",key:"maintainPeriod",render:function(e,a){return e("span",t.repairPeriod[a.row.maintainPeriod-1].label)}},{title:"设备类型",key:"equipmentTypeName"},{title:"保养设备",key:"equipmentName"},{title:"执行人",key:"assignUserName"},{title:"保养内容",key:"contents"},{title:"检查方法",key:"maintainStep"}],headerContent:{},operators:[],repairContents:[],list:[],curPageList:[]}},computed:h({},Object(i.b)({repairPeriod:function(t){return t.map.repair.plan.repairPeriod}})),watch:{},methods:{getHeaderContent:function(){var t=this;this.ID&&this.$http.get(c.a.getPlanDetail+this.ID).then((function(e){1!==e.state&&2!==e.state||"selection"!=t.columns[0].type&&t.columns.unshift({type:"selection",width:50}),t.headerContent=e,t.searchParams.dateRange.start=l.a.transDateFromServer(e.startDate,"yyyy-MM-dd"),t.searchParams.dateRange.end=l.a.transDateFromServer(e.endDate,"yyyy-MM-dd"),t.searchParams.holidays=1==e.holidayReminding?"不执行":"执行",t.searchParams.area.id=e.areaId||"",t.searchParams.area.title=e.areaName||"",t.searchParams.equTyp.id=e.equipmentTypeId||"",t.searchParams.equTyp.title=e.equipmentTypeName||"",t.searchParams.remark=e.remark,t.searchParams.planName=e.planName}))},getList:function(){var t=this;this.loading=!0,this.$http.get(c.a.getPlanDetailList,h({},this.page,{pageFlag:1,planId:this.ID,equipmentTypeId:this.searchParams.equTyp.id,areaId:this.searchParams.area.id,contents:this.searchParams.contents})).then((function(e){t.list=t.serverToLocal(e.items.map((function(t){return t.guid=l.a.guid(),t.isRepiar=!0,t}))),t.pageChange(),t.loading=!1}))},getRepairContents:function(){var t=this;this.ID&&this.$http.get(c.a.getContents+this.ID).then((function(e){t.repairContents=e}))},getOperators:function(){var t=this;this.$http.get(d.a.getOperators).then((function(e){e&&e.length&&(t.operators=e)}))},edit:function(){this.$router.push({name:"maintain-plan-edit",params:{id:this.ID}})},allocating:function(){var t=this;return this.searchParams.assignTo?this.params.ids.length?(this.assingBtnLoading=!0,void this.$http.post(c.a.assignPlan,{planId:this.ID,executeUserId:this.searchParams.assignTo,ids:p(new Set(this.params.ids)).join(),areaId:p(new Set(this.params.areaId)).join(),equipmentTypeId:p(new Set(this.params.equipmentTypeId)).join(),contents:p(new Set(this.params.contents)).join()}).then((function(e){t.getHeaderContent(),t.getList(),t.$Notice.success({title:"成功",desc:"分配成功"}),t.assingBtnLoading=!1}))):(this.$Message.warning("请先选择分配任务"),!1):(this.$Message.warning("请先选择执行人员"),!1)},issued:function(){var t=this;this.issuedBtnLoading=!0,this.$http.post(c.a.planIssued,{planId:this.ID}).then((function(e){t.issuedBtnLoading=!1,t.$Notice.success({title:"成功",desc:"下达成功"}),t.$router.back()}))},tableChange:function(t,e){var a=this,n=[],i=[],r=[],s=[],o=[].concat.apply([],this.list);e?o.forEach((function(e){return e._checked=t})):(this.curPageList.forEach((function(t){t._checked=!1})),t.forEach((function(t){a.curPageList.forEach((function(e){t.id==e.id&&(e._checked=!0)}))}))),o.forEach((function(t){t._checked&&(n.push(t.id),i.push(t.areaId),r.push(t.equipmentTypeId),s.push(t.contents))})),this.params.ids=n,this.params.areaId=i,this.params.equipmentTypeId=r,this.params.contents=s},checkAll:function(t){var e=[].concat.apply([],this.list).every((function(t){return t._checked}));this.list.forEach((function(t){t.forEach((function(t){t._checked=!e}))})),this.tableChange(!e,"isAll"),this.pageChange(this.page.currentPage)},pageChange:function(t){var e;t=t||1;this.page.currentPage=t,(e=this.curPageList).splice.apply(e,[0,this.page.pageSize].concat(p(this.list[t-1]||[])))},back:function(){this.$router.back()},serverToLocal:function(t){for(var e=Math.ceil(t.length/this.page.pageSize),a=[],n=0;n<e;n++)a.push(t.slice(n*this.page.pageSize,(n+1)*this.page.pageSize));return this.page.total=t.length,a}},created:function(){l.a.initTableColumnTitle(this.columns),this.getOperators(),this.getRepairContents(),this.getHeaderContent(),this.getList()}},f=(a(894),a(1)),v=Object(f.a)(m,n,[],!1,null,null,null);v.options.__file="src/views/maintain/plan/detail.vue";e.default=v.exports},515:function(t,e,a){var n=a(522);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(17).default)("43cd0b0e",n,!1,{})},517:function(t,e,a){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i={F:function(t,e){if(!t)return"";"object"!=n(t)&&(t=new Date(t)),e=e||"yyyy-MM-dd";var a=t.getFullYear().toString(),i={M:t.getMonth()+1,d:t.getDate(),h:t.getHours(),m:t.getMinutes(),s:t.getSeconds()};for(var r in e=e.replace(/(y+)/gi,(function(t,e){return a.substr(4-Math.min(4,e.length))})),i)e=e.replace(new RegExp("("+r+"+)","g"),(function(t,e){return i[r]<10&&e.length>1?"0"+i[r]:i[r]}));return e},str2Date:function(t){if(t)return"object"!=n(t)?new Date(t):t},firstDayByWeek:function(t){var e=i.str2Date(t)||new Date,a=e.getDay(),n=(0==a?7:a)-1;return i.midnight(new Date(e.getTime()-24*n*60*60*1e3))},firstDayByMonth:function(t){var e=i.str2Date(t)||new Date;return i.midnight(new Date(e.getFullYear(),e.getMonth(),1))},firstDayByYear:function(t){var e=i.str2Date(t)||new Date;return i.midnight(new Date(e.getFullYear(),0,1))},countDateByStep:function(t,e,a,n){t=i.formatePolyfill(t);var r,s=i.str2Date(t)||new Date(t),o=s.getTime(),l=(new Date).getTime();switch(a){case"day":r=o+864e5*e;break;case"week":r=o+6048e5*e;break;case"month":r=new Date(s.getFullYear(),s.getMonth()+e,s.getDate()).getTime(),n&&(r=new Date(s.getFullYear(),s.getMonth()+e,s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds()).getTime());break;case"year":r=new Date(s.getFullYear()+e,s.getMonth(),s.getDate()).getTime(),n&&(r=new Date(s.getFullYear()+e,s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds()).getTime())}return r>l&&(r=l),n?r:i.midnight(r)},midnight:function(t){return t?i.F(t)+" 00:00:00":""},beforeMidnight:function(t){return t?i.F(t)+" 23:59:59":""},midnightMill:function(t){var e=i.str2Date(t)||new Date;return new Date(i.midnight(e)).getTime()},chain:function(t,e){return i.countDateByStep(t,-1,e)},yearOFyear:function(t){return i.countDateByStep(t,-1,"year")},getPeriods:function(t){var e,a=t.beginDate,n=new Date(i.formatePolyfill(a)),r=n.getTime();switch(t.cycle){case"day":e=r+864e5;break;case"week":e=r+6048e5;break;case"month":e=new Date(n.getFullYear(),n.getMonth()+1,n.getDate(),0,0,0).getTime();break;case"year":e=new Date(n.getFullYear()+1,n.getMonth(),n.getDate(),0,0,0).getTime()}return{min:r,max:new Date(e).getTime()}},formatePolyfill:function(t){return"string"!=typeof t?t:("string"==typeof t&&0==/[TZ]/.test(t)&&(t=t.replace(/-/g,"/")),t)},getTerminalsByMonth:function(t,e){var a,n;return 0==e?(a=new Date(t,0,1,0,0,0),n=new Date(t,11,31,23,59,59)):(a=new Date(t,e-1,1,0,0,0),n=new Date(t,e,0,23,59,59)),{start:a,end:n}},transDateFromServer:function(t,e){return t?("string"==typeof t&&0==/[TZ]/.test(t)&&(t=t.replace(/-/g,"/")),i.F(t,e||"yyyy-MM-dd hh:mm")):""},transDateFromLocale:function(t){return t?("string"==typeof t&&(0==/[TZ]/.test(t)&&(t=t.replace(/-/g,"/")),t=new Date(t)),t.toISOString()):""},strToData:function(t){var e=t.split(" ")[0].split("-"),a=[];return void 0!==t.split(" ")[1]&&(a=t.split(" ")[1].split(":")),new Date(e[0],e[1]-1,e[2],null!==a[0]?a[0]:0,null!==a[1]?a[1]:0,null!==a[2]?a[2]:0)}};e.a=i},518:function(t,e,a){var n=a(530);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(17).default)("4411afe8",n,!1,{})},521:function(t,e,a){"use strict";var n=a(515);a.n(n).a},522:function(t,e,a){(e=a(10)(!1)).push([t.i,"\n.cmp-datepicker {\r\n\tdisplay: inline-block;\n}\r\n",""]),t.exports=e},523:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cmp-datepicker"},[a("DatePicker",{style:{width:t.width},attrs:{type:"date",placeholder:"开始日期",value:t.dateRange.start,disabled:t.disabled,options:t.startDateOptions},on:{"on-change":t.startDateChange}}),t._v(" "),a("span",[t._v(" - ")]),t._v(" "),a("DatePicker",{style:{width:t.width},attrs:{type:"date",placeholder:"结束日期",value:t.dateRange.end,disabled:t.disabled,options:t.endDateOptions},on:{"on-change":t.endDateChange}})],1)};n._withStripped=!0;var i=a(11),r=a(517),s={name:"datepickerRanger",props:{value:Object,width:String,disabled:{type:Boolean,default:!1},enabled:String},watch:{"value.start":function(t){this.dateRange.start=i.a.transDateFromServer(t,"yyyy-MM-dd")},"value.end":function(t){this.dateRange.end=i.a.transDateFromServer(t,"yyyy-MM-dd")}},data:function(){var t=this,e=r.a.midnightMill();return{dateRange:{start:i.a.transDateFromServer(this.value.start,"yyyy-MM-dd"),end:i.a.transDateFromServer(this.value.end,"yyyy-MM-dd")},startDateOptions:{disabledDate:function(a){return"coming"==t.enabled?a&&a.valueOf()<e:"halfYear"===t.enabled?a&&a.valueOf()<e-15552e6:t.dateRange.end&&a&&a.valueOf()>1*new Date(t.dateRange.end+" 23:59:59")}},endDateOptions:{disabledDate:function(a){var n=1*new Date(t.dateRange.start+" 00:00:00"),i=a&&a.valueOf();return"past"==t.enabled?a&&i>e:t.dateRange.start&&a&&i<n}}}},methods:{startDateChange:function(t){this.dateRange.start=t;var e=this.dateRange.start?i.a.transDateFromLocale(this.dateRange.start+" 00:00:00"):"",a=this.dateRange.end?i.a.transDateFromLocale(this.dateRange.end+" 23:59:59"):"";this.$emit("input",{start:e,end:a}),this.$emit("on-change",{start:e,end:a})},endDateChange:function(t){this.dateRange.end=t;var e=this.dateRange.start?i.a.transDateFromLocale(this.dateRange.start+" 00:00:00"):"",a=this.dateRange.end?i.a.transDateFromLocale(this.dateRange.end+" 23:59:59"):"";this.$emit("input",{start:e,end:a}),this.$emit("on-change",{start:e,end:a})}}},o=(a(521),a(1)),l=Object(o.a)(s,n,[],!1,null,null,null);l.options.__file="src/components/datepicker-ranger.vue";e.a=l.exports},529:function(t,e,a){"use strict";var n=a(518);a.n(n).a},530:function(t,e,a){(e=a(10)(!1)).push([t.i,"\n.cmp-dropdown-tree {\r\n    display: inline-block;\r\n    position: relative;\r\n    vertical-align: middle;\r\n    line-height: normal;\n}\n.ivu-form-item-error .cmp-dropdown-tree-label {\r\n    border: 1px solid #ed3f14;\n}\n.ivu-form-item-error .cmp-dropdown-tree-arrow {\r\n    border-left: 1px solid #ed3f14;\n}\n.cmp-dropdown-tree-label {\r\n    height: 28px;\r\n    width: 100%;\r\n    border: 1px solid #eaeaea;\r\n    display: flex;\r\n    border-radius: 3px;\r\n    cursor: pointer;\n}\n.cmp-dropdown-tree-text {\r\n    line-height: 28px;\r\n    text-indent: 5px;\r\n    flex: 1;\r\n    white-space: nowrap;\r\n    text-overflow: ellipsis;\r\n    overflow: hidden;\n}\n.cmp-dropdown-tree-arrow {\r\n    margin-top: -1px;\r\n    width: 28px;\r\n    height: 28px;\r\n    border-left: 1px solid #eaeaea;\r\n    text-align: center;\r\n    line-height: 28px;\n}\n.cmp-dropdown-tree .ivu-input-group-append {\r\n    width: 25px;\r\n    height: 28px;\r\n    overflow: hidden;\r\n    padding: 0;\n}\n.cmp-dropdown-tree .ivu-btn {\r\n    padding: 5px 10px;\n}\n.cmp-dropdown-tree-tree {\r\n    z-index: 901;\r\n    position: absolute;\r\n    top: 37px;\r\n    left: 0;\r\n    min-width: 300px;\r\n    max-height: 400px;\r\n    overflow: auto;\r\n    padding: 5px 10px;\r\n    background-color: #fff;\r\n    box-shadow: 1px 1px 5px #999;\r\n    border-radius: 3px;\n}\r\n",""]),t.exports=e},531:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.hideTree,expression:"hideTree"}],staticClass:"cmp-dropdown-tree",style:{width:t.width+"px"}},[a("div",{staticClass:"cmp-dropdown-tree-label",on:{click:t.labelClick}},[a("div",{staticClass:"cmp-dropdown-tree-text"},[t._v(t._s(t.value.title))]),t._v(" "),a("div",{staticClass:"cmp-dropdown-tree-arrow"},[a("Icon",{directives:[{name:"show",rawName:"v-show",value:1!=t.isShowTree,expression:"isShowTree != true"}],attrs:{type:"ios-arrow-down"}}),t._v(" "),a("Icon",{directives:[{name:"show",rawName:"v-show",value:1==t.isShowTree,expression:"isShowTree == true"}],attrs:{type:"ios-arrow-up"}})],1)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowTree,expression:"isShowTree"}],staticClass:"cmp-dropdown-tree-tree"},[a("Tree",{attrs:{data:t.datas,"show-checkbox":t.showCheckbox,multiple:t.multiple},on:{"on-select-change":t.selectTree}})],1)])};n._withStripped=!0;var i=a(11),r=a(146),s=a(147);function o(t){return function(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(t){!function t(e){e.forEach((function(e,a){e.childrenIds=function t(e,a){a=a||[];return e.forEach((function(e){e.children.length&&t(e.children,a),a.push(Math.abs(e.id))})),a}(e.children),e.children.length&&t(e.children)}))}(t)}var c={name:"myProcessTreeAuthority",mixins:[r.a],props:{field:String,value:Object,data:Array,url:String,query:Object,showCheckbox:Boolean,multiple:Boolean,width:{type:[Number,String],default:300},type:String},watch:{"value.id":function(t){t?this.flatDatas.length&&(i.a.setTrueTreeExpand(this.datas,t),i.a.setTrueTreeSelected(this.datas,t)):(!function t(e){for(var a,n=e.length,i=0;i<n;i++)1==(a=e[i]).selected&&(a.selected=!1),a.children.length&&t(a.children)}(this.datas),this.$emit("input",{id:"",title:"请选择"}))},data:function(t){this.datas=t}},data:function(){return{datas:this.data,flatDatas:[],isShowTree:!1}},methods:{selectTree:function(t){var e=this,a=[],n=[],i=[],r=this.field||"id",s=[];t.forEach((function(t){a.push(Math.abs(t[r])),n.push(t.key),i.push(t.title),s=s.concat(Math.abs(t[r]),t.childrenIds)})),s=o(new Set(s)),this.$emit("input",{id:a.join(),key:n.join(),title:i.join(),childrenIds:s}),this.$emit("on-change",{id:a.join(),key:n.join(),title:i.join(),childrenIds:s}),this.multiple||(this.isShowTree=!1),setTimeout((function(){e.dispatch("FormItem","on-form-change",{id:a.join(),key:n.join(),title:i.join(),childrenIds:s})}),100)},hideTree:function(){this.isShowTree=!1},labelClick:function(){this.isShowTree=!this.isShowTree}},directives:{clickoutside:s.a},mounted:function(){var t=this;this.url&&this.$http.get(this.url,this.query).then((function(e){e&&e.length&&(e.forEach((function(t){!1===t.authorized&&(t.render=function(t,e){e.root,e.node;return t("span",[e.data.name])})})),"EQUTYPE"==t.type&&e.forEach((function(t){var a=e.filter((function(e){return e.parentId==t.id}));("org"==t.type||a.length>0)&&(t.render=function(t,e){e.root,e.node;return t("span",[e.data.name])})})),"PROCESS"==t.type&&e.forEach((function(t){1==t.type&&(t.render=function(t,e){e.root,e.node;return t("span",[e.data.name])})})),t.flatDatas=e,t.value.id&&(i.a.setTreeExpand(t.flatDatas,t.value.id),i.a.setFlatTreeSelected(t.flatDatas,t.value.id)),t.datas=i.a.transDataToTree(t.flatDatas),l(t.datas))}))}},d=(a(529),a(1)),p=Object(d.a)(c,n,[],!1,null,null,null);p.options.__file="src/components/my-process-tree-authority.vue";e.a=p.exports},547:function(t,e,a){"use strict";var n={getPlans:"/equipment/api/maintains/plans",getPlanDetail:"/equipment/api/maintain/plan/",getPlanDetailList:"/equipment/api/maintain/plan/detail",initPlanDetailList:"/equipment/api/maintains/initGenerate",delPlans:"/equipment/api/maintains/plan",addPlan:"/equipment/api/maintains/plan",assignPlan:"/equipment/api/maintains/plan/assign",getTasks:"/equipment/api/maintains/tasks",delTask:"/equipment/api/maintains/task",stopTask:"/equipment/api/maintains/task/stop",getTaskDetail:"/equipment/api/maintain/task/",getTaskDetailList:"/equipment/api/maintain/task/detail/",taskTransfer:"/equipment/api/maintains/task/transfer",gatStatistics:"/equipment/api/maintains/statistics",export:a(22).a+"/equipment/api/maintains/statistics-excel-export",getContents:"/equipment/api/maintain/plan/contents/",planIssued:"/equipment/api/maintains/plan/distributeTask",getTaskByEqu:"/equipment/api/maintains/tasks/equ"};e.a=n},673:function(t,e,a){var n=a(895);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(17).default)("0740dedd",n,!1,{})},894:function(t,e,a){"use strict";var n=a(673);a.n(n).a},895:function(t,e,a){(e=a(10)(!1)).push([t.i,".maintain-plan-detail .c-form-item {\n  margin-left: 0;\n}\n.maintain-plan-detail .c-form-item .ivu-radio-group label {\n  margin-right: 0;\n}\n.maintain-plan-detail .pd3 {\n  padding-top: 3px;\n  padding-bottom: 3px;\n}\n.maintain-plan-detail .form-textarea {\n  position: relative;\n  padding-left: 100px;\n  width: 100%;\n  margin-top: 5px;\n}\n.maintain-plan-detail .form-textarea label {\n  position: absolute;\n  left: 0;\n  width: 100px;\n}\n.maintain-plan-detail .form-textarea textarea {\n  display: inline-block;\n  width: 100%;\n  padding: 10px;\n  border: 1px solid #dddee1;\n  border-radius: 4px;\n  outline: none;\n  overflow: auto;\n  vertical-align: top;\n}\n",""]),t.exports=e}}]);