(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{1061:function(e,t,n){"use strict";var r=n(753);n.n(r).a},1062:function(e,t,n){var r=n(10),i=n(24),o=n(628);t=r(!1);var s=i(o);t.push([e.i,"\n.monitor{overflow: hidden;}\n.monitor-win {\r\n    float: left;\r\n    background: #EFEFEF url("+s+") no-repeat center center;\n}\n.monitor .monitor-single .monitor-win {\r\n    width: 100%;\r\n    float: none;\n}\n.monitor .monitor-2-2 .monitor-win {\r\n    width: 49%;\r\n    margin: .5%;\n}\n.monitor .monitor-3-2 .monitor-win {\r\n    width: 32.3%;\r\n    margin: .5%;\n}\n.monitor .monitor-3-3 .monitor-win {\r\n    width: 32.3%;\r\n    margin: .5%;\n}\n.monitor .monitor-win p{\r\n    height: 32px;\r\n    line-height: 32px;\r\n    text-align: center;\r\n    color: #333;\r\n    font-weight: bold;\r\n    font-size: 12px;\n}\r\n\r\n",""]),e.exports=t},1202:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"c-tree"},[n("div",{staticClass:"c-tree-left c-scrollbar",attrs:{id:"J_TREE_LEFT"}},[n("h3",[e._v("区域位置")]),e._v(" "),n("div",{staticClass:"padding0-10"},[n("Tree",{attrs:{data:e.treeData,render:e.renderContent}})],1)]),e._v(" "),n("div",{staticClass:"c-main-border c-tree-right"},[n("div",{staticClass:"c-plain-bg-h"},[n("h3",[e._v("视频监控")]),e._v(" "),n("div",{staticClass:"c-btns-right",staticStyle:{"margin-right":"30px"}},[n("a",{attrs:{href:"javascript:;"},on:{click:e.fullscreenClick}},[n("Icon",{attrs:{type:"arrow-expand",size:"25",color:"#9baeb3"}})],1)])]),e._v(" "),n("fullscreen",{ref:"fullscreen",attrs:{background:"#FFF"},on:{change:e.fullscreenChange}},[n("div",{staticClass:"monitor",attrs:{id:"J_MONITOR"}},[n("div",{class:[e.homeMonitorFlexClass]},e._l(e.selectedData,(function(t){return n("div",{key:t.id,staticClass:"monitor-win",style:{height:e.itemHeight}},[n("div",{style:{height:e.vHeight}},[n("video",{attrs:{id:t.guid,width:"100%",autoplay:"autoplay",muted:"muted"},domProps:{muted:!0}})]),e._v(" "),n("div",{staticStyle:{"text-align":"center","background-color":"#FEFEFE",color:"#000","line-height":"20px"}},[e._v(e._s(t.name))])])})),0)])])],1)])};r._withStripped=!0;var i=n(538),o=n.n(i),s=n(7),l=n(11),c=n(576),a=n(783),u=n.n(a);function d(e){return e.replace("video_","")}s.default.use(o.a);var f={data:function(){return{activeTreeIds:[],treeData:[],homeMonitorFlexClass:"monitor-single",selectedData:[],itemHeight:"100%",vHeight:"50%"}},mounted:function(){this.getProcessTree(this.$route.params.id);var e=l.a.setTreeLeftHeight();document.querySelector("#J_MONITOR").style.height=e-60+"px"},methods:{initHeight:function(){},fullscreenClick:function(){this.$refs.fullscreen.toggle()},fullscreenChange:function(e){var t=window.screen.height;e?(document.querySelector("#J_MONITOR").style.height="99%",this.renderFlex(t-40)):(document.querySelector("#J_MONITOR").style.height=document.querySelector(".lay").offsetHeight-60+"px",this.renderFlex())},getProcessTree:function(e){var t=this;this.$http.get(c.a.getVideoTree).then((function(n){var r,i=n.items;if(e){var o=String(e).split(",");o.length>6&&(o.length=6),o.forEach((function(e){l.a.setTreeExpand(i,e);for(var n=0,o=i.length;n<o;n++)if(9==i[n].type&&d(i[n].id)==e){r=i[n];break}t.addVideo(r)}))}var s=l.a.getItemAndParentsByTypeId(i,!0);t.treeData=0==n.items.length?[]:l.a.transDataToTree(s.map((function(e){return e.expand=!0,e})))}))},renderContent:function(e,t){var n,r=this,i=(t.root,t.node,t.data);return 9==i.type&&(n=e("Icon",{style:{color:"#4b7efe",fontSize:"18px"},props:{type:"ios-videocam"}},[])),e("div",{class:{"c-tree-row":!0}},[n||"",e("span",{class:{"ivu-tree-title":"9"==i.type,"ivu-tree-title-selected":-1!=this.activeTreeIds.indexOf(d(i.id))},attrs:{title:i.name},on:{click:function(){if(9==i.type){var e=d(i.id),t=r.activeTreeIds.indexOf(e);if(9==r.activeTreeIds.length&&-1==t)return void r.$Notice.info({title:"最多选择9个画面"});-1==t?r.addVideo(i):r.removeVideo(i),0==r.activeTreeIds.length&&(r.stopAllLoad(),r.selectedData=[])}}}},[i.title])])},addVideo:function(e){this.activeTreeIds.push(d(e.id));var t=this.selectedData,n="m"+l.a.gusid(8,16),r={guid:n,name:e.name,id:e.id,hls:null};t.push(r),this.renderFlex(),this.$nextTick((function(){var t=function(e,t){var n=document.getElementById(e),r=new u.a;return r.attachMedia(n),r.on(u.a.Events.MEDIA_ATTACHED,(function(){r.loadSource(t)})),r.on(u.a.Events.MANIFEST_PARSED,(function(e,t){})),r.on(u.a.Events.ERROR,(function(e,t){if(console.log("Hls.Events.ERROR:"),t.fatal)switch(t.type){case u.a.ErrorTypes.NETWORK_ERROR:r.startLoad();break;case u.a.ErrorTypes.MEDIA_ERROR:r.recoverMediaError();break;default:r.destroy()}})),r}(n,e.url);r.hls=t}))},removeVideo:function(e){this.activeTreeIds.splice(this.activeTreeIds.indexOf(d(e.id)),1);var t=this.selectedData;!function(e,n){for(var r,i,o=0,s=t.length;o<s;o++)if(n[o].id==e.id){(i=n[r=o]).hls.stopLoad(),i.hls.detachMedia(),i.hls.destroy(),n.splice(r,1);break}}(e,t),this.renderFlex()},renderFlex:function(e){var t,n=e||document.querySelector(".lay").offsetHeight-80,r=this.selectedData.length,i="";r<=1?(i="monitor-single",t=n):r>1&&r<5?(i="monitor-2-2",t=n/2):r>=5&&r<=6?(i="monitor-3-2",t=n/2):(i="monitor-3-3",t=n/3),this.itemHeight=t+"px",this.vHeight=t-20+"px",this.homeMonitorFlexClass=i},back:function(){this.$router.back()},stopAllLoad:function(){for(var e,t=this.selectedData,n=0,r=t.length;n<r;n++)(e=t[n]).hls.stopLoad(),e.hls.detachMedia(),e.hls.destroy();t=[]}},beforeRouteLeave:function(e,t,n){this.stopAllLoad(),n()}},h=(n(1061),n(1)),p=Object(h.a)(f,r,[],!1,null,null,null);p.options.__file="src/views/monitor-screen/monitor.vue";t.default=p.exports},538:function(e,t,n){e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t,n){"use strict";t.b=function(){var e=document.documentElement;return"requestFullscreen"in e||"mozRequestFullScreen"in e&&document.mozFullScreenEnabled||"msRequestFullscreen"in e&&document.msFullscreenEnabled||"webkitRequestFullScreen"in e},t.c=function(){return!!(document.fullscreen||document.mozFullScreen||document.fullscreenElement||document.msFullscreenElement||document.webkitIsFullScreen)},t.g=function(e){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():console.log("Fullscreen API is not supported.")},t.d=function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():console.log("Fullscreen API is not supported.")},t.f=function(e){document.addEventListener("fullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("MSFullscreenChange",e),document.addEventListener("webkitfullscreenchange",e)},t.e=function(e){document.removeEventListener("fullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e),document.removeEventListener("webkitfullscreenchange",e)},t.a=function e(){var t={},n=!1,r=0,i=arguments.length;for("[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(n=arguments[0],r++);r<i;r++)!function(r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n&&"[object Object]"===Object.prototype.toString.call(r[i])?t[i]=e(!0,t[i],r[i]):t[i]=r[i])}(arguments[r]);return t}},function(e,t,n){"use strict";function r(){return n.i(s.c)()}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,t=arguments[1];if(c&&!r()){t=n.i(s.a)(!0,{},l,t);var i=e,o=void 0;t.wrap&&((o=document.createElement("div")).style["overflow-y"]="auto",o.style.background=t.background,o.style.width="100%",o.style.height="100%",i.parentNode.insertBefore(o,i),o.appendChild(i),o.addEventListener("click",(function(e){e.target===this&&n.i(s.d)()}))),i.classList.add(t.fullscreenClass),n.i(s.f)((function e(){var l=r();l||(n.i(s.e)(e),i.classList.remove(t.fullscreenClass),t.wrap&&(o.parentNode.insertBefore(i,o),o.parentNode.removeChild(o))),t.callback&&t.callback(l)})),n.i(s.g)(t.wrap?o:i)}}function o(){c&&r()&&n.i(s.d)()}var s=n(0),l={wrap:!0,background:"#333",callback:function(){},fullscreenClass:"fullscreen"},c=n.i(s.b)();t.a={getState:r,toggle:function(e,t,n){c&&(void 0===n?r()?o():i(e,t):n?i(e,t):o())},enter:i,exit:o}},function(e,t,n){var r=n(5)(n(4),n(6),null,null);e.exports=r.exports},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n.n(r),o=n(1),s=n(0);t.default={install:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.name||"fullscreen";e.component(r,n.i(s.a)(i.a,{name:r})),e.prototype["$"+r]=o.a}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default={props:{background:{type:String,default:"#333"},fullscreenClass:{type:String,default:"fullscreen"},fullscreen:{type:Boolean,default:!1}},data:function(){return{supportFullScreen:!1,isFullscreen:!1}},computed:{wrapperStyle:function(){return{background:this.background,"overflow-y":"auto",width:"100%",height:"100%"}}},methods:{toggle:function(e){void 0===e?n.i(r.c)()?this.exit():this.enter():e?this.enter():this.exit()},enter:function(){this.supportFullScreen&&(n.i(r.f)(this.fullScreenCallback),n.i(r.g)(this.$el))},exit:function(){this.supportFullScreen&&this.getState()&&n.i(r.d)()},getState:function(){return n.i(r.c)()},shadeClick:function(e){e.target===this.$el&&this.exit()},fullScreenCallback:function(){this.isFullscreen=n.i(r.c)(),this.isFullscreen||n.i(r.e)(this.fullScreenCallback),this.$emit("change",this.isFullscreen),this.$emit("update:fullscreen",this.isFullscreen)}},watch:{fullscreen:function(e){e!==n.i(r.c)()&&(e?this.enter():this.exit())}},created:function(){this.supportFullScreen=n.i(r.b)()}}},function(e,t){e.exports=function(e,t,n,r){var i,o=e=e||{},s=typeof e.default;"object"!==s&&"function"!==s||(i=e,o=e.default);var l="function"==typeof o?o.options:o;if(t&&(l.render=t.render,l.staticRenderFns=t.staticRenderFns),n&&(l._scopeId=n),r){var c=Object.create(l.computed||null);Object.keys(r).forEach((function(e){var t=r[e];c[e]=function(){return t}})),l.computed=c}return{esModule:i,exports:o,options:l}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{class:e.isFullscreen?[e.fullscreenClass]:[],style:e.isFullscreen?[e.wrapperStyle]:[],on:{click:function(t){e.shadeClick(t)}}},[e._t("default")],2)},staticRenderFns:[]}}])},576:function(e,t,n){"use strict";n(22);t.a={getVideoList:"/loong/api/videos",getVideo:"/loong/api/videos/",saveVideo:"/loong/api/videos",delVideo:"/loong/api/videos",getVideoTree:"/loong/api/videos/tree",getVideoThumbByType:"/loong/api/thumbs",getAlarmThumbIsread:"/loong/api/thumbs/count",setIsRead:"/loong/api/thumbs",getAlarmDataMonth:"/loong/api/thumbs/count"}},628:function(e,t,n){e.exports=n.p+"images/1486957d057df78ff207cf92be851e2d.png"},753:function(e,t,n){var r=n(1062);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,n(17).default)("00ff5898",r,!1,{})}}]);