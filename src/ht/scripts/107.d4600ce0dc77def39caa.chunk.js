(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{1189:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"c-main-border"},[a("div",{staticClass:"c-left-border-blue"},[a("h3",[t._v("查看记录")]),t._v(" "),a("div",{staticClass:"c-btns-right"},[a("Button",{staticClass:"c-btn-back",attrs:{type:"primary",shape:"circle"},on:{click:t.back}},[t._v("返回")])],1)]),t._v(" "),a("div",{staticClass:"c-top-border-gray"},[a("div",{staticClass:"c-table-top-btns"},[a("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle"},on:{click:t.add}},[t._v("新增")]),t._v(" "),a("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle"},on:{click:t.deleteConfirm}},[t._v("删除")]),t._v(" "),a("div",{staticClass:"c-btns-right"},[a("label",[t._v("业务时间：")]),t._v(" "),a("datepicker-ranger",{model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1)],1),t._v(" "),a("Table",{attrs:{columns:t.columns,data:t.listData,loading:t.loading,stripe:""},on:{"on-select":t.onSelect,"on-select-all":t.onSelect}}),t._v(" "),a("Page",{staticClass:"table-page",attrs:{total:t.total,"page-size":t.searchParams.pageSize,current:t.searchParams.currentPage,"show-total":"","show-elevator":""},on:{"on-change":t.pageChange}})],1)])};n._withStripped=!0;var r=a(11),i=a(533),s={name:"data-input-brief-history",data:function(){var t=this;return{advSearch:!1,cycleMap:{0:"不限",1:"天",2:"周",3:"月",4:"季度",5:"年"},dateRange:{start:null,end:null},searchParams:{queryName:"",formId:null,pageSize:10,currentPage:1},columns:[{type:"selection",width:50},{title:"业务时间",key:"recordDate",render:function(t,e){return t("span",r.a.F(e.row.recordDate,"yyyy-MM-dd hh:mm"))}},{title:"最近录入人",key:"updateUserName"},{title:"最近录入时间",key:"updateTime",render:function(t,e){return t("span",r.a.F(e.row.updateTime||e.row.createTime))}},{title:"操作",key:"action",render:function(e,a){return e("div",[r.a.tableBtnStyle(e,(function(){t.$router.push({name:"data-input-brief-input-detail",params:{formId:a.row.formId,recordDate:a.row.recordDate,cycleId:a.row.cycleId}})}),"查看"),r.a.tableBtnStyle(e,(function(){t.$router.push({name:"data-input-brief-input",params:{formId:a.row.formId,recordDate:a.row.recordDate,cycleId:a.row.cycleId}})}),"编辑")])}}],listData:[],total:0,selected:[],loading:!1}},methods:{getData:function(){var t=this;this.loading=!0,this.$http.get(i.a.history,this.searchParams).then((function(e){t.loading=!1,e&&e.total>=0&&(t.total=e.total,t.listData=e.items?e.items:[])}))},search:function(){this.searchParams.currentPage=1,this.searchParams.beginDate=this.dateRange.start,this.searchParams.endDate=this.dateRange.end,this.getData()},searchParamsClean:function(t){this.searchParams.currentPage=1,this.$refs[t].resetFields()},pageChange:function(t){this.searchParams.currentPage=t,this.getData()},add:function(){var t={};t.formId=this.$route.params.id,t.recordDate=r.a.transDateFromLocale(r.a.F(new Date,"yyyy-MM-dd")+" 00:00:00"),t.cycleId=this.$route.params.cycleId,this.$router.push({name:"data-input-brief-input",params:t})},onSelect:function(t,e){this.selected=t},deleteConfirm:function(){if(0!=this.selected.length){for(var t=[],e=0;e<this.selected.length;e++)t.push(this.selected[e].id);this.deleteByIds(t.join(","))}else this.$Notice.warning({title:"警告",desc:"请选中后删除",duration:3})},deleteByIds:function(t){var e=this;this.$Modal.confirm({title:"提示",content:"<p>确定要删除？</p>",onOk:function(){e.$http.del(i.a.historyDelete+"?ids="+t).then((function(t){t.count&&(e.$Notice.success({title:"成功",desc:"删除成功！",duration:3}),e.search())}))},onCancel:function(){}})},back:function(){this.$router.back()}},components:{datepickerRanger:a(523).a},created:function(){this.searchParams.formId=this.$route.params.id,this.search()},watch:{dateRange:{handler:function(){this.search()},deep:!0}}},o=a(1),c=Object(o.a)(s,n,[],!1,null,null,null);c.options.__file="src/views/data-input/brief/history.vue";e.default=c.exports},515:function(t,e,a){var n=a(522);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(17).default)("43cd0b0e",n,!1,{})},517:function(t,e,a){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r={F:function(t,e){if(!t)return"";"object"!=n(t)&&(t=new Date(t)),e=e||"yyyy-MM-dd";var a=t.getFullYear().toString(),r={M:t.getMonth()+1,d:t.getDate(),h:t.getHours(),m:t.getMinutes(),s:t.getSeconds()};for(var i in e=e.replace(/(y+)/gi,(function(t,e){return a.substr(4-Math.min(4,e.length))})),r)e=e.replace(new RegExp("("+i+"+)","g"),(function(t,e){return r[i]<10&&e.length>1?"0"+r[i]:r[i]}));return e},str2Date:function(t){if(t)return"object"!=n(t)?new Date(t):t},firstDayByWeek:function(t){var e=r.str2Date(t)||new Date,a=e.getDay(),n=(0==a?7:a)-1;return r.midnight(new Date(e.getTime()-24*n*60*60*1e3))},firstDayByMonth:function(t){var e=r.str2Date(t)||new Date;return r.midnight(new Date(e.getFullYear(),e.getMonth(),1))},firstDayByYear:function(t){var e=r.str2Date(t)||new Date;return r.midnight(new Date(e.getFullYear(),0,1))},countDateByStep:function(t,e,a,n){t=r.formatePolyfill(t);var i,s=r.str2Date(t)||new Date(t),o=s.getTime(),c=(new Date).getTime();switch(a){case"day":i=o+864e5*e;break;case"week":i=o+6048e5*e;break;case"month":i=new Date(s.getFullYear(),s.getMonth()+e,s.getDate()).getTime(),n&&(i=new Date(s.getFullYear(),s.getMonth()+e,s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds()).getTime());break;case"year":i=new Date(s.getFullYear()+e,s.getMonth(),s.getDate()).getTime(),n&&(i=new Date(s.getFullYear()+e,s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds()).getTime())}return i>c&&(i=c),n?i:r.midnight(i)},midnight:function(t){return t?r.F(t)+" 00:00:00":""},beforeMidnight:function(t){return t?r.F(t)+" 23:59:59":""},midnightMill:function(t){var e=r.str2Date(t)||new Date;return new Date(r.midnight(e)).getTime()},chain:function(t,e){return r.countDateByStep(t,-1,e)},yearOFyear:function(t){return r.countDateByStep(t,-1,"year")},getPeriods:function(t){var e,a=t.beginDate,n=new Date(r.formatePolyfill(a)),i=n.getTime();switch(t.cycle){case"day":e=i+864e5;break;case"week":e=i+6048e5;break;case"month":e=new Date(n.getFullYear(),n.getMonth()+1,n.getDate(),0,0,0).getTime();break;case"year":e=new Date(n.getFullYear()+1,n.getMonth(),n.getDate(),0,0,0).getTime()}return{min:i,max:new Date(e).getTime()}},formatePolyfill:function(t){return"string"!=typeof t?t:("string"==typeof t&&0==/[TZ]/.test(t)&&(t=t.replace(/-/g,"/")),t)},getTerminalsByMonth:function(t,e){var a,n;return 0==e?(a=new Date(t,0,1,0,0,0),n=new Date(t,11,31,23,59,59)):(a=new Date(t,e-1,1,0,0,0),n=new Date(t,e,0,23,59,59)),{start:a,end:n}},transDateFromServer:function(t,e){return t?("string"==typeof t&&0==/[TZ]/.test(t)&&(t=t.replace(/-/g,"/")),r.F(t,e||"yyyy-MM-dd hh:mm")):""},transDateFromLocale:function(t){return t?("string"==typeof t&&(0==/[TZ]/.test(t)&&(t=t.replace(/-/g,"/")),t=new Date(t)),t.toISOString()):""},strToData:function(t){var e=t.split(" ")[0].split("-"),a=[];return void 0!==t.split(" ")[1]&&(a=t.split(" ")[1].split(":")),new Date(e[0],e[1]-1,e[2],null!==a[0]?a[0]:0,null!==a[1]?a[1]:0,null!==a[2]?a[2]:0)}};e.a=r},521:function(t,e,a){"use strict";var n=a(515);a.n(n).a},522:function(t,e,a){(e=a(10)(!1)).push([t.i,"\n.cmp-datepicker {\r\n\tdisplay: inline-block;\n}\r\n",""]),t.exports=e},523:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cmp-datepicker"},[a("DatePicker",{style:{width:t.width},attrs:{type:"date",placeholder:"开始日期",value:t.dateRange.start,disabled:t.disabled,options:t.startDateOptions},on:{"on-change":t.startDateChange}}),t._v(" "),a("span",[t._v(" - ")]),t._v(" "),a("DatePicker",{style:{width:t.width},attrs:{type:"date",placeholder:"结束日期",value:t.dateRange.end,disabled:t.disabled,options:t.endDateOptions},on:{"on-change":t.endDateChange}})],1)};n._withStripped=!0;var r=a(11),i=a(517),s={name:"datepickerRanger",props:{value:Object,width:String,disabled:{type:Boolean,default:!1},enabled:String},watch:{"value.start":function(t){this.dateRange.start=r.a.transDateFromServer(t,"yyyy-MM-dd")},"value.end":function(t){this.dateRange.end=r.a.transDateFromServer(t,"yyyy-MM-dd")}},data:function(){var t=this,e=i.a.midnightMill();return{dateRange:{start:r.a.transDateFromServer(this.value.start,"yyyy-MM-dd"),end:r.a.transDateFromServer(this.value.end,"yyyy-MM-dd")},startDateOptions:{disabledDate:function(a){return"coming"==t.enabled?a&&a.valueOf()<e:"halfYear"===t.enabled?a&&a.valueOf()<e-15552e6:t.dateRange.end&&a&&a.valueOf()>1*new Date(t.dateRange.end+" 23:59:59")}},endDateOptions:{disabledDate:function(a){var n=1*new Date(t.dateRange.start+" 00:00:00"),r=a&&a.valueOf();return"past"==t.enabled?a&&r>e:t.dateRange.start&&a&&r<n}}}},methods:{startDateChange:function(t){this.dateRange.start=t;var e=this.dateRange.start?r.a.transDateFromLocale(this.dateRange.start+" 00:00:00"):"",a=this.dateRange.end?r.a.transDateFromLocale(this.dateRange.end+" 23:59:59"):"";this.$emit("input",{start:e,end:a}),this.$emit("on-change",{start:e,end:a})},endDateChange:function(t){this.dateRange.end=t;var e=this.dateRange.start?r.a.transDateFromLocale(this.dateRange.start+" 00:00:00"):"",a=this.dateRange.end?r.a.transDateFromLocale(this.dateRange.end+" 23:59:59"):"";this.$emit("input",{start:e,end:a}),this.$emit("on-change",{start:e,end:a})}}},o=(a(521),a(1)),c=Object(o.a)(s,n,[],!1,null,null,null);c.options.__file="src/components/datepicker-ranger.vue";e.a=c.exports},533:function(t,e,a){"use strict";var n=a(22),r={getListData:"/loong/api/datainput-forms",dataInputForm:"/loong/api/datainput-forms",mpointDataInput:"/loong/api/datainput-records/data",historyDatail:"/loong/api/datainput-records/data",history:"/loong/api/datainput-records",historyDelete:"/loong/api/datainput-records",getExcel:n.a+"/loong/api/datainput-mpoints/excel-temlate-down",importExcel:n.a+"/loong/api/datainput-mpoints/excel-import",saveExcelData:"/loong/api/datainput-mpoints/excel-data-save",cancelExcelData:"/loong/api/datainput-mpoints/excel-data-cancel"};e.a=r}}]);