(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{1279:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home-item"},[a("h3",[t._v("实时数据 "),t.isEdit?a("a",{staticClass:"home-edit-btn",attrs:{href:"javascript:;"},on:{click:function(e){t.pointsModalShown=!0}}},[t._v("编辑")]):t._e(),t.isEdit?a("a",{staticClass:"home-del-btn",attrs:{href:"javascript:;"},on:{click:t.del}},[t._v("删除")]):t._e()]),t._v(" "),a("div",{staticClass:"home-card-flex",staticStyle:{position:"relative"}},[t.chartLoading?a("Spin",{attrs:{fix:""}}):t._e(),t._v(" "),a("div",{staticClass:"home-realtime"},[0==t.selectedData.length?a("div",{staticClass:"home-mod-empty"},[t._v("请点击编辑，添加实时数据")]):t._e(),t._v(" "),t._l(t.selectedData,(function(e,n){return a("div",{key:e.id,staticClass:"home-card-item",class:{active:t.chartParams.ids==e.id,"home-card-odd":[0,2,5,7].indexOf(n)>=0},on:{click:function(a){return t.changePoint(e.id)}}},[a("div",{staticClass:"home-card-top",attrs:{title:e.mpointName}},[t._v(t._s(e.mpointName))]),t._v(" "),e.value?a("div",{staticClass:"home-card-value"},[a("strong",{attrs:{title:e.value}},[t._v(t._s(e.value))]),e.unit?a("span",[t._v(t._s(e.unit))]):t._e()]):a("div",{staticClass:"home-card-value home-card-nodata"},[t._v("暂无数据")]),t._v(" "),a("div",{staticClass:"home-card-bottom",attrs:{title:e.siteName}},[t._v(t._s(e.siteName))])])}))],2),t._v(" "),a("div",{staticStyle:{margin:"0 10px",clear:"both"}},[a("mg-date-step",{on:{"on-change":t.dateStepChange}},[a("a",{staticClass:"c-icon-chart",staticStyle:{float:"right"},attrs:{href:"javascript:;"},on:{click:t.linkToAnalysis}})])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.chartParams.ids,expression:"chartParams.ids"}],staticClass:"home-realtime-chart"},[a("div",{attrs:{id:t.chartID}})])],1),t._v(" "),a("Modal",{attrs:{width:"600",title:"选择测点"},model:{value:t.pointsModalShown,callback:function(e){t.pointsModalShown=e},expression:"pointsModalShown"}},[a("mg-mpoint-table",{attrs:{query:{datasource:"AUTO"},columns:t.modalColumns,selected:t.selected,max:8},on:{"on-submit":t.onModalSelect,"on-cancel":t.onModalSelectCancel}}),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"})],1)],1)};n._withStripped=!0;var i=a(23),r=a(11),o=a(517),s=a(31),l=a(556),c=a.n(l),d=a(579),h=a(555);function p(t){return""===t||null===t||Number.isNaN(Number(t))?null:Number(t)}var u={lang:{noData:""},credits:{enabled:!1},title:{floating:!0,text:null},legend:{y:-5,itemStyle:{color:"#576374"}},chart:{type:"spline",height:230,spacingBottom:0,marginTop:30},plotOptions:{spline:{tooltip:{xDateFormat:"%Y-%m-%d %H:%M:%S"},marker:{enabled:!1},turboThreshold:0}},xAxis:{type:"datetime",dateTimeLabelFormats:{millisecond:"%H:%M:%S",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%m-%e",week:"%m-%e",month:"%Y-%m",year:"%Y"}},yAxis:{title:{align:"high",offset:0,text:"mg/L",rotation:0,y:-10,style:{color:"#000000"}}},series:[{}]};c.a.setOptions({global:{useUTC:!1},lang:{thousandsSep:","}});var m={props:{isEdit:Boolean,itemData:Object,orgId:{type:[String,Number],default:-1}},name:"daxRealtime",components:{mgDateStep:d.a,mgMpointTable:h.a},computed:Object(i.b)({sourceText:function(t){return t.map.mpoint.sourceText},datypeText:function(t){return t.map.mpoint.datypeText}}),data:function(){var t=this;return{loading:!1,pointsModalShown:!1,selectedData:[],modalColumns:[{type:"selection",width:50},{title:"区域位置",key:"siteName"},{title:"测点名称",key:"mpointName"},{title:"数据来源",key:"datasource",width:90,render:function(e,a){return e("span",t.sourceText[a.row.datasource])}},{title:"数据分类",key:"datype",width:90,render:function(e,a){return e("span",t.datypeText[a.row.datype])}}],chartParams:{ids:0,beginDate:r.a.transDateFromLocale(o.a.midnight(new Date)),cycle:"day"},chartLoading:!1,chartData:null,chartID:"J_HOME_RAELTIME_CHART_"+this.itemData.i,selected:[]}},methods:{del:function(){this.$emit("on-delete",this.itemData)},getSelectedData:function(){var t=this;if(this.itemData.data&&this.itemData.data.ids){this.chartLoading=!0;var e=[];this.$http.get(s.a.mult_data_mpoints,{ids:this.itemData.data.ids}).then((function(a){t.chartLoading=!1,a.length>8&&(a.length=8),a.forEach((function(t){e.push(t)})),t.selectedData=a,t.selected=t.selectedData,a.length&&(t.chartParams.ids=a[0].id),t.renderChart()}))}},onModalSelect:function(t){var e=this,a=[];t.forEach((function(t){a.push(t.id)})),a.length?(this.$http.post(s.a.modSave,{i:this.itemData.i,data:JSON.stringify({ids:a.join()})}).then((function(t){e.$Notice.success({title:"添加成功！"}),e.itemData.data.ids=a.join(),e.getSelectedData()})),this.pointsModalShown=!1):this.$Notice.info({title:"请选择测点"})},onModalSelectCancel:function(){this.pointsModalShown=!1},dateStepChange:function(t){this.chartParams.beginDate=r.a.transDateFromLocale(t.date),this.chartParams.cycle=t.step,this.renderChart()},linkToAnalysis:function(){this.$router.push({name:"data-analysis-info",params:{id:this.chartData.ids}})},renderChart:function(){var t=this;this.chartParams.ids&&this.$http.get(s.a.daxRealtimeChartData,this.chartParams).then((function(e){new Date(t.chartParams.beginDate).getTime();t.chartData=e.items,t.chartData.ids=t.chartParams.ids;var a=e.items[0],n=function(t){var e=[];return(t||[]).forEach((function(t){e.push([t.dataDate,Number(t.dataValue)])})),e}(a.data),i=o.a.getPeriods(t.chartParams);u.xAxis.max=i.max,u.xAxis.min=i.min,u.yAxis.min=p(a.curveYaxisLowerRange),u.yAxis.max=p(a.curveYaxisUpperRange),u.yAxis.title.text=a.unit,u.series=[{name:a.mpointName+"-"+a.siteName,turboThreshold:0,data:n}];c.a.chart(t.chartID,u)}))},changePoint:function(t){this.chartParams.ids=t,this.renderChart()}},mounted:function(){this.getSelectedData()}},f=(a(838),a(1)),g=Object(f.a)(m,n,[],!1,null,null,null);g.options.__file="src/views/home/components/6/realtime.vue";e.default=g.exports},517:function(t,e,a){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i={F:function(t,e){if(!t)return"";"object"!=n(t)&&(t=new Date(t)),e=e||"yyyy-MM-dd";var a=t.getFullYear().toString(),i={M:t.getMonth()+1,d:t.getDate(),h:t.getHours(),m:t.getMinutes(),s:t.getSeconds()};for(var r in e=e.replace(/(y+)/gi,(function(t,e){return a.substr(4-Math.min(4,e.length))})),i)e=e.replace(new RegExp("("+r+"+)","g"),(function(t,e){return i[r]<10&&e.length>1?"0"+i[r]:i[r]}));return e},str2Date:function(t){if(t)return"object"!=n(t)?new Date(t):t},firstDayByWeek:function(t){var e=i.str2Date(t)||new Date,a=e.getDay(),n=(0==a?7:a)-1;return i.midnight(new Date(e.getTime()-24*n*60*60*1e3))},firstDayByMonth:function(t){var e=i.str2Date(t)||new Date;return i.midnight(new Date(e.getFullYear(),e.getMonth(),1))},firstDayByYear:function(t){var e=i.str2Date(t)||new Date;return i.midnight(new Date(e.getFullYear(),0,1))},countDateByStep:function(t,e,a,n){t=i.formatePolyfill(t);var r,o=i.str2Date(t)||new Date(t),s=o.getTime(),l=(new Date).getTime();switch(a){case"day":r=s+864e5*e;break;case"week":r=s+6048e5*e;break;case"month":r=new Date(o.getFullYear(),o.getMonth()+e,o.getDate()).getTime(),n&&(r=new Date(o.getFullYear(),o.getMonth()+e,o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds()).getTime());break;case"year":r=new Date(o.getFullYear()+e,o.getMonth(),o.getDate()).getTime(),n&&(r=new Date(o.getFullYear()+e,o.getMonth(),o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds()).getTime())}return r>l&&(r=l),n?r:i.midnight(r)},midnight:function(t){return t?i.F(t)+" 00:00:00":""},beforeMidnight:function(t){return t?i.F(t)+" 23:59:59":""},midnightMill:function(t){var e=i.str2Date(t)||new Date;return new Date(i.midnight(e)).getTime()},chain:function(t,e){return i.countDateByStep(t,-1,e)},yearOFyear:function(t){return i.countDateByStep(t,-1,"year")},getPeriods:function(t){var e,a=t.beginDate,n=new Date(i.formatePolyfill(a)),r=n.getTime();switch(t.cycle){case"day":e=r+864e5;break;case"week":e=r+6048e5;break;case"month":e=new Date(n.getFullYear(),n.getMonth()+1,n.getDate(),0,0,0).getTime();break;case"year":e=new Date(n.getFullYear()+1,n.getMonth(),n.getDate(),0,0,0).getTime()}return{min:r,max:new Date(e).getTime()}},formatePolyfill:function(t){return"string"!=typeof t?t:("string"==typeof t&&0==/[TZ]/.test(t)&&(t=t.replace(/-/g,"/")),t)},getTerminalsByMonth:function(t,e){var a,n;return 0==e?(a=new Date(t,0,1,0,0,0),n=new Date(t,11,31,23,59,59)):(a=new Date(t,e-1,1,0,0,0),n=new Date(t,e,0,23,59,59)),{start:a,end:n}},transDateFromServer:function(t,e){return t?("string"==typeof t&&0==/[TZ]/.test(t)&&(t=t.replace(/-/g,"/")),i.F(t,e||"yyyy-MM-dd hh:mm")):""},transDateFromLocale:function(t){return t?("string"==typeof t&&(0==/[TZ]/.test(t)&&(t=t.replace(/-/g,"/")),t=new Date(t)),t.toISOString()):""},strToData:function(t){var e=t.split(" ")[0].split("-"),a=[];return void 0!==t.split(" ")[1]&&(a=t.split(" ")[1].split(":")),new Date(e[0],e[1]-1,e[2],null!==a[0]?a[0]:0,null!==a[1]?a[1]:0,null!==a[2]?a[2]:0)}};e.a=i},518:function(t,e,a){var n=a(530);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(17).default)("4411afe8",n,!1,{})},520:function(t,e,a){"use strict";var n=a(22),i={modalMpoints:"/loong/api/mpoints/dialog",alarmChart:"/loong/api/mpoints/alarm-condition",downloadTemplate:n.a+"/loong/api/mpoints/excel-template-download",exportTemplate:n.a+"/loong/api/mpoints/export",importExcel:n.a+"/loong/api/mpoints/import",saveExcelData:"/loong/api/mpoints/import-save",cancelExcelData:"/loong/api/mpoints/import-cancel",getCategroyData:"/loong/api/mpoints-datacategory",getMpointsList:"/loong/api/mpoints",deleteMpoints:"/loong/api/mpoints",deleteAllMpoints:"/loong/api/mpoints/all",batchSave:"/loong/api/mpoints/batch",autoMpoints:"/loong/api/mpoints-auto",datainputMpoints:"/loong/api/mpoints-datainput",taskMpoints:"/loong/api/mpoints-task",getCalcMpointDetail:"/loong/api/mpoints-calc",getCycle:"/loong/api/mpoints-calc-cycle",getAnalysisMpointDetail:"/loong/api/mpoints-analysis",getMpointNumByType:"/loong/api/mpoints/batch/all",getMpointDataImportList:"/loong/api/mpoint-data-imports",deleteMpointDataImport:"/loong/api/mpoint-data-imports",stopMpointDataImport:"/loong/api/mpoint-data-imports",pointDataImportTempleDownload:n.a+"/loong/api/mpoint-data-imports/templeDownload",pointDataImportFileUpload:n.a+"/loong/api/mpoint-data-imports/fileUpload"};e.a=i},529:function(t,e,a){"use strict";var n=a(518);a.n(n).a},530:function(t,e,a){(e=a(10)(!1)).push([t.i,"\n.cmp-dropdown-tree {\r\n    display: inline-block;\r\n    position: relative;\r\n    vertical-align: middle;\r\n    line-height: normal;\n}\n.ivu-form-item-error .cmp-dropdown-tree-label {\r\n    border: 1px solid #ed3f14;\n}\n.ivu-form-item-error .cmp-dropdown-tree-arrow {\r\n    border-left: 1px solid #ed3f14;\n}\n.cmp-dropdown-tree-label {\r\n    height: 28px;\r\n    width: 100%;\r\n    border: 1px solid #eaeaea;\r\n    display: flex;\r\n    border-radius: 3px;\r\n    cursor: pointer;\n}\n.cmp-dropdown-tree-text {\r\n    line-height: 28px;\r\n    text-indent: 5px;\r\n    flex: 1;\r\n    white-space: nowrap;\r\n    text-overflow: ellipsis;\r\n    overflow: hidden;\n}\n.cmp-dropdown-tree-arrow {\r\n    margin-top: -1px;\r\n    width: 28px;\r\n    height: 28px;\r\n    border-left: 1px solid #eaeaea;\r\n    text-align: center;\r\n    line-height: 28px;\n}\n.cmp-dropdown-tree .ivu-input-group-append {\r\n    width: 25px;\r\n    height: 28px;\r\n    overflow: hidden;\r\n    padding: 0;\n}\n.cmp-dropdown-tree .ivu-btn {\r\n    padding: 5px 10px;\n}\n.cmp-dropdown-tree-tree {\r\n    z-index: 901;\r\n    position: absolute;\r\n    top: 37px;\r\n    left: 0;\r\n    min-width: 300px;\r\n    max-height: 400px;\r\n    overflow: auto;\r\n    padding: 5px 10px;\r\n    background-color: #fff;\r\n    box-shadow: 1px 1px 5px #999;\r\n    border-radius: 3px;\n}\r\n",""]),t.exports=e},531:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.hideTree,expression:"hideTree"}],staticClass:"cmp-dropdown-tree",style:{width:t.width+"px"}},[a("div",{staticClass:"cmp-dropdown-tree-label",on:{click:t.labelClick}},[a("div",{staticClass:"cmp-dropdown-tree-text"},[t._v(t._s(t.value.title))]),t._v(" "),a("div",{staticClass:"cmp-dropdown-tree-arrow"},[a("Icon",{directives:[{name:"show",rawName:"v-show",value:1!=t.isShowTree,expression:"isShowTree != true"}],attrs:{type:"ios-arrow-down"}}),t._v(" "),a("Icon",{directives:[{name:"show",rawName:"v-show",value:1==t.isShowTree,expression:"isShowTree == true"}],attrs:{type:"ios-arrow-up"}})],1)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowTree,expression:"isShowTree"}],staticClass:"cmp-dropdown-tree-tree"},[a("Tree",{attrs:{data:t.datas,"show-checkbox":t.showCheckbox,multiple:t.multiple},on:{"on-select-change":t.selectTree}})],1)])};n._withStripped=!0;var i=a(11),r=a(146),o=a(147);function s(t){return function(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(t){!function t(e){e.forEach((function(e,a){e.childrenIds=function t(e,a){a=a||[];return e.forEach((function(e){e.children.length&&t(e.children,a),a.push(Math.abs(e.id))})),a}(e.children),e.children.length&&t(e.children)}))}(t)}var c={name:"myProcessTreeAuthority",mixins:[r.a],props:{field:String,value:Object,data:Array,url:String,query:Object,showCheckbox:Boolean,multiple:Boolean,width:{type:[Number,String],default:300},type:String},watch:{"value.id":function(t){t?this.flatDatas.length&&(i.a.setTrueTreeExpand(this.datas,t),i.a.setTrueTreeSelected(this.datas,t)):(!function t(e){for(var a,n=e.length,i=0;i<n;i++)1==(a=e[i]).selected&&(a.selected=!1),a.children.length&&t(a.children)}(this.datas),this.$emit("input",{id:"",title:"请选择"}))},data:function(t){this.datas=t}},data:function(){return{datas:this.data,flatDatas:[],isShowTree:!1}},methods:{selectTree:function(t){var e=this,a=[],n=[],i=[],r=this.field||"id",o=[];t.forEach((function(t){a.push(Math.abs(t[r])),n.push(t.key),i.push(t.title),o=o.concat(Math.abs(t[r]),t.childrenIds)})),o=s(new Set(o)),this.$emit("input",{id:a.join(),key:n.join(),title:i.join(),childrenIds:o}),this.$emit("on-change",{id:a.join(),key:n.join(),title:i.join(),childrenIds:o}),this.multiple||(this.isShowTree=!1),setTimeout((function(){e.dispatch("FormItem","on-form-change",{id:a.join(),key:n.join(),title:i.join(),childrenIds:o})}),100)},hideTree:function(){this.isShowTree=!1},labelClick:function(){this.isShowTree=!this.isShowTree}},directives:{clickoutside:o.a},mounted:function(){var t=this;this.url&&this.$http.get(this.url,this.query).then((function(e){e&&e.length&&(e.forEach((function(t){!1===t.authorized&&(t.render=function(t,e){e.root,e.node;return t("span",[e.data.name])})})),"EQUTYPE"==t.type&&e.forEach((function(t){var a=e.filter((function(e){return e.parentId==t.id}));("org"==t.type||a.length>0)&&(t.render=function(t,e){e.root,e.node;return t("span",[e.data.name])})})),"PROCESS"==t.type&&e.forEach((function(t){1==t.type&&(t.render=function(t,e){e.root,e.node;return t("span",[e.data.name])})})),t.flatDatas=e,t.value.id&&(i.a.setTreeExpand(t.flatDatas,t.value.id),i.a.setFlatTreeSelected(t.flatDatas,t.value.id)),t.datas=i.a.transDataToTree(t.flatDatas),l(t.datas))}))}},d=(a(529),a(1)),h=Object(d.a)(c,n,[],!1,null,null,null);h.options.__file="src/components/my-process-tree-authority.vue";e.a=h.exports},536:function(t,e,a){var n=a(551);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(17).default)("f8fc3b20",n,!1,{})},540:function(t,e,a){var n=a(571);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(17).default)("4f138dda",n,!1,{})},550:function(t,e,a){"use strict";var n=a(536);a.n(n).a},551:function(t,e,a){(e=a(10)(!1)).push([t.i,"\n.mg-mp-table-header {\r\n\tdisplay: flex;\r\n\theight: 40px;\n}\n.mg-mp-table-search {\r\n\twidth: 250px;\n}\n.mg-mp-table-tip {\r\n\ttext-align: right;\r\n\tline-height: 30px;\r\n\tcolor: #999;\n}\n.mg-mp-table-tip strong {\r\n\tcolor: #777;\r\n\tmargin: 0 3px;\n}\n.mg-mp-table-search .ivu-icon {\r\n\tright: 35px;\n}\r\n",""]),t.exports=e},555:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mg-mp-table"},[a("div",[a("div",[a("div",{staticClass:"c-form-item"},[a("label",{staticStyle:{width:"auto"}},[t._v("关键字：")]),t._v(" "),a("Input",{staticStyle:{width:"160px"},attrs:{placeholder:t.searchPlaceholder,clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.searchParams.queryName,callback:function(e){t.$set(t.searchParams,"queryName",e)},expression:"searchParams.queryName"}})],1),t._v(" "),a("div",{staticClass:"c-form-item"},[a("label",{staticStyle:{width:"auto"}},[t._v("区域位置：")]),t._v(" "),a("my-process-tree-authority",{ref:"processTree",staticStyle:{width:"160px"},attrs:{url:t.treeApi.getProcessTreeData},on:{"on-change":t.processSelect},model:{value:t.relProcess,callback:function(e){t.relProcess=e},expression:"relProcess"}})],1),t._v(" "),a("div",{staticClass:"c-adv-search-btn"},[a("Button",{staticClass:"c-btn-modal-search",attrs:{type:"primary"},on:{click:t.search}},[t._v("搜索")]),t._v(" "),a("Button",{staticClass:"c-btn-modal-reset",attrs:{type:"primary"},on:{click:t.searchParamsClean}},[t._v("重置")])],1)]),t._v(" "),a("div",{staticClass:"mg-mp-table-tip"},[t._v("已选择"),a("strong",[t._v(t._s(t.selectedTemp.length))]),t._v("个 "),a("a",{staticClass:"c-btn-text",attrs:{href:"javascript:;"},on:{click:t.cleanup}},[t._v("[清空]")])])]),t._v(" "),a("div",{attrs:{id:t.TID}},[a("Table",{ref:t.tableRef,attrs:{columns:t.inColumns,data:t.listData,loading:t.loading,stripe:"",size:"small"},on:{"on-select":t.onSelect,"on-select-cancel":t.onSelectCancel,"on-select-all":t.onSelectAll}})],1),t._v(" "),a("Page",{staticClass:"table-page",attrs:{total:t.total,"page-size":t.searchParams.pageSize,current:t.searchParams.currentPage,"show-total":"","show-elevator":"",size:"small"},on:{"on-change":t.pageChange}}),t._v(" "),a("div",{staticClass:"c-modal-footer-btns",staticStyle:{margin:"30px auto 0"}},[a("Button",{attrs:{type:"default",shape:"circle"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),a("Button",{attrs:{type:"primary",shape:"circle"},on:{click:t.submit}},[t._v("确定")])],1)],1)};n._withStripped=!0;var i=a(11),r=a(107),o=a(520),s={name:"mgMpointTable",components:{myProcessTreeAuthority:a(531).a},props:{columns:Array,disabledRow:Boolean,selected:Array,max:Number,manual:Boolean,field:String,query:Object},watch:{selected:function(t){var e=JSON.stringify(t);this.selectedTemp=JSON.parse(e),this.selectedTruth=JSON.parse(e),this.checkSelection()}},data:function(){return{searchPlaceholder:"输入测点名称以检索",relProcess:{id:"",title:"请选择"},treeApi:r.a,url:o.a.modalMpoints,inColumns:[{type:"selection",width:50},{title:"测点编号",width:120,key:"mpointId"},{title:"区域位置",key:"siteName"},{title:"测点名称",key:"mpointName"}],TID:"",searchParams:{queryName:"",siteId:"",currentPage:1,pageSize:10},listData:[],selectedTemp:[],selectedTruth:[],loading:!1,total:0,tableRef:""}},methods:{searchParamsClean:function(){this.searchParams=Object.assign({},{queryName:"",siteId:"",currentPage:1,pageSize:10},this.query||{}),this.relProcess={id:"",title:"请选择"}},processSelect:function(t){this.searchParams.siteId=t.id},cleanup:function(){this.selectedTemp=[],this.selectedTruth=[],this.checkSelection()},getData:function(){var t=this;this.loading=!0,this.$http.get(this.url,this.searchParams).then((function(e){var a=e.items?e.items:[];t.disabledRow&&a.forEach((function(t){t.disabled&&(t._disabled=!0)})),t.field&&a.forEach((function(e){e.id||(e.id=e[t.field])})),t.listData=a,t.total=e.total,t.loading=!1,t.checkSelection()}))},pageChange:function(t){this.searchParams.currentPage=t,this.getData()},search:function(){this.searchParams.currentPage=1,this.getData()},onSelect:function(t,e){var a=this.selectedTemp;this.max&&a.length>=this.max?(this.$Notice.info({title:"最多选择"+this.max+"个"}),this.cancelChecked(e.id)):this.selectedTemp.push(e)},onSelectCancel:function(t,e){var a=this;this.selectedTemp.forEach((function(t,n){t.id==e.id&&a.selectedTemp.splice(n,1)}))},onSelectAll:function(t){0==t.length?this.removeTableFromTemp(this.listData):this.addTableToTemp(t)},addTableToTemp:function(t){var e=this.selectedTemp;t.forEach((function(t){var a=!1;e.forEach((function(e,n){e.id==t.id&&(a=!0)})),a||e.push(t)}))},removeTableFromTemp:function(t){for(var e=this.selectedTemp,a=e.length;a--;){var n=!1;t.forEach((function(t){t.id==e[a].id&&(n=!0)})),n&&e.splice(a,1)}},cancelChecked:function(t){var e=this;this.checkSelection();var a=this.selectedTemp,n=[];a.forEach((function(a){a.id==t&&e.$set(a,"_checked",!1),n.push(a)})),this.selectedTemp=n},checkSelection:function(){var t=this;this.$nextTick((function(){var e=t.listData,a=t.selectedTemp,n=t.$refs[t.tableRef];e.forEach((function(t,e){var i=n.$refs.tbody.objData[e];i._isChecked=!1,a.forEach((function(e){e.id==t.id&&(i._isChecked=!0)}))}))}))},submit:function(){this.selectedTruth=i.a.copyArray(this.selectedTemp),this.$emit("on-submit",this.selectedTruth)},cancel:function(){this.selectedTemp=i.a.copyArray(this.selectedTruth),this.checkSelection(),this.$emit("on-cancel")}},mounted:function(){this.max&&(document.querySelector("#"+this.TID).querySelector(".ivu-table-header").querySelector(".ivu-table-cell").style.display="none"),this.query&&(this.searchParams=Object.assign({},{queryName:"",siteId:"",currentPage:1,pageSize:10},this.query)),this.getData()},created:function(){var t=i.a.gusid(6);this.TID="J_TABLE_"+t,this.tableRef="mg-select-table-"+t,this.columns&&(this.inColumns=this.columns),i.a.initTableColumnTitle(this.inColumns)}},l=(a(550),a(1)),c=Object(l.a)(s,n,[],!1,null,null,null);c.options.__file="src/components/mg-mpoint-table.vue";e.a=c.exports},570:function(t,e,a){"use strict";var n=a(540);a.n(n).a},571:function(t,e,a){(e=a(10)(!1)).push([t.i,"\n.cmp-date-step-icon {\r\n    display: inline-block;\r\n    vertical-align: bottom;\r\n    /* margin-left: ; */\n}\n.cmp-date-step-icon a {\r\n    display: inline-block;\r\n    margin: 0 5px;\n}\r\n",""]),t.exports=e},579:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cmp-date-step"},[a("label",{attrs:{for:""}},[t._v("起始时间：")]),t._v(" "),a("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"date",format:"yyyy-MM-dd HH:mm:ss",placeholder:"选择时间",size:"small",editable:t.editable,clearable:t.clearable},on:{"on-change":t.dateChange},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}),t._v(" "),a("div",{staticClass:"cmp-date-step-icon"},[a("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.dateRelaChange(-1)}}},[a("Icon",{attrs:{type:"arrow-left-b",size:"22",color:"#4B7EFE"}})],1),t._v(" "),a("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.dateRelaChange(1)}}},[a("Icon",{attrs:{type:"arrow-right-b",size:"22",color:"#4B7EFE"}})],1),t._v(" "),a("a",{attrs:{href:"javascript:;"},on:{click:t.dateRelaLastest}},[a("Icon",{attrs:{type:"ios-skipforward",size:"22",color:"#4B7EFE"}})],1)]),t._v(" "),a("label",{attrs:{for:""}},[t._v("时间跨度：")]),t._v(" "),a("Select",{staticStyle:{width:"70px"},attrs:{size:"small"},on:{"on-change":t.dateStepChange},model:{value:t.step,callback:function(e){t.step=e},expression:"step"}},[a("Option",{attrs:{value:"day"}},[t._v("天")]),t._v(" "),a("Option",{attrs:{value:"week"}},[t._v("周")]),t._v(" "),a("Option",{attrs:{value:"month"}},[t._v("月")]),t._v(" "),a("Option",{attrs:{value:"year"}},[t._v("年")])],1),t._v(" "),t._t("default")],2)};n._withStripped=!0;var i=a(517),r={name:"mgDateStep",props:{editable:!1,clearable:!1,value:{type:String,default:""}},data:function(){return{startDate:this.value.split("#")[0]||i.a.midnight(new Date),step:this.value.split("#")[1]||"day"}},methods:{dateChange:function(){this.$emit("on-change",{date:i.a.midnight(this.startDate),step:this.step})},dateStepChange:function(){switch(this.step){case"day":this.startDate=i.a.midnight(new Date);break;case"week":this.startDate=i.a.firstDayByWeek();break;case"month":this.startDate=i.a.firstDayByMonth();break;case"year":this.startDate=i.a.firstDayByYear()}this.$emit("on-timeRangeChange",{date:this.startDate,step:this.step}),this.$emit("on-change",{date:this.startDate,step:this.step})},dateRelaChange:function(t){var e=this.startDate,a=this.step;this.startDate=i.a.countDateByStep(e,t,a),this.$emit("on-change",{date:this.startDate,step:this.step})},dateRelaLastest:function(){this.dateStepChange()},resetDate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.value;this.startDate=t.split("#")[0]||i.a.midnight(new Date),this.step=t.split("#")[1]||"day"}},mounted:function(){}},o=(a(570),a(1)),s=Object(o.a)(r,n,[],!1,null,null,null);s.options.__file="src/components/mg-date-step.vue";e.a=s.exports},632:function(t,e,a){var n=a(839);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(17).default)("64115bd0",n,!1,{})},838:function(t,e,a){"use strict";var n=a(632);a.n(n).a},839:function(t,e,a){var n=a(10),i=a(212);(e=n(!1)).i(i),e.push([t.i,"\n.home-realtime {\r\n\toverflow: hidden;\r\n\theight: 195px;\n}\n.home-realtime .home-card-item {\r\n\tbackground-color: #EEEFF3;\n}\n.home-realtime .home-card-odd {\r\n\tbackground-color: #F8F9FB;\n}\n.home-realtime .active {\r\n\tbackground-color: #EEF0FC;\n}\n.home-realtime .home-card-value {\r\n\tcolor: #576374;\n}\n.active .home-card-top, .active .home-card-value {\r\n\tcolor: #4B7EFE;\n}\n.active .home-card-bottom {\r\n\tcolor: #A6BEFB;\r\n\tbackground-position: 0 -28px;\n}\r\n",""]),t.exports=e}}]);