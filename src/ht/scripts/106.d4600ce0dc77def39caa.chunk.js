(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{1127:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"c-tree"},[r("div",{staticClass:"c-tree-left",attrs:{id:"J_TREE_LEFT"}},[r("div",{staticStyle:{padding:"2px"}},[r("Select",{staticStyle:{width:"100%"},attrs:{placeholder:"输入简报名称以检索",clearable:"",filterable:"",remote:"","remote-method":e.onSearch,loading:e.searchLoading},on:{"on-change":e.onSearchItemClick}},e._l(e.searchItems,(function(t){return r("Option",{key:t.id,attrs:{value:JSON.stringify(t)}},[e._v(e._s(t.name))])})),1)],1),e._v(" "),r("div",{staticClass:"padding-l-10",staticStyle:{"border-top":"1px solid #e6e6e6",position:"relative"}},[e.treeLoading?r("Spin",{attrs:{fix:""}}):e._e(),e._v(" "),r("Tree",{attrs:{data:e.treeData,render:e.renderContent}})],1)]),e._v(" "),r("div",{staticClass:"c-main-border c-tree-right",staticStyle:{overflow:"auto"}},[r("brief",{model:{value:e.inputForm,callback:function(t){e.inputForm=t},expression:"inputForm"}})],1)])};a._withStripped=!0;var n=r(11),i=(r(517),r(580)),o=r(533),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"report-brief"},[r("div",{staticClass:"c-left-border-blue"},[r("div",{staticClass:"c-form-item"},[r("label",[e._v("业务时间：")]),e._v(" "),r("DatePicker",{ref:"date1",staticStyle:{width:"250px"},attrs:{type:e.dateType,rules:{required:!0,message:"请选择业务时间",trigger:"blur"},placeholder:"业务时间"},on:{"on-change":e.showPointValues},model:{value:e.recordDate,callback:function(t){e.recordDate=t},expression:"recordDate"}})],1),e._v(" "),r("div",{staticClass:"c-form-item"},[r("label",[e._v("分组内容：")]),e._v(" "),r("Select",{staticStyle:{width:"200px"},on:{"on-change":e.groupNameChange},model:{value:e.findGroupName,callback:function(t){e.findGroupName=t},expression:"findGroupName"}},e._l(e.data.items.groups,(function(t,a){return r("Option",{key:a,attrs:{value:a}},[e._v(e._s(a.substr(a.indexOf(",")+1)))])})),1)],1)]),e._v(" "),r("div",{staticClass:"c-top-border-gray"},[r("div",{staticClass:"c-table-top-btns"},[r("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle"},on:{click:e.briefExport}},[e._v("导出")])],1),e._v(" "),r("div",{staticStyle:{padding:"10px"}},[r("div",{staticStyle:{padding:"5px 5px 5px 0 !important"}},[r("b",[e._v(e._s(e.data.record.formName))])]),e._v(" "),r("div",{staticStyle:{padding:"5px 5px 5px 0 !important",color:"gray"}},[e._v(e._s(e.reportDate(e.recordDate))+" ")]),e._v(" "),e._l(e.data.items.groups,(function(t,a){return r("div",[r("div",{staticClass:"ivu-table-wrapper"},[r("div",{staticClass:"ivu-table ivu-table-stripe ivu-table-small"},[r("div",{staticClass:"ivu-table-header"},[r("table",[r("thead",[r("tr",[r("th",{attrs:{id:a,title:a.substr(a.indexOf(",")+1)}},[e._v(e._s(a.substr(a.indexOf(",")+1)))])])])])]),e._v(" "),r("div",{staticClass:"ivu-table-body"},[e._l(t,(function(t,a){return[r("div",{class:"single"==t.textType?"report-brief-col-2":"report-brief-col-1"},[r("div",{staticClass:"item-name ell",attrs:{title:t.mpointName}},[e._v(e._s(t.mpointName))]),e._v(" "),"single"==t.textType?r("div",{staticClass:"item-value ell",attrs:{title:t.datas[0].value}},[e._v(e._s(t.datas[0].value))]):e._e(),e._v(" "),"single"!=t.textType?r("div",{staticClass:"item-value"},[e._v(e._s(t.datas[0].value))]):e._e()])]}))],2)])])])}))],2)])])};s._withStripped=!0;r(107),r(39);var l={props:{value:Object},watch:{"value.id":function(){this.showPointValues()}},data:function(){return{findGroupName:"",data:{record:{recordDate:"",formName:""},items:{groups:[]}},cycleId:this.$route.params.cycleId,recordDate:new Date}},mounted:function(){this.showPointValues()},methods:{reportDate:function(e){var t=this.value.cycleId,r="";if("D"==t)r=n.a.F(e,"yyyy年MM月dd日");else if("W"==t)r=n.a.F(e,"yyyy年MM月dd日");else if("M"==t)r=n.a.F(e,"yyyy年MM月");else if("Q"==t){var a=new Date(e).getMonth(),i="";a<3?i="第一季度":a<6?i="第二季度":a<9?i="第三季度":a<12&&(i="第四季度"),r=n.a.F(e,"yyyy年")+i}else"Y"==t&&(r=n.a.F(e,"yyyy年"));return r},showPointValues:function(){var e=this,t={};if(t.formId=this.value.id,this.value.id){var r=this.recordDate||this.value.recordDate;t.recordDate=r?n.a.F(r,"yyyy-MM-dd")+" 00:00:00":n.a.F(new Date,"yyyy-MM-dd")+" 00:00:00",t.recordDate=n.a.transDateFromLocale(t.recordDate),t.cycleId=this.value.cycleId,this.$http.get(o.a.historyDatail,t).then((function(a){for(var n in e.$refs.date1.options.disabledDate=function(e){return e>new Date||("W"==t.cycleId?1!=e.getDay():void 0)},a.record||(a.record={recordDate:r,formName:""}),a.record.recordDate||(a.record.recordDate=r),a.items.groups)for(var i=a.items.groups[n],o=0;o<i.length;o++)i[o].mpointName+=" ";e.data=a}))}},groupNameChange:function(e){document.getElementById(e).scrollIntoView(!0)},hasTextarea:function(e){for(var t=0;t<e.length;t++)if("multi"==e[t].textType)return!0;return!1},back:function(){this.$router.back()},briefExport:function(){var e=this.recordDate;e=e?n.a.F(e,"yyyy-MM-dd")+" 00:00:00":n.a.F(new Date,"yyyy-MM-dd")+" 00:00:00",n.a.download(i.a.exportBrief,{formId:this.value.id,recordDate:n.a.transDateFromLocale(e),cycleId:this.value.cycleId})}},computed:{dateType:function(){var e="date";switch(this.value.cycleId){case"D":case"W":e="date";break;case"M":case"Q":e="month";break;case"Y":e="year"}return e}}},c=(r(989),r(1)),d=Object(c.a)(l,s,[],!1,null,null,null);d.options.__file="src/views/report/show/brief.vue";var p={data:function(){return{searchLoading:!1,searchItems:[],treeData:[],activeTreeId:"",inputForm:{},treeLoading:!1}},components:{brief:d.exports},methods:{onSearch:function(e){var t=this;e&&(this.searchLoading=!0,this.$http.get(i.a.briefTree,{query:e}).then((function(e){t.searchLoading=!1,t.searchItems=e.filter((function(e){return 20==e.type}))||[]})).catch((function(){t.searchLoading=!1})))},onSearchItemClick:function(e){var t=JSON.parse(e);n.a.setTrueTreeExpand(this.treeData,t.id),this.activeTreeId=t.id,this.getData()},getTreeData:function(){var e=this;this.treeLoading=!0,this.$http.get(i.a.briefTree).then((function(t){var r=n.a.getItemAndParentsByTypeId(t,!1,[20]);e.treeData=n.a.transDataToTree(r.map((function(e){return e.expand=!0,e}))),e.treeLoading=!1}))},renderContent:function(e,t){var r=this,a=(t.root,t.node,t.data),n=a.name;return 20==a.type&&(n=[e("span",{class:{"ivu-tree-title":!0,"ivu-tree-title-selected":this.activeTreeId==a.id},on:{click:function(){r.activeTreeId=a.id,r.getData()}}},a.name)]),e("div",{class:["c-tree-row"]},n)},getData:function(){var e,t=this;this.$http.get(o.a.dataInputForm+"/"+(e=this.activeTreeId,e.replace(/(datainput_)/gi,""))).then((function(e){t.inputForm=e}))}},mounted:function(){n.a.setTreeLeftHeight(),this.getTreeData()}},u=Object(c.a)(p,a,[],!1,null,null,null);u.options.__file="src/views/report/briefing.vue";t.default=u.exports},517:function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n={F:function(e,t){if(!e)return"";"object"!=a(e)&&(e=new Date(e)),t=t||"yyyy-MM-dd";var r=e.getFullYear().toString(),n={M:e.getMonth()+1,d:e.getDate(),h:e.getHours(),m:e.getMinutes(),s:e.getSeconds()};for(var i in t=t.replace(/(y+)/gi,(function(e,t){return r.substr(4-Math.min(4,t.length))})),n)t=t.replace(new RegExp("("+i+"+)","g"),(function(e,t){return n[i]<10&&t.length>1?"0"+n[i]:n[i]}));return t},str2Date:function(e){if(e)return"object"!=a(e)?new Date(e):e},firstDayByWeek:function(e){var t=n.str2Date(e)||new Date,r=t.getDay(),a=(0==r?7:r)-1;return n.midnight(new Date(t.getTime()-24*a*60*60*1e3))},firstDayByMonth:function(e){var t=n.str2Date(e)||new Date;return n.midnight(new Date(t.getFullYear(),t.getMonth(),1))},firstDayByYear:function(e){var t=n.str2Date(e)||new Date;return n.midnight(new Date(t.getFullYear(),0,1))},countDateByStep:function(e,t,r,a){e=n.formatePolyfill(e);var i,o=n.str2Date(e)||new Date(e),s=o.getTime(),l=(new Date).getTime();switch(r){case"day":i=s+864e5*t;break;case"week":i=s+6048e5*t;break;case"month":i=new Date(o.getFullYear(),o.getMonth()+t,o.getDate()).getTime(),a&&(i=new Date(o.getFullYear(),o.getMonth()+t,o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds()).getTime());break;case"year":i=new Date(o.getFullYear()+t,o.getMonth(),o.getDate()).getTime(),a&&(i=new Date(o.getFullYear()+t,o.getMonth(),o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds()).getTime())}return i>l&&(i=l),a?i:n.midnight(i)},midnight:function(e){return e?n.F(e)+" 00:00:00":""},beforeMidnight:function(e){return e?n.F(e)+" 23:59:59":""},midnightMill:function(e){var t=n.str2Date(e)||new Date;return new Date(n.midnight(t)).getTime()},chain:function(e,t){return n.countDateByStep(e,-1,t)},yearOFyear:function(e){return n.countDateByStep(e,-1,"year")},getPeriods:function(e){var t,r=e.beginDate,a=new Date(n.formatePolyfill(r)),i=a.getTime();switch(e.cycle){case"day":t=i+864e5;break;case"week":t=i+6048e5;break;case"month":t=new Date(a.getFullYear(),a.getMonth()+1,a.getDate(),0,0,0).getTime();break;case"year":t=new Date(a.getFullYear()+1,a.getMonth(),a.getDate(),0,0,0).getTime()}return{min:i,max:new Date(t).getTime()}},formatePolyfill:function(e){return"string"!=typeof e?e:("string"==typeof e&&0==/[TZ]/.test(e)&&(e=e.replace(/-/g,"/")),e)},getTerminalsByMonth:function(e,t){var r,a;return 0==t?(r=new Date(e,0,1,0,0,0),a=new Date(e,11,31,23,59,59)):(r=new Date(e,t-1,1,0,0,0),a=new Date(e,t,0,23,59,59)),{start:r,end:a}},transDateFromServer:function(e,t){return e?("string"==typeof e&&0==/[TZ]/.test(e)&&(e=e.replace(/-/g,"/")),n.F(e,t||"yyyy-MM-dd hh:mm")):""},transDateFromLocale:function(e){return e?("string"==typeof e&&(0==/[TZ]/.test(e)&&(e=e.replace(/-/g,"/")),e=new Date(e)),e.toISOString()):""},strToData:function(e){var t=e.split(" ")[0].split("-"),r=[];return void 0!==e.split(" ")[1]&&(r=e.split(" ")[1].split(":")),new Date(t[0],t[1]-1,t[2],null!==r[0]?r[0]:0,null!==r[1]?r[1]:0,null!==r[2]?r[2]:0)}};t.a=n},533:function(e,t,r){"use strict";var a=r(22),n={getListData:"/loong/api/datainput-forms",dataInputForm:"/loong/api/datainput-forms",mpointDataInput:"/loong/api/datainput-records/data",historyDatail:"/loong/api/datainput-records/data",history:"/loong/api/datainput-records",historyDelete:"/loong/api/datainput-records",getExcel:a.a+"/loong/api/datainput-mpoints/excel-temlate-down",importExcel:a.a+"/loong/api/datainput-mpoints/excel-import",saveExcelData:"/loong/api/datainput-mpoints/excel-data-save",cancelExcelData:"/loong/api/datainput-mpoints/excel-data-cancel"};t.a=n},580:function(e,t,r){"use strict";var a=r(22),n={tree:"/loong/api/reports/tree",normalTree:"/loong/api/normal-reports/tree",smartTree:"/loong/api/smart-reports/tree",briefTree:"/loong/api/datainput-reports/tree",folder:"/loong/api/folders",template:"/loong/api/report-templates",data:"/loong/api/reports/data",getReportUrl:"/loong/api/report/server-url",exportReport:a.a+"/loong/api/reports/export",exportBrief:a.a+"/loong/api/datainput-reports/export",getSessionId:"/loong/api/smart-reports/server-session-id",redirect:a.a+"/loong/api/smart-reports/server-url?reportUrl="};t.a=n},719:function(e,t,r){var a=r(990);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,r(17).default)("b6a7c5c6",a,!1,{})},989:function(e,t,r){"use strict";var a=r(719);r.n(a).a},990:function(e,t,r){(t=r(10)(!1)).push([e.i,'\n.report-brief .c-top-border-gray {\r\n    padding: 0;\n}\r\n/* 导出按钮 */\n.report-brief .c-table-top-btns {\r\n    padding: 10px;\r\n    border-bottom: 1px solid #e6e6e6;\r\n    height: 50px;\n}\n.report-brief table {\r\n    width: 100%;\r\n    border-collapse: collapse;\n}\n.report-brief th,\r\n.report-brief td {\r\n    padding: 5px 5px 5px 10px !important;\r\n    text-align: left;\r\n    border-bottom: none !important;\n}\n.report-brief .ivu-table-body {\r\n    overflow: hidden;\r\n    font-size: 0;\n}\r\n/* 单行测点与多行测点 */\n.report-brief-col-1,\r\n.report-brief-col-2 {\r\n    min-height: 40px;\r\n    border-bottom: 1px solid #dddee1;\n}\r\n/* 单行测点 */\n.report-brief-col-1 {\r\n    padding: 0 5px;\r\n    width: 100%;\r\n    clear: both;\r\n    overflow: hidden;\n}\r\n/* 多行测点 */\n.report-brief-col-2 {\r\n    display: inline-block;\r\n    padding: 0 0 0 5px;\r\n    border-right: 1px solid #dddee1;\r\n    width: 50%;\r\n    position: relative;\n}\n.report-brief-col-2:after {\r\n    content: "";\r\n    width: 100%;\r\n    border-bottom: 1px solid #dddee1;\r\n    position: absolute;\r\n    left: 100%;\r\n    bottom: -1px;\n}\r\n/* 测点名称 */\n.report-brief .ivu-table-body .item-name {\r\n    font-weight: bold;\r\n    height: 16px;\r\n    line-height: 16px;\r\n    border-right: 1px solid #e9e9e9;\r\n    margin: 12px 0;\r\n    padding: 0 5px;\n}\r\n/* 测点值 */\n.report-brief .ivu-table-body .item-value {\r\n    color: rgb(114, 114, 114);\r\n    line-height: 20px;\r\n    padding: 5px 10px;\n}\n.report-brief .ivu-table-body .item-name,\r\n.report-brief .ivu-table-body .item-value {\r\n    display: inline-block;\r\n    font-size: 13px;\n}\r\n/* 多行测点的测点名称 */\n.report-brief-col-1 .item-name {\r\n    width: 25%;\r\n    vertical-align: middle;\n}\r\n/* 多行测点的测点值 */\n.report-brief-col-1 .item-value {\r\n    width: 75%;\r\n    vertical-align: middle;\n}\r\n/* 单行测点 */\n.report-brief-col-2 > div {\r\n    width: 50%;\r\n    float: left;\n}\r\n/* 单行测点的测点值 */\n.report-brief-col-2 .item-value {\r\n    margin: 5px 0;\r\n    overflow: hidden;\n}\r\n',""]),e.exports=t}}]);