(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{1130:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home-item"},[n("h3",[e._v("视频监视 "),n("a",{staticClass:"home-fullscreen-trigger",attrs:{href:"javascript:;"},on:{click:e.toggle}},[e._v("全屏")]),e.isEdit?n("a",{staticClass:"home-edit-btn",attrs:{href:"javascript:;"},on:{click:function(t){e.monitorModalShown=!0}}},[e._v("编辑")]):e._e(),e.isEdit?n("a",{staticClass:"home-del-btn",attrs:{href:"javascript:;"},on:{click:e.del}},[e._v("删除")]):e._e()]),e._v(" "),n("div",{class:[e.homeMonitorFlexClass],staticStyle:{"padding-left":"10px",height:"440px"}},[n("fullscreen",{ref:e.fullscreenRef},[0==e.selectedData.length?n("div",{staticStyle:{"line-height":"80px","text-align":"center"}},[e._v("请点击编辑，添加视频监视")]):e._e(),e._v(" "),n("mg-hls",{attrs:{selected:e.selectedData,className:["home-monitor-win"]}})],1)],1),e._v(" "),n("Modal",{attrs:{width:400,title:"选择视频","class-name":"dax-home-monitor-modal"},model:{value:e.monitorModalShown,callback:function(t){e.monitorModalShown=t},expression:"monitorModalShown"}},[n("mg-select-table",{ref:"modalTable",attrs:{columns:e.modalColumns,url:e.modalUrl,selected:e.selected,searchPlaceholder:"输入视频名称以检索",max:9},on:{"on-submit":e.onModalSelect,"on-cancel":e.onModalSelectCancel}}),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"})],1)],1)};i._withStripped=!0;var o=n(538),r=n.n(o),a=n(7),s=n(11),l=n(31),c=n(537),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{height:"100%",overflow:"hidden"}},e._l(e.videos,(function(t){return n("div",{key:t.guid,class:e.className,style:e.styles},[n("video",{attrs:{id:t.guid,width:"100%",autoplay:"autoplay",muted:"muted"},domProps:{muted:!0}})])})),0)};u._withStripped=!0;var d=n(783),h=n.n(d);var m={name:"mgHls",props:{selected:Array,styles:Object,className:Array},data:function(){return{videos:[]}},watch:{selected:function(e){this.rebuild(e)}},methods:{rebuild:function(e){this.cleanup();var t=e;t.forEach((function(e){var t="m"+s.a.gusid(8,16);e.guid=t})),this.videos=t,this.$nextTick((function(){t.forEach((function(e){var t=function(e,t){var n=document.getElementById(e),i=new h.a;return i.attachMedia(n),i.on(h.a.Events.MEDIA_ATTACHED,(function(){i.loadSource(t)})),i.on(h.a.Events.MANIFEST_PARSED,(function(e,t){})),i.on(h.a.Events.ERROR,(function(e,t){if(console.log("Hls.Events.ERROR:"),t.fatal)switch(t.type){case h.a.ErrorTypes.NETWORK_ERROR:i.startLoad();break;case h.a.ErrorTypes.MEDIA_ERROR:i.recoverMediaError();break;default:i.destroy()}})),i}(e.guid,e.url);e.hls=t}))}))},cleanup:function(){this.videos.forEach((function(e){e.hls.stopLoad(),e.hls.detachMedia(),e.hls.destroy()})),this.videos=[]}},mounted:function(){},beforeDestroy:function(){this.cleanup()}},f=n(1),p=Object(f.a)(m,u,[],!1,null,null,null);p.options.__file="src/components/mg-hls.vue";var g=p.exports;a.default.use(r.a);var v={props:{isEdit:Boolean,itemData:Object,orgId:{type:[String,Number],default:-1}},name:"daxMonitor",components:{mgSelectTable:c.a,mgHls:g},data:function(){return{monitorModalShown:!1,modalColumns:[{type:"selection",width:50},{title:"视频名称",key:"name"}],selected:[],selectedData:[],modalUrl:l.a.daxMonitors,homeMonitorFlexClass:"home-monitor-single",fullscreenRef:"fullscreen_"+s.a.gusid(8)}},methods:{toggle:function(e){this.$refs[this.fullscreenRef].toggle()},del:function(){this.$emit("on-delete",this.itemData)},getSelectedData:function(){var e=this;this.itemData.data&&this.itemData.data.ids&&this.$http.get(l.a.mult_data_videos,{ids:this.itemData.data.ids}).then((function(t){var n=t||[];n.forEach((function(e){e.id=e.videoId})),e.selectedData=(n||[]).concat([]),e.selected=(n||[]).concat([]),e.renderFlex()}))},onModalSelect:function(e){var t=this,n=[];e.forEach((function(e){n.push(e.id)})),n.length?this.$http.post(l.a.modSave,{i:this.itemData.i,data:JSON.stringify({ids:n.join()})}).then((function(e){t.$Notice.success({title:"添加成功！"}),t.monitorModalShown=!1,t.itemData.data.ids=n.join(),t.getSelectedData()})):this.$Notice.info({title:"请选择画面"})},onModalSelectCancel:function(e,t){this.monitorModalShown=!1},renderFlex:function(){var e=this.selectedData.length,t="";t=e<=1?"home-monitor-single":e>1&&e<5?"home-monitor-2-2":e>=5&&e<=6?"home-monitor-3-2":"home-monitor-3-3",this.homeMonitorFlexClass=t}},mounted:function(){this.getSelectedData()}},b=(n(830),Object(f.a)(v,i,[],!1,null,null,null));b.options.__file="src/views/home/components/5/monitor.vue";t.default=b.exports},528:function(e,t,n){var i=n(535);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,n(17).default)("ad278fbc",i,!1,{})},534:function(e,t,n){"use strict";var i=n(528);n.n(i).a},535:function(e,t,n){(t=n(10)(!1)).push([e.i,"\n.mg-select-table-tip {\r\n\ttext-align: right;\r\n\tline-height: 30px;\r\n\tcolor: #999;\n}\n.mg-select-table-tip strong {\r\n\tcolor: #777;\r\n\tmargin: 0 3px;\n}\n.mg-select-table-search .ivu-icon {\r\n\tright: 35px;\n}\r\n",""]),e.exports=t},537:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mg-select-table"},[e._t("top"),e._v(" "),n("div",{staticClass:"mg-select-table-header"},[e._t("default",[n("div",{staticClass:"mg-select-table-search"},[n("Input",{staticStyle:{width:"200px"},attrs:{placeholder:e.searchPlaceholder,clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.searchParams.queryName,callback:function(t){e.$set(e.searchParams,"queryName",t)},expression:"searchParams.queryName"}},[n("Button",{attrs:{slot:"append",icon:"ios-search"},on:{click:e.search},slot:"append"})],1)],1)]),e._v(" "),n("div",{staticClass:"mg-select-table-tip"},[e._v("已选择"),n("strong",[e._v(e._s(e.selectedTemp.length))]),e._v("个 "),n("a",{staticClass:"c-btn-text",attrs:{href:"javascript:;"},on:{click:e.cleanup}},[e._v("[清空]")])])],2),e._v(" "),n("div",{attrs:{id:e.TID}},[n("Table",{ref:e.tableRef,attrs:{columns:e.columns,data:e.listData,loading:e.loading,stripe:"",size:e.size},on:{"on-select":e.onSelect,"on-select-cancel":e.onSelectCancel,"on-select-all":e.onSelectAll}})],1),e._v(" "),n("Page",{staticClass:"table-page",attrs:{total:e.total,"page-size":e.searchParams.pageSize,current:e.searchParams.currentPage,"show-total":"","show-elevator":"",size:e.size},on:{"on-change":e.pageChange}}),e._v(" "),n("div",{staticClass:"c-modal-footer-btns",staticStyle:{margin:"30px auto 0"}},[n("Button",{attrs:{type:"default",shape:"circle"},on:{click:e.cancel}},[e._v("取消")]),e._v(" "),n("Button",{attrs:{type:"primary",shape:"circle"},on:{click:e.submit}},[e._v("确定")])],1)],2)};i._withStripped=!0;var o=n(11),r={name:"mgSelectTable",props:{disabledRow:Boolean,selected:Array,searchPlaceholder:String,columns:{type:Array,default:[]},url:String,size:{type:String,default:"small"},max:Number,manual:Boolean,field:String},watch:{selected:function(e){var t=JSON.stringify(e);this.selectedTemp=JSON.parse(t),this.selectedTruth=JSON.parse(t),this.checkSelection()}},data:function(){return{TID:"",searchParams:{queryName:"",currentPage:1,pageSize:10},listData:[],selectedTemp:[],selectedTruth:[],loading:!1,total:0,tableRef:""}},methods:{cleanup:function(){this.selectedTemp=[],this.selectedTruth=[],this.checkSelection()},getData:function(e){var t=this;e&&(this.searchParams=Object.assign({},{queryName:"",currentPage:1,pageSize:10},e)),this.loading=!0,this.$http.get(this.url,this.searchParams).then((function(e){var n=e.items?e.items:[];t.disabledRow&&n.forEach((function(e){e.disabled&&(e._disabled=!0)})),t.field&&n.forEach((function(e){e.id||(e.id=e[t.field])})),t.listData=n,t.total=e.total,t.loading=!1,t.checkSelection()}))},pageChange:function(e){this.searchParams.currentPage=e,this.getData()},search:function(){this.searchParams.currentPage=1,this.getData()},onSelect:function(e,t){var n=this.selectedTemp;this.max&&n.length>=this.max?(this.$Notice.info({title:"最多选择"+this.max+"个"}),this.cancelChecked(t.id)):this.selectedTemp.push(t)},onSelectCancel:function(e,t){var n=this;this.selectedTemp.forEach((function(e,i){e.id==t.id&&n.selectedTemp.splice(i,1)}))},onSelectAll:function(e){0==e.length?this.removeTableFromTemp(this.listData):this.addTableToTemp(e)},addTableToTemp:function(e){var t=this.selectedTemp;e.forEach((function(e){var n=!1;t.forEach((function(t,i){t.id==e.id&&(n=!0)})),n||t.push(e)}))},removeTableFromTemp:function(e){for(var t=this.selectedTemp,n=t.length;n--;){var i=!1;e.forEach((function(e){e.id==t[n].id&&(i=!0)})),i&&t.splice(n,1)}},cancelChecked:function(e){var t=this;this.checkSelection();var n=this.selectedTemp,i=[];n.forEach((function(n){n.id==e&&t.$set(n,"_checked",!1),i.push(n)})),this.selectedTemp=i},checkSelection:function(){var e=this;this.$nextTick((function(){var t=e.listData,n=e.selectedTemp,i=e.$refs[e.tableRef];t.forEach((function(e,t){var o=i.$refs.tbody.objData[t];o._isChecked=!1,n.forEach((function(t){t.id==e.id&&(o._isChecked=!0)}))}))}))},submit:function(){this.selectedTruth=o.a.copyArray(this.selectedTemp),this.$emit("on-submit",this.selectedTruth)},cancel:function(){this.selectedTemp=o.a.copyArray(this.selectedTruth),this.checkSelection(),this.$emit("on-cancel")}},mounted:function(){this.max&&(document.querySelector("#"+this.TID).querySelector(".ivu-table-header").querySelector(".ivu-table-cell").style.display="none"),this.manual||this.getData()},created:function(){var e=o.a.gusid(6);this.TID="J_TABLE_"+e,this.tableRef="mg-select-table-"+e,o.a.initTableColumnTitle(this.columns)}},a=(n(534),n(1)),s=Object(a.a)(r,i,[],!1,null,null,null);s.options.__file="src/components/mg-select-table.vue";t.a=s.exports},538:function(e,t,n){e.exports=function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t,n){"use strict";t.b=function(){var e=document.documentElement;return"requestFullscreen"in e||"mozRequestFullScreen"in e&&document.mozFullScreenEnabled||"msRequestFullscreen"in e&&document.msFullscreenEnabled||"webkitRequestFullScreen"in e},t.c=function(){return!!(document.fullscreen||document.mozFullScreen||document.fullscreenElement||document.msFullscreenElement||document.webkitIsFullScreen)},t.g=function(e){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():console.log("Fullscreen API is not supported.")},t.d=function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():console.log("Fullscreen API is not supported.")},t.f=function(e){document.addEventListener("fullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("MSFullscreenChange",e),document.addEventListener("webkitfullscreenchange",e)},t.e=function(e){document.removeEventListener("fullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e),document.removeEventListener("webkitfullscreenchange",e)},t.a=function e(){var t={},n=!1,i=0,o=arguments.length;for("[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(n=arguments[0],i++);i<o;i++)!function(i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n&&"[object Object]"===Object.prototype.toString.call(i[o])?t[o]=e(!0,t[o],i[o]):t[o]=i[o])}(arguments[i]);return t}},function(e,t,n){"use strict";function i(){return n.i(a.c)()}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,t=arguments[1];if(l&&!i()){t=n.i(a.a)(!0,{},s,t);var o=e,r=void 0;t.wrap&&((r=document.createElement("div")).style["overflow-y"]="auto",r.style.background=t.background,r.style.width="100%",r.style.height="100%",o.parentNode.insertBefore(r,o),r.appendChild(o),r.addEventListener("click",(function(e){e.target===this&&n.i(a.d)()}))),o.classList.add(t.fullscreenClass),n.i(a.f)((function e(){var s=i();s||(n.i(a.e)(e),o.classList.remove(t.fullscreenClass),t.wrap&&(r.parentNode.insertBefore(o,r),r.parentNode.removeChild(r))),t.callback&&t.callback(s)})),n.i(a.g)(t.wrap?r:o)}}function r(){l&&i()&&n.i(a.d)()}var a=n(0),s={wrap:!0,background:"#333",callback:function(){},fullscreenClass:"fullscreen"},l=n.i(a.b)();t.a={getState:i,toggle:function(e,t,n){l&&(void 0===n?i()?r():o(e,t):n?o(e,t):r())},enter:o,exit:r}},function(e,t,n){var i=n(5)(n(4),n(6),null,null);e.exports=i.exports},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=n.n(i),r=n(1),a=n(0);t.default={install:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.name||"fullscreen";e.component(i,n.i(a.a)(o.a,{name:i})),e.prototype["$"+i]=r.a}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);t.default={props:{background:{type:String,default:"#333"},fullscreenClass:{type:String,default:"fullscreen"},fullscreen:{type:Boolean,default:!1}},data:function(){return{supportFullScreen:!1,isFullscreen:!1}},computed:{wrapperStyle:function(){return{background:this.background,"overflow-y":"auto",width:"100%",height:"100%"}}},methods:{toggle:function(e){void 0===e?n.i(i.c)()?this.exit():this.enter():e?this.enter():this.exit()},enter:function(){this.supportFullScreen&&(n.i(i.f)(this.fullScreenCallback),n.i(i.g)(this.$el))},exit:function(){this.supportFullScreen&&this.getState()&&n.i(i.d)()},getState:function(){return n.i(i.c)()},shadeClick:function(e){e.target===this.$el&&this.exit()},fullScreenCallback:function(){this.isFullscreen=n.i(i.c)(),this.isFullscreen||n.i(i.e)(this.fullScreenCallback),this.$emit("change",this.isFullscreen),this.$emit("update:fullscreen",this.isFullscreen)}},watch:{fullscreen:function(e){e!==n.i(i.c)()&&(e?this.enter():this.exit())}},created:function(){this.supportFullScreen=n.i(i.b)()}}},function(e,t){e.exports=function(e,t,n,i){var o,r=e=e||{},a=typeof e.default;"object"!==a&&"function"!==a||(o=e,r=e.default);var s="function"==typeof r?r.options:r;if(t&&(s.render=t.render,s.staticRenderFns=t.staticRenderFns),n&&(s._scopeId=n),i){var l=Object.create(s.computed||null);Object.keys(i).forEach((function(e){var t=i[e];l[e]=function(){return t}})),s.computed=l}return{esModule:o,exports:r,options:s}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{class:e.isFullscreen?[e.fullscreenClass]:[],style:e.isFullscreen?[e.wrapperStyle]:[],on:{click:function(t){e.shadeClick(t)}}},[e._t("default")],2)},staticRenderFns:[]}}])},627:function(e,t,n){var i=n(831);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,n(17).default)("288fa359",i,!1,{})},628:function(e,t,n){e.exports=n.p+"images/1486957d057df78ff207cf92be851e2d.png"},830:function(e,t,n){"use strict";var i=n(627);n.n(i).a},831:function(e,t,n){var i=n(10),o=n(24),r=n(628);t=i(!1);var a=o(r);t.push([e.i,"\n.home-monitor-single .home-monitor-win {\r\n\twidth: 99%;\r\n\theight: 440px;\r\n\tmargin-right: 1%;\r\n\tfloat: none;\n}\n.home-monitor-2-2 .home-monitor-win {\r\n\twidth: 49%;\r\n\theight: 215px;\r\n\tmargin-right: 1%;\r\n\tmargin-bottom: 1%;\n}\n.home-monitor-3-2 .home-monitor-win {\r\n\twidth: 32%;\r\n\theight: 215px;\r\n\tmargin-right: 1.3%;\r\n\tmargin-bottom: 10px;\n}\n.home-monitor-3-3 .home-monitor-win {\r\n\twidth: 32%;\r\n\theight: 140px;\r\n\tmargin-right: 1.3%;\r\n\tmargin-bottom: 10px;\n}\n.home-monitor-win {\r\n\tfloat: left;\r\n\tbackground: #EFEFEF url("+a+") no-repeat center center;\n}\n.home-monitor-single .fullscreen .home-monitor-win{\r\n\theight:100%\n}\n.home-monitor-2-2 .fullscreen .home-monitor-win{\r\n\theight:49%;\r\n\tmargin: .5%;\n}\n.home-monitor-3-2 .fullscreen .home-monitor-win{\r\n\theight:49.7%;\r\n\twidth: 33%;\r\n\tmargin: .15%;\n}\n.home-monitor-3-3 .fullscreen .home-monitor-win{\t\r\n\theight:33%;\r\n\twidth: 33%;\r\n\tmargin: .15%;\n}\r\n",""]),e.exports=t}}]);