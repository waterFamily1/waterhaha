(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{1257:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:" c-main-border"},[a("div",{staticClass:"c-left-border-blue"},[a("div",{staticClass:"c-search-main"},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("关键字：")]),a("Input",{staticStyle:{width:"150px"},attrs:{placeholder:"编号/报警名称"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.searchParams.queryName,callback:function(e){t.$set(t.searchParams,"queryName",e)},expression:"searchParams.queryName"}})],1),t._v(" "),a("div",{staticClass:"c-form-item"},[a("label",[t._v("区域位置：")]),a("dropdown-tree",{attrs:{url:t.treeApi.getProcessTreeData,width:200,multiple:!0},model:{value:t.site,callback:function(e){t.site=e},expression:"site"}})],1),t._v(" "),a("div",{staticClass:"c-adv-search-btn"},[a("a",{attrs:{href:"javascript:;"},on:{click:function(e){t.advSearch=!t.advSearch}}},[a("Icon",{directives:[{name:"show",rawName:"v-show",value:!t.advSearch,expression:"!advSearch"}],attrs:{type:"ios-arrow-down"}}),a("Icon",{directives:[{name:"show",rawName:"v-show",value:t.advSearch,expression:"advSearch"}],attrs:{type:"ios-arrow-up"}}),t._v("高级搜索")],1),t._v(" "),a("Button",{attrs:{type:"primary",shape:"circle"},on:{click:t.search}},[t._v("搜索")]),t._v(" "),a("Button",{staticClass:"c-btn-reset",attrs:{type:"primary",shape:"circle"},on:{click:function(e){return t.searchParamsClean("searchParams")}}},[t._v("重置")])],1)]),t._v(" "),a("collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.advSearch,expression:"advSearch"}],staticClass:"c-adv-search"},[a("div",{staticClass:"c-adv-search-row"},[a("div",{staticClass:"c-form-item c-form-item-tab"},[a("label",[t._v("确认方法：")]),t._v(" "),a("mg-tab",{attrs:{groups:t.relieveMap,multiple:!0,entire:!0},on:{"on-click":t.search},model:{value:t.disarmMethod,callback:function(e){t.disarmMethod=e},expression:"disarmMethod"}})],1)]),t._v(" "),a("div",{staticClass:"c-adv-search-row"},[a("div",{staticClass:"c-form-item c-form-item-tab"},[a("label",[t._v("报警等级：")]),t._v(" "),a("mg-tab",{attrs:{groups:t.levelMap,multiple:!0,entire:!0},on:{"on-click":t.search},model:{value:t.alarmLevel,callback:function(e){t.alarmLevel=e},expression:"alarmLevel"}})],1)]),t._v(" "),a("div",{staticClass:"c-adv-search-row"},[a("div",{staticClass:"c-form-item c-form-item-tab"},[a("label",[t._v("使用状态：")]),t._v(" "),a("mg-tab",{attrs:{groups:t.statesMap,multiple:!0,entire:!0},on:{"on-click":t.search},model:{value:t.enabledStatus,callback:function(e){t.enabledStatus=e},expression:"enabledStatus"}})],1)])])])],1),t._v(" "),a("div",{staticClass:"c-top-border-gray"},[a("div",{staticClass:"c-table-top-btns"},[a("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle"},on:{click:t.add}},[t._v("新增")]),t._v(" "),a("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle"},on:{click:t.deleteConfirm}},[t._v("删除")]),t._v(" "),a("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle"},on:{click:function(e){return t.changeStatus("ON")}}},[t._v("启用")]),t._v(" "),a("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle"},on:{click:function(e){return t.changeStatus("OFF")}}},[t._v("停用")]),t._v(" "),a("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle"},on:{click:t.importEvent}},[t._v("导入")])],1),t._v(" "),a("Table",{attrs:{columns:t.columns,data:t.listData,loading:t.loading,stripe:""},on:{"on-select-all":t.onSelect,"on-select":t.onSelect,"on-selection-change":t.onSelect}}),t._v(" "),a("Page",{staticClass:"table-page",attrs:{total:t.total,"page-size":t.searchParams.pageSize,current:t.searchParams.currentPage,"show-total":"","show-elevator":""},on:{"on-change":t.pageChange}})],1)])};s._withStripped=!0;var i=a(23),n=a(519),r=a(524),l=a(145),o=a(11),c=a(543),d=a(107),u={name:"alarm-define",data:function(){var t=this;return{treeApi:d.a,site:{id:"",title:"请选择"},advSearch:!1,disarmMethod:[],alarmLevel:[],enabledStatus:[],searchParams:{siteId:"",queryName:"",enabledStatus:"",disarmMethod:"",alarmLevel:"",pageSize:10,currentPage:1},columns:[{type:"selection",width:50},{title:"报警名称",key:"alarmName"},{title:"确认方法",key:"disarmMethod",width:110,render:function(e,a){return e("span",t.relieveText[a.row.disarmMethod])}},{title:"报警等级",key:"alarmLevel",render:function(t,e){return t("span",{class:["alarm-lev-"+e.row.alarmLevel]},e.row.alarmLevel+"级")}},{title:"使用状态",key:"enabledStatus",render:function(e,a){return e("span",{attrs:{title:t.transforLabel(t.statesMap,a.row.enabledStatus)}},t.transforLabel(t.statesMap,a.row.enabledStatus))}},{title:"最近报警时间",key:"alarmTriggerTime",width:120,render:function(t,e){return o.a.tableDatetime(t,e.row.alarmTriggerTime)}},{title:"区域位置",key:"siteName"},{title:"操作",key:"action",width:100,render:function(e,a){return e("div",[o.a.tableBtnStyle(e,(function(){t.$router.push({name:"alarm-define-detail",params:{id:a.row.id}})}),"查看"),o.a.tableBtnStyle(e,(function(){t.$router.push({name:"alarm-define-edit",params:{id:a.row.id}})}),"编辑")])}}],listData:[],total:0,selected:[],loading:!1}},computed:Object(i.b)({statesMap:function(t){return t.map.alarm.define.states},relieveMap:function(t){return t.map.alarm.define.relieve},relieveText:function(t){return t.map.alarm.define.relieveText},levelMap:function(t){return t.map.alarm.define.level}}),created:function(){o.a.initTableColumnTitle(this.columns),this.getData()},methods:{transforLabel:function(t,e){var a="";return t.forEach((function(t){t.value===e&&(a=t.label)})),a},changeSelect:function(t){this.searchParams.siteId=t.map((function(t){return t.id})).join(),this.search()},getData:function(){var t=this;this.$setSearchParams((function(e){t.searchParams=e,t.site.id=t.searchParams.siteId,t.site.title=t.searchParams.siteName,t.disarmMethod=t.searchParams.disarmMethod?t.searchParams.disarmMethod.split(","):[],t.alarmLevel=t.searchParams.alarmLevel?t.searchParams.alarmLevel.split(","):[],t.enabledStatus=t.searchParams.enabledStatus?t.searchParams.enabledStatus.split(","):[]})),this.loading=!0,this.$http.get(c.a.defines,this.searchParams).then((function(e){t.loading=!1,e&&e.total>=0&&(t.total=e.total,t.listData=e.items?e.items:[])}))},search:function(){this.selected=[],this.searchParams.siteId=this.site.id,this.searchParams.siteName=this.site.title,this.searchParams.currentPage=1,this.searchParams.disarmMethod=this.disarmMethod.join(),this.searchParams.alarmLevel=this.alarmLevel.join(),this.searchParams.enabledStatus=this.enabledStatus.join(),this.getData(),this.$addRouteFilter({routeName:"alarm-define",searchParams:this.searchParams})},searchParamsClean:function(t){this.site.id="",this.site.title="",this.disarmMethod=[],this.alarmLevel=[],this.enabledStatus=[],this.searchParams={siteId:"",queryName:"",enabledStatus:"",disarmMethod:"",alarmLevel:"",pageSize:10,currentPage:1},this.$cleanRouteFilter()},pageChange:function(t){this.searchParams.currentPage=t,this.getData(),this.$addRouteFilter({routeName:"alarm-define",searchParams:this.searchParams})},add:function(){this.$router.push({name:"alarm-define-add"})},onSelect:function(t,e){this.selected=t},deleteConfirm:function(){if(0!=this.selected.length){for(var t=[],e=0;e<this.selected.length;e++)t.push(this.selected[e].id);this.deleteByIds(t.join(","))}else this.$Notice.warning({title:"警告",desc:"请选中后删除",duration:3})},deleteByIds:function(t){var e=this;this.$Modal.confirm({title:"提示",content:"<p>确定要删除？</p>",onOk:function(){e.$http.del(c.a.defines,{ids:t}).then((function(t){t.count&&(e.$Notice.success({title:"成功",desc:"删除成功！",duration:3}),e.search())}))},onCancel:function(){}})},changeStatus:function(t){if(0!=this.selected.length){for(var e=[],a=0;a<this.selected.length;a++)e.push(this.selected[a].id);this.changeStatusByIds(e,t)}else this.$Notice.warning({title:"警告",desc:"请选中后"+this.transforLabel(this.statesMap,t),duration:3})},changeStatusByIds:function(t,e){var a=this,s=this.transforLabel(this.statesMap,e);this.$Modal.confirm({title:"提示",content:"<p>确定要"+s+"？</p>",onOk:function(){a.$http.patch(c.a.updateDefineStatus,{ids:t,status:e}).then((function(t){t.count&&(a.$Notice.success({title:"成功",desc:"操作成功！",duration:3}),a.selected=[],a.search())}))},onCancel:function(){}})},importEvent:function(){this.$router.push({name:"import",params:{id:"alarm-definition"}})}},components:{CollapseTransition:n.a,mgTab:r.a,dropdownTree:l.a}},h=(a(858),a(1)),m=Object(h.a)(u,s,[],!1,null,null,null);m.options.__file="src/views/alarm/define/list.vue";e.default=m.exports},507:function(t,e,a){t.exports=a.p+"images/3a23524e9c2a6dd02c2c02fb7847102e.png"},516:function(t,e,a){var s=a(526);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);(0,a(17).default)("5a7c571a",s,!1,{})},519:function(t,e,a){"use strict";function s(t,e){if(!t||!e)return!1;if(-1!==e.indexOf(" "))throw new Error("className should not contain space.");return t.classList?t.classList.contains(e):(" "+t.className+" ").indexOf(" "+e+" ")>-1}function i(t,e){if(t){for(var a=t.className,i=(e||"").split(" "),n=0,r=i.length;n<r;n++){var l=i[n];l&&(t.classList?t.classList.add(l):s(t,l)||(a+=" "+l))}t.classList||(t.className=a)}}function n(t,e){if(t&&e){for(var a=e.split(" "),i=" "+t.className+" ",n=0,r=a.length;n<r;n++){var l=a[n];l&&(t.classList?t.classList.remove(l):s(t,l)&&(i=i.replace(" "+l+" "," ")))}t.classList||(t.className=trim(i))}}var r={beforeEnter:function(t){i(t,"collapse-transition"),t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.style.height="0",t.style.paddingTop=0,t.style.paddingBottom=0},enter:function(t){t.dataset.oldOverflow=t.style.overflow,0!==t.scrollHeight?(t.style.height=t.scrollHeight+"px",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom):(t.style.height="",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom),t.style.overflow="hidden"},afterEnter:function(t){n(t,"collapse-transition"),t.style.height="",t.style.overflow=t.dataset.oldOverflow},beforeLeave:function(t){t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.dataset.oldOverflow=t.style.overflow,t.style.height=t.scrollHeight+"px",t.style.overflow="hidden"},leave:function(t){0!==t.scrollHeight&&(i(t,"collapse-transition"),t.style.height=0,t.style.paddingTop=0,t.style.paddingBottom=0)},afterLeave:function(t){n(t,"collapse-transition"),t.style.height="",t.style.overflow=t.dataset.oldOverflow,t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom}};e.a={name:"CollapseTransition",functional:!0,render:function(t,e){var a=e.children;return t("transition",{on:r},a)}}},524:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cmp-tab",class:{"cmp-tab-underline":t.underline}},t._l(t.items,(function(e){return a("a",{key:e.value,class:{active:t.activeIds.indexOf(e.value)>-1},attrs:{href:"javascript:;"},on:{click:function(a){return t.selectTab(e)}}},[t._v(t._s(e.label))])})),0)};function i(t){return function(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}s._withStripped=!0;var n=null,r={name:"mgTab",props:{groups:Array,value:Array,multiple:{type:Boolean,default:!1},entire:{type:Boolean,default:!1},underline:Boolean},data:function(){return{activeIds:this.value,items:i(this.groups)}},watch:{groups:function(t){this.entire?this.items=[{label:"全部",value:n}].concat(i(t)):this.items=t},value:function(t){this.activeIds=t}},mounted:function(){this.entire&&this.items.unshift({label:"全部",value:n})},methods:{isSelected:function(t){return this.activeIds.indexOf(t)>-1},removeFromSelected:function(t){var e=this;this.activeIds.forEach((function(a,s){a==t&&e.activeIds.splice(s,1)}))},selectTab:function(t){this.entire&&t.value===n?this.activeIds=[n]:this.multiple?this.isSelected(t.value)?this.removeFromSelected(t.value):(this.activeIds.push(t.value),this.entire&&this.removeFromSelected(n)):(this.activeIds=[],this.activeIds.push(t.value)),this.$emit("input",this.activeIds),this.$emit("on-click",this.activeIds)},setValue:function(t){this.activeIds=t,this.$emit("input",this.activeIds)}}},l=(a(525),a(1)),o=Object(l.a)(r,s,[],!1,null,null,null);o.options.__file="src/components/mg-tab.vue";e.a=o.exports},525:function(t,e,a){"use strict";var s=a(516);a.n(s).a},526:function(t,e,a){(e=a(10)(!1)).push([t.i,"\n.cmp-tab {\r\n\tdisplay: inline-block;\n}\n.cmp-tab a {\r\n\tmargin-right: 20px;\t\r\n\tcolor: #576374;\n}\n.cmp-tab .active{\r\n\tcolor: #4B7EFE;\n}\n.cmp-tab-underline a {\r\n\tpadding: 2px 1px;\r\n\ttext-align: center;\n}\n.cmp-tab-underline .active  {\r\n\tborder-bottom: 2px solid #4B7EFE;\n}\r\n",""]),t.exports=e},543:function(t,e,a){"use strict";a(22);e.a={updateDefineStatus:"/loong/api/alarm-definitions/status",defines:"/loong/api/alarm-definitions",modalDefines:"/loong/api/alarm-definitions",history:"/loong/api/alarm-records",history_detail:"/loong/api/alarm-records/detail",release:"/loong/api/alarm-records/confirm",getAlarmData:"/loong/api/alarm-records",subscribe:"/loong/api/alarm-subscriptions"}},638:function(t,e,a){var s=a(859);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);(0,a(17).default)("d188e614",s,!1,{})},858:function(t,e,a){"use strict";var s=a(638);a.n(s).a},859:function(t,e,a){var s=a(10),i=a(506);(e=s(!1)).i(i),e.push([t.i,"\r\n\r\n",""]),t.exports=e}}]);