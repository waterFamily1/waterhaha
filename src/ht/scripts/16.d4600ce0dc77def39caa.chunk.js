(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{1125:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"c-main-border"},[a("Form",{ref:"form1",attrs:{model:t.data,rules:t.formRules,"label-width":100}},[a("div",{staticClass:"c-left-border-blue"},[a("h3",[t._v("简报数据采集")]),t._v(" "),a("div",{staticClass:"c-btns-right"},[a("Button",{attrs:{type:"primary",shape:"circle"},on:{click:function(e){return t.submit("form1")}}},[t._v("保存")]),t._v(" "),a("Button",{staticClass:"c-btn-back",attrs:{type:"primary",shape:"circle"},on:{click:t.back}},[t._v("取消")])],1)]),t._v(" "),a("div",{staticClass:"c-top-border-gray padding20-0"},[a("Row",{staticStyle:{"padding-left":"20px"}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{prop:"siteId",label:"区域位置："}},[a("my-process-tree-authority",{ref:"processTree",staticStyle:{width:"250px"},attrs:{url:t.treeApi.getProcessTreeData},on:{input:t.chooseSite},model:{value:t.process,callback:function(e){t.process=e},expression:"process"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{prop:"formName",label:"简报名称："}},[a("Input",{staticStyle:{width:"250px"},attrs:{placeholder:"简报名称"},model:{value:t.data.formName,callback:function(e){t.$set(t.data,"formName",e)},expression:"data.formName"}})],1)],1)],1),t._v(" "),a("Row",{staticStyle:{"padding-left":"20px"}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{prop:"cycleId",label:"录入周期："}},[a("Select",{staticStyle:{width:"250px"},attrs:{disabled:t.cycleDisabled},model:{value:t.data.cycleId,callback:function(e){t.$set(t.data,"cycleId",e)},expression:"data.cycleId"}},t._l(t.cycleMap,(function(e,i){return a("Option",{key:i,attrs:{value:i}},[t._v(t._s(e))])})),1)],1)],1)],1),t._v(" "),a("form-items",{model:{value:t.data,callback:function(e){t.data=e},expression:"data"}})],1)])],1)};i._withStripped=!0;var n=a(11),r=a(533),o=a(107),s=a(531),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"c-top-border-gray",attrs:{id:"edit-table"}},[a("div",{staticClass:"c-table-top-btns"},[a("Button",{directives:[{name:"show",rawName:"v-show",value:t.IsImport,expression:"IsImport"}],staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle"},on:{click:t.add}},[t._v("新增")]),t._v(" "),a("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle"},on:{click:t.importHour}},[t._v("导入")])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.IsImport,expression:"IsImport"}],attrs:{id:"add-mpoint"}},[a("Row",{staticClass:"edit-table-header"},[a("Col",{attrs:{span:"5"}},[t._v("测点名称")]),t._v(" "),a("Col",{attrs:{span:"3"}},[t._v("文本类型")]),t._v(" "),a("Col",{attrs:{span:"3"}},[t._v("自动填充上次数据")]),t._v(" "),a("Col",{attrs:{span:"4"}},[t._v("分组名称")]),t._v(" "),a("Col",{attrs:{span:"3"}},[t._v("组序号")]),t._v(" "),a("Col",{attrs:{span:"3"}},[t._v("组内序号")]),t._v(" "),a("Col",{attrs:{span:"3"}},[t._v("操作")])],1),t._v(" "),0==t.value.mpointList.length?a("Row",{staticClass:"edit-table-row"},[a("Col",{attrs:{span:"24"}},[a("p",{staticClass:"no-data"},[t._v("暂无数据")])])],1):t._e(),t._v(" "),t._l(t.value.mpointList,(function(e,i){return a("Row",{staticClass:"edit-table-row"},[a("Col",{attrs:{span:"5"}},[a("FormItem",{attrs:{prop:"mpointList."+i+".mpointName",rules:{required:!0,message:"测点不能为空"}}},[a("span",[t._v(t._s(e.mpointName))])])],1),t._v(" "),a("Col",{attrs:{span:"3"}},[a("FormItem",{staticStyle:{"margin-left":"0"},attrs:{prop:"mpointList."+i+".textType"}},[a("Select",{model:{value:e.textType,callback:function(a){t.$set(e,"textType",a)},expression:"item.textType"}},t._l(t.textTypeMap,(function(e,i){return a("Option",{attrs:{value:i}},[t._v(t._s(e))])})),1)],1)],1),t._v(" "),a("Col",{attrs:{span:"3"}},[a("Select",{model:{value:e.autoComplete,callback:function(a){t.$set(e,"autoComplete",a)},expression:"item.autoComplete"}},[a("Option",{attrs:{value:0}},[t._v("否")]),t._v(" "),a("Option",{attrs:{value:1}},[t._v("是")])],1)],1),t._v(" "),a("Col",{attrs:{span:"4"}},[a("FormItem",{attrs:{prop:"mpointList."+i+".groupName"}},[a("Input",{staticStyle:{width:"150px"},attrs:{maxlength:20},model:{value:e.groupName,callback:function(a){t.$set(e,"groupName",a)},expression:"item.groupName"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"3"}},[a("FormItem",{attrs:{prop:"mpointList."+i+".groupOrder",rules:{required:!0,pattern:/^\d+(\.\d+)?$/,message:"不能为空",trigger:"blur"}}},[a("InputNumber",{staticStyle:{width:"100px"},attrs:{min:0,formatter:t.formatterOrder},model:{value:e.groupOrder,callback:function(a){t.$set(e,"groupOrder",a)},expression:"item.groupOrder"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"3"}},[a("FormItem",{attrs:{prop:"mpointList."+i+".mpointOrder",rules:{required:!0,pattern:/^\d+(\.\d+)?$/,message:"不能为空",trigger:"blur"}}},[a("InputNumber",{staticStyle:{width:"100px"},attrs:{min:0,formatter:t.formatterOrder},model:{value:e.mpointOrder,callback:function(a){t.$set(e,"mpointOrder",a)},expression:"item.mpointOrder"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"3"}},[a("a",{staticStyle:{color:"#4b7efe","line-height":"30px"},on:{click:function(e){return t.removeRow(i)}}},[t._v("删除")])])],1)}))],2),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.IsImport,expression:"!IsImport"}],attrs:{id:"import-mpoint"}},[a("point-import",{attrs:{value:t.value},on:{"on-close":t.closeImport,"save-excelData":t.saveExcelData}})],1)]),t._v(" "),a("point-table-select",{ref:"pointTableSelect1",attrs:{tag:"datainput",type:"multiple"},on:{input:t.choosePoint}})],1)};l._withStripped=!0;var c=a(578),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"import-detail"},[a("div",{staticClass:"c-left-border-blue"},[a("h3"),t._v(" "),a("div",{staticClass:"c-btns-right"},[a("Button",{directives:[{name:"show",rawName:"v-show",value:"validate"==t.processActive,expression:"processActive == 'validate'"}],attrs:{type:"primary",shape:"circle"},on:{click:t.cancelClick}},[t._v("重新整理")]),t._v(" "),a("Button",{directives:[{name:"show",rawName:"v-show",value:"complete"!==t.processActive,expression:"processActive !== 'complete'"}],staticClass:"c-btn-back",attrs:{type:"default",shape:"circle"},on:{click:t.backClick}},[t._v("关闭")])],1)]),t._v(" "),a("div",[a("div",{staticClass:"equ-import-process"},[a("span",{class:{active:"upload"==t.processActive}},[t._v("数据上传")]),t._v(" "),a("span",{class:{active:"validate"==t.processActive}},[t._v("数据验证")]),t._v(" "),a("span",{class:{active:"complete"==t.processActive}},[t._v("完成")])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"upload"==t.processActive,expression:"processActive == 'upload'"}]},[a("div",{staticClass:"equ-import-upload"},[a("Upload",{ref:"upload",attrs:{name:"file",accept:".xls, .xlsx",format:["xls","xlsx"],"on-success":t.uploadSucess,"on-error":t.uploadError,action:t.importUrl}},[a("Button",{attrs:{type:"primary",shape:"circle"}},[t._v("文件上传")])],1)],1),t._v(" "),a("div",{staticClass:"equ-import-download"},[a("a",{attrs:{download:""},on:{click:t.downExcel}},[t._v("\n                    导入模版下载\n                    "),a("Icon",{attrs:{type:"android-download"}})],1),t._v(" "),a("div",[t._v("上传文件数量不超过500条")])])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"validate"==t.processActive,expression:"processActive == 'validate'"}]},[a("ul",{staticClass:"validate-box clearfix"},[a("li",{staticClass:"all-validate"},[t._v("\n                    共\n                    "),a("em",[t._v(t._s(t.totalNum))]),t._v("行\n                ")]),t._v(" "),a("li",{staticClass:"all-pass"},[t._v("\n                    验证通过\n                    "),a("em",[t._v(t._s(t.passNum))]),t._v("行\n                ")]),t._v(" "),a("li",{staticClass:"all-error"},[t._v("\n                    错误\n                    "),a("em",[t._v(t._s(t.errNum))]),t._v("行\n                ")])]),t._v(" "),a("Tabs",{directives:[{name:"show",rawName:"v-show",value:!!t.errNum,expression:"!!errNum"}],attrs:{animated:!1}},[a("TabPane",{attrs:{label:"简报录入测点信息",icon:t.iccidImportResults.length?"information-circled":""}},[a("Table",{directives:[{name:"show",rawName:"v-show",value:t.iccidImportResults.length,expression:"iccidImportResults.length"}],attrs:{columns:t.iccidImportResultsColumns,data:t.iccidImportResults,loading:t.loading,stripe:""}}),t._v(" "),a("validate-pass",{attrs:{flag:!!t.iccidImportResults.length}})],1)],1),t._v(" "),a("validate-pass",{attrs:{flag:!!t.errNum}}),t._v(" "),a("Button",{directives:[{name:"show",rawName:"v-show",value:!t.errNum,expression:"!errNum"}],staticClass:"submit-btn",attrs:{type:"primary",shape:"circle"},on:{click:t.saveExcelData}},[t._v("确定导入")])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"complete"==t.processActive,expression:"processActive == 'complete'"}],staticClass:"complete-box"},[a("Icon",{staticStyle:{color:"#56D43F"},attrs:{type:"checkmark-circled",size:"60"}}),t._v(" "),a("h3",[t._v("本次成功导入"+t._s(t.totalNum)+"行数据")]),t._v(" "),a("Button",{staticClass:"c-btn-back btn-back",attrs:{type:"primary",shape:"circle"},on:{click:t.backClick}},[t._v("返回上一级")])],1)])])};function d(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}p._withStripped=!0;var u=["upload","validate","complete"],m={props:{value:Object},components:{"validate-pass":{props:{flag:Boolean},data:function(){return{}},template:'<div v-show="!flag" class="validate-pass-box"><span class="complete-icon"></span><span>文件确认通过</span></div>'}},data:function(){var t=this;return{processActive:u[0],totalNum:0,passNum:0,errNum:0,iccidImportResults:[],iccidImportResultsColumns:[{title:"行序号",key:"mpoint.index",width:80,render:function(t,e){return t("span",e.row.mpoint.index)}},{title:"测点名称",key:"mpoint.mpointName",render:function(e,a){return t.renderHandle(e,a,"mpoint","mpointName")}},{title:"文本类型",key:"mpoint.textType",render:function(e,a){return t.renderHandle(e,a,"mpoint","textType")}},{title:"自动填充",key:"mpoint.autoComplete",render:function(e,a){return t.renderHandle(e,a,"mpoint","autoComplete")}},{title:"分组名称",key:"mpoint.groupName",render:function(e,a){return t.renderHandle(e,a,"mpoint","groupName")}},{title:"组序号",key:"mpoint.groupOrder",render:function(e,a){return t.renderHandle(e,a,"mpoint","groupOrder")}},{title:"组内序号",key:"mpoint.mpointOrder",render:function(e,a){return t.renderHandle(e,a,"mpoint","mpointOrder")}},{title:"其他错误",key:"sim.otherError",render:function(e,a){return t.renderHandle(e,a,"sim","otherError")}}],excelDataCachekey:"",loading:!1,filterId:""}},computed:{importUrl:function(){return this.$route.params.id?r.a.importExcel+"?formId="+this.value.id+"&type=day":r.a.importExcel+"?type=day"}},watch:{"value.mpointList":function(t){if(t){var e=[];t.forEach((function(t){e.push(t.mpointId)})),this.filterId=e.join(",")}}},mounted:function(){},methods:{backClick:function(){this.$emit("on-close",!0),this.processActive=u[0]},uploadSucess:function(t,e,a){if(t){if(t.outnumber)return this.$refs.upload.clearFiles(),this.$Modal.warning({title:"上传警告",render:function(t){return t("div",{class:{"import-modal":!0}},"上传数据已超过500行，请重新整理后上传！")}}),!1;this.processActive=u[1],this.iccidImportResults=this.dataHandle(t.importResults),this.excelDataCachekey=t.excelDataCachekey,this.totalNum=t.totalNum,this.passNum=t.passNum,this.errNum=t.errNum}},uploadError:function(t,e,a){this.$Message.error("文件上传失败！")},saveExcelData:function(){var t=this;this.errNum?this.$Message.error("Excel表格校验不通过！"):this.$http.get(r.a.saveExcelData,{excelDataCacheKey:this.excelDataCachekey}).then((function(e){e&&(t.$Notice.success({title:"成功！",desc:"数据保存成功",duration:3}),t.processActive=u[2],t.$emit("save-excelData",e))}))},cancelClick:function(){var t=this;this.processActive=u[0],this.$refs.upload.clearFiles(),this.excelDataCachekey&&this.$http.get(r.a.cancelExcelData,{excelDataCacheKey:this.excelDataCachekey}).then((function(e){t.$Notice.success({title:"取消导入",desc:"取消导入成功！",duration:3})}))},dataHandle:function(t){return t.forEach((function(t,e){t.validateResult.otherError="无",t.validateResult.mpointNameNotExist&&(t.validateResult.otherError="测点名称不存在"),t.validateResult.textTypeFormatError&&(t.validateResult.otherError="文本类型格式不正确(单行文本/多行文本)"),t.validateResult.autoCompleteFormatError&&(t.validateResult.otherError="自动填充格式不正确(是/否)"),t.validateResult.dbExistFlag&&(t.validateResult.otherError="数据库中已存在"),t.validateResult.excelRepeat&&(t.validateResult.otherError="Excel表中重复")})),t},renderHandle:function(t,e,a,i,r){var o=e.row.validateResult[i],s=!o||"otherError"==i&&"无"==o?"#333":"red",l=o||e.row[a][i];return r&&(l=n.a.transDateFromServer(l)),o||"textType"!=i||(l="single"==l?"单行文本":"多行文本"),o||"autoComplete"!=i||(l="0"==l?"否":"是"),t("span",{style:{color:s},attrs:{title:l}},l)},downExcel:function(){var t;this.$route.params.id?n.a.download(r.a.getExcel,{formId:this.value.id,siteId:this.value.siteId,type:"day",filterId:this.filterId}):this.value.siteId?n.a.download(r.a.getExcel,(d(t={siteId:this.value.siteId},"siteId",this.value.siteId),d(t,"type","day"),d(t,"filterId",this.filterId),t)):this.$Notice.warning({title:"警告",desc:"请选择区域位置",duration:3})}}},h=(a(910),a(1)),v=Object(h.a)(m,p,[],!1,null,null,null);v.options.__file="src/views/data-input/brief/import.vue";var f=v.exports,g={props:{value:Object},data:function(){return{textTypeMap:{single:"单行文本",multi:"多行文本"},IsImport:!0,filterArray:[]}},methods:{add:function(){this.$refs.pointTableSelect1.show=!0,this.$refs.pointTableSelect1.searchParams.inputFilter="1",this.$refs.pointTableSelect1.searchParams.datasource="INPUT";var t=[];this.value.mpointList.map((function(e){t.push(e.mpointId)})),this.$refs.pointTableSelect1.searchParams.siteId=this.value.siteId,this.$refs.pointTableSelect1.searchParams.filterId=t.join(),this.$refs.pointTableSelect1.search()},choosePoint:function(t){if(t instanceof Array)for(var e=this.value.mpointList.length,a=0;a<t.length;a++){for(var i=t[a],n=!1,r=0;r<this.value.mpointList.length;r++)if(this.value.mpointList[r].mpointId==i.id){n=!0;break}n||this.value.mpointList.push({mpointId:i.id,mpointName:i.mpointName,unit:i.unit,formId:this.value.id,textType:"single",groupName:"未命名分组",autoComplete:0,groupOrder:1,mpointOrder:e+a+1,status:null,index:e})}},removeRow:function(t){var e=this;this.$route.params.id?this.$Modal.confirm({title:"提示",content:"<p>确定要删除？</p>",onOk:function(){e.value.mpointList.splice(t,1)},onCancel:function(){}}):this.value.mpointList.splice(t,1)},importHour:function(){this.IsImport=!1},closeImport:function(t){this.IsImport=t},saveExcelData:function(t){var e=this,a=this.value.mpointList.length;t.forEach((function(t,i){t.autoComplete=t.autoComplete?1:0,t.index=i,t.groupName||(t.groupName="未命名分组"),t.groupOrder||(t.groupOrder=1),t.mpointOrder||(t.mpointOrder=a+i+1),e.value.mpointList.push(t)}))},formatterOrder:function(t){return parseInt(t)}},components:{pointTableSelect:c.a,pointImport:f},mounted:function(){}},x=(a(912),Object(h.a)(g,l,[],!1,null,null,null));x.options.__file="src/views/data-input/brief/form-items.vue";var b=x.exports,w={components:{myProcessTreeAuthority:s.a,formItems:b},data:function(){return{treeApi:o.a,cacheMpointList:[],data:{id:0,cycleId:"W",siteName:"",mpointList:[]},process:{id:null,title:null},cycleMap:{D:"天",W:"周",M:"月",Q:"季度",Y:"年"},formRules:{formName:[{required:!0,message:"请输入名称",trigger:"blur"},{max:50,message:"名称不能超过50个字符",trigger:"change"}],siteId:[{required:!0,message:"请选择区域位置"}]},cycleDisabled:!1}},mounted:function(){var t=this;"data-input-brief-edit"==this.$route.name&&this.$route.params.id&&(this.cycleDisabled=!0,this.$http.get(r.a.dataInputForm+"/"+this.$route.params.id).then((function(e){e&&(e.mpointList.forEach((function(e,a){e.index=a,t.cacheMpointList.push(Object.assign({},e))})),t.data=e,t.process.id=t.data.siteId,t.process.title=t.data.siteName)})))},computed:{},methods:{chooseSite:function(t){this.data.siteId=t.id},submit:function(t){var e=this,a=this;this.$refs[t].validate((function(t){if(0!=e.data.mpointList.length)if(t){for(var i={},n=0;n<e.data.mpointList.length;n++){var o=e.data.mpointList[n].mpointId;if(i[o])return a.$Notice.warning({title:"警告",desc:"存在重复的测点信息! 请正确填写相关信息",duration:3}),!1;i[o]=1}var s=[];e.cacheMpointList.forEach((function(t){t.status="delete";for(var a=!0,i=0;i<e.data.mpointList.length;i++)if(t.mpointId==e.data.mpointList[i].mpointId)return t.status=null,a=!1,!1;a&&s.push(t)}));var l=Object.assign({},e.data);l.siteId=e.process.id,l.siteName=e.process.title,l.mpointList=e.data.mpointList.concat(s),l.id?e.$http.put(r.a.dataInputForm,l).then((function(t){e.$Notice.success({title:"成功",desc:"数据保存成功",duration:3}),e.$router.push({name:"data-input-brief"})})):e.$http.post(r.a.dataInputForm,l).then((function(t){e.$Notice.success({title:"成功",desc:"数据保存成功",duration:3}),e.$router.push({name:"data-input-brief"})}))}else e.$Notice.warning({title:"警告",desc:"验证失败 ! 请正确填写相关信息",duration:3});else e.$Notice.warning({title:"警告",desc:"验证失败 ! 请选择测点",duration:3})}))},back:function(){this.$router.back()}}},y=Object(h.a)(w,i,[],!1,null,null,null);y.options.__file="src/views/data-input/brief/form.vue";e.default=y.exports},518:function(t,e,a){var i=a(530);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a(17).default)("4411afe8",i,!1,{})},529:function(t,e,a){"use strict";var i=a(518);a.n(i).a},530:function(t,e,a){(e=a(10)(!1)).push([t.i,"\n.cmp-dropdown-tree {\r\n    display: inline-block;\r\n    position: relative;\r\n    vertical-align: middle;\r\n    line-height: normal;\n}\n.ivu-form-item-error .cmp-dropdown-tree-label {\r\n    border: 1px solid #ed3f14;\n}\n.ivu-form-item-error .cmp-dropdown-tree-arrow {\r\n    border-left: 1px solid #ed3f14;\n}\n.cmp-dropdown-tree-label {\r\n    height: 28px;\r\n    width: 100%;\r\n    border: 1px solid #eaeaea;\r\n    display: flex;\r\n    border-radius: 3px;\r\n    cursor: pointer;\n}\n.cmp-dropdown-tree-text {\r\n    line-height: 28px;\r\n    text-indent: 5px;\r\n    flex: 1;\r\n    white-space: nowrap;\r\n    text-overflow: ellipsis;\r\n    overflow: hidden;\n}\n.cmp-dropdown-tree-arrow {\r\n    margin-top: -1px;\r\n    width: 28px;\r\n    height: 28px;\r\n    border-left: 1px solid #eaeaea;\r\n    text-align: center;\r\n    line-height: 28px;\n}\n.cmp-dropdown-tree .ivu-input-group-append {\r\n    width: 25px;\r\n    height: 28px;\r\n    overflow: hidden;\r\n    padding: 0;\n}\n.cmp-dropdown-tree .ivu-btn {\r\n    padding: 5px 10px;\n}\n.cmp-dropdown-tree-tree {\r\n    z-index: 901;\r\n    position: absolute;\r\n    top: 37px;\r\n    left: 0;\r\n    min-width: 300px;\r\n    max-height: 400px;\r\n    overflow: auto;\r\n    padding: 5px 10px;\r\n    background-color: #fff;\r\n    box-shadow: 1px 1px 5px #999;\r\n    border-radius: 3px;\n}\r\n",""]),t.exports=e},531:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.hideTree,expression:"hideTree"}],staticClass:"cmp-dropdown-tree",style:{width:t.width+"px"}},[a("div",{staticClass:"cmp-dropdown-tree-label",on:{click:t.labelClick}},[a("div",{staticClass:"cmp-dropdown-tree-text"},[t._v(t._s(t.value.title))]),t._v(" "),a("div",{staticClass:"cmp-dropdown-tree-arrow"},[a("Icon",{directives:[{name:"show",rawName:"v-show",value:1!=t.isShowTree,expression:"isShowTree != true"}],attrs:{type:"ios-arrow-down"}}),t._v(" "),a("Icon",{directives:[{name:"show",rawName:"v-show",value:1==t.isShowTree,expression:"isShowTree == true"}],attrs:{type:"ios-arrow-up"}})],1)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowTree,expression:"isShowTree"}],staticClass:"cmp-dropdown-tree-tree"},[a("Tree",{attrs:{data:t.datas,"show-checkbox":t.showCheckbox,multiple:t.multiple},on:{"on-select-change":t.selectTree}})],1)])};i._withStripped=!0;var n=a(11),r=a(146),o=a(147);function s(t){return function(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(t){!function t(e){e.forEach((function(e,a){e.childrenIds=function t(e,a){a=a||[];return e.forEach((function(e){e.children.length&&t(e.children,a),a.push(Math.abs(e.id))})),a}(e.children),e.children.length&&t(e.children)}))}(t)}var c={name:"myProcessTreeAuthority",mixins:[r.a],props:{field:String,value:Object,data:Array,url:String,query:Object,showCheckbox:Boolean,multiple:Boolean,width:{type:[Number,String],default:300},type:String},watch:{"value.id":function(t){t?this.flatDatas.length&&(n.a.setTrueTreeExpand(this.datas,t),n.a.setTrueTreeSelected(this.datas,t)):(!function t(e){for(var a,i=e.length,n=0;n<i;n++)1==(a=e[n]).selected&&(a.selected=!1),a.children.length&&t(a.children)}(this.datas),this.$emit("input",{id:"",title:"请选择"}))},data:function(t){this.datas=t}},data:function(){return{datas:this.data,flatDatas:[],isShowTree:!1}},methods:{selectTree:function(t){var e=this,a=[],i=[],n=[],r=this.field||"id",o=[];t.forEach((function(t){a.push(Math.abs(t[r])),i.push(t.key),n.push(t.title),o=o.concat(Math.abs(t[r]),t.childrenIds)})),o=s(new Set(o)),this.$emit("input",{id:a.join(),key:i.join(),title:n.join(),childrenIds:o}),this.$emit("on-change",{id:a.join(),key:i.join(),title:n.join(),childrenIds:o}),this.multiple||(this.isShowTree=!1),setTimeout((function(){e.dispatch("FormItem","on-form-change",{id:a.join(),key:i.join(),title:n.join(),childrenIds:o})}),100)},hideTree:function(){this.isShowTree=!1},labelClick:function(){this.isShowTree=!this.isShowTree}},directives:{clickoutside:o.a},mounted:function(){var t=this;this.url&&this.$http.get(this.url,this.query).then((function(e){e&&e.length&&(e.forEach((function(t){!1===t.authorized&&(t.render=function(t,e){e.root,e.node;return t("span",[e.data.name])})})),"EQUTYPE"==t.type&&e.forEach((function(t){var a=e.filter((function(e){return e.parentId==t.id}));("org"==t.type||a.length>0)&&(t.render=function(t,e){e.root,e.node;return t("span",[e.data.name])})})),"PROCESS"==t.type&&e.forEach((function(t){1==t.type&&(t.render=function(t,e){e.root,e.node;return t("span",[e.data.name])})})),t.flatDatas=e,t.value.id&&(n.a.setTreeExpand(t.flatDatas,t.value.id),n.a.setFlatTreeSelected(t.flatDatas,t.value.id)),t.datas=n.a.transDataToTree(t.flatDatas),l(t.datas))}))}},p=(a(529),a(1)),d=Object(p.a)(c,i,[],!1,null,null,null);d.options.__file="src/components/my-process-tree-authority.vue";e.a=d.exports},533:function(t,e,a){"use strict";var i=a(22),n={getListData:"/loong/api/datainput-forms",dataInputForm:"/loong/api/datainput-forms",mpointDataInput:"/loong/api/datainput-records/data",historyDatail:"/loong/api/datainput-records/data",history:"/loong/api/datainput-records",historyDelete:"/loong/api/datainput-records",getExcel:i.a+"/loong/api/datainput-mpoints/excel-temlate-down",importExcel:i.a+"/loong/api/datainput-mpoints/excel-import",saveExcelData:"/loong/api/datainput-mpoints/excel-data-save",cancelExcelData:"/loong/api/datainput-mpoints/excel-data-cancel"};e.a=n},546:function(t,e,a){t.exports=a.p+"images/f9339ba968ba75b06c552a91fbe42722.jpg"},552:function(t,e,a){t.exports=a.p+"images/dcd735d5f12eb9b839b5bfcc73fbe386.png"},553:function(t,e,a){t.exports=a.p+"images/fbf666a5531edaf663783cc3a955a010.png"},578:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.value?a("div",[a("Input",{attrs:{readonly:"",disabled:t.disabled,placeholder:"测点"},on:{"on-focus":function(e){t.show=!0}},model:{value:t.value.title||"",callback:function(e){t.$set(t.value,"title||''",e)},expression:" value.title||'' "}})],1):t._e(),t._v(" "),a("Modal",{ref:"modal1",attrs:{"mask-closable":!1,title:"测点列表选择",width:"600",closable:""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("Row",[a("Col",{attrs:{xs:6,sm:6,md:6,lg:6}},[a("Input",{attrs:{size:"default",placeholder:"测点编号/名称"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.searchParams.queryName,callback:function(e){t.$set(t.searchParams,"queryName",e)},expression:"searchParams.queryName"}})],1),t._v(" "),a("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",shape:"circle"},on:{click:t.search}},[t._v("搜索")])],1),t._v(" "),a("br"),t._v(" "),a("Table",{ref:"table1",attrs:{columns:t.columns,data:t.listData,loading:t.loading,size:"small",stripe:""},on:{"on-select-all":t.onSelect,"on-select":t.onSelect,"on-selection-change":t.selectChange}}),t._v(" "),a("Page",{staticClass:"table-page",attrs:{total:t.total,"page-size":t.searchParams.pageSize,current:t.searchParams.currentPage,"show-total":"","show-elevator":"",size:"small"},on:{"on-change":t.pageChange}}),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},["multiple"==t.type?a("div",{staticClass:"c-modal-footer-btns"},[a("Button",{attrs:{type:"default",shape:"circle",size:"large"},on:{click:function(e){t.show=!1}}},[t._v("取消")]),t._v(" "),a("Button",{attrs:{type:"primary",shape:"circle",size:"large"},on:{click:t.chooses}},[t._v("确定")])],1):t._e()])],1)],1)};i._withStripped=!0;var n=a(39),r=a(11),o={components:{commonApi:n.a,util:r.a},props:{value:Object,tag:"",type:{type:String,default:"single"},disabled:{type:Boolean,default:!1}},data:function(){return{show:!1,searchParams:{filterId:"",tag:this.tag,queryName:"",executeStatus:"",siteId:null,datasource:"",pageSize:10,currentPage:1},listData:[],selected:[],total:0,loading:!1,modalSelected:{}}},mounted:function(){this.search()},computed:{columns:function(){var t=this,e=[];return"multiple"==this.type&&e.push({type:"selection",width:60,align:"left"}),e.push({title:"测点编号",key:"mpointId"}),e.push({title:"区域位置",key:"siteName"}),e.push({title:"测点名称",key:"mpointName"}),"single"==this.type&&e.push({title:"操作",key:"action",width:100,render:function(e,a){return e("div",[r.a.tableBtnStyle(e,(function(){t.choose(a.row)}),"选择")])}}),e}},created:function(){r.a.initTableColumnTitle(this.columns)},methods:{selectChange:function(t){this.modalSelected[this.searchParams.currentPage]=t},getData:function(){var t=this;this.loading=!0,this.$http.get(n.a.point,this.searchParams).then((function(e){t.loading=!1,e&&e.total>=0&&(t.total=e.total,t.listData=e.items?e.items:[],t.checkSelection(t.searchParams.currentPage))}))},checkSelection:function(t){var e=this,a=this.modalSelected[t]||[];this.listData.forEach((function(t){e.$set(t,"_checked",!1),a.forEach((function(a){a.id==t.id&&e.$set(t,"_checked",!0)}))}))},search:function(){this.modalSelected={},this.searchParams.currentPage=1,this.getData()},pageChange:function(t){this.searchParams.currentPage=t,this.getData()},onSelect:function(t,e){this.selected=t},choose:function(t){this.show=!1,this.value?(this.value.id=t.id,this.value.title=t.mpointName,this.value.unit=t.unit,this.$emit("input",this.value)):this.$emit("input",{id:t.id,title:t.mpointName,unit:t.unit})},chooses:function(){if(this.show=!1,"datainput"==this.tag){var t=[],e=this.modalSelected;for(var a in e)e[a].forEach((function(e){t.push(e)}));this.$emit("input",t)}else this.$emit("input",this.selected)}}},s=a(1),l=Object(s.a)(o,i,[],!1,null,null,null);l.options.__file="src/components/point-table-select.vue";e.a=l.exports},687:function(t,e,a){var i=a(911);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a(17).default)("19b58c5c",i,!1,{})},688:function(t,e,a){var i=a(913);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a(17).default)("7ba16a5d",i,!1,{})},910:function(t,e,a){"use strict";var i=a(687);a.n(i).a},911:function(t,e,a){var i=a(10),n=a(24),r=a(552),o=a(553),s=a(546);e=i(!1);var l=n(r),c=n(o),p=n(s);e.push([t.i,".import-detail .c-left-border-blue {\n  border: none;\n  position: relative;\n  top: -40px;\n  padding: 0;\n}\n.import-detail .equ-import-process {\n  width: 620px;\n  height: 110px;\n  background: #fff url("+l+") repeat-x 0 -9px;\n  margin: 0 auto 20px;\n  display: flex;\n  align-items: flex-start;\n  justify-content: space-between;\n}\n.import-detail .equ-import-process span {\n  font-size: 13px;\n  display: inline-block;\n  width: 74px;\n  height: 70px;\n  background: #fff url("+c+") no-repeat 15px -48px;\n  background-size: 60%;\n  text-align: center;\n  color: #666;\n  padding-top: 65px;\n}\n.import-detail .equ-import-process span.active {\n  font-size: 16px;\n  color: #4b7efe;\n  font-weight: 700;\n  background: #fff url("+c+') no-repeat 10px 10px;\n  background-size: 70%;\n}\n.import-detail .equ-import-upload {\n  height: 40px;\n  margin: 100px auto 20px;\n  text-align: center;\n}\n.import-detail .equ-import-upload .ivu-btn {\n  width: 110px;\n  border-radius: 15px;\n  font-size: 13px;\n  color: #fff;\n}\n.import-detail .equ-import-download {\n  text-align: center;\n  height: 40px;\n  margin: 0 auto;\n}\n.import-detail .equ-import-download a {\n  color: #4b7efe;\n  font-size: 13px;\n}\n.import-detail .equ-import-download .ivu-icon {\n  font-size: 14px;\n  margin-left: 7px;\n}\n.import-detail .equ-import-download div {\n  margin-top: 10px;\n}\n.import-detail .ivu-upload-list {\n  margin-top: -80px;\n}\n.import-detail .validate-box {\n  width: 600px;\n  height: 40px;\n  margin: 0 auto 20px;\n}\n.import-detail .validate-box li {\n  float: left;\n  width: 200px;\n  height: 40px;\n  line-height: 40px;\n  list-style: none;\n  text-align: center;\n}\n.import-detail .validate-box li:before {\n  content: "";\n  display: inline-block;\n  width: 10px;\n  height: 10px;\n  margin-right: 10px;\n  border-radius: 50%;\n}\n.import-detail .validate-box li.all-validate:before {\n  background-color: #4b7efe;\n}\n.import-detail .validate-box li.all-pass:before {\n  background-color: #55d43f;\n}\n.import-detail .validate-box li.all-error:before {\n  background-color: #e03d3e;\n}\n.import-detail .validate-box li em {\n  margin: 0 20px;\n  font-size: 26px;\n  font-weight: 700;\n  font-style: normal;\n  color: #000;\n}\n.import-detail .ivu-tabs {\n  width: 100%;\n}\n.import-detail .ivu-tabs-bar {\n  border-bottom: none;\n}\n.import-detail .ivu-tabs-nav-wrap {\n  border-top: 1px solid #dddee1;\n}\n.import-detail .ivu-icon-information-circled {\n  float: right;\n  margin-right: 0;\n  margin-left: 8px;\n  margin-top: 2px;\n  color: #e03e3c;\n}\n.import-detail .validate-list li {\n  float: left;\n  width: 300px;\n  margin: 20px 30px;\n  list-style: none;\n}\n.import-detail .no-data {\n  height: 50px;\n  line-height: 50px;\n  text-align: center;\n}\n.import-detail .validate-pass-box {\n  border-top: 1px solid #dddee1;\n  text-align: center;\n}\n.import-detail .validate-pass-box > span {\n  display: block;\n  margin-bottom: 15px;\n}\n.import-detail .validate-pass-box .complete-icon {\n  display: inline-block;\n  width: 80px;\n  height: 80px;\n  margin-top: 30px;\n  background: url('+p+") no-repeat;\n  background-size: 100%;\n}\n.import-detail .submit-btn {\n  display: block;\n  width: 120px;\n  margin: 0 auto;\n}\n.import-detail .ivu-tabs-content .validate-pass-box {\n  border-top: none;\n}\n.import-detail .complete-box {\n  margin: 30px auto 0;\n  text-align: center;\n}\n.import-detail .complete-box > h3 {\n  margin: 15px 0;\n}\n.import-detail .complete-box .btn-back {\n  width: 100px;\n  border: solid 1px #4b7efe;\n  color: #4b7efe;\n  background: #fff;\n}\n.import-modal {\n  text-align: center;\n  padding: 30px 0 0;\n}\n",""]),t.exports=e},912:function(t,e,a){"use strict";var i=a(688);a.n(i).a},913:function(t,e,a){(e=a(10)(!1)).push([t.i,"\n#edit-table .edit-table-header > div {\r\n    background: #e5e8e9;\r\n    padding: 10px;\n}\n#edit-table .edit-table-row {\r\n    border: 1px solid #e6e6e6;\r\n    border-top: none;\n}\n#edit-table .edit-table-row > div {\r\n    height: 45px;\r\n    background: #fff;\r\n    padding: 5px 10px;\n}\n#edit-table .edit-table-row:nth-child(2n-1) > div {\r\n    background: #f4f4f4;\n}\n#edit-table .edit-table-row .ivu-form-item-content {\r\n    margin-left: 0 !important;\n}\n#edit-table .edit-table-row .ivu-form-item-content {\r\n    margin-left: 0 !important;\n}\n#edit-table .edit-table-row .ivu-form-item {\r\n    margin-bottom: 0;\n}\n#edit-table .edit-table-row .ivu-form-item-content .ivu-form-item-error-tip {\r\n    display: none;\n}\n.no-data {\r\n    text-align: center;\r\n    color: #495060;\r\n    background: #fff;\r\n    height: 28px;\r\n    line-height: 28px;\n}\r\n",""]),t.exports=e}}]);