(window.webpackJsonp=window.webpackJsonp||[]).push([[145],{1171:function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"material c-main-border"},[o("div",{staticClass:"c-left-border-blue"},[o("h3",[t._v("仓库详细")]),t._v(" "),o("div",{staticClass:"c-btns-right"},[o("Button",{attrs:{type:"primary",shape:"circle",loading:t.submitLoading},on:{click:t.submit}},[t._v("保存")]),t._v(" "),o("Button",{staticClass:"c-btn-back",attrs:{type:"primary",shape:"circle"},on:{click:t.cancel}},[t._v("取消")])],1)]),t._v(" "),o("Form",{ref:"detailInfoForms",attrs:{model:t.detailInfo,rules:t.formRules,"label-width":100}},[o("div",{staticClass:"c-top-border-gray"},[o("div",{staticClass:"c-form-row-2col"},[o("div",{staticClass:"c-form-item"},[o("label",[t._v("仓库编号：")]),t._v("\n                    "+t._s(t.detailInfo.no)+"\n                ")]),t._v(" "),o("div",{staticClass:"c-form-item"},[o("FormItem",{attrs:{prop:"orgId",label:"所属组织："}},[o("dropdown-tree",{staticStyle:{width:"300px"},attrs:{url:t.orgTreeApi},on:{input:t.chooseOrg},model:{value:t.org,callback:function(e){t.org=e},expression:"org"}})],1)],1)]),t._v(" "),o("div",{staticClass:"c-form-row-2col"},[o("div",{staticClass:"c-form-item"},[o("FormItem",{attrs:{prop:"name",label:"仓库名称："}},[o("Input",{staticStyle:{width:"300px"},attrs:{type:"text"},model:{value:t.detailInfo.name,callback:function(e){t.$set(t.detailInfo,"name",e)},expression:"detailInfo.name"}})],1)],1),t._v(" "),o("div",{staticClass:"c-form-item"},[o("FormItem",{attrs:{prop:"personInCharge",label:"负责人："}},[o("Select",{staticStyle:{width:"300px"},model:{value:t.detailInfo.personInCharge,callback:function(e){t.$set(t.detailInfo,"personInCharge",e)},expression:"detailInfo.personInCharge"}},t._l(t.personInCharge,(function(e,a){return o("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1)],1)],1)]),t._v(" "),o("div",{staticClass:"c-form-row-1col"},[o("div",{staticClass:"c-form-item"},[o("FormItem",{attrs:{prop:"address",label:"仓库地址："}},[o("Input",{staticStyle:{width:"300px"},attrs:{type:"text"},model:{value:t.detailInfo.address,callback:function(e){t.$set(t.detailInfo,"address",e)},expression:"detailInfo.address"}})],1)],1)])])]),t._v(" "),o("div",{staticClass:"c-top-border-gray"},[o("Tabs",{attrs:{animated:!1}},[o("TabPane",{staticClass:"padding10",attrs:{label:"库存信息"}},[o("div",{staticClass:"padding10-0"},[o("Input",{staticStyle:{width:"180px"},attrs:{placeholder:"物料编号或物料名称",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchStock(e)}},model:{value:t.searchParamsByStock.queryName,callback:function(e){t.$set(t.searchParamsByStock,"queryName",e)},expression:"searchParamsByStock.queryName"}}),t._v(" "),o("Button",{staticClass:"c-btn-add",attrs:{type:"primary"},on:{click:t.searchStock}},[t._v("搜索")])],1),t._v(" "),o("Table",{attrs:{columns:t.columnsByStock,data:t.listDataByStock,loading:t.loadingByStock,stripe:""}}),t._v(" "),o("Page",{staticClass:"table-page",attrs:{total:t.totalByStock,"page-size":t.searchParamsByStock.pageSize,current:t.searchParamsByStock.currentPage,"show-total":"","show-elevator":""},on:{"on-change":t.pageChangeByStock}})],1),t._v(" "),o("TabPane",{staticClass:"padding10",attrs:{label:"库位信息"}},[o("div",{staticClass:"padding10-0 clearfix"},[o("div",{staticClass:"c-btns-right"},[o("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle",size:"small"},on:{click:t.addRow}},[t._v("库位新增")]),t._v(" "),o("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle",size:"small"},on:{click:t.toInfoImport}},[t._v("库位导入")])],1)]),t._v(" "),o("Table",{attrs:{columns:t.columnsByLocator,data:t.listDataByLocator,loading:t.loadingByLocator,stripe:""}}),t._v(" "),o("Page",{staticClass:"table-page",attrs:{total:t.totalByLocator,"page-size":t.searchParamsByLocator.pageSize,current:t.searchParamsByLocator.currentPage,"show-total":"","show-elevator":""},on:{"on-change":t.pageChangeByLocator}})],1)],1)],1)],1)};a._withStripped=!0;o(23);var i=o(11),r=o(145),n=o(527),s=o(107);function c(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,a)}return o}function l(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var u={components:{dropdownTree:r.a},data:function(){var t=this,e=this;return{orgTreeApi:s.a.getOrgTreeData,personInCharge:[],org:{id:"",title:"请选择"},detailInfo:{},formRules:{orgId:[{required:!0,validator:function(t,e,o){e?o():o(new Error("请选择组织"))}}],name:[{validator:function(e,o,a){o?t.$http.get(n.a.repertory.checkWarehousenameIsExist,{warehouseName:o,warehouseId:t.$route.params.id}).then((function(t){t.isExist?a(new Error("仓库名称已存在")):a()})):a(new Error("仓库名称不能为空"))},required:!0,trigger:"blur"}],personInCharge:{required:!0,validator:function(t,e,o){e?o():o(new Error("请选择负责人"))}}},searchParamsByStock:{warehouseNo:"",queryName:"",currentPage:1,pageSize:5},totalByStock:0,loadingByStock:!1,columnsByStock:[{title:"物料编号",key:"materielNumber"},{title:"物料名称",key:"materielName"},{title:"规格",key:"standard"},{title:"库位",key:"warehouseLocationNo"},{title:"数量",key:"amount"},{title:"计量单位",key:"measurementUnit"}],listDataByStock:[],searchParamsByLocator:{warehouseNo:"",locationNo:"",currentPage:1,pageSize:5},totalByLocator:0,loadingByLocator:!1,columnsByLocator:[{title:"库位编号",key:"locationNo",render:function(t,o){return t("div",[t("Input",{props:{value:o.row.locationNo},on:{input:function(t){o.row.locationNo=t,e.listDataByLocator[o.index]=o.row}}})])}},{title:"描述",key:"description",render:function(t,o){return t("div",[t("Input",{props:{value:o.row.description},on:{input:function(t){o.row.description=t,e.listDataByLocator[o.index]=o.row}}})])}},{title:"操作",key:"act",width:200,render:function(t,o){return t("div",[t("a",{attrs:{href:"javascript:;"},style:{color:"#4b7efe",margin:"0 10px 0 0"},on:{click:function(){o.row.id?e.$http.del(n.a.repertory.delWarehousePosition,{ids:o.row.id}).then((function(t){e.listDataByLocator.splice(o.index,1),e.$Notice.success({title:"删除成功！"})})):e.listDataByLocator.splice(o.index,1)}}},"删除")])}}],submitLoading:!1,listDataByLocator:[]}},methods:{cancel:function(){this.$router.back()},getListByStock:function(){var t=this;this.loadingByStock=!0,this.$http.get(n.a.repertory.getWarehouseInfo,this.searchParamsByStock).then((function(e){t.listDataByStock=e.items,t.totalByStock=e.total,t.loadingByStock=!1}))},getListByLocator:function(){var t=this;this.loadingByLocator=!0,this.$http.get(n.a.repertory.getPositionOfWarehouse,this.searchParamsByLocator).then((function(e){t.listDataByLocator=e.items,t.totalByLocator=e.total,t.loadingByLocator=!1}))},searchStock:function(){this.searchParamsByStock.currentPage=1,this.getListByStock()},searchLocator:function(){this.searchParamsByLocator.currentPage=1,this.getListByLocator()},pageChangeByStock:function(t){this.searchParamsByStock.currentPage=t,this.getListByStock()},pageChangeByLocator:function(t){this.searchParamsByLocator.currentPage=t,this.getListByLocator()},addRow:function(){this.listDataByLocator.push({warehouseNo:this.detailInfo.no,locationNo:"",description:"",isEdit:!0})},chooseOrg:function(){this.detailInfo.orgId=this.org.id,this.detailInfo.personInCharge="",this.org.id&&this.getUnderOrganizationUsers(this.org)},getUnderOrganizationUsers:function(t,e){var o=this;this.$http.get(n.a.getManaginguser,{orgIds:t.id}).then((function(t){t&&t.items&&(o.personInCharge=t.items,e&&e(o))}))},submit:function(t){var e=this,o=this;if(o.listDataByLocator.some((function(t,e){return!t.locationNo&&(o.$Notice.warning({title:"请输入第"+(e+1)+"行中的库位编号"}),!0)})))return!1;this.$refs.detailInfoForms.validate((function(a){a&&(e.submitLoading=!0,e.$http.put(n.a.repertory.changeWarehouses,function(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?c(Object(o),!0).forEach((function(e){l(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):c(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}({},e.detailInfo,{warehousePositions:e.listDataByLocator})).then((function(a){e.submitLoading=!1,a.count&&(e.$Notice.success({title:"保存成功！"}),i.a.checkType(t,"function")?t():o.$router.push({name:"storage-repertory-detail",params:{id:e.$route.params.id}}))})).catch((function(){e.submitLoading=!1})))}))},toInfoImport:function(){var t=this;this.submit((function(e){t.$router.push({name:"storage-repertory-import",params:{warehouseNo:t.detailInfo.no}})}))}},created:function(){var t=this,e=this.$route.params.id;i.a.initTableColumnTitle(this.columnsByStock),i.a.initTableColumnTitle(this.columnsByLocator),this.$http.get(n.a.repertory.getWarehouseDetail+"/"+e).then((function(e){t.org={id:e.orgId,title:e.orgName},t.detailInfo=e,t.searchParamsByStock.warehouseNo=e.no,t.searchParamsByLocator.warehouseNo=e.no,t.getListByStock(),t.getListByLocator(),t.getUnderOrganizationUsers(t.org)}))}},p=(o(997),o(1)),d=Object(p.a)(u,a,[],!1,null,null,null);d.options.__file="src/views/storage/repertory/edit.vue";e.default=d.exports},527:function(t,e,o){"use strict";var a=o(22),i={getWarehouseComboList:"/inventory/api/warehouse/comboList",getManaginguser:"/inventory/api/users/managinguser",category:{getTree:"/inventory/api/materiel-category/tree",getInfo:"/inventory/api/materiel-category/materiel",add:"/inventory/api/materiel-category/materiel",edit:"/inventory/api/materiel-category/materiel",del:"/inventory/api/materiel-category/materiel",search:"/inventory/api/materiel-category/list"},inventory:{audit:"/inventory/api/store-adjustment/audited",export:a.a+"/inventory/api/store-adjustment/export",url:"/inventory/api/store-adjustment/adjusment",list:"/inventory/api/store-adjustment/list",detailList:"/inventory/api/store-adjustment/detail/list",itemList:"/inventory/api/store-adjustment/materiel/list",move:"/inventory/api/store-adjustment/move",materielSearch:"/inventory/api/stock/materiel",materielPosition:"/inventory/api/stock/position",materielDepot:"/inventory/api/stock/warehous"},takeStock:{audit:"/inventory/api/materiel-inventory/audited",export:a.a+"/inventory/api/materiel-inventory/export",import:a.a+"/inventory/api/materiel-inventory/import",url:"/inventory/api/materiel-inventory/inventory",detailList:"/inventory/api/materiel-inventory/detail/list",list:"/inventory/api/materiel-inventory/list"},storage:{comboList:"/inventory/api/warehouse/comboList"},material:{getMaterielCategoryTree:"/inventory/api/materiel-category/tree/external",getMateriel:"/inventory/api/materiels",delMateriel:"/inventory/api/materiels",exportMateriel:a.a+"/inventory/api/materiels/excel-export",addMateriel:"/inventory/api/materiel",changeMateriel:"/inventory/api/materiel",getMaterielDetail:"/inventory/api/materiel",getDistribution:"/inventory/api/materielStocks/distribution",getMaterielStockLimits:"/inventory/api/materielStockLimits",bacthAddMaterielStockLimit:"/inventory/api/materielStockLimit/batch-save",updateMaterielStockLimit:"/inventory/api/materielStockLimit",delMaterielStockLimit:"/inventory/api/materielStockLimits",getUnitList:"/inventory/api/materiel/unit",modalMateriel:"/inventory/api/materiel/external",getExcel:a.a+"/inventory/api/excel-temlate-down",importExcel:a.a+"/inventory/api/excel-import",cancelExcelData:"/inventory/api/excel-data-cancel",saveExcelData:"/inventory/api/excel-data-save"},repertory:{getWarehouses:"/inventory/api/warehouses",exportWarehouse:a.a+"/inventory/api/warehouse/excel-export",delWarehouses:"/inventory/api/warehouses",changeWarehouses:"/inventory/api/warehouse",addWarehouse:"/inventory/api/warehouse",getWarehouseDetail:"/inventory/api/warehouse",getWarehouseInfo:"/inventory/api/warehouse/getWarehouseInfo",getPositionOfWarehouse:"/inventory/api/warehousePosition/positionList",bacthAddWarehouseposition:"/inventory/api/warehouseposition/batch-save",updateWarehousePosition:"/inventory/api/warehousePosition",delWarehousePosition:"/inventory/api/warehousePositions",positionByWarehouse:"/inventory/api/warehousePosition/move",checkWarehousenameIsExist:"/inventory/api/warehouse/check-warehousename-isexist",getExcel:a.a+"/inventory/api/warehousePosition/excel-temlate-down",importExcel:a.a+"/inventory/api/warehousePosition/excel-import",cancelExcelData:"/inventory/api/warehousePosition/excel-data-cancel",saveExcelData:"/inventory/api/warehousePosition/excel-data-save"},checkin:{getInbond:"/inventory/api/inbounds",delInbond:"/inventory/api/inbounds",addInbond:"/inventory/api/inbound",getInbondDetail:"/inventory/api/inbound",getInbondRecordList:"/inventory/api/inbound/inboundDetails",getPositionComboxList:"/inventory/api/warehousePosition/positionComboxList",auditeInbound:"/inventory/api/inbound/audite",getMaterielsByWareHouseNo:"/inventory/api/materiel/getMaterielsByWareHouseNo",getMateriels:"/inventory/api/materiel/getMateriels",updateInboundDetail:"/inventory/api/inboundDetail"},checkout:{getApplicantMember:"/uaa/api/users/select",getOutbond:"/inventory/api/outbounds",delOutbond:"/inventory/api/outbounds",addOutbond:"/inventory/api/outbound",getOutbondDetail:"/inventory/api/outbound",getOutbondRecordList:"/inventory/api/outboundDetail",auditeOutbound:"/inventory/api/outbound/audite",updateOutboundDetail:"/inventory/api/outboundDetail",getstock:"/inventory/api/stock/getstock",getMaterielsOutBound:"/inventory/api/materiel/getMaterielsOutBound"},allot:{getTransfer:"/inventory/api/transfer/list",delTransfer:"/inventory/api/transfer/transfer",addTransfer:"/inventory/api/transfer/transfer",getTransferDetail:"/inventory/api/transfer/transfer",getTransferDetailList:"/inventory/api/transfer/detail/list",auditTransfer:"/inventory/api/transfer/audited",updateTransfer:"/inventory/api/transfer/transfer",getMaterielList:"/inventory/api/transfer/materiel/list",getStockPosiComboList:"/inventory/api/stock/position",getWarehousePosition:"/inventory/api/warehousePosition/move"},reporting:{getStockInfo:"/inventory/api/stock/getstock-info",exportStockInfo:a.a+"/inventory/api/stock/getstock-info-excel-export",getStockInoutbound:"/inventory/api/stock/getstock-info-inoutbound",exportStockInoutbound:a.a+"/inventory/api/stock/getstock-info-inoutbound-excel-export",getStockMove:"/inventory/api/stock/get-inventory-mobility-report",exportStockMove:a.a+"/inventory/api/stock/get-inventory-mobility-report-excel-export",getInventoryProfitLossList:"/inventory/api/materiel-inventory/inventory-report",exportInventoryProfitLoss:a.a+"/inventory/api/materiel-inventory/inventory-report-export",getInventoryNumberList:"/inventory/api/materiel-inventory/inventory-report-inventory-number"}};e.a=i},723:function(t,e,o){var a=o(998);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o(17).default)("12cfd85b",a,!1,{})},997:function(t,e,o){"use strict";var a=o(723);o.n(a).a},998:function(t,e,o){(e=o(10)(!1)).push([t.i,"\n.material .ivu-tabs-bar {\r\n    margin-bottom: 0;\n}\n.c-btns-right .c-btn-add {\r\n    padding: 3px 15px;\n}\r\n",""]),t.exports=e}}]);