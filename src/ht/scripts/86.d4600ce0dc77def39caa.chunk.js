(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{1213:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"maintain-task-detail c-main-border"},[a("div",{staticClass:"c-left-border-blue"},[a("h3",[t._v("保养任务详情")]),t._v(" "),t.concernLoading?a("span",{staticClass:"c-btn-attention"},[t._v("正在处理...")]):a("span",[t.headerContent.concerned?a("a",{staticClass:"c-btn-attention",attrs:{href:"javascirpt:;"},on:{click:t.cancelConcern}},[t._v("取消关注")]):a("a",{staticClass:"c-btn-attention",attrs:{href:"javascript:;"},on:{click:t.concern}},[t._v("添加关注")])]),t._v(" "),a("div",{staticClass:"c-btns-right"},[1==t.headerContent.state||2==t.headerContent.state?a("Button",{attrs:{type:"primary",shape:"circle"},on:{click:function(e){t.isShowAssignDialog=!0}}},[t._v("任务转派")]):t._e(),t._v(" "),a("Button",{staticClass:"c-btn-back",attrs:{type:"primary",shape:"circle"},on:{click:t.back}},[t._v("返回")])],1)]),t._v(" "),a("div",{staticClass:"c-top-border-gray"},[a("div",{staticClass:"task-box"},[a("Row",{attrs:{gutter:16}},[a("Col",{attrs:{span:"12"}},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("保养任务名称：")]),t._v(" "),a("span",[t._v(t._s(t.headerContent.taskName))])])]),t._v(" "),a("Col",{attrs:{span:"12"}},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("任务状态：")]),t._v(" "),a("span",[t._v(t._s(t.taskStatus[t.headerContent.state]))])])])],1),t._v(" "),a("Row",{attrs:{gutter:16}},[a("Col",{attrs:{span:"12"}},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("所属组织：")]),t._v(" "),a("span",[t._v(t._s(t.headerContent.orgName))])])]),t._v(" "),a("Col",{attrs:{span:"12"}},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("执行开始日期：")]),t._v(" "),a("span",[t._v(t._s(t._f("F")(t.headerContent.startDate,"yyyy-MM-dd")))])])])],1),t._v(" "),a("Row",{attrs:{gutter:16}},[a("Col",{attrs:{span:"12"}},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("执行人员：")]),t._v(" "),a("span",[t._v(t._s(t.headerContent.executeUserName))])])]),t._v(" "),a("Col",{attrs:{span:"12"}},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("实际耗时：")]),t._v(" "),a("span",[t._v(t._s(t.headerContent.spentTime))])])])],1),t._v(" "),a("Row",{attrs:{gutter:16}},[a("Col",{attrs:{span:"12"}},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("保养持续时间：")]),t._v(" "),a("span",[t._v(t._s(t.headerContent.planDuration))])])])],1)],1)]),t._v(" "),a("div",{staticClass:"c-top-border-gray"},[a("Table",{attrs:{columns:t.columns,data:t.list,loading:t.loading,stripe:""}}),t._v(" "),a("Page",{staticClass:"table-page",attrs:{total:t.page.total,"page-size":t.page.pageSize,current:t.page.currentPage,"show-total":"","show-elevator":""},on:{"on-change":t.pageChange}})],1),t._v(" "),a("Modal",{attrs:{width:"330",title:"任务分派"},model:{value:t.isShowAssignDialog,callback:function(e){t.isShowAssignDialog=e},expression:"isShowAssignDialog"}},[a("p",{staticStyle:{height:"40px","font-size":"13px"}},[t._v("选择相应的执行人员进行分派：")]),t._v(" "),a("div",[a("dropdown-tree",{attrs:{url:t.orgTreeApi},on:{"on-change":t.getUnderOrganizationUsers},model:{value:t.org,callback:function(e){t.org=e},expression:"org"}}),t._v(" "),a("Form",{ref:"assignForm",attrs:{model:t.assignFormModel}},[a("FormItem",{attrs:{prop:"assignTo",rules:{required:!0,message:"请选择人员",trigger:"change",type:"number"}}},[a("Select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择人员"},model:{value:t.assignFormModel.assignTo,callback:function(e){t.$set(t.assignFormModel,"assignTo",e)},expression:"assignFormModel.assignTo"}},t._l(t.operators,(function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1)],1),t._v(" "),a("div",{staticStyle:{"margin-top":"30px"}},[a("Button",{attrs:{type:"primary",shape:"circle",size:"large",long:"",loading:t.btnLoading},on:{click:t.assign}},[t._v("分派")])],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"})])],1)};n._withStripped=!0;var i=a(23),r=a(145),s=a(523),o=a(11),l=a(547),c=a(107),d=a(148);function p(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function g(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var u={components:{dropdownTree:r.a,datepickerRanger:s.a},data:function(){var t=this;return{treeApi:c.a,concernLoading:!1,loading:!1,isShowAssignDialog:!1,btnLoading:!1,org:{id:"",title:"请选择组织"},orgTreeApi:c.a.getOrgTreeData,operators:[],assignFormModel:{assignTo:""},searchParams:{},page:{pageSize:10,currentPage:1,total:0},columns:[{title:"序号",width:60,render:function(t,e){return t("span",e.index+1)}},{title:"保养周期",key:"maintainPeriod",render:function(e,a){return e("span",t.repairPeriod[a.row.maintainPeriod-1].label)}},{title:"设备类型",key:"equipmentTypeName"},{title:"保养设备",key:"equipmentName"},{title:"保养内容",key:"contents"},{title:"检查方法",key:"maintainStep"},{title:"执行人",key:"executeUserName"}],headerContent:"",list:[]}},computed:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?p(Object(a),!0).forEach((function(e){g(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},Object(i.b)({taskStatus:function(t){return t.map.repair.taskStatus},repairPeriod:function(t){return t.map.repair.plan.repairPeriod}})),watch:{},methods:{getList:function(){var t=this;this.loading=!0,this.$http.get(l.a.getTaskDetailList,{taskId:this.$route.params.id,pageFlag:0,currentPage:this.page.currentPage,pageSize:this.page.pageSize}).then((function(e){t.list=e.items,t.page.total=e.total,t.loading=!1}))},getHeaderContent:function(){var t=this;this.$http.get(l.a.getTaskDetail+this.$route.params.id).then((function(e){t.headerContent=e}))},pageChange:function(t){this.page.currentPage=t,this.getList()},assign:function(){var t=this;this.$refs.assignForm.validate((function(e){e&&(t.btnLoading=!0,t.$http.get(l.a.taskTransfer,{taskId:t.$route.params.id,transferToId:t.assignFormModel.assignTo}).then((function(e){t.$Notice.success({title:"指派人员成功！"}),t.$router.back(),t.btnLoading=!1})))}))},getUnderOrganizationUsers:function(t){var e=this;this.$http.get(c.a.underOrganizationUsers,{orgId:t.id}).then((function(t){t&&t.length&&(e.operators=t)}))},back:function(){this.$router.back()},concern:function(){var t=this;this.concernLoading=!0,this.$http.post(d.a.addConcern,{concernId:this.$route.params.id,type:"maintain"}).then((function(e){e&&(t.$Notice.success({title:"关注成功！"}),t.headerContent.concerned=!0),t.concernLoading=!1}))},cancelConcern:function(){var t=this;this.concernLoading=!0,this.$http.del(d.a.cancelConcern,{concernIds:this.$route.params.id,type:"maintain"}).then((function(e){e&&(t.$Notice.success({title:"取消关注成功！"}),t.headerContent.concerned=!1),t.concernLoading=!1}))}},created:function(){o.a.initTableColumnTitle(this.columns),this.getHeaderContent(),this.getList()}},m=(a(898),a(1)),h=Object(m.a)(u,n,[],!1,null,null,null);h.options.__file="src/views/maintain/task/detail.vue";e.default=h.exports},515:function(t,e,a){var n=a(522);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(17).default)("43cd0b0e",n,!1,{})},517:function(t,e,a){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i={F:function(t,e){if(!t)return"";"object"!=n(t)&&(t=new Date(t)),e=e||"yyyy-MM-dd";var a=t.getFullYear().toString(),i={M:t.getMonth()+1,d:t.getDate(),h:t.getHours(),m:t.getMinutes(),s:t.getSeconds()};for(var r in e=e.replace(/(y+)/gi,(function(t,e){return a.substr(4-Math.min(4,e.length))})),i)e=e.replace(new RegExp("("+r+"+)","g"),(function(t,e){return i[r]<10&&e.length>1?"0"+i[r]:i[r]}));return e},str2Date:function(t){if(t)return"object"!=n(t)?new Date(t):t},firstDayByWeek:function(t){var e=i.str2Date(t)||new Date,a=e.getDay(),n=(0==a?7:a)-1;return i.midnight(new Date(e.getTime()-24*n*60*60*1e3))},firstDayByMonth:function(t){var e=i.str2Date(t)||new Date;return i.midnight(new Date(e.getFullYear(),e.getMonth(),1))},firstDayByYear:function(t){var e=i.str2Date(t)||new Date;return i.midnight(new Date(e.getFullYear(),0,1))},countDateByStep:function(t,e,a,n){t=i.formatePolyfill(t);var r,s=i.str2Date(t)||new Date(t),o=s.getTime(),l=(new Date).getTime();switch(a){case"day":r=o+864e5*e;break;case"week":r=o+6048e5*e;break;case"month":r=new Date(s.getFullYear(),s.getMonth()+e,s.getDate()).getTime(),n&&(r=new Date(s.getFullYear(),s.getMonth()+e,s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds()).getTime());break;case"year":r=new Date(s.getFullYear()+e,s.getMonth(),s.getDate()).getTime(),n&&(r=new Date(s.getFullYear()+e,s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds()).getTime())}return r>l&&(r=l),n?r:i.midnight(r)},midnight:function(t){return t?i.F(t)+" 00:00:00":""},beforeMidnight:function(t){return t?i.F(t)+" 23:59:59":""},midnightMill:function(t){var e=i.str2Date(t)||new Date;return new Date(i.midnight(e)).getTime()},chain:function(t,e){return i.countDateByStep(t,-1,e)},yearOFyear:function(t){return i.countDateByStep(t,-1,"year")},getPeriods:function(t){var e,a=t.beginDate,n=new Date(i.formatePolyfill(a)),r=n.getTime();switch(t.cycle){case"day":e=r+864e5;break;case"week":e=r+6048e5;break;case"month":e=new Date(n.getFullYear(),n.getMonth()+1,n.getDate(),0,0,0).getTime();break;case"year":e=new Date(n.getFullYear()+1,n.getMonth(),n.getDate(),0,0,0).getTime()}return{min:r,max:new Date(e).getTime()}},formatePolyfill:function(t){return"string"!=typeof t?t:("string"==typeof t&&0==/[TZ]/.test(t)&&(t=t.replace(/-/g,"/")),t)},getTerminalsByMonth:function(t,e){var a,n;return 0==e?(a=new Date(t,0,1,0,0,0),n=new Date(t,11,31,23,59,59)):(a=new Date(t,e-1,1,0,0,0),n=new Date(t,e,0,23,59,59)),{start:a,end:n}},transDateFromServer:function(t,e){return t?("string"==typeof t&&0==/[TZ]/.test(t)&&(t=t.replace(/-/g,"/")),i.F(t,e||"yyyy-MM-dd hh:mm")):""},transDateFromLocale:function(t){return t?("string"==typeof t&&(0==/[TZ]/.test(t)&&(t=t.replace(/-/g,"/")),t=new Date(t)),t.toISOString()):""},strToData:function(t){var e=t.split(" ")[0].split("-"),a=[];return void 0!==t.split(" ")[1]&&(a=t.split(" ")[1].split(":")),new Date(e[0],e[1]-1,e[2],null!==a[0]?a[0]:0,null!==a[1]?a[1]:0,null!==a[2]?a[2]:0)}};e.a=i},521:function(t,e,a){"use strict";var n=a(515);a.n(n).a},522:function(t,e,a){(e=a(10)(!1)).push([t.i,"\n.cmp-datepicker {\r\n\tdisplay: inline-block;\n}\r\n",""]),t.exports=e},523:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cmp-datepicker"},[a("DatePicker",{style:{width:t.width},attrs:{type:"date",placeholder:"开始日期",value:t.dateRange.start,disabled:t.disabled,options:t.startDateOptions},on:{"on-change":t.startDateChange}}),t._v(" "),a("span",[t._v(" - ")]),t._v(" "),a("DatePicker",{style:{width:t.width},attrs:{type:"date",placeholder:"结束日期",value:t.dateRange.end,disabled:t.disabled,options:t.endDateOptions},on:{"on-change":t.endDateChange}})],1)};n._withStripped=!0;var i=a(11),r=a(517),s={name:"datepickerRanger",props:{value:Object,width:String,disabled:{type:Boolean,default:!1},enabled:String},watch:{"value.start":function(t){this.dateRange.start=i.a.transDateFromServer(t,"yyyy-MM-dd")},"value.end":function(t){this.dateRange.end=i.a.transDateFromServer(t,"yyyy-MM-dd")}},data:function(){var t=this,e=r.a.midnightMill();return{dateRange:{start:i.a.transDateFromServer(this.value.start,"yyyy-MM-dd"),end:i.a.transDateFromServer(this.value.end,"yyyy-MM-dd")},startDateOptions:{disabledDate:function(a){return"coming"==t.enabled?a&&a.valueOf()<e:"halfYear"===t.enabled?a&&a.valueOf()<e-15552e6:t.dateRange.end&&a&&a.valueOf()>1*new Date(t.dateRange.end+" 23:59:59")}},endDateOptions:{disabledDate:function(a){var n=1*new Date(t.dateRange.start+" 00:00:00"),i=a&&a.valueOf();return"past"==t.enabled?a&&i>e:t.dateRange.start&&a&&i<n}}}},methods:{startDateChange:function(t){this.dateRange.start=t;var e=this.dateRange.start?i.a.transDateFromLocale(this.dateRange.start+" 00:00:00"):"",a=this.dateRange.end?i.a.transDateFromLocale(this.dateRange.end+" 23:59:59"):"";this.$emit("input",{start:e,end:a}),this.$emit("on-change",{start:e,end:a})},endDateChange:function(t){this.dateRange.end=t;var e=this.dateRange.start?i.a.transDateFromLocale(this.dateRange.start+" 00:00:00"):"",a=this.dateRange.end?i.a.transDateFromLocale(this.dateRange.end+" 23:59:59"):"";this.$emit("input",{start:e,end:a}),this.$emit("on-change",{start:e,end:a})}}},o=(a(521),a(1)),l=Object(o.a)(s,n,[],!1,null,null,null);l.options.__file="src/components/datepicker-ranger.vue";e.a=l.exports},547:function(t,e,a){"use strict";var n={getPlans:"/equipment/api/maintains/plans",getPlanDetail:"/equipment/api/maintain/plan/",getPlanDetailList:"/equipment/api/maintain/plan/detail",initPlanDetailList:"/equipment/api/maintains/initGenerate",delPlans:"/equipment/api/maintains/plan",addPlan:"/equipment/api/maintains/plan",assignPlan:"/equipment/api/maintains/plan/assign",getTasks:"/equipment/api/maintains/tasks",delTask:"/equipment/api/maintains/task",stopTask:"/equipment/api/maintains/task/stop",getTaskDetail:"/equipment/api/maintain/task/",getTaskDetailList:"/equipment/api/maintain/task/detail/",taskTransfer:"/equipment/api/maintains/task/transfer",gatStatistics:"/equipment/api/maintains/statistics",export:a(22).a+"/equipment/api/maintains/statistics-excel-export",getContents:"/equipment/api/maintain/plan/contents/",planIssued:"/equipment/api/maintains/plan/distributeTask",getTaskByEqu:"/equipment/api/maintains/tasks/equ"};e.a=n},675:function(t,e,a){var n=a(899);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(17).default)("68486301",n,!1,{})},898:function(t,e,a){"use strict";var n=a(675);a.n(n).a},899:function(t,e,a){(e=a(10)(!1)).push([t.i,'.maintain-task-detail .c-top-border-gray {\n  position: relative;\n}\n.maintain-task-detail .c-top-border-gray .task-box {\n  width: 916px;\n}\n.maintain-task-detail .c-top-border-gray .task-box .ivu-row {\n  padding: 5px 0;\n}\n.maintain-task-detail .c-top-border-gray .task-box .task-border-top {\n  position: absolute;\n  top: 175px;\n  width: 100%;\n  padding: 0 30px 0 20px;\n}\n.maintain-task-detail .c-top-border-gray .task-box .task-border-top:after {\n  content: "";\n  display: block;\n  border-top: 1px solid #e6e6e6;\n}\n.maintain-task-detail .c-top-border-gray .task-box .task-remark-box {\n  position: relative;\n  padding-left: 100px;\n  width: 100%;\n}\n.maintain-task-detail .c-top-border-gray .task-box .task-remark-box label {\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n.maintain-task-detail .c-top-border-gray .task-box .task-remark-box .task-remark {\n  display: inline-block;\n  width: 100%;\n  padding: 0 10px;\n  line-height: 35px;\n}\n',""]),t.exports=e}}]);