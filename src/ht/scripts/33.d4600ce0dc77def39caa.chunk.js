(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{1262:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"c-main-border"},[a("div",{staticClass:"c-left-border-blue"},[a("h3",{domProps:{textContent:t._s(t.ISADD?"新增用户":"用户编辑")}}),t._v(" "),a("div",{staticClass:"c-btns-right"},[a("Button",{attrs:{type:"primary",shape:"circle",loading:t.submitLoading},on:{click:function(e){return t.handleSubmit("formValidate")}}},[t._v("保存")]),t._v(" "),a("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"default",shape:"circle"},on:{click:t.handleCancle}},[t._v("取消")])],1)]),t._v(" "),a("div",{staticClass:"c-top-border-gray padding20"},[a("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":80}},[a("div",{staticClass:"c-form-row-2col"},[a("FormItem",{attrs:{label:"用户姓名:",prop:"name"}},[a("Input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入用户姓名"},model:{value:t.formValidate.name,callback:function(e){t.$set(t.formValidate,"name",e)},expression:"formValidate.name"}})],1)],1),t._v(" "),a("div",{staticClass:"c-form-row-2col"},[a("FormItem",{staticClass:"orgId",attrs:{label:"所属组织:",prop:"orgId"}},[a("dropdown-tree",{attrs:{url:t.treeApi.getOrgTreeData,multiple:!1,width:"350"},on:{"on-change":t.chooseOrg},model:{value:t.org,callback:function(e){t.org=e},expression:"org"}})],1)],1),t._v(" "),a("div",{staticClass:"c-form-row-2col"},[a("FormItem",{attrs:{label:"手机号:",prop:"tel"}},[a("Input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入手机号"},model:{value:t.formValidate.tel,callback:function(e){t.$set(t.formValidate,"tel",e)},expression:"formValidate.tel"}}),t._v(" "),a("Tooltip",{attrs:{placement:"right"}},[a("Icon",{attrs:{type:"help-circled",size:"18",color:"#adadad"}}),t._v(" "),a("ul",{staticStyle:{"white-space":"normal","padding-left":"15px"},attrs:{slot:"content"},slot:"content"},[a("li",[t._v("手机和邮箱地址是作为用户登录时使用的ID。")]),t._v(" "),a("li",[t._v("请正确填写真实有效的手机号和邮箱地址。")]),t._v(" "),a("li",[t._v("\n                                如有问题请与我们联系。\n                                "),a("a",{staticStyle:{float:"right","margin-top":"-3px"},attrs:{href:"javascript:;"},on:{click:t.contactUs}},[a("Icon",{attrs:{type:"ios-email-outline",size:"24",color:"#fff"}})],1)])])],1)],1)],1),t._v(" "),a("div",{staticClass:"c-form-row-2col"},[a("FormItem",{attrs:{label:"邮箱:"}},[a("Input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入邮箱"},model:{value:t.formValidate.email,callback:function(e){t.$set(t.formValidate,"email",e)},expression:"formValidate.email"}})],1)],1)])],1)])};i._withStripped=!0;var r=a(145),o=(a(11),a(107)),l=a(148),s={components:{dropdownTree:r.a},data:function(){return{submitLoading:!1,ISADD:!0,treeApi:o.a,isShowOrgTree:!1,formValidate:{name:"",orgId:"",email:"",tel:""},org:{id:"",title:"请选择"},ruleValidate:{name:[{required:!0,message:"请输入姓名",trigger:"blur"},{max:20,message:"用户姓名不能超过20个字符",trigger:"change"}],orgId:[{required:!0,validator:function(t,e,a){e?a():a(new Error("请选择组织"))}}],tel:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:function(t,e,a){/\d{11}/.test(e)?a():a(new Error("请正确输入有效的手机号"))},trigger:"blur"}]},defaultProps:{children:"children",label:"title"}}},mounted:function(){var t=this;this.$route.params&&this.$route.params.id?this.ISADD=!1:this.ISADD=!0,this.ISADD||this.$http.get(l.a.getUser+"/"+this.$route.params.id).then((function(e){t.formValidate=e,t.formValidate.orgChain.forEach((function(e){e.id===t.formValidate.orgId&&(t.org.id=e.id,t.org.title=e.name)}))}))},methods:{filterNode:function(t,e){return!t||-1!==e.title.indexOf(t)},chooseOrg:function(){this.formValidate.orgId=this.org.id},handleSubmit:function(t){var e=this;this.$refs[t].validate((function(t){if(t){e.submitLoading=!0;var a=Object.assign({},e.formValidate,{orgId:e.org.id});(e.ISADD?e.$http.post(l.a.updateUser,a):e.$http.put(l.a.updateUser,a)).then((function(t){t.id||t.count?(e.$Notice.success({title:"成功",desc:"数据保存成功",duration:3}),e.$router.back()):e.submitLoading=!1})).catch((function(){e.submitLoading=!1}))}}))},handleReset:function(t){this.$refs[t].resetFields()},handleCancle:function(){window.history.go(-1)},contactUs:function(){this.$router.push({name:"feedback"})}}},n=a(1),c=Object(n.a)(s,i,[],!1,null,null,null);c.options.__file="src/views/basic/user-edit.vue";e.default=c.exports}}]);