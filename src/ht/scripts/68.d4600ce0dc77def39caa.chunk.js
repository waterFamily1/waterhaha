(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{1225:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"fault c-main-border"},[a("div",{staticClass:"c-left-border-blue"},[a("div",{staticClass:"c-search-main"},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("关键字：")]),a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"缺陷类型/编号"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.searchParams.queryName,callback:function(e){t.$set(t.searchParams,"queryName",e)},expression:"searchParams.queryName"}})],1),t._v(" "),a("div",{staticClass:"c-form-item"},[a("label",[t._v("所属组织：")]),t._v(" "),a("dropdown-tree",{attrs:{url:t.orgTreeApi,multiple:!0,width:200},model:{value:t.org,callback:function(e){t.org=e},expression:"org"}})],1),t._v(" "),a("div",{staticClass:"c-adv-search-btn"},[a("a",{attrs:{href:"javascript:;"},on:{click:function(e){t.advSearch=!t.advSearch}}},[a("Icon",{directives:[{name:"show",rawName:"v-show",value:!t.advSearch,expression:"!advSearch"}],attrs:{type:"ios-arrow-down"}}),a("Icon",{directives:[{name:"show",rawName:"v-show",value:t.advSearch,expression:"advSearch"}],attrs:{type:"ios-arrow-up"}}),t._v("高级搜索")],1),t._v(" "),a("Button",{attrs:{type:"primary",shape:"circle"},on:{click:t.search}},[t._v("搜索")]),t._v(" "),a("Button",{staticClass:"c-btn-reset",attrs:{type:"primary",shape:"circle"},on:{click:t.searchParamsClean}},[t._v("重置")])],1)]),t._v(" "),a("collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.advSearch,expression:"advSearch"}],staticClass:"c-adv-search"},[a("div",{staticClass:"c-adv-search-row"},[a("div",{staticClass:"c-form-item"},[a("label",[t._v("创建时间：")]),t._v(" "),a("datepicker-ranger",{model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1)]),t._v(" "),a("div",{staticClass:"c-adv-search-row"},[a("div",{staticClass:"c-form-item c-form-item-tab"},[a("label",[t._v("状态：")]),t._v(" "),a("mg-tab",{attrs:{groups:t.faultState,multiple:!0,entire:!0},on:{"on-click":t.search},model:{value:t.states,callback:function(e){t.states=e},expression:"states"}})],1)]),t._v(" "),a("div",{staticClass:"c-adv-search-row"},[a("div",{staticClass:"c-form-item c-form-item-tab"},[a("label",[t._v("缺陷类型：")]),t._v(" "),a("mg-tab",{attrs:{groups:t.faultType,multiple:!0,entire:!0},on:{"on-click":t.search},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}})],1)]),t._v(" "),a("div",{staticClass:"c-adv-search-row"},[a("div",{staticClass:"c-form-item c-form-item-tab"},[a("label",[t._v("级别：")]),t._v(" "),a("mg-tab",{attrs:{groups:t.faultLevel,multiple:!0,entire:!0},on:{"on-click":t.search},model:{value:t.level,callback:function(e){t.level=e},expression:"level"}})],1)])])])],1),t._v(" "),a("div",{staticClass:"c-top-border-gray"},[a("div",{staticClass:"c-table-top-btns"},[a("Button",{staticClass:"c-btn-add",attrs:{type:"primary",shape:"circle"},on:{click:t.toReportPage}},[t._v("缺陷申报")])],1),t._v(" "),a("Table",{attrs:{columns:t.columns,data:t.listData,loading:t.loading,stripe:""}}),t._v(" "),a("Page",{staticClass:"table-page",attrs:{total:t.total,"page-size":t.searchParams.pageSize,current:t.searchParams.currentPage,"show-total":"","show-elevator":""},on:{"on-change":t.pageChange}})],1)])};s._withStripped=!0;var n=a(23),r=a(519),i=a(145),l=a(523),o=a(524),c=a(11),d=a(573),u=a(107),h={name:"fault",data:function(){var t=this;return{advSearch:!1,dateRange:{start:"",end:""},org:{id:"",title:"请选择"},type:[],states:["0","1","2","5"],level:[],searchParams:{queryName:"",orgIds:"",faultTypes:"",states:"0,1,2,5",startDate:"",endDate:"",severityTypes:"",pageSize:10,currentPage:1},columns:[{title:"缺陷类型",key:"faultTypeName",width:120},{title:"缺陷编号",key:"faultNumber"},{title:"相关设备",key:"equName"},{title:"级别",key:"severityTypeName",width:80},{title:"创建人",key:"createUser"},{title:"创建时间",key:"createDate",width:110,render:function(t,e){return c.a.tableDatetime(t,e.row.createDate)}},{title:"关闭时间",key:"finishTime",width:110,render:function(t,e){return c.a.tableDatetime(t,e.row.finishTime)}},{title:"所属组织",key:"orgName"},{title:"当前状态",key:"stateName",width:110},{title:"当前处理人",key:"processingPersonName"},{title:"操作",key:"act",width:100,render:function(e,a){return e("div",[c.a.tableBtnStyle(e,(function(){t.$router.push({name:"fault-detail",params:{id:a.row.id}})}),"查看")])}}],listData:[],loading:!1,total:0,orgTreeApi:u.a.getOrgTreeData}},computed:Object(n.b)({faultState:function(t){return t.map.fault.state},faultType:function(t){return t.map.fault.type},faultLevel:function(t){return t.map.fault.level},faultStateText:function(t){return t.map.fault.stateText},faultTypeText:function(t){return t.map.fault.typeText},faultLevelText:function(t){return t.map.fault.levelText}}),methods:{getFaults:function(){var t=this;this.$setSearchParams((function(e){t.searchParams=e,t.org.id=t.searchParams.orgIds,t.org.title=t.searchParams.orgNames,t.type=t.searchParams.faultTypes?t.searchParams.faultTypes.split(","):[],t.states=t.searchParams.states?t.searchParams.states.split(","):[],t.dateRange.start=t.searchParams.startDate&&new Date(t.searchParams.startDate),t.dateRange.end=t.searchParams.endDate&&new Date(t.searchParams.endDate),t.level=t.searchParams.severityTypes?t.searchParams.severityTypes.split(","):[]})),this.loading=!0,this.$http.get(d.a.getFaults,this.searchParams).then((function(e){t.listData=e.items,t.total=e.total,t.loading=!1}))},search:function(){this.searchParams.faultTypes=this.type.join(),this.searchParams.states=this.states.join(),this.searchParams.startDate=c.a.transDateFromLocale(this.dateRange.start),this.searchParams.endDate=c.a.transDateFromLocale(this.dateRange.end),this.searchParams.orgIds=this.org.id,this.searchParams.orgNames=this.org.title,this.searchParams.currentPage=1,this.searchParams.severityTypes=this.level.join(),this.getFaults(),this.$addRouteFilter({routeName:"fault",searchParams:this.searchParams})},searchParamsClean:function(){this.dateRange.start="",this.dateRange.end="",this.type=[],this.states=[],this.level=[],this.org={id:"",title:""},this.searchParams={queryName:"",orgIds:"",faultTypes:"",states:"",startDate:"",endDate:"",severityTypes:"",pageSize:10,currentPage:1},this.$cleanRouteFilter()},pageChange:function(t){this.searchParams.currentPage=t,this.getFaults(),this.$addRouteFilter({routeName:"fault",searchParams:this.searchParams})},toReportPage:function(){this.$router.push({name:"fault-add"})}},components:{dropdownTree:i.a,datepickerRanger:l.a,CollapseTransition:r.a,mgTab:o.a},created:function(){c.a.initTableColumnTitle(this.columns),this.getFaults()}},p=a(1),m=Object(p.a)(h,s,[],!1,null,null,null);m.options.__file="src/views/fault/list.vue";e.default=m.exports},515:function(t,e,a){var s=a(522);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);(0,a(17).default)("43cd0b0e",s,!1,{})},516:function(t,e,a){var s=a(526);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);(0,a(17).default)("5a7c571a",s,!1,{})},517:function(t,e,a){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n={F:function(t,e){if(!t)return"";"object"!=s(t)&&(t=new Date(t)),e=e||"yyyy-MM-dd";var a=t.getFullYear().toString(),n={M:t.getMonth()+1,d:t.getDate(),h:t.getHours(),m:t.getMinutes(),s:t.getSeconds()};for(var r in e=e.replace(/(y+)/gi,(function(t,e){return a.substr(4-Math.min(4,e.length))})),n)e=e.replace(new RegExp("("+r+"+)","g"),(function(t,e){return n[r]<10&&e.length>1?"0"+n[r]:n[r]}));return e},str2Date:function(t){if(t)return"object"!=s(t)?new Date(t):t},firstDayByWeek:function(t){var e=n.str2Date(t)||new Date,a=e.getDay(),s=(0==a?7:a)-1;return n.midnight(new Date(e.getTime()-24*s*60*60*1e3))},firstDayByMonth:function(t){var e=n.str2Date(t)||new Date;return n.midnight(new Date(e.getFullYear(),e.getMonth(),1))},firstDayByYear:function(t){var e=n.str2Date(t)||new Date;return n.midnight(new Date(e.getFullYear(),0,1))},countDateByStep:function(t,e,a,s){t=n.formatePolyfill(t);var r,i=n.str2Date(t)||new Date(t),l=i.getTime(),o=(new Date).getTime();switch(a){case"day":r=l+864e5*e;break;case"week":r=l+6048e5*e;break;case"month":r=new Date(i.getFullYear(),i.getMonth()+e,i.getDate()).getTime(),s&&(r=new Date(i.getFullYear(),i.getMonth()+e,i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds()).getTime());break;case"year":r=new Date(i.getFullYear()+e,i.getMonth(),i.getDate()).getTime(),s&&(r=new Date(i.getFullYear()+e,i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds()).getTime())}return r>o&&(r=o),s?r:n.midnight(r)},midnight:function(t){return t?n.F(t)+" 00:00:00":""},beforeMidnight:function(t){return t?n.F(t)+" 23:59:59":""},midnightMill:function(t){var e=n.str2Date(t)||new Date;return new Date(n.midnight(e)).getTime()},chain:function(t,e){return n.countDateByStep(t,-1,e)},yearOFyear:function(t){return n.countDateByStep(t,-1,"year")},getPeriods:function(t){var e,a=t.beginDate,s=new Date(n.formatePolyfill(a)),r=s.getTime();switch(t.cycle){case"day":e=r+864e5;break;case"week":e=r+6048e5;break;case"month":e=new Date(s.getFullYear(),s.getMonth()+1,s.getDate(),0,0,0).getTime();break;case"year":e=new Date(s.getFullYear()+1,s.getMonth(),s.getDate(),0,0,0).getTime()}return{min:r,max:new Date(e).getTime()}},formatePolyfill:function(t){return"string"!=typeof t?t:("string"==typeof t&&0==/[TZ]/.test(t)&&(t=t.replace(/-/g,"/")),t)},getTerminalsByMonth:function(t,e){var a,s;return 0==e?(a=new Date(t,0,1,0,0,0),s=new Date(t,11,31,23,59,59)):(a=new Date(t,e-1,1,0,0,0),s=new Date(t,e,0,23,59,59)),{start:a,end:s}},transDateFromServer:function(t,e){return t?("string"==typeof t&&0==/[TZ]/.test(t)&&(t=t.replace(/-/g,"/")),n.F(t,e||"yyyy-MM-dd hh:mm")):""},transDateFromLocale:function(t){return t?("string"==typeof t&&(0==/[TZ]/.test(t)&&(t=t.replace(/-/g,"/")),t=new Date(t)),t.toISOString()):""},strToData:function(t){var e=t.split(" ")[0].split("-"),a=[];return void 0!==t.split(" ")[1]&&(a=t.split(" ")[1].split(":")),new Date(e[0],e[1]-1,e[2],null!==a[0]?a[0]:0,null!==a[1]?a[1]:0,null!==a[2]?a[2]:0)}};e.a=n},519:function(t,e,a){"use strict";function s(t,e){if(!t||!e)return!1;if(-1!==e.indexOf(" "))throw new Error("className should not contain space.");return t.classList?t.classList.contains(e):(" "+t.className+" ").indexOf(" "+e+" ")>-1}function n(t,e){if(t){for(var a=t.className,n=(e||"").split(" "),r=0,i=n.length;r<i;r++){var l=n[r];l&&(t.classList?t.classList.add(l):s(t,l)||(a+=" "+l))}t.classList||(t.className=a)}}function r(t,e){if(t&&e){for(var a=e.split(" "),n=" "+t.className+" ",r=0,i=a.length;r<i;r++){var l=a[r];l&&(t.classList?t.classList.remove(l):s(t,l)&&(n=n.replace(" "+l+" "," ")))}t.classList||(t.className=trim(n))}}var i={beforeEnter:function(t){n(t,"collapse-transition"),t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.style.height="0",t.style.paddingTop=0,t.style.paddingBottom=0},enter:function(t){t.dataset.oldOverflow=t.style.overflow,0!==t.scrollHeight?(t.style.height=t.scrollHeight+"px",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom):(t.style.height="",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom),t.style.overflow="hidden"},afterEnter:function(t){r(t,"collapse-transition"),t.style.height="",t.style.overflow=t.dataset.oldOverflow},beforeLeave:function(t){t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.dataset.oldOverflow=t.style.overflow,t.style.height=t.scrollHeight+"px",t.style.overflow="hidden"},leave:function(t){0!==t.scrollHeight&&(n(t,"collapse-transition"),t.style.height=0,t.style.paddingTop=0,t.style.paddingBottom=0)},afterLeave:function(t){r(t,"collapse-transition"),t.style.height="",t.style.overflow=t.dataset.oldOverflow,t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom}};e.a={name:"CollapseTransition",functional:!0,render:function(t,e){var a=e.children;return t("transition",{on:i},a)}}},521:function(t,e,a){"use strict";var s=a(515);a.n(s).a},522:function(t,e,a){(e=a(10)(!1)).push([t.i,"\n.cmp-datepicker {\r\n\tdisplay: inline-block;\n}\r\n",""]),t.exports=e},523:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cmp-datepicker"},[a("DatePicker",{style:{width:t.width},attrs:{type:"date",placeholder:"开始日期",value:t.dateRange.start,disabled:t.disabled,options:t.startDateOptions},on:{"on-change":t.startDateChange}}),t._v(" "),a("span",[t._v(" - ")]),t._v(" "),a("DatePicker",{style:{width:t.width},attrs:{type:"date",placeholder:"结束日期",value:t.dateRange.end,disabled:t.disabled,options:t.endDateOptions},on:{"on-change":t.endDateChange}})],1)};s._withStripped=!0;var n=a(11),r=a(517),i={name:"datepickerRanger",props:{value:Object,width:String,disabled:{type:Boolean,default:!1},enabled:String},watch:{"value.start":function(t){this.dateRange.start=n.a.transDateFromServer(t,"yyyy-MM-dd")},"value.end":function(t){this.dateRange.end=n.a.transDateFromServer(t,"yyyy-MM-dd")}},data:function(){var t=this,e=r.a.midnightMill();return{dateRange:{start:n.a.transDateFromServer(this.value.start,"yyyy-MM-dd"),end:n.a.transDateFromServer(this.value.end,"yyyy-MM-dd")},startDateOptions:{disabledDate:function(a){return"coming"==t.enabled?a&&a.valueOf()<e:"halfYear"===t.enabled?a&&a.valueOf()<e-15552e6:t.dateRange.end&&a&&a.valueOf()>1*new Date(t.dateRange.end+" 23:59:59")}},endDateOptions:{disabledDate:function(a){var s=1*new Date(t.dateRange.start+" 00:00:00"),n=a&&a.valueOf();return"past"==t.enabled?a&&n>e:t.dateRange.start&&a&&n<s}}}},methods:{startDateChange:function(t){this.dateRange.start=t;var e=this.dateRange.start?n.a.transDateFromLocale(this.dateRange.start+" 00:00:00"):"",a=this.dateRange.end?n.a.transDateFromLocale(this.dateRange.end+" 23:59:59"):"";this.$emit("input",{start:e,end:a}),this.$emit("on-change",{start:e,end:a})},endDateChange:function(t){this.dateRange.end=t;var e=this.dateRange.start?n.a.transDateFromLocale(this.dateRange.start+" 00:00:00"):"",a=this.dateRange.end?n.a.transDateFromLocale(this.dateRange.end+" 23:59:59"):"";this.$emit("input",{start:e,end:a}),this.$emit("on-change",{start:e,end:a})}}},l=(a(521),a(1)),o=Object(l.a)(i,s,[],!1,null,null,null);o.options.__file="src/components/datepicker-ranger.vue";e.a=o.exports},524:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cmp-tab",class:{"cmp-tab-underline":t.underline}},t._l(t.items,(function(e){return a("a",{key:e.value,class:{active:t.activeIds.indexOf(e.value)>-1},attrs:{href:"javascript:;"},on:{click:function(a){return t.selectTab(e)}}},[t._v(t._s(e.label))])})),0)};function n(t){return function(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}s._withStripped=!0;var r=null,i={name:"mgTab",props:{groups:Array,value:Array,multiple:{type:Boolean,default:!1},entire:{type:Boolean,default:!1},underline:Boolean},data:function(){return{activeIds:this.value,items:n(this.groups)}},watch:{groups:function(t){this.entire?this.items=[{label:"全部",value:r}].concat(n(t)):this.items=t},value:function(t){this.activeIds=t}},mounted:function(){this.entire&&this.items.unshift({label:"全部",value:r})},methods:{isSelected:function(t){return this.activeIds.indexOf(t)>-1},removeFromSelected:function(t){var e=this;this.activeIds.forEach((function(a,s){a==t&&e.activeIds.splice(s,1)}))},selectTab:function(t){this.entire&&t.value===r?this.activeIds=[r]:this.multiple?this.isSelected(t.value)?this.removeFromSelected(t.value):(this.activeIds.push(t.value),this.entire&&this.removeFromSelected(r)):(this.activeIds=[],this.activeIds.push(t.value)),this.$emit("input",this.activeIds),this.$emit("on-click",this.activeIds)},setValue:function(t){this.activeIds=t,this.$emit("input",this.activeIds)}}},l=(a(525),a(1)),o=Object(l.a)(i,s,[],!1,null,null,null);o.options.__file="src/components/mg-tab.vue";e.a=o.exports},525:function(t,e,a){"use strict";var s=a(516);a.n(s).a},526:function(t,e,a){(e=a(10)(!1)).push([t.i,"\n.cmp-tab {\r\n\tdisplay: inline-block;\n}\n.cmp-tab a {\r\n\tmargin-right: 20px;\t\r\n\tcolor: #576374;\n}\n.cmp-tab .active{\r\n\tcolor: #4B7EFE;\n}\n.cmp-tab-underline a {\r\n\tpadding: 2px 1px;\r\n\ttext-align: center;\n}\n.cmp-tab-underline .active  {\r\n\tborder-bottom: 2px solid #4B7EFE;\n}\r\n",""]),t.exports=e},573:function(t,e,a){"use strict";var s={faultReport:"/equipment/api/faults",getFaults:"/equipment/api/faults",getFaultDetail:"/equipment/api/faults",taskAssign:"/equipment/api/faults/assign",taskHandle:"/equipment/api/faults/process",getFaultStatistics:"/equipment/api/faults/statistics",export:a(22).a+"/equipment/api/faults/statistics-export",getFaultsEqu:"/equipment/api/faults/equ",getSpare:"/inventory/api/outbounds/web"};e.a=s}}]);